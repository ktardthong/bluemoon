<md-content>
  <div ui-view="header"></div>

  <section class="gray-background margin-top">

    <div layout="row" class="container animated slideInUp">

      <md-sidenav
        flex-auto
        layout="column"
        class="md-sidenav-left"
        md-component-id="left"
        md-is-locked-open="$mdMedia('gt-sm')">
        <div flex>
          Login
        </div>
        Rules
      </md-sidenav>

      <div flex class="md-padding">

        <!-- Creation form -->
        <div ng-controller="TopicCtrl as topicCtrl">

          <md-content ng-if="topicCtrl.auth.ref.getAuth().uid" class="md-padding md-whiteframe-1dp">

            <form ng-submit="topicCtrl.createTopic(cateCtrl.cateName.$id,topic.isDraft)"
                  ng-init="topic.isDraft = 0">
              <md-list>
                <md-list-item class="md-3-line">
                  <img ng-src="{{topicCtrl.profile.photo}}"
                       class="img-circle" width="36px">

                  <div class="md-list-item-text" layout="column">

                    <!-- Topics -->
                    <md-input-container ng-click="topicCtrl.body.show = true" flex="" ng-keyup="topicCtrl.checkSlug()">
                      <label>Topic</label>
                      <input ng-model="topicCtrl.newTopic.topic" autocomplete="off">
                    </md-input-container>

                    <div ng-if="topicCtrl.slugReturn != null">
                      <p class="md-title">Topic already exist</p>
                      <!-- if the topic's slug exist list them here -->
                      <div ng-repeat="data in topicCtrl.slugReturn">
                        {{data}}
                      </div>
                    </div>

                    <md-input-container class="md-block" flex-gt-sm>
                      <label>Create</label>
                      <md-select ng-model="topicCtrl.type">
                        <md-option><i class="ion-ios-help-outline"></i> Question</md-option>
                        <md-option>Topic</md-option>
                      </md-select>
                    </md-input-container>

                    <div ng-init="topicCtrl.body.show = false" ng-show="topicCtrl.body.show">

                      <!-- Body -->
                      <md-input-container class="md-block">
                        <label>Your story</label>
                        <textarea ng-model="topicCtrl.newTopic.body" columns="1" rows="5"></textarea>
                      </md-input-container>



                      <!-- Tags -->
                      <!--<input ng-model="topicCtrl.newTopic.tags">-->
                      <tags-input ng-model="tags"></tags-input>


                      <p ng-if="locationDetail.details.place_id">location</p>
                    </div>
                  </div>
                </md-list-item>
              </md-list>

              <!-- Optional -->
              <div layout="row" ng-init="topicCtrl.body.show = false" ng-show="topicCtrl.body.show">

                <div flow-init
                     flow-name="uploader.flow"
                     flow-files-added="topicCtrl.uploadFile($files)">
                  <md-button aria-label="Photo" class="md-primary md-fab md-mini ion-camera" flow-btn type="file"></md-button>
                  <div ng-repeat="image in uploader.flow.files track by $index">
                    <img class="preview" flow-img="image"/><br>
                  </div>
                </div>


                <!-- Location input -->
                <md-button aria-label="Location" class="md-primary md-fab md-mini ion-location" ng-click="locationInput=true"></md-button>
                  <md-input-container ng-show="locationInput" ng-init="locationInput=false">
                    <input aria-label="Location Query"
                           ng-autocomplete type="text"
                           ng-model = "topicCtrl.newTopic.location.query"
                           details  = "topicCtrl.newTopic.location.details"
                           options  = "topicCtrl.newTopic.location.options">
                  </md-input-container>


                <!-- URL input -->
                <md-button aria-label="Link" class="md-primary md-fab md-mini ion-link" ng-click="urlInput=true"></md-button>
                  <md-input-container ng-show="urlInput" ng-init="urlInput=false">
                    <input aria-label="URL" ng-model="topicCtrl.newTopic.url">
                  </md-input-container>


                <!-- Save as draft -->
                <md-button ng-if="topicCtrl.newTopic.topic.length > 0"
                           class="md-primary" type="submit"
                           aria-label="Save as Draft"
                           ng-click="topic.isDraft=1">Save as draft</md-button>


                <!-- Languages -->
                <!--<md-input-container style="margin-right: 10px;">
                  <label>Size</label>
                  <md-select ng-model="size">
                    <md-option ng-repeat="size in topicCtrl.languages" value="{{size}}">{{size}}</md-option>
                  </md-select>
                </md-input-container>-->
              </div>

              <md-card-actions layout="row" layout-align="end center"
                               ng-if="!topicCtrl.slugReturn">
                <md-button class="md-primary md-raised" type="submit">submit</md-button>
              </md-card-actions>
            </form>
          </md-content>
        </div>

        <!-- Topic Category -->
        <p class="text-center md-headline md-padding">
          {{cateCtrl.cateName.name}}
        </p>

        <!-- List topics here-->
        <topic-list topics="cateCtrl.cateTopics"></topic-list>
      </div>
    </div>

  </section>

</md-content>
