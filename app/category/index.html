<md-content>
  <div ui-view="header"></div>

  <section>
    <h1>
      {{cateCtrl.cateName.name}}
    </h1>

    <div layout="column" class="inner-container container">

      <div ng-controller="TopicCtrl as topicCtrl">
        <md-card ng-if="topicCtrl.uid">
          <form ng-submit="topicCtrl.createTopic(cateCtrl.cateName.$id)">
            <md-card-title>
              <md-card-title-media>
                <img src="https://lh3.googleusercontent.com/-ONIXPD1ozmQ/AAAAAAAAAAI/AAAAAAAAD8Q/HB38gqJDdyU/s36-p-k-rw-no/photo.jpg"
                     class="img-circle">
              </md-card-title-media>
              <md-card-title-text>
                <md-input-container>
                  <label>Topic</label>
                  <input ng-model="topicCtrl.newTopic.topic">
                </md-input-container>
                <md-input-container class="md-block">
                  <label>Your story</label>
                  <textarea ng-model="topicCtrl.newTopic.body" columns="1" md-maxlength="150" rows="5"></textarea>
                </md-input-container>
              </md-card-title-text>
            </md-card-title>

            <div flow-init
                 flow-name="uploader.flow"
                 flow-files-added="topicCtrl.uploadFile($files)">
              <button flow-btn type="file">Upload Images</button>
              <div ng-repeat="image in uploader.flow.files track by $index">
                <!--<span class="text">Blob image displayed with "flow-img"</span>-->
                <img class="preview" flow-img="image"/><br>
                <!--<span class="text">Base64 image displayed with "ng-src"</span> <img class="preview" ng-src="{{imageStrings[$index]}}"/>-->
              </div>
            </div>

            <md-card-actions layout="row" layout-align="end center">
              <md-button class="md-primary" type="submit">submit</md-button>
            </md-card-actions>
          </form>
        </md-card>
      </div>


      <!-- List topics here-->
      <div ng-repeat="(topicKey, topic) in cateCtrl.cateTopics | orderBy:'created'">
        <md-card class="md-whiteframe-2dp">
          <md-card-title>
            <md-card-title-text>
              <small>
                <i class="ion-ios-clock-outline"></i>
                <span am-time-ago="topic.created"></span>
              </small>
              <span class="md-headline text-center">
                <a ui-sref="topic({Slug: topic.slug, Key: topicKey })">{{topic.topic}}</a>
              </span>
            </md-card-title-text>
          </md-card-title>

          <md-card-content>
            <p>
              {{topic.body}}
            </p>
          </md-card-content>

          <div ng-if="topic.photos" ng-repeat="photo in topic.photos">
            <img ng-src="{{photo}}" class="md-card-image" alt="Washed Out">
          </div>


          <md-card-actions layout="row" layout-align="start center">
            <md-card-icon-actions>
              <md-button class="md-primary ion-chevron-up"  aria-label="Upvote"> Upvote</md-button>
              <md-button class="ion-chevron-down"           aria-label="Downvote"> Downvote</md-button>
              <md-button class="ion-chatbubble-working"     aria-label="Comments"> Comments 2 </md-button>
              <md-button class="ion-share"     aria-label="Share"> Share </md-button>
            </md-card-icon-actions>
          </md-card-actions>

        </md-card>
      </div>
    </div>
  </section>

</md-content>
