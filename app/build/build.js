"use strict";function show(e){return console.log(e),JSON.stringify(e,null,2)}function extend(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t&&"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}),e}function moveFbRecord(e,t){e.once("value",function(o){t.set(o.val(),function(t){t?"undefined"!=typeof console&&console.error&&console.error(t):e.remove()})})}var app=angular.module("App",["firebase","angular-md5","ngRoute","ui.router","ngMaterial","angularMoment","flow","slugifier","ngAutocomplete","ngTagsInput","cgNotify","pascalprecht.translate","facebook","angular-flexslider","ngSanitize","ui.bootstrap","angular-smilies","ngCookies","notification"]).config(["$mdThemingProvider",function(e){e.definePalette("slack",{50:"ffebee",100:"ffcdd2",200:"ef9a9a",300:"e57373",400:"ef5350",500:"4D394B",600:"e53935",700:"d32f2f",800:"c62828",900:"b71c1c",A100:"ff8a80",A200:"ff5252",A400:"ff1744",A700:"d50000",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("slack")}]).config(["FacebookProvider",function(e){var t="931376120263856";e.setAppId(t),e.init(t)}]).config(["$translateProvider",function(e){e.preferredLanguage("Eng"),e.useSanitizeValueStrategy("escape")}]).config(["$stateProvider","$urlRouterProvider","$controllerProvider",function(e,t,o){app.registerCtrl=o.register,e.state("home",{url:"/",views:{"":{controller:"DashboardCtrl as  dashboardCtrl",templateUrl:"home/home.html",resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("dashboard")},function(e){return e})}]}},"login-form@home":{templateUrl:"templates/html/login-form.html"}}}).state("trending",{url:"/explore/trending",views:{"":{controller:"DashboardCtrl as  dashboardCtrl",templateUrl:"home/trend.html",resolve:{feed:["Topics",function(e){return e.latestFeed()}]}}}}).state("category",{url:"/category/{Slug}",views:{"":{templateUrl:"category/index.html",resolve:{cateName:["$stateParams","Category",function(e,t){return t.getName(e.Slug).$loaded()}],cateTopics:["$stateParams","Topics",function(e,t){return t.list(e.Slug)}]}}}}).state("places",{url:"/places/{place_slug}/{place_id}",views:{"header@places":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"PlacesCtrl as placesCtrl",templateUrl:"place/index.html",resolve:{placeLanding:["Places","Topics","$stateParams","$firebaseArray",function(e,t,o,r){var n;return e.getPlaceRef(o.place_id).on("value",function(e){n=e.val(),console.log(e.val())}),n}]}}}}).state("tag",{url:"/tag/{Tag}",views:{"header@tag":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"TagCtrl as tagCtrl",templateUrl:"tag/index.html",resolve:{tagName:["$stateParams",function(e){return e.Tag}],tagLanding:["Topics","$stateParams","Tags",function(e,t,o){var r=t.Tag;return e.topicsByTag(r)}]}}}}).state("topic",{url:"/{Slug}",resolve:{},views:{"":{controller:"TopicLandingCtrl as topicLandingCtrl",templateUrl:"topics/index.html",resolve:{isOwner:["Auth","Users","$stateParams","Topics",function(e,t,o,r){var n="";return e.ref.getAuth()?r.fortopic(o.Slug).$loaded().then(function(t){return null!=t[0]?(n=t[0].uid,e.ref.getAuth().uid==n?!0:!1):void 0}):!1}],topicLanding:["$stateParams","Topics",function(e,t){return t.fortopic(e.Slug).$loaded()}],replyList:["$stateParams","Topics","$state",function(e,t,o){var r="";return t.fortopic(e.Slug).$loaded().then(function(e){return null!=e[0]?r=e[0].$id:o.go("topic-notfound"),t.replyList(r)})}],viewData:["$stateParams","Topics","Users","Auth",function(e,t,o,r){var n,i,l=moment().toISOString(),a={userIP:"",created:l};return o.getLocationIP().success(function(e){a.userIP=e.data}).then(function(e){a.userIP=e.data}),t.getTopicBySlug(e.Slug).$loaded().then(function(e){return"undefined"!==e[0].$id&&(n=e[0].$id,i=t.getViews(n),i.obj.$loaded().then(function(e){null==e.count?i.ref.child("count").set(1):i.ref.child("count").set(e.count+1)}),r.auth.$requireAuth().then(function(e){var t=e.uid;i.ref.child("history").child(t).push().set(a),o.userRef(e.uid).child("views").child(n).push().set(a)})),i.obj})}],followers:["$stateParams","Topics",function(e,t){return t.getTopicBySlug(e.Slug).$loaded().then(function(e){var o=e[0].$id;return t.getFollowers(o).obj.$loaded().then(function(e){return e})})}]}}}}).state("topic-notfound",{url:"/err/notfound"}).state("profile",{url:"/profile/{Name}",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/index.html",resolve:{isOwner:["Auth","Users","$stateParams",function(e,t,o){return e.ref.getAuth()?t.getProfileByUsername(o.Name).$loaded().then(function(t){return t[0].$id==e.ref.getAuth().uid?!0:!1}):!1}],userPosts:["Users","Topics","$stateParams",function(e,t,o){return e.getProfileByUsername(o.Name).$loaded().then(function(e){return"undefined"!==e[0].$id?t.createdBy(e[0].$id):void 0})}],profile:["$state","$stateParams","$rootScope","Auth","Users",function(e,t,o,r,n){return n.getProfileByUsername(t.Name).$loaded().then(function(e){return e})}]}},"header@profile":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("acccountEdit",{url:"/account/edit",views:{"passwordEdit@acccountEdit":{url:"/account/changePassword",templateUrl:"profile/passwd.html"},"userEdit@acccountEdit":{url:"/account/edit-form",templateUrl:"profile/edit-form.html"},"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/edit.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(t){return t.displayName?t:void e.go("get_started")})},function(t){e.go("home")})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("accountPassword",{url:"/account/changePassword",templateUrl:"profile/passwd.html"}).state("accountUserEdit",{url:"/account/edit-form",templateUrl:"profile/edit-form.html"}).state("dashboard",{url:"/user/dashboard",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"dashboard/index.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(o){return o.stat||(r.userRef(t.uid).child("stat/upvoted/count").set(0),r.userRef(t.uid).child("stat/posted/count").set(0),r.userRef(t.uid).child("stat/comment/count").set(0),r.userRef(t.uid).child("stat/follower/count").set(0),r.userRef(t.uid).child("stat/following/count").set(0)),o.displayName?o:void e.go("get_started")})},function(t){return e.go("home"),t})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("dashboard.list",{url:"/feed/{Slug}",views:{"":{controller:"CateCtrl as cateCtrl",templateUrl:"category/index.html",resolve:{cateName:["$stateParams","Category",function(e,t){return t.getName(e.Slug).$loaded()}],cateTopics:["$stateParams","Topics",function(e,t){return t.list(e.Slug)}]}}}}).state("follow_cates",{url:"/user/follow-categories",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/follow-categories.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("get_started",{url:"/user/get_started",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/get_started.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@get_started":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("login",{url:"/user/login",views:{"":{templateUrl:"auth/login.html"},"login-form@login":{templateUrl:"templates/html/login-form.html"}}}).state("register",{url:"/user/register",views:{"":{templateUrl:"auth/register.html"}},resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("home")},function(e){return e})}]}}),t.otherwise("/")}]).filter("orderObjectBy",function(){return function(e,t,o){var r=[];return angular.forEach(e,function(e){r.push(e.$id).set(e)}),r.sort(function(e,o){return e[t]>o[t]?1:-1}),o&&r.reverse(),r}}).filter("decodeURI",function(){return function(e){return e?decodeURI(e):""}}).filter("nl2br",["$sce",function(e){return function(t){return t?e.trustAsHtml(t.replace(/\n/g,"<br/>")):""}}]).constant("FirebaseUrl","https://bmxyz.firebaseio.com/");angular.module("App").controller("AuthCtrl",["$scope","Auth","Users","$state","$rootScope","$mdSidenav","$translate","$cookies","NotiService","$notification",function(e,t,o,r,n,i,l,a,u,s){console.log("authCtrl");var c=this;s.requestPermission().then(function(e){console.log(e)}),c.auth=t,c.users=o,c.notification=u,null!=t.ref.getAuth()?c.profile=c.users.getProfile(t.ref.getAuth().uid):c.profile="",c.user={email:"",password:""},e.badgeNotifcation=c.badgeNotification,c.resetCounter=function(){c.notification.resetUnread(c.profile.$id)},c.changeVal=function(){console.log("badge value "+c.badgeNotification.$value)},c.toggleLang=function(e){l.use(e),a.put("userLang",e),t.ref.getAuth()&&c.users.userArrRef(t.ref.getAuth().uid).update({lang:e})},c.profile.lang?c.toggleLang(c.profile.lang):a.get("userLang")?c.toggleLang(a.get("userLang")):c.toggleLang("Eng"),c.login=function(){c.auth.auth.$authWithPassword(c.user).then(function(e){r.go("dashboard")},function(e){c.error=e})},c.logout=function(){t.auth.$unauth(),r.go("login")},c.register=function(){t.auth.$createUser(c.user).then(function(e){c.login()},function(e){c.error=e})}}]),angular.module("App").factory("Auth",["$firebaseAuth","FirebaseUrl",function(e,t){var o=new Firebase(t),r=e(o),n={ref:o,auth:r,getUid:function(){var e=o.getAuth();return null!=e?o.getAuth().uid:!1}};return n}]),angular.module("App").controller("CateCtrl",["$state","Category","cateName","cateTopics",function(e,t,o,r){var n=this;n.cateName=o,n.category=t,n.cateTopics=r,console.log("CateCtrl")}]),angular.module("App").factory("CateService",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r),i={name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopic:function(t){return e(usersRef.child(uid))},addChild:function(e){return r.child(e)},followList:function(e){var o=r.orderByChild("news/follower").equalTo(e);return t(o)},unFollow:function(e,t){var r=new Firebase(o+"categories/"+e+"/follower/"+t);r.remove()},userFollow:function(e,t){var r=!1,n=new Firebase(o+"categories/"+e+"/follower/"+t);return n.once("value",function(e){r=e.exists()}),r},arr:t(r),all:n};return i}]),angular.module("App").factory("Post",["$firebaseObject","FirebaseUrl",function(e,t){var o=new Firebase(t+"topics"),r=e(o),n={topicName:function(t){var r=o.orderByChild("slug").equalTo(t);return e(r)},fortopic:function(t){return e(usersRef.child(uid))},all:r};return n}]),angular.module("App").controller("DashboardCtrl",["Auth","$state","Category","CateService","Tags","Topics",function(e,t,o,r,n,i){var l=this;l.auth=e,l.cate=r,l.categories=o,l.topics=i,l.topic_grid=!1,l.tags=n.arr,l.userCateFollow=[],l.cateIsFollow=[],l.followList="",l.userFeed="null",l.latestFeed=l.topics.latestFeed(),l.followCate=function(t){l.cate.addChild(t+"/follower").child(e.ref.getAuth().uid).push().set(moment().toISOString())},console.log("DashboardCtrl")}]),angular.module("App").directive("mainHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/toolbar/main_toolbar.html"}}).directive("badgeNotification",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/html/badge-notification.html",scope:{notification:"="}}}).directive("reviewScore",function(){return{templateUrl:"templates/html/review-summary-list.html",scope:{review:"="}}}).directive("userFollowerBtn",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/html/follow-user.html",scope:{follow:"="}}}).directive("cateFollowBtn",function(){return{templateUrl:"templates/html/category-follow-btn.html",scope:{cate:"="}}}).directive("topicGrid",function(){return{templateUrl:"templates/html/category-grid.html"}}).directive("tagGrid",function(){return{templateUrl:"templates/html/tag-grid.html"}}).directive("topicCreate",function(){return{templateUrl:"templates/html/topic-create.html",scope:{topic:"="}}}).directive("topicList",function(){return{templateUrl:"templates/html/topic-list.html",scope:{topics:"="}}}).directive("topicActionsCard",function(){return{templateUrl:"templates/html/topic-actions-card.html",scope:{topic:"="}}}).directive("enforceMaxTags",function(){return{require:"ngModel",link:function(e,t,o,r){var n=o.maxTags?parseInt(o.maxTags,"4"):null;r.$parsers.push(function(e){return e&&n&&e.length>n&&e.splice(e.length-1,1),e})}}}),angular.module("App").config(["$translateProvider",function(e){e.translations("Eng",{KEY_DASHBOARD:"Dashboard",KEY_LANGUAGES:"Languages",KEY_HOME:"Home",KEY_REGISTER:"Register",KEY_LOGIN:"Log in",KEY_LOGOUT:"Log out",KEY_FOLLOW:"Follow",KEY_FOLLOWER:"Follower",KEY_UNFOLLOW:"Unfollow",KEY_FOLLOWING:"Following",KEY_POST:"Post",KEY_POSTED:"Posted",KEY_UPVOTE:"Upvote",KEY_UPVOTED:"Upvoted",KEY_DWN_VOTE:"Downvote",KEY_DWN_VOTED:"Downvoted",KEY_VIEW:"View",KEY_REMOVE:"Remove",KEY_CANCEL:"Cancel",KEY_QUESTION:"Question",KEY_TOPIC:"Topic",KEY_CHG_PWD:"Change Password",KEY_PASSWORD:"Password",KEY_OLD_PWD:"Old Password",KEY_NEW_PWD:"New Password",KEY_NEW_PWD_C:"New password confirmation",KEY_SAVE:"Save",KEY_SAVE_DRAFT:"Save as draft",KEY_TAGS:"Tags",KEY_EXPLORE:"Explore",KEY_FEAT_CAT:"Features categories",KEY_COMMENTS:"Comments",KEY_REPLY:"Reply",KEY_REVIEW:"Review",KEY_EDIT:"Edit",KEY_TREND:"Trend",KEY_TRENDING:"Trending",KEY_WRITE_REPLY:"Write a reply",KEY_LATEST_FEED:"Latest Feed",KEY_CONF_REMOVE:"Are you sure you want to remove?",KEY_CONF_REM_C:"Once remove, you will not be ableto to get this topic back",KEY_WHAT_ON_UR_MIND:"What's on your mind?",KEY_YOU_WANT_FOLLOW:"You may want to follow",KEY_NO_ACCT_REGISTER:"Don't have account? Register",KEY_CANT_CHNG_USER:"Don't have account? Register",KEY_YOUR_ACCOUNT:"Your account",KEY_NOTHING_HERE:"Nothing here, yet",KEY_WHO_TO_FOLLOW:"Who to follow",KEY_CAT_WILL_APPEAR:"Follow some categories and it will appear here",KEY_WHT_UR_STORY:"What's your story",KEY_WRT_COMMENT:"Write a comment",KEY_FIRSTNAME:"First name",KEY_LASTNAME:"Last name",KEY_BIRTHDAY:"Birthday",KEY_MONTH:"Month",KEY_DAY:"Day",KEY_EMAIL:"Email",KEY_CONF_EMAIL:"Confirm Email",KEY_GENDER:"Gender",KEY_MALE:"Male",KEY_FEMALE:"Female",KEY_USERNAME:"Username",KEY_LOCATION:"Location",KEY_ED_PROFILE:"Edit Profile",KEY_ED_CHG_PWD:"Change Password",KEY_ED_PROFILE:"Edit Profile",KEY_ED_SITE:"Website",KEY_ED_PHONE:"Phone",KEY_ED_BIO:"Biography"}),e.translations("ไทย",{KEY_DASHBOARD:"ห้องทั้งหมด",KEY_LANGUAGES:"ภาษา",KEY_HOME:"หน้าแรก",KEY_REGISTER:"สมัครใช้",KEY_LOGIN:"เข้าสู่ระบบ",KEY_FOLLOW:"ติดตาม",KEY_POST:"โพสต์"}),e.preferredLanguage("en")}]),angular.module("App").controller("NotiCtrl",["$state","Category","Topics","NotiService",function(e,t,o,r){var n=this;n.topics=o,n.feed=feed,n.notiService=r,n.notifyTo=function(e){return n.arr.push(e).$add(e)}}]),angular.module("App").factory("NotiService",["$firebaseObject","$firebaseArray","FirebaseUrl","Users","$notification",function(e,t,o,r,n){var i=new Firebase(o+"notification"),l=e(i),a=r,u={unreadNotification:function(e){var t,r=new Firebase(o+"notification/"+e+"/unread");r.on("value",function(e){t=e.val()});var i=new Firebase(o+"notification/"+e);return i.on("child_added",function(){n("New message from Qanya",{body:"Hello "+e,dir:"auto",lang:"en",tag:"my-tag",icon:"http://www.cl.cam.ac.uk/research/srg/netos/images/qsense-logo.png",focusWindowOnClick:!0})}),t},notifyFollower:function(e,t){var o=a.getFollower(t);o.once("value",function(t){t.forEach(function(t){u.updateNotificationCount(e,t.key())})})},notifyLog:function(e,t,o){console.log("uid "+t),console.log("from uid "+o),u.addChild(t).push().set({topicId:e,from:o,is_read:!1,timestamp:moment().toISOString()})},resetUnread:function(e){var t=new Firebase(o+"notification/"+e+"/unread");t.set(0)},updateNotificationCount:function(e,t,r){var n=new Firebase(o+"notification/"+t+"/unread");n.once("value",function(e){"null"==e.val()?n.set(1):n.set(e.val()+1)},function(e){console.log("The read failed: "+e.code)}),u.notifyLog(e,t,r)},addChild:function(e){return i.child(e)},addArrChild:function(t){return e(i.child(t))},arr:t(i),all:l};return u}]),angular.module("App").controller("PlacesCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","Tags","Topics","Auth","Users","Slug","Languages","placeLanding",function(e,t,o,r,n,i,l,a,u,s,c,d){var f=this;console.log(d),f.placeLanding=d}]),angular.module("App").factory("Places",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"places"),r=new Firebase(t+"places_details"),n=e(o),i={addChild:function(e){return o.child(e)},addPlaceDetailChild:function(e){return r.child(e)},getPlaceRef:function(e){return o.child(e+"/info")},arr:n};return i}]),angular.module("App").factory("Category",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r),i=(t(r),{getName:function(t){var o=r.child(t);return e(o)},all:n});return i}]).factory("Languages",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"languages"),r=e(o);return r}]).factory("Archive",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"archive"),r=e(o),n={addChild:function(e){return o.child(e)},ref:o,arr:r};return n}]),angular.module("App").controller("TagCtrl",["Auth","Users","$state","$rootScope","tagLanding","tagName",function(e,t,o,r,n,i){var l=this;l.tagLanding=n,l.tagName=i}]),angular.module("App").factory("Tags",["$firebaseArray","$firebaseObject","FirebaseUrl","$q",function(e,t,o,r){var n=new Firebase(o+"tags"),i=e(n),l={addChild:function(e){return n.child(e)},tagsUrl:function(){return e(n)},getTagRef:function(e){return n.child(e)},getTagObject:function(e){return t(n.child(e))},topicTags:function(e){var t=r.defer(),n=new Firebase(o);return n.child("tags/"+e).on("child_added",function(o){n.child("topics").orderByChild("tags").equalTo(e).on("child_added",function(e){return t.resolve(),extend({},o.val(),e.val())})})},arr:i};return l}]),angular.module("App").controller("TopicLandingCtrl",["$state","$scope","Slug","Topics","Auth","Users","isOwner","topicLanding","replyList","viewData","followers",function(e,t,o,r,n,i,l,a,u,s,c){console.log("topicLandingCtrl");var d=this;d.auth=n,d.users=i,d.topicLanding=a,d.topics=r,d.replyList=u,d.views=s,d.followers=c,d.isOwner=l,d.inReplyArr=[],d.replyInReply=function(){for(var e=0;e<d.replyList.length;e++){var t=d.replyList[e].topicId,o=d.replyList[e].$id;d.inReplyArr[e]=d.topics.replyInReply(t,o)}},d.replyInReply()}]),angular.module("App").controller("TopicCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","$http","FirebaseUrl","$translate","$notification","NotiService","Tags","Topics","Auth","Users","Slug","Places","Languages","Archive",function(e,t,o,r,n,i,l,a,u,s,c,d,f,p,g,h,m,v){console.log("topicCtrl");var w=this;w.tags=c,w.topics=d,w.auth=f,w.users=p,w.languages=m,w.places=h,w.archive=v,w.noti=s,null!=w.auth.ref.getAuth()?(w.profile=w.users.getProfile(w.auth.ref.getAuth().uid),w.uid=w.profile.$id,w.userRef=w.users.userRef(w.uid),w.userUpvotedTopics=w.users.upvotes(w.uid),w.userDownvotedTopics=w.users.downvotes(w.uid),w.userFollowing=w.users.following(w.uid)):(w.profile="",w.uid="",w.userRef=""),w.imageStrings=[],w.imageText=[],w.inReplyArr=[],w.loadBusy=!1,w.slugReturn=null,w.criteria=!1,w.criteriaReply=null,w.reviewCriteria=!1,w.critReplyData=null,w.newTopic={location:"",url:"",ipInfo:"",tags:"",body:""},w.avgReviewReply=function(){for(var e=Object.keys(w.criteriaReply).length,t=0,o=0;e>o;o++)t+=w.criteriaReply[o];w.replyReviewAverage=t/e,console.log(w.criteriaReply),w.critReplyData={avg:w.replyReviewAverage,data:w.criteriaReply}},w.avgReviewScore=function(e){if(e){for(var t=0,o=0;o<e.length;o++)t+=e[o].rating;return t/e.length}},a(["KEY_REMOVE","KEY_CANCEL","KEY_CONF_REMOVE","KEY_CONF_REM_C"]).then(function(e){w.removeTrans=e.KEY_REMOVE,w.cancelTrans=e.KEY_CANCEL,w.confirmRem=e.KEY_CONF_REMOVE,w.confirmRemContent=e.KEY_CONF_REM_C}),w.userName=function(e){},w.showMdLogin=function(e){var o=(n("sm")||n("xs"))&&t.customFullscreen;r.show({templateUrl:"templates/html/md-login-form.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:o})},w.decodeText=function(e){return console.log(decodeURI(e)),decodeURI(e)},w.loadMore=function(e){w.loadBusy=!0;for(var t=[],o=0;o<e.length;o++)t.push(e[o]);return console.log(t),t},w.loadTags=function(e){console.log(w.tags.tagsUrl())},w.uploadFile=function(e,t){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;w.imageStrings[t]=o},o.readAsDataURL(e.file)})},w.showConfirmRemove=function(t,o,n){var i=r.confirm().title(w.confirmRem).textContent(w.confirmRemContent).targetEvent(t).ok(w.removeTrans).cancel(w.cancelTrans);r.show(i).then(function(){w.removeTopic(o,n)&&e.go("dashboard")})},w.removeTopic=function(e,t){return e==w.uid?(moveFbRecord(w.topics.refChild(t.$id),w.archive.addChild(t.$id)),!0):!1},w.reply=function(e){w.topics.replyArr(e.$id).$add({topicId:e.$id,body:w.newReply.body,uid:w.uid,review:w.critReplyData,created:moment().toISOString()}).then(function(){w.noti.updateNotificationCount(e.$id,e.uid,w.uid)}),w.topics.replyCount(e.$id).$loaded().then(function(t){t.count?w.topics.replyCountRef(e.$id).set(t.count+1):w.topics.replyCountRef(e.$id).set(1)}),w.users.userRef(w.uid).child("stat/comment/count").set(w.profile.stat.comment.count+1),w.users.userRef(w.uid).child("stat/comment/topics/"+e.$id).push().set(moment().toISOString())},w.replyInReply=function(e,t){w.topics.replyInReplyArr(e,t).$add({body:w.replyInReply.body,uid:w.uid,created:moment().toISOString()})},w.addNewChoice=function(){var e=w.reviewCriteria.length+1;w.reviewCriteria.push({id:"criteria"+e})},w.removeChoice=function(){var e=w.reviewCriteria.length-1;w.reviewCriteria.splice(e)},w.createTopic=function(e,t){var o="";""!==w.newTopic.location&&(console.log(w.newTopic.location),o={place_id:w.newTopic.location.details.place_id,slug:g.slugify(w.newTopic.location.details.name),name:w.newTopic.location.details.name,address:w.newTopic.location.details.formatted_address,lat:w.newTopic.location.details.geometry.location.lat(),lng:w.newTopic.location.details.geometry.location.lng(),lng:w.newTopic.location.details.geometry.location.lng(),lng:w.newTopic.location.details.geometry.location.lng()}),w.topics.arr.$add({type:w.type,lang:w.newTopic.lang,topic:w.newTopic.topic,body:w.newTopic.body,category:e,uid:w.uid,slug:w.newTopic.topic,photos:w.imageStrings,photos_text:w.imageText,location:o,url:w.newTopic.url,draft:t,created:moment().toISOString(),tags:w.newTopic.tags,userIP:w.newTopic.ipInfo,review:w.reviewCriteria}).then(function(e){var t="";if(t=""==g.slugify(w.newTopic.topic)?w.newTopic.topic:g.slugify(w.newTopic.topic),w.topics.getTopicByKey(e.key()).update({slug:t+e.key()}),w.users.userRef(w.uid).child("stat/posted/count").set(w.profile.stat.posted.count+1),w.users.userRef(w.uid).child("stat/posted/topics/"+e.key()).push().set(moment().toISOString()),""!==o&&(w.places.addChild(o.place_id).child(e.key()).push().set(moment().toISOString()),w.places.addChild(o.place_id).child("info").set(o)),null!==w.newTopic.tags)for(var r=0;r<w.newTopic.tags.length;++r)w.tags.addChild(w.newTopic.tags[r].text).child(e.key()).push().set(moment().toISOString());w.noti.notifyFollower(e.key(),w.uid),w.newTopic={body:""}})},w.checkFollow=function(e){return w.users.checkFollow(w.uid,e)?!0:!1},w.followUser=function(e){w.users.getProfile(e).$loaded().then(function(t){w.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count+1),w.users.userRef(e).child("stat/follower/uid/"+w.uid).push().set(moment().toISOString())}),w.users.getProfile(w.uid).$loaded().then(function(t){w.users.userRef(w.uid).child("stat/following/count").set(t.stat.follower.count+1),w.users.userRef(w.uid).child("stat/following/uid/"+e).push().set(moment().toISOString())})},w.unfollowUser=function(e){w.users.getProfile(e).$loaded().then(function(t){w.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count-1),w.users.userRef(e).child("stat/follower/uid/"+w.uid).remove()}),w.users.getProfile(w.uid).$loaded().then(function(t){w.users.userRef(w.uid).child("stat/following/count").set(t.stat.following.count-1),w.users.userRef(w.uid).child("stat/following/uid/"+e).remove()})},w.upvote=function(e){void 0!=e.downvotes&&void 0!=e.downvotes[w.uid]&&w.cancelDownvote(e),w.topics.upvoteTopic(e.$id,w.uid).$loaded().then(function(t){w.userUpvotedTopics.child(e.$id).set(t.$value),w.users.getProfile(e.uid).$loaded().then(function(t){w.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count+1),w.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).push().set(moment().toISOString())})})},w.cancelUpvote=function(e){w.topics.undoUpvote(e.$id,w.uid),w.users.getProfile(e.uid).$loaded().then(function(t){w.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count-1),w.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).remove()}),w.userUpvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},w.downvote=function(e){void 0!=e.upvotes&&void 0!=e.upvotes[w.uid]&&w.cancelUpvote(e),w.topics.downvoteTopic(e.$id,w.uid).$loaded().then(function(t){w.userDownvotedTopics.child(e.$id).set(t.$value)})},w.cancelDownvote=function(e){w.topics.undoDownvote(e.$id,w.uid),w.userDownvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},w.followTopic=function(e){w.topics.follow(e.$id,w.uid).$loaded().then(function(t){w.userFollowing.child(e.$id).set(t.history[w.uid])})},w.unfollowTopic=function(e){w.topics.unfollow(e.$id,w.uid),w.userFollowing.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})}}]),angular.module("App").factory("Topics",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"topics"),n=e(r),i=(t(r),{getTag:function(e){return t(r.orderByChild("tags").equalTo(e))},getSlug:function(e){var o=r.orderByChild("slug").equalTo(e);return t(o)},createdBy:function(e){return t(r.orderByChild("uid").equalTo(e))},refChild:function(e){return r.child(e)},countUserTopics:function(){},list:function(e){var o=r.orderByChild("category").equalTo(e);return t(o)},name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopicRef:function(e){return r.orderByChild("slug").equalTo(e)},getTopicByKey:function(e){return new Firebase(o+"topics/"+e)},getTopicBySlug:function(e){return t(r.orderByChild("slug").equalTo(e).limitToFirst(1))},incrementView:function(e){},fortopic:function(e){return t(i.fortopicRef(e))},replyList:function(e){var o=r.child(e+"/replies");return t(o)},replyArr:function(e){return t(r.child(e+"/replies"))},replyCount:function(t){return e(r.child(t+"/replies/"))},replyCountRef:function(e){return r.child(e+"/replies/count")},replyInReply:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},replyInReplyArr:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},getUpvotes:function(e){return{ref:r.child(e+"/upvotes"),array:t(r.child(e+"/upvotes"))}},getDownvotes:function(e){return{ref:r.child(e+"/downvotes"),array:t(r.child(e+"/downvotes"))}},getFollowers:function(t){return{ref:r.child(t+"/followers"),obj:e(r.child(t+"/followers"))}},upvoteTopic:function(t,o){return r.child(t+"/upvotes").child(o).set(moment().toISOString()),e(r.child(t+"/upvotes").child(o))},undoUpvote:function(e,t){return r.child(e+"/upvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/upvotes")},downvoteTopic:function(t,o){return r.child(t+"/downvotes").child(o).set(moment().toISOString()),e(r.child(t+"/downvotes").child(o))},undoDownvote:function(e,t){return r.child(e+"/downvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/downvotes")},follow:function(t,o){return r.child(t+"/followers").child("history").child(o).set(moment().toISOString()),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){null===e.value||void 0===e.value?r.child(t+"/followers").child("count").set(1):r.child(t+"/followers").child("count").set(e.$value+1)}),e(r.child(t+"/followers"))},unfollow:function(t,o){return r.child(t+"/followers").child("history").child(o).remove(function(o){o?console.log("Error:",o):(console.log("Removed successfully!"),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){r.child(t+"/followers").child("count").set(e.$value-1)}))}),r.child(t+"/followers")},getViews:function(t){return{ref:r.child(t).child("views"),obj:e(r.child(t).child("views"))}},latestFeed:function(){return t(r.orderByChild("created").limitToLast(10))},topicsByTag:function(e){return t(r.orderByChild("tags").equalTo(e))},arr:t(r),all:n,ref:r});return i}]),angular.module("App").controller("ProfileCtrl",["$scope","$rootScope","$state","$filter","md5","Auth","Users","Topics","Facebook","notify","CateService","profile","isOwner","userPosts",function(e,t,o,r,n,i,l,a,u,s,c,d,f,p){console.log("ProfileCtrl");var g=this;g.profile=d,g.auth=i,g.users=l,g.topics=a,g.facebook=u,g.isOwner=f,g.cate=c,g.$state=o,g.userPosts=p,g.userFeed="",g.feed="",g.editInit="userEdit",g.nameExist=!1,g.getUserPost=function(e){g.feed=g.topics.createdBy(e)},g.linkFacebook=function(){g.facebook.login(function(t){g.facebook.getLoginStatus(function(t){"connected"===t.status?(e.loggedIn=!0,g.facebook.api("/me",function(e){console.log(e)})):console.log("not logged in")})})},g.oldProfileValue=g.profile,g.userCreated=function(e){return g.topics.createdBy(e)},g.imageStrings=[],g.userCateFollow=[],g.cateIsFollow=[],g.followList="",g.followCateListArr=function(e){g.followList=g.cate.followList(e)},i.ref.getAuth()&&g.followCateListArr(i.ref.getAuth().uid),g.followCate=function(e,t){g.cateIsFollow[e]=!0,g.cate.addChild(t+"/follower").child(i.ref.getAuth().uid).push().set(moment().toISOString())},g.uploadFile=function(e){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;g.imageStrings[t]=o,g.users.userArrRef(i.ref.getAuth().uid).update({photo:o}),s({message:"Saved",position:"center",duration:3e3})},o.readAsDataURL(e.file)})},g.saveProfile=function(e){g.profile.updated=moment().toISOString(),null!==g.location&&(locationDetail={place_id:g.location.details.place_id,name:g.location.details.name,address:g.location.details.formatted_address,lat:g.location.details.geometry.location.lat(),lng:g.location.details.geometry.location.lng()},g.profile.userLocation=locationDetail),g.profile.$save().then(function(){s({message:"Saved",position:"center",duration:3e3}),void 0!==e&&o.go(e)})["catch"](function(e){s({message:"Error saving data",position:"center",duration:3e3})})},g.updateName=function(){g.users.userArrRef(i.ref.getAuth().uid).update({firstname:g.profile.firstname,lastname:g.profile.lastname}),g.users.userArrRef(i.ref.getAuth().uid+"/log").push().set({
action:"name_change",oldname:g.oldProfileValue.firstname+"-"+g.oldProfileValue.lastname,created:moment().toISOString()}),s({message:"Saved",position:"center",duration:3e3})},g.updateBio=function(){g.users.userArrRef(i.ref.getAuth().uid).update({biography:g.profile.biography}),s({message:"Saved",position:"center",duration:3e3})},g.updateProfile=function(){g.profile.$save().then(function(){o.go("dashboard")})},g.checkUsername=function(){g.users.checkUsernameExist(g.profile.displayName).once("value",function(e){return null!==e.val()?g.nameExist=!0:g.nameExist=!1})}}]),angular.module("App").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl","$http",function(e,t,o,r){var n=new Firebase(o+"users"),i=e(n),l={getLocationIP:function(){return r({url:"http://ipinfo.io/json",method:"GET"})},getLocationIPData:function(){return r({url:"http://ipinfo.io/json",method:"GET"}).then(function(e){return e.data})},profile:function(e){return i.$getRecord(e)},getProfileByUsername:function(t){return e(n.orderByChild("displayName").equalTo(t))},checkUsernameExist:function(e){return n.orderByChild("displayName").equalTo(e)},getProfile:function(e){return t(n.child(e))},getDisplayName:function(e){return null!==e||""!==e?i.$getRecord(e).displayName:void 0},getFollower:function(e){return n.child(e+"/stat/follower/uid")},checkFollow:function(e,t){var r=!1,n=new Firebase(o+"users/"+e+"/stat/following/uid/"+t);return n.once("value",function(e){r=e.exists()}),r},userChangePassword:function(e,t,r){var n=new Firebase(o);n.changePassword({email:e,oldPassword:t,newPassword:r},function(e){if(e)switch(e.code){case"INVALID_PASSWORD":console.log("The specified user account password is incorrect.");break;case"INVALID_USER":console.log("The specified user account does not exist.");break;default:console.log("Error changing password:",e)}else console.log("User password changed successfully!")})},userRef:function(e){return n.child(e)},upvotes:function(e){return n.child(e).child("upvotes")},downvotes:function(e){return n.child(e).child("downvotes")},following:function(e){return n.child(e).child("following")},userArrRef:function(e){return n.child(e)},all:i};return l}]),angular.module("App").factory("UniqueIDGenerator",function(){return{generatePushID:function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,o=[],r=(new Date).getTime(),n=r===t;t=r;for(var i=new Array(8),l=7;l>=0;l--)i[l]=e.charAt(r%64),r=Math.floor(r/64);if(0!==r)throw new Error("We should have converted the entire timestamp.");var a=i.join("");if(n){for(l=11;l>=0&&63===o[l];l--)o[l]=0;o[l]++}else for(l=0;12>l;l++)o[l]=Math.floor(64*Math.random());for(l=0;12>l;l++)a+=e.charAt(o[l]);if(20!=a.length)throw new Error("Length should be 20.");return a}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRvcGljcy5jb250cm9sbGVyLmpzIiwiYnVpbGQuanMiLCJhdXRoLmNvbnRyb2xsZXIuanMiLCJhdXRoLnNlcnZpY2UuanMiLCJjYXRlZ29yeS5jb250cm9sbGVyLmpzIiwiY2F0ZWdvcnkuc2VydmljZS5qcyIsInBvc3Quc2VydmljZS5qcyIsImRhc2hib2FyZC5jb250cm9sbGVyLmpzIiwiZGlyZWN0aXZlcy5qcyIsImxhbmcuanMiLCJub3RpZmljYXRpb24uY29udHJvbGxlci5qcyIsIm5vdGlmaWNhdGlvbi5zZXJ2aWNlLmpzIiwicGxhY2UuY29udHJvbGxlci5qcyIsInBsYWNlLnNlcnZpY2UuanMiLCJ1dGlsaXRpZXMuc2VydmljZS5qcyIsInRhZy5jb250cm9sbGVyLmpzIiwidGFnLnNlcnZpY2UuanMiLCJ0b3BpYy1sYW5kaW5nLmNvbnRyb2xsZXIuanMiLCJ0b3BpY3Muc2VydmljZS5qcyIsInByb2ZpbGUuY29udHJvbGxlci5qcyIsInVzZXJzLnNlcnZpY2UuanMiLCJoZWxwZXJzLnNlcnZpY2UuanMiXSwibmFtZXMiOlsic2hvdyIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImV4dGVuZCIsImJhc2UiLCJwYXJ0cyIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwiZm9yRWFjaCIsInAiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJtb3ZlRmJSZWNvcmQiLCJvbGRSZWYiLCJuZXdSZWYiLCJvbmNlIiwic25hcCIsInNldCIsInZhbCIsImVycm9yIiwicmVtb3ZlIiwiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRtZFRoZW1pbmdQcm92aWRlciIsImRlZmluZVBhbGV0dGUiLCI1MCIsIjEwMCIsIjIwMCIsIjMwMCIsIjQwMCIsIjUwMCIsIjYwMCIsIjcwMCIsIjgwMCIsIjkwMCIsIkExMDAiLCJBMjAwIiwiQTQwMCIsIkE3MDAiLCJjb250cmFzdERlZmF1bHRDb2xvciIsImNvbnRyYXN0RGFya0NvbG9ycyIsImNvbnRyYXN0TGlnaHRDb2xvcnMiLCJ1bmRlZmluZWQiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiRmFjZWJvb2tQcm92aWRlciIsIm15QXBwSWQiLCJzZXRBcHBJZCIsImluaXQiLCIkdHJhbnNsYXRlUHJvdmlkZXIiLCJwcmVmZXJyZWRMYW5ndWFnZSIsInVzZVNhbml0aXplVmFsdWVTdHJhdGVneSIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGNvbnRyb2xsZXJQcm92aWRlciIsInJlZ2lzdGVyQ3RybCIsInJlZ2lzdGVyIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsIiIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsImF1dGgiLCIkcmVxdWlyZUF1dGgiLCJ0aGVuIiwiZ28iLCJsb2dpbi1mb3JtQGhvbWUiLCJmZWVkIiwiVG9waWNzIiwibGF0ZXN0RmVlZCIsImNhdGVOYW1lIiwiJHN0YXRlUGFyYW1zIiwiQ2F0ZWdvcnkiLCJnZXROYW1lIiwiU2x1ZyIsIiRsb2FkZWQiLCJjYXRlVG9waWNzIiwibGlzdCIsImhlYWRlckBwbGFjZXMiLCJwbGFjZUxhbmRpbmciLCJQbGFjZXMiLCIkZmlyZWJhc2VBcnJheSIsImdldFBsYWNlUmVmIiwicGxhY2VfaWQiLCJvbiIsInNuYXBzaG90IiwiaGVhZGVyQHRhZyIsInRhZ05hbWUiLCJUYWciLCJ0YWdMYW5kaW5nIiwiVGFncyIsInRhZyIsInRvcGljc0J5VGFnIiwiaXNPd25lciIsIlVzZXJzIiwidG9waWNVaWQiLCJyZWYiLCJnZXRBdXRoIiwiZm9ydG9waWMiLCJ1aWQiLCJ0b3BpY0xhbmRpbmciLCJyZXBseUxpc3QiLCJ0b3BpY0tleSIsIiRpZCIsInZpZXdEYXRhIiwidGltZSIsIm1vbWVudCIsInRvSVNPU3RyaW5nIiwiaGlzdG9yeU9iaiIsInVzZXJJUCIsImNyZWF0ZWQiLCJnZXRMb2NhdGlvbklQIiwic3VjY2VzcyIsImdldFRvcGljQnlTbHVnIiwiZ2V0Vmlld3MiLCJvYmoiLCJjb3VudCIsImNoaWxkIiwicHVzaCIsInVzZXJSZWYiLCJmb2xsb3dlcnMiLCJnZXRGb2xsb3dlcnMiLCJ2YWx1ZSIsImdldFByb2ZpbGVCeVVzZXJuYW1lIiwiTmFtZSIsInByb2ZpbGUiLCJ1c2VyUG9zdHMiLCJjcmVhdGVkQnkiLCIkcm9vdFNjb3BlIiwiaGVhZGVyQHByb2ZpbGUiLCJwYXNzd29yZEVkaXRAYWNjY291bnRFZGl0IiwidXNlckVkaXRAYWNjY291bnRFZGl0IiwiZ2V0UHJvZmlsZSIsImRpc3BsYXlOYW1lIiwic3RhdCIsImhlYWRlckBnZXRfc3RhcnRlZCIsImxvZ2luLWZvcm1AbG9naW4iLCJvdGhlcndpc2UiLCJmaWx0ZXIiLCJpdGVtcyIsImZpZWxkIiwicmV2ZXJzZSIsImZpbHRlcmVkIiwiaXRlbSIsInNvcnQiLCJhIiwiYiIsInRleHQiLCJkZWNvZGVVUkkiLCIkc2NlIiwidHJ1c3RBc0h0bWwiLCJyZXBsYWNlIiwiY29uc3RhbnQiLCIkc2NvcGUiLCIkbWRTaWRlbmF2IiwiJHRyYW5zbGF0ZSIsIiRjb29raWVzIiwiTm90aVNlcnZpY2UiLCIkbm90aWZpY2F0aW9uIiwiYXV0aEN0cmwiLCJ0aGlzIiwicmVxdWVzdFBlcm1pc3Npb24iLCJwZXJtaXNzaW9uIiwidXNlcnMiLCJub3RpZmljYXRpb24iLCJ1c2VyIiwiZW1haWwiLCJwYXNzd29yZCIsImJhZGdlTm90aWZjYXRpb24iLCJiYWRnZU5vdGlmaWNhdGlvbiIsInJlc2V0Q291bnRlciIsInJlc2V0VW5yZWFkIiwiY2hhbmdlVmFsIiwiJHZhbHVlIiwidG9nZ2xlTGFuZyIsImxhbmdLZXkiLCJ1c2UiLCJwdXQiLCJ1c2VyQXJyUmVmIiwidXBkYXRlIiwibGFuZyIsImdldCIsImxvZ2luIiwiJGF1dGhXaXRoUGFzc3dvcmQiLCJsb2dvdXQiLCIkdW5hdXRoIiwiJGNyZWF0ZVVzZXIiLCJmYWN0b3J5IiwiJGZpcmViYXNlQXV0aCIsIkZpcmViYXNlVXJsIiwiRmlyZWJhc2UiLCJnZXRVaWQiLCJjYXRlQ3RybCIsImNhdGVnb3J5IiwiJGZpcmViYXNlT2JqZWN0IiwiY2F0ZWdvcmllcyIsIkNhdGUiLCJuYW1lIiwidG9waWNfc2x1ZyIsIm9yZGVyQnlDaGlsZCIsImVxdWFsVG8iLCJ1c2Vyc1JlZiIsImFkZENoaWxkIiwiY2hpbGRuYW1lIiwiZm9sbG93TGlzdCIsInVuRm9sbG93Iiwic2x1ZyIsInVzZXJGb2xsb3ciLCJmb2xsb3ciLCJleGlzdHMiLCJhcnIiLCJhbGwiLCJ0b3BpY3MiLCJUUyIsInRvcGljTmFtZSIsIkNhdGVTZXJ2aWNlIiwiZGFzaGJvYXJkQ3RybCIsImNhdGUiLCJ0b3BpY19ncmlkIiwidGFncyIsInVzZXJDYXRlRm9sbG93IiwiY2F0ZUlzRm9sbG93IiwidXNlckZlZWQiLCJmb2xsb3dDYXRlIiwiY2F0ZV9zbHVnIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0cmFuc2NsdWRlIiwic2NvcGUiLCJyZXZpZXciLCJ0b3BpYyIsInJlcXVpcmUiLCJsaW5rIiwiZWxlbWVudCIsImF0dHJzIiwibmdDdHJsIiwibWF4VGFncyIsInBhcnNlSW50IiwiJHBhcnNlcnMiLCJsZW5ndGgiLCJzcGxpY2UiLCJ0cmFuc2xhdGlvbnMiLCJLRVlfREFTSEJPQVJEIiwiS0VZX0xBTkdVQUdFUyIsIktFWV9IT01FIiwiS0VZX1JFR0lTVEVSIiwiS0VZX0xPR0lOIiwiS0VZX0xPR09VVCIsIktFWV9GT0xMT1ciLCJLRVlfRk9MTE9XRVIiLCJLRVlfVU5GT0xMT1ciLCJLRVlfRk9MTE9XSU5HIiwiS0VZX1BPU1QiLCJLRVlfUE9TVEVEIiwiS0VZX1VQVk9URSIsIktFWV9VUFZPVEVEIiwiS0VZX0RXTl9WT1RFIiwiS0VZX0RXTl9WT1RFRCIsIktFWV9WSUVXIiwiS0VZX1JFTU9WRSIsIktFWV9DQU5DRUwiLCJLRVlfUVVFU1RJT04iLCJLRVlfVE9QSUMiLCJLRVlfQ0hHX1BXRCIsIktFWV9QQVNTV09SRCIsIktFWV9PTERfUFdEIiwiS0VZX05FV19QV0QiLCJLRVlfTkVXX1BXRF9DIiwiS0VZX1NBVkUiLCJLRVlfU0FWRV9EUkFGVCIsIktFWV9UQUdTIiwiS0VZX0VYUExPUkUiLCJLRVlfRkVBVF9DQVQiLCJLRVlfQ09NTUVOVFMiLCJLRVlfUkVQTFkiLCJLRVlfUkVWSUVXIiwiS0VZX0VESVQiLCJLRVlfVFJFTkQiLCJLRVlfVFJFTkRJTkciLCJLRVlfV1JJVEVfUkVQTFkiLCJLRVlfTEFURVNUX0ZFRUQiLCJLRVlfQ09ORl9SRU1PVkUiLCJLRVlfQ09ORl9SRU1fQyIsIktFWV9XSEFUX09OX1VSX01JTkQiLCJLRVlfWU9VX1dBTlRfRk9MTE9XIiwiS0VZX05PX0FDQ1RfUkVHSVNURVIiLCJLRVlfQ0FOVF9DSE5HX1VTRVIiLCJLRVlfWU9VUl9BQ0NPVU5UIiwiS0VZX05PVEhJTkdfSEVSRSIsIktFWV9XSE9fVE9fRk9MTE9XIiwiS0VZX0NBVF9XSUxMX0FQUEVBUiIsIktFWV9XSFRfVVJfU1RPUlkiLCJLRVlfV1JUX0NPTU1FTlQiLCJLRVlfRklSU1ROQU1FIiwiS0VZX0xBU1ROQU1FIiwiS0VZX0JJUlRIREFZIiwiS0VZX01PTlRIIiwiS0VZX0RBWSIsIktFWV9FTUFJTCIsIktFWV9DT05GX0VNQUlMIiwiS0VZX0dFTkRFUiIsIktFWV9NQUxFIiwiS0VZX0ZFTUFMRSIsIktFWV9VU0VSTkFNRSIsIktFWV9MT0NBVElPTiIsIktFWV9FRF9QUk9GSUxFIiwiS0VZX0VEX0NIR19QV0QiLCJLRVlfRURfU0lURSIsIktFWV9FRF9QSE9ORSIsIktFWV9FRF9CSU8iLCJub3RpQ3RybCIsIm5vdGlTZXJ2aWNlIiwibm90aWZ5VG8iLCIkYWRkIiwibm90aSIsIk5vdGlmaWNhdGlvbiIsInVucmVhZE5vdGlmaWNhdGlvbiIsImNvdW50ZXIiLCJub3RpZmljYXRpb25fcmVmIiwiYm9keSIsImRpciIsImljb24iLCJmb2N1c1dpbmRvd09uQ2xpY2siLCJub3RpZnlGb2xsb3dlciIsInRvcGljSWQiLCJnZXRGb2xsb3dlciIsImNoaWxkU25hcHNob3QiLCJ1cGRhdGVOb3RpZmljYXRpb25Db3VudCIsImtleSIsIm5vdGlmeUxvZyIsImZyb21fdWlkIiwiZnJvbSIsImlzX3JlYWQiLCJ0aW1lc3RhbXAiLCJlcnJvck9iamVjdCIsImNvZGUiLCJhZGRBcnJDaGlsZCIsIiRtZERpYWxvZyIsIiRtZE1lZGlhIiwiTGFuZ3VhZ2VzIiwicGxhY2VzQ3RybCIsInBsYWNlRGV0YWlsX3JlZiIsInBsYWNlcyIsImFkZFBsYWNlRGV0YWlsQ2hpbGQiLCJhcmNoaXZlIiwiQXJjaGl2ZSIsInRhZ0N0cmwiLCIkcSIsInRhZ3NVcmwiLCJnZXRUYWdSZWYiLCJnZXRUYWdPYmplY3QiLCJ0b3BpY1RhZ3MiLCJkZWZlcnJlZCIsImRlZmVyIiwiZmIiLCJ0YWdTbmFwIiwidG9waWNTbmFwIiwidG9waWNMYW5kaW5nQ3RybCIsImluUmVwbHlBcnIiLCJyZXBseUluUmVwbHkiLCJpIiwicmVwbHlJZCIsIiRodHRwIiwidG9waWNDdHJsIiwibGFuZ3VhZ2VzIiwidXNlclVwdm90ZWRUb3BpY3MiLCJ1cHZvdGVzIiwidXNlckRvd252b3RlZFRvcGljcyIsImRvd252b3RlcyIsInVzZXJGb2xsb3dpbmciLCJmb2xsb3dpbmciLCJpbWFnZVN0cmluZ3MiLCJpbWFnZVRleHQiLCJsb2FkQnVzeSIsInNsdWdSZXR1cm4iLCJjcml0ZXJpYSIsImNyaXRlcmlhUmVwbHkiLCJyZXZpZXdDcml0ZXJpYSIsImNyaXRSZXBseURhdGEiLCJuZXdUb3BpYyIsImxvY2F0aW9uIiwiaXBJbmZvIiwiYXZnUmV2aWV3UmVwbHkiLCJvYmpDb3VudCIsIk9iamVjdCIsImtleXMiLCJhdmciLCJyZXBseVJldmlld0F2ZXJhZ2UiLCJhdmdSZXZpZXdTY29yZSIsInJhdGluZyIsInJlbW92ZVRyYW5zIiwiY2FuY2VsVHJhbnMiLCJjb25maXJtUmVtIiwiY29uZmlybVJlbUNvbnRlbnQiLCJ1c2VyTmFtZSIsInVzZXJJZCIsInNob3dNZExvZ2luIiwiZXYiLCJ1c2VGdWxsU2NyZWVuIiwiY3VzdG9tRnVsbHNjcmVlbiIsInBhcmVudCIsImRvY3VtZW50IiwidGFyZ2V0RXZlbnQiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiZnVsbHNjcmVlbiIsImRlY29kZVRleHQiLCJsb2FkTW9yZSIsImxvYWRUYWdzIiwicXVlcnkiLCJ1cGxvYWRGaWxlIiwiZmlsZXMiLCJpbmRleCIsImZsb3dGaWxlIiwiZmlsZVJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJldmVudCIsInVyaSIsInRhcmdldCIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJmaWxlIiwic2hvd0NvbmZpcm1SZW1vdmUiLCJ0b3BpY19vd25lciIsImNvbmZpcm0iLCJ0aXRsZSIsInRleHRDb250ZW50Iiwib2siLCJjYW5jZWwiLCJyZW1vdmVUb3BpYyIsInJlZkNoaWxkIiwicmVwbHkiLCJ0b3BpY09iaiIsInJlcGx5QXJyIiwibmV3UmVwbHkiLCJyZXBseUNvdW50IiwicmVwbHlDb3VudFJlZiIsImNvbW1lbnQiLCJyZXBseUluUmVwbHlBcnIiLCJhZGROZXdDaG9pY2UiLCJuZXdJdGVtTm8iLCJpZCIsInJlbW92ZUNob2ljZSIsImxhc3RJdGVtIiwiY3JlYXRlVG9waWMiLCJpc0RyYWZ0IiwibG9jYXRpb25EZXRhaWwiLCJkZXRhaWxzIiwic2x1Z2lmeSIsImFkZHJlc3MiLCJmb3JtYXR0ZWRfYWRkcmVzcyIsImxhdCIsImdlb21ldHJ5IiwibG5nIiwidHlwZSIsInBob3RvcyIsInBob3Rvc190ZXh0IiwiZHJhZnQiLCJzbHVnVGV4dCIsImdldFRvcGljQnlLZXkiLCJwb3N0ZWQiLCJjaGVja0ZvbGxvdyIsImZvbGxvd191aWQiLCJmb2xsb3dVc2VyIiwiZm9sbG93ZXIiLCJ1bmZvbGxvd1VzZXIiLCJ1cHZvdGUiLCJjYW5jZWxEb3dudm90ZSIsInVwdm90ZVRvcGljIiwidXB2b3RlZCIsImNhbmNlbFVwdm90ZSIsInVuZG9VcHZvdGUiLCJkb3dudm90ZSIsImRvd252b3RlVG9waWMiLCJ1bmRvRG93bnZvdGUiLCJmb2xsb3dUb3BpYyIsImhpc3RvcnkiLCJ1bmZvbGxvd1RvcGljIiwidW5mb2xsb3ciLCJnZXRUYWciLCJnZXRTbHVnIiwiY291bnRVc2VyVG9waWNzIiwiZm9ydG9waWNSZWYiLCJ0b3BpY19rZXkiLCJsaW1pdFRvRmlyc3QiLCJpbmNyZW1lbnRWaWV3IiwiZ2V0VXB2b3RlcyIsImFycmF5IiwiZ2V0RG93bnZvdGVzIiwibGltaXRUb0xhc3QiLCIkZmlsdGVyIiwibWQ1IiwiRmFjZWJvb2siLCJub3RpZnkiLCJwcm9maWxlQ3RybCIsImZhY2Vib29rIiwiZWRpdEluaXQiLCJuYW1lRXhpc3QiLCJnZXRVc2VyUG9zdCIsImxpbmtGYWNlYm9vayIsInJlc3BvbnNlIiwiZ2V0TG9naW5TdGF0dXMiLCJzdGF0dXMiLCJsb2dnZWRJbiIsImFwaSIsIm9sZFByb2ZpbGVWYWx1ZSIsInVzZXJDcmVhdGVkIiwiZm9sbG93Q2F0ZUxpc3RBcnIiLCJwaG90byIsIm1lc3NhZ2UiLCJwb3NpdGlvbiIsImR1cmF0aW9uIiwic2F2ZVByb2ZpbGUiLCJyZWRpcmVjdCIsInVwZGF0ZWQiLCJ1c2VyTG9jYXRpb24iLCIkc2F2ZSIsInVwZGF0ZU5hbWUiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsImFjdGlvbiIsIm9sZG5hbWUiLCJ1cGRhdGVCaW8iLCJiaW9ncmFwaHkiLCJ1cGRhdGVQcm9maWxlIiwiY2hlY2tVc2VybmFtZSIsImNoZWNrVXNlcm5hbWVFeGlzdCIsIm1ldGhvZCIsImdldExvY2F0aW9uSVBEYXRhIiwiJGdldFJlY29yZCIsInVzZXJuYW1lIiwiZ2V0RGlzcGxheU5hbWUiLCJmb2xsb3dfaWQiLCJ1c2VyQ2hhbmdlUGFzc3dvcmQiLCJvbGRwYXNzIiwibmV3cGFzcyIsImNoYW5nZVBhc3N3b3JkIiwib2xkUGFzc3dvcmQiLCJuZXdQYXNzd29yZCIsImdlbmVyYXRlUHVzaElEIiwiUFVTSF9DSEFSUyIsImxhc3RQdXNoVGltZSIsImxhc3RSYW5kQ2hhcnMiLCJub3ciLCJEYXRlIiwiZ2V0VGltZSIsImR1cGxpY2F0ZVRpbWUiLCJ0aW1lU3RhbXBDaGFycyIsImNoYXJBdCIsIk1hdGgiLCJmbG9vciIsIkVycm9yIiwiam9pbiIsInJhbmRvbSJdLCJtYXBwaW5ncyI6IkFBQUEsWUF1bkJBLFNBQUFBLE1BQUFDLEdBRUEsTUFEQUMsU0FBQUMsSUFBQUYsR0FDQUcsS0FBQUMsVUFBQUosRUFBQSxLQUFBLEdBSUEsUUFBQUssUUFBQUMsR0FDQSxHQUFBQyxHQUFBQyxNQUFBQyxVQUFBQyxNQUFBQyxLQUFBQyxVQUFBLEVBVUEsT0FUQUwsR0FBQU0sUUFBQSxTQUFBQyxHQUNBLEdBQUFBLEdBQUEsZ0JBQUEsR0FDQSxJQUFBLEdBQUFDLEtBQUFELEdBQ0FBLEVBQUFFLGVBQUFELEtBQ0FULEVBQUFTLEdBQUFELEVBQUFDLE1BS0FULEVDOUlBLFFBQUFXLGNBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLEtBQUEsUUFBQSxTQUFBQyxHQUNBRixFQUFBRyxJQUFBRCxFQUFBRSxNQUFBLFNBQUFDLEdBQ0FBLEVBR0EsbUJBQUEsVUFBQXZCLFFBQUF1QixPQUNBdkIsUUFBQXVCLE1BQUFBLEdBSEFOLEVBQUFPLGFEemZBLEdBQUFDLEtBQUFDLFFBQUFDLE9BQUEsT0FDQSxXQUNBLGNBQ0EsVUFDQSxZQUNBLGFBQ0EsZ0JBQ0EsT0FDQSxZQUNBLGlCQUNBLGNBQ0EsV0FDQSx5QkFDQSxXQUNBLHFCQUdBLGFBQ0EsZUFDQSxrQkFFQSxZQUNBLGlCQUlBQyxRQUFBLHFCQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGNBQUEsU0FDQUMsR0FBQSxTQUNBQyxJQUFBLFNBQ0FDLElBQUEsU0FDQUMsSUFBQSxTQUNBQyxJQUFBLFNBQ0FDLElBQUEsU0FDQUMsSUFBQSxTQUNBQyxJQUFBLFNBQ0FDLElBQUEsU0FDQUMsSUFBQSxTQUNBQyxLQUFBLFNBQ0FDLEtBQUEsU0FDQUMsS0FBQSxTQUNBQyxLQUFBLFNBQ0FDLHFCQUFBLFFBRUFDLG9CQUFBLEtBQUEsTUFDQSxNQUFBLE1BQUEsTUFBQSxRQUNBQyxvQkFBQUMsU0FFQW5CLEVBQUFvQixNQUFBLFdBQ0FDLGVBQUEsWUFJQXRCLFFFQ0ssbUJGQUwsU0FBQXVCLEdBQ0EsR0FBQUMsR0FBQSxpQkFDQUQsR0FBQUUsU0FBQUQsR0FDQUQsRUFBQUcsS0FBQUYsTUFLQXhCLFFBQUEscUJBQUEsU0FBQTJCLEdBQ0FBLEVBQUFDLGtCQUFBLE9BRUFELEVBQUFFLHlCQUFBLGFBS0E3QixRQUFBLGlCQUFBLHFCQUFBLHNCQUFBLFNBQUE4QixFQUFBQyxFQUFBQyxHQUVBbkMsSUFBQW9DLGFBQUFELEVBQUFFLFNBRUFKLEVBQ0FLLE1BQUEsUUFDQUMsSUFBQSxJQUNBQyxPQUNBQyxJQUNBQyxXQUFBLGtDQUNBQyxZQUFBLGlCQUNBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFDLEtBQUEsU0FBQUYsR0FDQUYsRUFBQUssR0FBQSxjQUNBLFNBQUFyRCxHQUNBLE1BQUFBLFNBS0FzRCxtQkFFQVQsWUFBQSxxQ0FPQUwsTUFBQSxZQUNBQyxJQUFBLG9CQUNBQyxPQUNBQyxJQUNBQyxXQUFBLGtDQUNBQyxZQUFBLGtCQUNBQyxTQUNBUyxNQUFBLFNBQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUFBQyxvQkFTQWpCLE1BQUEsWUFDQUMsSUFBQSxtQkFDQUMsT0FDQUMsSUFFQUUsWUFBQSxzQkFDQUMsU0FFQVksVUFBQSxlQUFBLFdBQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBQSxHQUFBQyxRQUFBRixFQUFBRyxNQUFBQyxZQUdBQyxZQUFBLGVBQUEsU0FBQSxTQUFBTCxFQUFBSCxHQUNBLE1BQUFBLEdBQUFTLEtBQUFOLEVBQUFHLGFBU0F0QixNQUFBLFVBQ0FDLElBQUEsa0NBQ0FDLE9BQ0F3QixpQkFDQXRCLFdBQUEsdUJBQ0FDLFlBQUEsdUNBRUFGLElBQ0FDLFdBQUEsMkJBQ0FDLFlBQUEsbUJBQ0FDLFNBQ0FxQixjQUFBLFNBQUEsU0FBQSxlQUFBLGlCQUFBLFNBQUFDLEVBQUFaLEVBQUFHLEVBQUFVLEdBQ0EsR0FBQTdGLEVBS0EsT0FKQTRGLEdBQUFFLFlBQUFYLEVBQUFZLFVBQUFDLEdBQUEsUUFBQSxTQUFBQyxHQUNBakcsRUFBQWlHLEVBQUExRSxNQUNBdEIsUUFBQUMsSUFBQStGLEVBQUExRSxTQUVBdkIsU0FVQWdFLE1BQUEsT0FDQUMsSUFBQSxhQUNBQyxPQUNBZ0MsY0FDQTlCLFdBQUEsdUJBQ0FDLFlBQUEsdUNBRUFGLElBQ0FDLFdBQUEscUJBQ0FDLFlBQUEsaUJBQ0FDLFNBQ0E2QixTQUFBLGVBQUEsU0FBQWhCLEdBQ0EsTUFBQUEsR0FBQWlCLE1BR0FDLFlBQUEsU0FBQSxlQUFBLE9BQUEsU0FBQXJCLEVBQUFHLEVBQUFtQixHQUNBLEdBQUFDLEdBQUFwQixFQUFBaUIsR0F5Q0EsT0FBQXBCLEdBQUF3QixZQUFBRCxVQVdBdkMsTUFBQSxTQUNBQyxJQUFBLFVBQ0FLLFdBUUFKLE9BQ0FDLElBQ0FDLFdBQUEsdUNBQ0FDLFlBQUEsb0JBQ0FDLFNBQ0FtQyxTQUFBLE9BQUEsUUFBQSxlQUFBLFNBQUEsU0FBQWhDLEVBQUFpQyxFQUFBdkIsRUFBQUgsR0FDQSxHQUFBMkIsR0FBQSxFQUVBLE9BQUFsQyxHQUFBbUMsSUFBQUMsVUFDQTdCLEVBQUE4QixTQUFBM0IsRUFBQUcsTUFBQUMsVUFBQVgsS0FBQSxTQUFBNUUsR0FDQSxNQUFBLE9BQUFBLEVBQUEsSUFDQTJHLEVBQUEzRyxFQUFBLEdBQUErRyxJQUNBdEMsRUFBQW1DLElBQUFDLFVBQUFFLEtBQUFKLEdBQ0EsR0FFQSxHQUxBLFVBVUEsSUFHQUssY0FBQSxlQUFBLFNBQUEsU0FBQTdCLEVBQUFILEdBQ0EsTUFBQUEsR0FBQThCLFNBQUEzQixFQUFBRyxNQUFBQyxZQUVBMEIsV0FBQSxlQUFBLFNBQUEsU0FBQSxTQUFBOUIsRUFBQUgsRUFBQVIsR0FDQSxHQUFBMEMsR0FBQSxFQUNBLE9BQUFsQyxHQUFBOEIsU0FBQTNCLEVBQUFHLE1BQUFDLFVBQUFYLEtBQUEsU0FBQTVFLEdBTUEsTUFMQSxPQUFBQSxFQUFBLEdBQ0FrSCxFQUFBbEgsRUFBQSxHQUFBbUgsSUFFQTNDLEVBQUFLLEdBQUEsa0JBRUFHLEVBQUFpQyxVQUFBQyxPQUdBRSxVQUFBLGVBQUEsU0FBQSxRQUFBLE9BQUEsU0FBQWpDLEVBQUFILEVBQUEwQixFQUFBakMsR0FDQSxHQUFBeUMsR0FBQWhELEVBQ0FtRCxFQUFBQyxTQUFBQyxjQUNBQyxHQUFBQyxPQUFBLEdBQUFDLFFBQUFMLEVBTUEsT0FMQVgsR0FBQWlCLGdCQUFBQyxRQUFBLFNBQUE1SCxHQUNBd0gsRUFBQUMsT0FBQXpILEVBQUFBLE9BQ0E0RSxLQUFBLFNBQUE1RSxHQUNBd0gsRUFBQUMsT0FBQXpILEVBQUFBLE9BRUFnRixFQUFBNkMsZUFBQTFDLEVBQUFHLE1BQUFDLFVBQUFYLEtBQUEsU0FBQTVFLEdBa0JBLE1BakJBLGNBQUFBLEVBQUEsR0FBQW1ILE1BQ0FELEVBQUFsSCxFQUFBLEdBQUFtSCxJQUNBakQsRUFBQWMsRUFBQThDLFNBQUFaLEdBRUFoRCxFQUFBNkQsSUFBQXhDLFVBQUFYLEtBQUEsU0FBQTVFLEdBQ0EsTUFBQUEsRUFBQWdJLE1BQ0E5RCxFQUFBMEMsSUFBQXFCLE1BQUEsU0FBQTNHLElBQUEsR0FFQTRDLEVBQUEwQyxJQUFBcUIsTUFBQSxTQUFBM0csSUFBQXRCLEVBQUFnSSxNQUFBLEtBR0F2RCxFQUFBQyxLQUFBQyxlQUFBQyxLQUFBLFNBQUFGLEdBQ0EsR0FBQXFDLEdBQUFyQyxFQUFBcUMsR0FDQTdDLEdBQUEwQyxJQUFBcUIsTUFBQSxXQUFBQSxNQUFBbEIsR0FBQW1CLE9BQUE1RyxJQUFBa0csR0FDQWQsRUFBQXlCLFFBQUF6RCxFQUFBcUMsS0FBQWtCLE1BQUEsU0FBQUEsTUFBQWYsR0FBQWdCLE9BQUE1RyxJQUFBa0csTUFHQXRELEVBQUE2RCxRQUdBSyxXQUFBLGVBQUEsU0FBQSxTQUFBakQsRUFBQUgsR0FDQSxNQUFBQSxHQUFBNkMsZUFBQTFDLEVBQUFHLE1BQUFDLFVBQUFYLEtBQUEsU0FBQTVFLEdBQ0EsR0FBQWtILEdBQUFsSCxFQUFBLEdBQUFtSCxHQUNBLE9BQUFuQyxHQUFBcUQsYUFBQW5CLEdBQUFhLElBQUF4QyxVQUFBWCxLQUFBLFNBQUEwRCxHQUNBLE1BQUFBLGNBVUF0RSxNQUFBLGtCQUNBQyxJQUFBLGtCQUlBRCxNQUFBLFdBQ0FDLElBQUEsa0JBQ0FDLE9BQ0FDLElBQ0FDLFdBQUEsNkJBQ0FDLFlBQUEscUJBQ0FDLFNBQ0FtQyxTQUFBLE9BQUEsUUFBQSxlQUFBLFNBQUFoQyxFQUFBaUMsRUFBQXZCLEdBQ0EsTUFBQVYsR0FBQW1DLElBQUFDLFVBQ0FILEVBQUE2QixxQkFBQXBELEVBQUFxRCxNQUFBakQsVUFBQVgsS0FBQSxTQUFBNkQsR0FDQSxNQUFBQSxHQUFBLEdBQUF0QixLQUFBMUMsRUFBQW1DLElBQUFDLFVBQUFFLEtBQ0EsR0FFQSxLQUlBLElBR0EyQixXQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUFoQyxFQUFBMUIsRUFBQUcsR0FDQSxNQUFBdUIsR0FBQTZCLHFCQUFBcEQsRUFBQXFELE1BQUFqRCxVQUFBWCxLQUFBLFNBQUE2RCxHQUNBLE1BQUEsY0FBQUEsRUFBQSxHQUFBdEIsSUFDQW5DLEVBQUEyRCxVQUFBRixFQUFBLEdBQUF0QixLQURBLFdBS0FzQixTQUFBLFNBQUEsZUFBQSxhQUFBLE9BQUEsUUFBQSxTQUFBakUsRUFBQVcsRUFBQXlELEVBQUFuRSxFQUFBaUMsR0FDQSxNQUFBQSxHQUFBNkIscUJBQUFwRCxFQUFBcUQsTUFBQWpELFVBQUFYLEtBQUEsU0FBQTZELEdBQ0EsTUFBQUEsU0FLQUksa0JBQ0F6RSxXQUFBLHVCQUNBQyxZQUFBLDBDQVFBTCxNQUFBLGdCQUNBQyxJQUFBLGdCQUNBQyxPQUNBNEUsNkJBQ0E3RSxJQUFBLDBCQUNBSSxZQUFBLHVCQUVBMEUseUJBQ0E5RSxJQUFBLHFCQUNBSSxZQUFBLDBCQUVBRixJQUNBQyxXQUFBLDZCQUNBQyxZQUFBLG9CQUNBQyxTQUNBb0UsVUFBQSxXQUNBLE9BQUEsR0FFQWpDLFFBQUEsV0FDQSxPQUFBLEdBRUFnQyxTQUFBLFNBQUEsYUFBQSxPQUFBLFFBQUEsU0FBQWpFLEVBQUFvRSxFQUFBbkUsRUFBQWlDLEdBQ0EsTUFBQWpDLEdBQUFDLEtBQUFDLGVBQUFDLEtBQUEsU0FBQUYsR0FDQSxNQUFBZ0MsR0FBQXNDLFdBQUF0RSxFQUFBcUMsS0FBQXhCLFVBQUFYLEtBQUEsU0FBQTZELEdBQ0EsTUFBQUEsR0FBQVEsWUFDQVIsTUFFQWpFLEdBQUFLLEdBQUEsa0JBR0EsU0FBQXJELEdBQ0FnRCxFQUFBSyxHQUFBLFlBR0FILE1BQUEsU0FBQSxRQUFBLE9BQUEsU0FBQUYsRUFBQWtDLEVBQUFqQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFGLFNBQUEsV0FDQUQsRUFBQUssR0FBQSxpQkFRQWIsTUFBQSxtQkFDQUMsSUFBQSwwQkFDQUksWUFBQSx3QkFHQUwsTUFBQSxtQkFDQUMsSUFBQSxxQkFDQUksWUFBQSwyQkFLQUwsTUFBQSxhQUNBQyxJQUFBLGtCQUNBQyxPQUNBQyxJQUNBQyxXQUFBLDZCQUNBQyxZQUFBLHVCQUNBQyxTQUNBb0UsVUFBQSxXQUNBLE9BQUEsR0FFQWpDLFFBQUEsV0FDQSxPQUFBLEdBRUFnQyxTQUFBLFNBQUEsYUFBQSxPQUFBLFFBQUEsU0FBQWpFLEVBQUFvRSxFQUFBbkUsRUFBQWlDLEdBQ0EsTUFBQWpDLEdBQUFDLEtBQUFDLGVBQUFDLEtBQUEsU0FBQUYsR0FDQSxNQUFBZ0MsR0FBQXNDLFdBQUF0RSxFQUFBcUMsS0FBQXhCLFVBQUFYLEtBQUEsU0FBQTZELEdBV0EsTUFUQUEsR0FBQVMsT0FDQXhDLEVBQUF5QixRQUFBekQsRUFBQXFDLEtBQUFrQixNQUFBLHNCQUFBM0csSUFBQSxHQUNBb0YsRUFBQXlCLFFBQUF6RCxFQUFBcUMsS0FBQWtCLE1BQUEscUJBQUEzRyxJQUFBLEdBQ0FvRixFQUFBeUIsUUFBQXpELEVBQUFxQyxLQUFBa0IsTUFBQSxzQkFBQTNHLElBQUEsR0FDQW9GLEVBQUF5QixRQUFBekQsRUFBQXFDLEtBQUFrQixNQUFBLHVCQUFBM0csSUFBQSxHQUNBb0YsRUFBQXlCLFFBQUF6RCxFQUFBcUMsS0FBQWtCLE1BQUEsd0JBQUEzRyxJQUFBLElBSUFtSCxFQUFBUSxZQUNBUixNQUVBakUsR0FBQUssR0FBQSxrQkFHQSxTQUFBckQsR0FFQSxNQURBZ0QsR0FBQUssR0FBQSxRQUNBckQsTUFHQWtELE1BQUEsU0FBQSxRQUFBLE9BQUEsU0FBQUYsRUFBQWtDLEVBQUFqQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFGLFNBQUEsV0FDQUQsRUFBQUssR0FBQSxpQkFVQWIsTUFBQSxrQkFDQUMsSUFBQSxlQUVBQyxPQUNBQyxJQUNBQyxXQUFBLHVCQUNBQyxZQUFBLHNCQUNBQyxTQUVBWSxVQUFBLGVBQUEsV0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLFFBQUFGLEVBQUFHLE1BQUFDLFlBR0FDLFlBQUEsZUFBQSxTQUFBLFNBQUFMLEVBQUFILEdBQ0EsTUFBQUEsR0FBQVMsS0FBQU4sRUFBQUcsYUFTQXRCLE1BQUEsZ0JBQ0FDLElBQUEsMEJBQ0FDLE9BQ0FDLElBQ0FDLFdBQUEsNkJBQ0FDLFlBQUEsOEJBQ0FDLFNBQ0FvRSxVQUFBLFdBQ0EsT0FBQSxHQUVBakMsUUFBQSxXQUNBLE9BQUEsR0FFQWdDLFNBQUEsUUFBQSxPQUFBLFNBQUEvQixFQUFBakMsR0FDQSxNQUFBQSxHQUFBQyxLQUFBQyxlQUFBQyxLQUFBLFNBQUFGLEdBQ0EsTUFBQWdDLEdBQUFzQyxXQUFBdEUsRUFBQXFDLEtBQUF4QixjQUdBYixNQUFBLFNBQUEsUUFBQSxPQUFBLFNBQUFGLEVBQUFrQyxFQUFBakMsR0FDQSxNQUFBQSxHQUFBQyxLQUFBQyxlQUFBRixTQUFBLFdBQ0FELEVBQUFLLEdBQUEsaUJBVUFiLE1BQUEsZUFDQUMsSUFBQSxvQkFDQUMsT0FDQUMsSUFDQUMsV0FBQSw2QkFDQUMsWUFBQSx3QkFDQUMsU0FDQW9FLFVBQUEsV0FDQSxPQUFBLEdBRUFqQyxRQUFBLFdBQ0EsT0FBQSxHQUVBZ0MsU0FBQSxRQUFBLE9BQUEsU0FBQS9CLEVBQUFqQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFDLEtBQUEsU0FBQUYsR0FDQSxNQUFBZ0MsR0FBQXNDLFdBQUF0RSxFQUFBcUMsS0FBQXhCLGNBR0FiLE1BQUEsU0FBQSxRQUFBLE9BQUEsU0FBQUYsRUFBQWtDLEVBQUFqQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFGLFNBQUEsV0FDQUQsRUFBQUssR0FBQSxjQUtBc0Usc0JBQ0EvRSxXQUFBLHVCQUNBQyxZQUFBLDBDQUtBTCxNQUFBLFNBQ0FDLElBQUEsY0FDQUMsT0FDQUMsSUFDQUUsWUFBQSxtQkFFQStFLG9CQUNBL0UsWUFBQSxxQ0FLQUwsTUFBQSxZQUNBQyxJQUFBLGlCQUNBQyxPQUNBQyxJQUNBRSxZQUFBLHVCQUdBQyxTQUNBQyxlQUFBLFNBQUEsT0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFDLEtBQUFDLGVBQUFDLEtBQUEsU0FBQUYsR0FDQUYsRUFBQUssR0FBQSxTQUNBLFNBQUFyRCxHQUNBLE1BQUFBLFVBTUFvQyxFQUFBeUYsVUFBQSxRQUdBQyxPQUFBLGdCQUFBLFdBQ0EsTUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEtBUUEsT0FQQS9ILFNBQUFkLFFBQUEwSSxFQUFBLFNBQUFJLEdBQ0FELEVBQUF4QixLQUFBeUIsRUFBQXhDLEtBQUE3RixJQUFBcUksS0FFQUQsRUFBQUUsS0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFELEdBQUFMLEdBQUFNLEVBQUFOLEdBQUEsRUFBQSxLQUVBQyxHQUFBQyxFQUFBRCxVQUNBQyxLQUlBSixPQUFBLFlBQUEsV0FDQSxNQUFBLFVBQUFTLEdBQ0EsTUFBQUEsR0FBQUMsVUFBQUQsR0FBQSxNQUtBVCxPQUFBLFNBQUEsT0FBQSxTQUFBVyxHQUNBLE1BQUEsVUFBQUYsR0FDQSxNQUFBQSxHQUFBRSxFQUFBQyxZQUFBSCxFQUFBSSxRQUFBLE1BQUEsVUFBQSxPQUlBQyxTQUFBLGNBQUEsZ0NHcm5CQXpJLFNBQUFDLE9BQUEsT0FDQXdDLFdBQUEsWUFBQSxTQUFBLE9BQUEsUUFBQSxTQUFBLGFBQUEsYUFBQSxhQUFBLFdBQUEsY0FBQSxnQkFBQSxTQUFBaUcsRUFBQTVGLEVBQUFpQyxFQUFBbEMsRUFBQW9FLEVBQUEwQixFQUFBQyxFQUFBQyxFQUNBQyxFQUFBQyxHQUVBekssUUFBQUMsSUFBQSxXQUVBLElBQUF5SyxHQUFBQyxJQUdBRixHQUFBRyxvQkFDQWpHLEtBQUEsU0FBQWtHLEdBQ0E3SyxRQUFBQyxJQUFBNEssS0FJQUgsRUFBQWpHLEtBQUFELEVBQ0FrRyxFQUFBSSxNQUFBckUsRUFDQWlFLEVBQUFLLGFBQUFQLEVBR0EsTUFBQWhHLEVBQUFtQyxJQUFBQyxVQUNBOEQsRUFBQWxDLFFBQUFrQyxFQUFBSSxNQUFBL0IsV0FBQXZFLEVBQUFtQyxJQUFBQyxVQUFBRSxLQUdBNEQsRUFBQWxDLFFBQUEsR0FJQWtDLEVBQUFNLE1BQ0FDLE1BQUEsR0FDQUMsU0FBQSxJQWNBZCxFQUFBZSxpQkFBQVQsRUFBQVUsa0JBR0FWLEVBQUFXLGFBQUEsV0FDQVgsRUFBQUssYUFBQU8sWUFBQVosRUFBQWxDLFFBQUF0QixNQUdBd0QsRUFBQWEsVUFBQSxXQUNBdkwsUUFBQUMsSUFBQSxlQUFBeUssRUFBQVUsa0JBQUFJLFNBWUFkLEVBQUFlLFdBQUEsU0FBQUMsR0FDQXBCLEVBQUFxQixJQUFBRCxHQUVBbkIsRUFBQXFCLElBQUEsV0FBQUYsR0FFQWxILEVBQUFtQyxJQUFBQyxXQUNBOEQsRUFBQUksTUFBQWUsV0FBQXJILEVBQUFtQyxJQUFBQyxVQUFBRSxLQUFBZ0YsUUFBQUMsS0FBQUwsS0FLQWhCLEVBQUFsQyxRQUFBdUQsS0FRQXJCLEVBQUFlLFdBQUFmLEVBQUFsQyxRQUFBdUQsTUFQQXhCLEVBQUF5QixJQUFBLFlBQ0F0QixFQUFBZSxXQUFBbEIsRUFBQXlCLElBQUEsYUFFQXRCLEVBQUFlLFdBQUEsT0FTQWYsRUFBQXVCLE1BQUEsV0FDQXZCLEVBQUFqRyxLQUFBQSxLQUFBeUgsa0JBQUF4QixFQUFBTSxNQUFBckcsS0FBQSxTQUFBRixHQUNBRixFQUFBSyxHQUFBLGNBQ0EsU0FBQXJELEdBQ0FtSixFQUFBbkosTUFBQUEsS0FLQW1KLEVBQUF5QixPQUFBLFdBQ0EzSCxFQUFBQyxLQUFBMkgsVUFDQTdILEVBQUFLLEdBQUEsVUFJQThGLEVBQUE1RyxTQUFBLFdBQ0FVLEVBQUFDLEtBQUE0SCxZQUFBM0IsRUFBQU0sTUFBQXJHLEtBQUEsU0FBQXFHLEdBQ0FOLEVBQUF1QixTQUNBLFNBQUExSyxHQUNBbUosRUFBQW5KLE1BQUFBLFFDM0dBRyxRQUFBQyxPQUFBLE9BQ0EySyxRQUFBLFFBQUEsZ0JBQUEsY0FBQSxTQUFBQyxFQUFBQyxHQUNBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxHQUNBL0gsRUFBQThILEVBQUE1RixHQUVBbkMsR0FDQW1DLElBQUFBLEVBQ0FsQyxLQUFBQSxFQUVBaUksT0FBQSxXQUNBLEdBQUE1RixHQUFBSCxFQUFBQyxTQUNBLE9BQUEsT0FBQUUsRUFDQUgsRUFBQUMsVUFBQUUsS0FHQSxHQUtBLE9BQUF0QyxNQ3BCQTlDLFFBQUFDLE9BQUEsT0FDQXdDLFdBQUEsWUFBQSxTQUFBLFdBQUEsV0FBQSxhQUFBLFNBQUFJLEVBQUFZLEVBQUFGLEVBQUFNLEdBQ0EsR0FBQW9ILEdBQUFoQyxJQUdBZ0MsR0FBQTFILFNBQUFBLEVBQ0EwSCxFQUFBQyxTQUFBekgsRUFDQXdILEVBQUFwSCxXQUFBQSxFQUdBdkYsUUFBQUMsSUFBQSxlQ1ZBeUIsUUFBQUMsT0FBQSxPQUdBMkssUUFBQSxlQUFBLGtCQUFBLGlCQUFBLGNBQUEsU0FBQU8sRUFBQWpILEVBQUE0RyxHQUNBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxFQUFBLGNBQ0FNLEVBQUFELEVBQUFsRyxHQUVBb0csR0FFQUMsS0FBQSxTQUFBQyxHQUNBLEdBQUFsTixHQUFBNEcsRUFBQXVHLGFBQUEsUUFBQUMsUUFBQUYsRUFDQSxPQUFBSixHQUFBOU0sSUFHQThHLFNBQUEsU0FBQW9HLEdBQ0EsTUFBQUosR0FBQU8sU0FBQXBGLE1BQUFsQixPQUdBdUcsU0FBQSxTQUFBQyxHQUNBLE1BQUEzRyxHQUFBcUIsTUFBQXNGLElBR0FDLFdBQUEsU0FBQXpHLEdBQ0EsR0FBQS9HLEdBQUE0RyxFQUFBdUcsYUFBQSxpQkFBQUMsUUFBQXJHLEVBQ0EsT0FBQWxCLEdBQUE3RixJQUdBeU4sU0FBQSxTQUFBQyxFQUFBM0csR0FDQSxHQUFBSCxHQUFBLEdBQUE4RixVQUFBRCxFQUFBLGNBQUFpQixFQUFBLGFBQUEzRyxFQUNBSCxHQUFBbkYsVUFHQWtNLFdBQUEsU0FBQUQsRUFBQTNHLEdBQ0EsR0FBQTZHLElBQUEsRUFDQWhILEVBQUEsR0FBQThGLFVBQUFELEVBQUEsY0FBQWlCLEVBQUEsYUFBQTNHLEVBSUEsT0FIQUgsR0FBQXhGLEtBQUEsUUFBQSxTQUFBNkUsR0FDQTJILEVBQUEzSCxFQUFBNEgsV0FFQUQsR0FFQUUsSUFBQWpJLEVBQUFlLEdBQ0FtSCxJQUFBaEIsRUFFQSxPQUFBQyxNQzNDQXJMLFFBQUFDLE9BQUEsT0FHQTJLLFFBQUEsUUFBQSxrQkFBQSxjQUFBLFNBQUFPLEVBQUFMLEdBQ0EsR0FBQTdGLEdBQUEsR0FBQThGLFVBQUFELEVBQUEsVUFDQXVCLEVBQUFsQixFQUFBbEcsR0FFQXFILEdBQ0FDLFVBQUEsU0FBQWhCLEdBQ0EsR0FBQWxOLEdBQUE0RyxFQUFBdUcsYUFBQSxRQUFBQyxRQUFBRixFQUNBLE9BQUFKLEdBQUE5TSxJQUVBOEcsU0FBQSxTQUFBb0csR0FDQSxNQUFBSixHQUFBTyxTQUFBcEYsTUFBQWxCLE9BRUFnSCxJQUFBQyxFQUVBLE9BQUFDLE1DakJBdE0sUUFBQUMsT0FBQSxPQUNBd0MsV0FBQSxpQkFBQSxPQUFBLFNBQUEsV0FBQSxjQUFBLE9BQUEsU0FBQSxTQUFBSyxFQUFBRCxFQUFBWSxFQUFBK0ksRUFBQTdILEVBQUF0QixHQUVBLEdBQUFvSixHQUFBeEQsSUFFQXdELEdBQUExSixLQUFBRCxFQUVBMkosRUFBQUMsS0FBQUYsRUFDQUMsRUFBQXJCLFdBQUEzSCxFQUNBZ0osRUFBQUosT0FBQWhKLEVBQ0FvSixFQUFBRSxZQUFBLEVBQ0FGLEVBQUFHLEtBQUFqSSxFQUFBd0gsSUFFQU0sRUFBQUksa0JBQ0FKLEVBQUFLLGdCQUNBTCxFQUFBWixXQUFBLEdBQ0FZLEVBQUFNLFNBQUEsT0FFQU4sRUFBQW5KLFdBQUFtSixFQUFBSixPQUFBL0ksYUFFQW1KLEVBQUFPLFdBQUEsU0FBQUMsR0FDQVIsRUFBQUMsS0FBQWYsU0FBQXNCLEVBQUEsYUFDQTNHLE1BQUF4RCxFQUFBbUMsSUFBQUMsVUFBQUUsS0FBQW1CLE9BQUE1RyxJQUFBZ0csU0FBQUMsZ0JBR0F0SCxRQUFBQyxJQUFBLG9CQ3pCQXlCLFFBQUFDLE9BQUEsT0FFQWlOLFVBQUEsYUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsWUFBQSxFQUVBMUssWUFBQSx5Q0FNQXdLLFVBQUEsb0JBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLFlBQUEsRUFFQTFLLFlBQUEseUNBQ0EySyxPQUNBaEUsYUFBQSxRQU9BNkQsVUFBQSxjQUFBLFdBQ0EsT0FFQXhLLFlBQUEsMENBQ0EySyxPQUNBQyxPQUFBLFFBT0FKLFVBQUEsa0JBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLFlBQUEsRUFFQTFLLFlBQUEsa0NBQ0EySyxPQUNBcEIsT0FBQSxRQU9BaUIsVUFBQSxnQkFBQSxXQUNBLE9BRUF4SyxZQUFBLDBDQUNBMkssT0FDQVgsS0FBQSxRQU1BUSxVQUFBLFlBQUEsV0FDQSxPQUVBeEssWUFBQSx1Q0FLQXdLLFVBQUEsVUFBQSxXQUNBLE9BRUF4SyxZQUFBLGtDQUtBd0ssVUFBQSxjQUFBLFdBRUEsT0FFQXhLLFlBQUEsbUNBQ0EySyxPQUNBRSxNQUFBLFFBT0FMLFVBQUEsWUFBQSxXQUNBLE9BRUF4SyxZQUFBLGlDQUNBMkssT0FDQWhCLE9BQUEsUUFNQWEsVUFBQSxtQkFBQSxXQUNBLE9BRUF4SyxZQUFBLHlDQUNBMkssT0FDQUUsTUFBQSxRQU9BTCxVQUFBLGlCQUFBLFdBQ0EsT0FDQU0sUUFBQSxVQUNBQyxLQUFBLFNBQUFKLEVBQUFLLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQUYsRUFBQUUsUUFBQUMsU0FBQUgsRUFBQUUsUUFBQSxLQUFBLElBRUFELEdBQUFHLFNBQUF4SCxLQUFBLFNBQUFJLEdBSUEsTUFIQUEsSUFBQWtILEdBQUFsSCxFQUFBcUgsT0FBQUgsR0FDQWxILEVBQUFzSCxPQUFBdEgsRUFBQXFILE9BQUEsRUFBQSxHQUVBckgsUUM5SEEzRyxRQUFBQyxPQUFBLE9BQ0FDLFFBQUEscUJBQUEsU0FBQTJCLEdBQ0FBLEVBQUFxTSxhQUFBLE9BQ0FDLGNBQUEsWUFDQUMsY0FBQSxZQUNBQyxTQUFBLE9BQ0FDLGFBQUEsV0FDQUMsVUFBQSxTQUNBQyxXQUFBLFVBQ0FDLFdBQUEsU0FDQUMsYUFBQSxXQUNBQyxhQUFBLFdBQ0FDLGNBQUEsWUFDQUMsU0FBQSxPQUNBQyxXQUFBLFNBQ0FDLFdBQUEsU0FDQUMsWUFBQSxVQUNBQyxhQUFBLFdBQ0FDLGNBQUEsWUFDQUMsU0FBQSxPQUNBQyxXQUFBLFNBQ0FDLFdBQUEsU0FDQUMsYUFBQSxXQUNBQyxVQUFBLFFBQ0FDLFlBQUEsa0JBQ0FDLGFBQUEsV0FDQUMsWUFBQSxlQUNBQyxZQUFBLGVBQ0FDLGNBQUEsNEJBQ0FDLFNBQUEsT0FDQUMsZUFBQSxnQkFDQUMsU0FBQSxPQUNBQyxZQUFBLFVBQ0FDLGFBQUEsc0JBQ0FDLGFBQUEsV0FDQUMsVUFBQSxRQUNBQyxXQUFBLFNBQ0FDLFNBQUEsT0FDQUMsVUFBQSxRQUNBQyxhQUFBLFdBQ0FDLGdCQUFBLGdCQUNBQyxnQkFBQSxjQUdBQyxnQkFBQSxtQ0FDQUMsZUFBQSw2REFJQUMsb0JBQUEsdUJBQ0FDLG9CQUFBLHlCQUNBQyxxQkFBQSwrQkFDQUMsbUJBQUEsK0JBQ0FDLGlCQUFBLGVBQ0FDLGlCQUFBLG9CQUNBQyxrQkFBQSxnQkFDQUMsb0JBQUEsaURBQ0FDLGlCQUFBLG9CQUNBQyxnQkFBQSxrQkFLQUMsY0FBQSxhQUNBQyxhQUFBLFlBQ0FDLGFBQUEsV0FDQUMsVUFBQSxRQUNBQyxRQUFBLE1BQ0FDLFVBQUEsUUFDQUMsZUFBQSxnQkFDQUMsV0FBQSxTQUNBQyxTQUFBLE9BQ0FDLFdBQUEsU0FDQUMsYUFBQSxXQUNBQyxhQUFBLFdBR0FDLGVBQUEsZUFDQUMsZUFBQSxrQkFDQUQsZUFBQSxlQUNBRSxZQUFBLFVBQ0FDLGFBQUEsUUFDQUMsV0FBQSxjQUlBelEsRUFBQXFNLGFBQUEsT0FDQUMsY0FBQSxjQUNBQyxjQUFBLE9BQ0FDLFNBQUEsVUFDQUMsYUFBQSxXQUNBQyxVQUFBLGNBQ0FFLFdBQUEsU0FDQUksU0FBQSxVQUdBaE4sRUFBQUMsa0JBQUEsU0NoR0E5QixRQUFBQyxPQUFBLE9BQ0F3QyxXQUFBLFlBQUEsU0FBQSxXQUFBLFNBQUEsY0FBQSxTQUFBSSxFQUFBWSxFQUFBSixFQUFBeUYsR0FDQSxHQUFBeUosR0FBQXRKLElBR0FzSixHQUFBbEcsT0FBQWhKLEVBQ0FrUCxFQUFBblAsS0FBQUEsS0FDQW1QLEVBQUFDLFlBQUExSixFQUVBeUosRUFBQUUsU0FBQSxTQUFBck4sR0FDQSxNQUFBbU4sR0FBQXBHLElBQUE1RixLQUFBbkIsR0FBQXNOLEtBQUF0TixPQ1ZBcEYsUUFBQUMsT0FBQSxPQUVBMkssUUFBQSxlQUFBLGtCQUFBLGlCQUFBLGNBQUEsUUFBQSxnQkFBQSxTQUFBTyxFQUFBakgsRUFBQTRHLEVBQ0EvRixFQUFBZ0UsR0FDQSxHQUFBOUQsR0FBQSxHQUFBOEYsVUFBQUQsRUFBQSxnQkFDQTZILEVBQUF4SCxFQUFBbEcsR0FDQW1FLEVBQUFyRSxFQUtBNk4sR0FHQUMsbUJBQUEsU0FBQXpOLEdBQ0EsR0FDQTBOLEdBREE3TixFQUFBLEdBQUE4RixVQUFBRCxFQUFBLGdCQUFBMUYsRUFBQSxVQUVBSCxHQUFBWixHQUFBLFFBQUEsU0FBQUMsR0FDQXdPLEVBQUF4TyxFQUFBMUUsT0FHQSxJQUFBbVQsR0FBQSxHQUFBaEksVUFBQUQsRUFBQSxnQkFBQTFGLEVBWUEsT0FYQTJOLEdBQUExTyxHQUFBLGNBQUEsV0FDQTBFLEVBQUEsMEJBQ0FpSyxLQUFBLFNBQUE1TixFQUNBNk4sSUFBQSxPQUNBNUksS0FBQSxLQUNBekYsSUFBQSxTQUNBc08sS0FBQSxvRUFFQUMsb0JBQUEsTUFHQUwsR0FJQU0sZUFBQSxTQUFBQyxFQUFBak8sR0FDQSxHQUFBSCxHQUFBbUUsRUFBQWtLLFlBQUFsTyxFQUNBSCxHQUFBeEYsS0FBQSxRQUFBLFNBQUE2RSxHQUNBQSxFQUFBcEYsUUFBQSxTQUFBcVUsR0FFQVgsRUFBQVksd0JBQUFILEVBQUFFLEVBQUFFLFlBTUFDLFVBQUEsU0FBQUwsRUFBQWpPLEVBQUF1TyxHQUVBclYsUUFBQUMsSUFBQSxPQUFBNkcsR0FDQTlHLFFBQUFDLElBQUEsWUFBQW9WLEdBRUFmLEVBQUFqSCxTQUFBdkcsR0FBQW1CLE9BQUE1RyxLQUNBMFQsUUFBQUEsRUFDQU8sS0FBQUQsRUFDQUUsU0FBQSxFQUNBQyxVQUFBbk8sU0FBQUMsaUJBT0FnRSxZQUFBLFNBQUF4RSxHQUNBLEdBQUFILEdBQUEsR0FBQThGLFVBQUFELEVBQUEsZ0JBQUExRixFQUFBLFVBQ0FILEdBQUF0RixJQUFBLElBTUE2VCx3QkFBQSxTQUFBSCxFQUFBak8sRUFBQXVPLEdBRUEsR0FBQTFPLEdBQUEsR0FBQThGLFVBQUFELEVBQUEsZ0JBQUExRixFQUFBLFVBQ0FILEdBQUF4RixLQUFBLFFBQUEsU0FBQTZFLEdBRUEsUUFBQUEsRUFBQTFFLE1BQ0FxRixFQUFBdEYsSUFBQSxHQUVBc0YsRUFBQXRGLElBQUEyRSxFQUFBMUUsTUFBQSxJQUVBLFNBQUFtVSxHQUNBelYsUUFBQUMsSUFBQSxvQkFBQXdWLEVBQUFDLFFBSUFwQixFQUFBYyxVQUFBTCxFQUFBak8sRUFBQXVPLElBS0FoSSxTQUFBLFNBQUFyRixHQUNBLE1BQUFyQixHQUFBcUIsTUFBQUEsSUFHQTJOLFlBQUEsU0FBQTNOLEdBQ0EsTUFBQTZFLEdBQUFsRyxFQUFBcUIsTUFBQUEsS0FHQTZGLElBQUFqSSxFQUFBZSxHQUNBbUgsSUFBQXVHLEVBRUEsT0FBQUMsTUN2R0E1UyxRQUFBQyxPQUFBLE9BQ0F3QyxXQUFBLGNBQUEsU0FBQSxTQUFBLGFBQUEsWUFBQSxXQUFBLE9BQUEsU0FBQSxPQUFBLFFBQUEsT0FBQSxZQUFBLGVBQUEsU0FBQUksRUFBQTZGLEVBQUF6QixFQUFBaU4sRUFBQUMsRUFFQXhQLEVBQUF0QixFQUFBUCxFQUFBaUMsRUFBQXBCLEVBQUF5USxFQUNBcFEsR0FFQSxHQUFBcVEsR0FBQXBMLElBQ0EzSyxTQUFBQyxJQUFBeUYsR0FDQXFRLEVBQUFyUSxhQUFBQSxLQ1JBaEUsUUFBQUMsT0FBQSxPQUNBMkssUUFBQSxVQUFBLGlCQUFBLGNBQUEsU0FBQTFHLEVBQUE0RyxHQUVBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxFQUFBLFVBQ0F3SixFQUFBLEdBQUF2SixVQUFBRCxFQUFBLGtCQUVBeUosRUFBQXJRLEVBQUFlLEdBRUFoQixHQUNBMEgsU0FBQSxTQUFBQyxHQUNBLE1BQUEzRyxHQUFBcUIsTUFBQXNGLElBR0E0SSxvQkFBQSxTQUFBNUksR0FDQSxNQUFBMEksR0FBQWhPLE1BQUFzRixJQUdBekgsWUFBQSxTQUFBQyxHQUNBLE1BQUFhLEdBQUFxQixNQUFBbEMsRUFBQSxVQUVBK0gsSUFBQW9JLEVBRUEsT0FBQXRRLE1DdEJBakUsUUFBQUMsT0FBQSxPQUdBMkssUUFBQSxZQUFBLGtCQUFBLGlCQUFBLGNBQUEsU0FBQU8sRUFBQWpILEVBQUE0RyxHQUNBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxFQUFBLGNBQ0FNLEVBQUFELEVBQUFsRyxHQUdBeEIsR0FGQVMsRUFBQWUsSUFHQXZCLFFBQUEsU0FBQXFJLEdBQ0EsR0FBQTFOLEdBQUE0RyxFQUFBcUIsTUFBQXlGLEVBQ0EsT0FBQVosR0FBQTlNLElBR0ErTixJQUFBaEIsR0FFQSxPQUFBM0gsTUFLQW1ILFFBQUEsYUFBQSxpQkFBQSxjQUFBLFNBQUExRyxFQUFBNEcsR0FDQSxHQUFBN0YsR0FBQSxHQUFBOEYsVUFBQUQsRUFBQSxhQUNBVCxFQUFBbkcsRUFBQWUsRUFFQSxPQUFBb0YsTUFLQU8sUUFBQSxXQUFBLGlCQUFBLGNBQUEsU0FBQTFHLEVBQUE0RyxHQUNBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxFQUFBLFdBQ0EySixFQUFBdlEsRUFBQWUsR0FFQXlQLEdBQ0EvSSxTQUFBLFNBQUFJLEdBQ0EsTUFBQTlHLEdBQUFxQixNQUFBeUYsSUFFQTlHLElBQUFBLEVBQ0FrSCxJQUFBc0ksRUFFQSxPQUFBQyxNQ3pDQTFVLFFBQUFDLE9BQUEsT0FDQXdDLFdBQUEsV0FBQSxPQUFBLFFBQUEsU0FBQSxhQUFBLGFBQUEsVUFBQSxTQUFBSyxFQUFBaUMsRUFBQWxDLEVBQUFvRSxFQUVBdkMsRUFBQUYsR0FFQSxHQUFBbVEsR0FBQTFMLElBQ0EwTCxHQUFBalEsV0FBQUEsRUFDQWlRLEVBQUFuUSxRQUFBQSxLQ1BBeEUsUUFBQUMsT0FBQSxPQUNBMkssUUFBQSxRQUFBLGlCQUFBLGtCQUFBLGNBQUEsS0FBQSxTQUFBMUcsRUFBQWlILEVBQUFMLEVBQUE4SixHQUVBLEdBQUEzUCxHQUFBLEdBQUE4RixVQUFBRCxFQUFBLFFBQ0E4QixFQUFBMUksRUFBQWUsR0FFQU4sR0FFQWdILFNBQUEsU0FBQUMsR0FDQSxNQUFBM0csR0FBQXFCLE1BQUFzRixJQUdBaUosUUFBQSxXQUNBLE1BQUEzUSxHQUFBZSxJQUdBNlAsVUFBQSxTQUFBbFEsR0FDQSxNQUFBSyxHQUFBcUIsTUFBQTFCLElBR0FtUSxhQUFBLFNBQUFuUSxHQUNBLE1BQUF1RyxHQUFBbEcsRUFBQXFCLE1BQUExQixLQUdBb1EsVUFBQSxTQUFBcFEsR0FDQSxHQUFBcVEsR0FBQUwsRUFBQU0sUUFFQUMsRUFBQSxHQUFBcEssVUFBQUQsRUFHQSxPQUFBcUssR0FBQTdPLE1BQUEsUUFBQTFCLEdBQ0FQLEdBQUEsY0FBQSxTQUFBK1EsR0FDQUQsRUFBQTdPLE1BQUEsVUFDQWtGLGFBQUEsUUFDQUMsUUFBQTdHLEdBQ0FQLEdBQUEsY0FBQSxTQUFBZ1IsR0FHQSxNQUZBSixHQUFBdFMsVUFFQWpFLFVBQUEwVyxFQUFBeFYsTUFBQXlWLEVBQUF6VixZQU1BdU0sSUFBQVMsRUFHQSxPQUFBakksTUMvQ0EzRSxRQUFBQyxPQUFBLE9BQ0F3QyxXQUFBLG9CQUFBLFNBQUEsU0FBQSxPQUFBLFNBQUEsT0FBQSxRQUFBLFVBQUEsZUFBQSxZQUFBLFdBQUEsWUFBQSxTQUFBSSxFQUFBNkYsRUFBQS9FLEVBQUFOLEVBQUFQLEVBQUFpQyxFQUVBRCxFQUFBTyxFQUFBQyxFQUFBRyxFQUFBZ0IsR0FFQW5JLFFBQUFDLElBQUEsbUJBRUEsSUFBQStXLEdBQUFyTSxJQUdBcU0sR0FBQXZTLEtBQUFELEVBQ0F3UyxFQUFBbE0sTUFBQXJFLEVBQ0F1USxFQUFBalEsYUFBQUEsRUFDQWlRLEVBQUFqSixPQUFBaEosRUFDQWlTLEVBQUFoUSxVQUFBQSxFQUNBZ1EsRUFBQS9TLE1BQUFrRCxFQUNBNlAsRUFBQTdPLFVBQUFBLEVBQ0E2TyxFQUFBeFEsUUFBQUEsRUFNQXdRLEVBQUFDLGNBQ0FELEVBQUFFLGFBQUEsV0FFQSxJQUFBLEdBQUFDLEdBQUEsRUFBQUEsRUFBQUgsRUFBQWhRLFVBQUEwSSxPQUFBeUgsSUFBQSxDQUNBLEdBQUFwQyxHQUFBaUMsRUFBQWhRLFVBQUFtUSxHQUFBcEMsUUFDQXFDLEVBQUFKLEVBQUFoUSxVQUFBbVEsR0FBQWpRLEdBQ0E4UCxHQUFBQyxXQUFBRSxHQUFBSCxFQUFBakosT0FBQW1KLGFBQUFuQyxFQUFBcUMsS0FJQUosRUFBQUUsa0JqQmpDQXhWLFFBQUFDLE9BQUEsT0FDQXdDLFdBQUEsYUFBQSxTQUFBLFNBQUEsYUFBQSxZQUFBLFdBQUEsUUFBQSxjQUFBLGFBQUEsZ0JBQUEsY0FBQSxPQUFBLFNBQUEsT0FBQSxRQUFBLE9BQUEsU0FBQSxZQUFBLFVBQUEsU0FBQUksRUFBQTZGLEVBQUF6QixFQUFBaU4sRUFBQUMsRUFDQXdCLEVBQUE3SyxFQUFBbEMsRUFBQUcsRUFFQUQsRUFBQW5FLEVBQUF0QixFQUFBUCxFQUFBaUMsRUFDQXBCLEVBQUFNLEVBQUFtUSxFQUFBTSxHQUVBcFcsUUFBQUMsSUFBQSxZQUVBLElBQUFxWCxHQUFBM00sSUFJQTJNLEdBQUFoSixLQUFBakksRUFDQWlSLEVBQUF2SixPQUFBaEosRUFDQXVTLEVBQUE3UyxLQUFBRCxFQUNBOFMsRUFBQXhNLE1BQUFyRSxFQUNBNlEsRUFBQUMsVUFBQXpCLEVBQ0F3QixFQUFBckIsT0FBQXRRLEVBQ0EyUixFQUFBbkIsUUFBQUMsRUFDQWtCLEVBQUFqRCxLQUFBN0osRUFFQSxNQUFBOE0sRUFBQTdTLEtBQUFrQyxJQUFBQyxXQUNBMFEsRUFBQTlPLFFBQUE4TyxFQUFBeE0sTUFBQS9CLFdBQUF1TyxFQUFBN1MsS0FBQWtDLElBQUFDLFVBQUFFLEtBQ0F3USxFQUFBeFEsSUFBQXdRLEVBQUE5TyxRQUFBdEIsSUFDQW9RLEVBQUFwUCxRQUFBb1AsRUFBQXhNLE1BQUE1QyxRQUFBb1AsRUFBQXhRLEtBQ0F3USxFQUFBRSxrQkFBQUYsRUFBQXhNLE1BQUEyTSxRQUFBSCxFQUFBeFEsS0FDQXdRLEVBQUFJLG9CQUFBSixFQUFBeE0sTUFBQTZNLFVBQUFMLEVBQUF4USxLQUNBd1EsRUFBQU0sY0FBQU4sRUFBQXhNLE1BQUErTSxVQUFBUCxFQUFBeFEsT0FHQXdRLEVBQUE5TyxRQUFBLEdBQ0E4TyxFQUFBeFEsSUFBQSxHQUNBd1EsRUFBQXBQLFFBQUEsSUFNQW9QLEVBQUFRLGdCQUNBUixFQUFBUyxhQUNBVCxFQUFBTCxjQUNBSyxFQUFBVSxVQUFBLEVBQ0FWLEVBQUFXLFdBQUEsS0FDQVgsRUFBQVksVUFBQSxFQUNBWixFQUFBYSxjQUFBLEtBQ0FiLEVBQUFjLGdCQUFBLEVBQ0FkLEVBQUFlLGNBQUEsS0FHQWYsRUFBQWdCLFVBQ0FDLFNBQUEsR0FDQXZVLElBQUEsR0FDQXdVLE9BQUEsR0FDQWxLLEtBQUEsR0FDQW9HLEtBQUEsSUFLQTRDLEVBQUFtQixlQUFBLFdBSUEsSUFBQSxHQUZBQyxHQUFBQyxPQUFBQyxLQUFBdEIsRUFBQWEsZUFBQXpJLE9BQ0FtSixFQUFBLEVBQ0ExQixFQUFBLEVBQUF1QixFQUFBdkIsRUFBQUEsSUFDQTBCLEdBQUF2QixFQUFBYSxjQUFBaEIsRUFHQUcsR0FBQXdCLG1CQUFBRCxFQUFBSCxFQUVBMVksUUFBQUMsSUFBQXFYLEVBQUFhLGVBRUFiLEVBQUFlLGVBQUFRLElBQUF2QixFQUFBd0IsbUJBQUEvWSxLQUFBdVgsRUFBQWEsZ0JBS0FiLEVBQUF5QixlQUFBLFNBQUFoWixHQUNBLEdBQUFBLEVBQ0EsQ0FFQSxJQUFBLEdBREE4WSxHQUFBLEVBQ0ExQixFQUFBLEVBQUFBLEVBQUFwWCxFQUFBMlAsT0FBQXlILElBQ0EwQixHQUFBOVksRUFBQW9YLEdBQUE2QixNQUVBLE9BQUFILEdBQUE5WSxFQUFBMlAsU0FNQXBGLEdBQUEsYUFBQSxhQUFBLGtCQUFBLG1CQUFBM0YsS0FBQSxTQUFBaUwsR0FDQTBILEVBQUEyQixZQUFBckosRUFBQWtCLFdBQ0F3RyxFQUFBNEIsWUFBQXRKLEVBQUFtQixXQUNBdUcsRUFBQTZCLFdBQUF2SixFQUFBd0MsZ0JBQ0FrRixFQUFBOEIsa0JBQUF4SixFQUFBeUMsaUJBSUFpRixFQUFBK0IsU0FBQSxTQUFBQyxLQVVBaEMsRUFBQWlDLFlBQUEsU0FBQUMsR0FDQSxHQUFBQyxJQUFBNUQsRUFBQSxPQUFBQSxFQUFBLFFBQUF6TCxFQUFBc1AsZ0JBQ0E5RCxHQUFBOVYsTUFFQXNFLFlBQUEsb0NBQ0F1VixPQUFBalksUUFBQTBOLFFBQUF3SyxTQUFBbEYsTUFDQW1GLFlBQUFMLEVBQ0FNLHFCQUFBLEVBQ0FDLFdBQUFOLEtBTUFuQyxFQUFBMEMsV0FBQSxTQUFBbFEsR0FHQSxNQURBOUosU0FBQUMsSUFBQThKLFVBQUFELElBQ0FDLFVBQUFELElBSUF3TixFQUFBMkMsU0FBQSxTQUFBM1EsR0FDQWdPLEVBQUFVLFVBQUEsQ0FFQSxLQUFBLEdBREFqWSxNQUNBb1gsRUFBQSxFQUFBQSxFQUFBN04sRUFBQW9HLE9BQUF5SCxJQUNBcFgsRUFBQWtJLEtBQUFxQixFQUFBNk4sR0FHQSxPQURBblgsU0FBQUMsSUFBQUYsR0FDQUEsR0FHQXVYLEVBQUE0QyxTQUFBLFNBQUFDLEdBQ0FuYSxRQUFBQyxJQUFBcVgsRUFBQWhKLEtBQUFpSSxZQVVBZSxFQUFBOEMsV0FBQSxTQUFBQyxFQUFBQyxHQUNBNVksUUFBQWQsUUFBQXlaLEVBQUEsU0FBQUUsRUFBQUQsR0FDQSxHQUFBRSxHQUFBLEdBQUFDLFdBQ0FELEdBQUFFLE9BQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBRSxPQUFBQyxNQUNBeEQsR0FBQVEsYUFBQXdDLEdBQUFNLEdBRUFKLEVBQUFPLGNBQUFSLEVBQUFTLFNBTUExRCxFQUFBMkQsa0JBQUEsU0FBQXpCLEVBQUEwQixFQUFBcFQsR0FFQSxHQUFBcVQsR0FBQXZGLEVBQUF1RixVQUNBQyxNQUFBOUQsRUFBQTZCLFlBQ0FrQyxZQUFBL0QsRUFBQThCLG1CQUNBUyxZQUFBTCxHQUNBOEIsR0FBQWhFLEVBQUEyQixhQUNBc0MsT0FBQWpFLEVBQUE0QixZQUNBdEQsR0FBQTlWLEtBQUFxYixHQUFBeFcsS0FBQSxXQUNBMlMsRUFBQWtFLFlBQUFOLEVBQUFwVCxJQUNBdkQsRUFBQUssR0FBQSxnQkFPQTBTLEVBQUFrRSxZQUFBLFNBQUFOLEVBQUFwVCxHQUVBLE1BQUFvVCxJQUFBNUQsRUFBQXhRLEtBQ0E5RixhQUFBc1csRUFBQXZKLE9BQUEwTixTQUFBM1QsRUFBQVosS0FBQW9RLEVBQUFuQixRQUFBOUksU0FBQXZGLEVBQUFaLE9BQ0EsSUFFQSxHQU1Bb1EsRUFBQW9FLE1BQUEsU0FBQUMsR0FFQXJFLEVBQUF2SixPQUFBNk4sU0FBQUQsRUFBQXpVLEtBQUFrTixNQUNBVyxRQUFBNEcsRUFBQXpVLElBQ0F3TixLQUFBNEMsRUFBQXVFLFNBQUFuSCxLQUNBNU4sSUFBQXdRLEVBQUF4USxJQUNBa0ksT0FBQXNJLEVBQUFlLGNBQ0E1USxRQUFBSixTQUFBQyxnQkFDQTNDLEtBQUEsV0FHQTJTLEVBQUFqRCxLQUFBYSx3QkFBQXlHLEVBQUF6VSxJQUFBeVUsRUFBQTdVLElBQUF3USxFQUFBeFEsT0FRQXdRLEVBQUF2SixPQUFBK04sV0FBQUgsRUFBQXpVLEtBQUE1QixVQUFBWCxLQUFBLFNBQUE1RSxHQUNBQSxFQUFBZ0ksTUFHQXVQLEVBQUF2SixPQUFBZ08sY0FBQUosRUFBQXpVLEtBQ0E3RixJQUFBdEIsRUFBQWdJLE1BQUEsR0FIQXVQLEVBQUF2SixPQUFBZ08sY0FBQUosRUFBQXpVLEtBQUE3RixJQUFBLEtBU0FpVyxFQUFBeE0sTUFBQTVDLFFBQUFvUCxFQUFBeFEsS0FBQWtCLE1BQUEsc0JBQ0EzRyxJQUFBaVcsRUFBQTlPLFFBQUFTLEtBQUErUyxRQUFBalUsTUFBQSxHQUVBdVAsRUFBQXhNLE1BQUE1QyxRQUFBb1AsRUFBQXhRLEtBQUFrQixNQUFBLHVCQUFBMlQsRUFBQXpVLEtBQ0FlLE9BQUE1RyxJQUFBZ0csU0FBQUMsZ0JBTUFnUSxFQUFBSixhQUFBLFNBQUFuQyxFQUFBcUMsR0FDQUUsRUFBQXZKLE9BQUFrTyxnQkFBQWxILEVBQUFxQyxHQUFBaEQsTUFDQU0sS0FBQTRDLEVBQUFKLGFBQUF4QyxLQUNBNU4sSUFBQXdRLEVBQUF4USxJQUNBVyxRQUFBSixTQUFBQyxpQkFNQWdRLEVBQUE0RSxhQUFBLFdBQ0EsR0FBQUMsR0FBQTdFLEVBQUFjLGVBQUExSSxPQUFBLENBQ0E0SCxHQUFBYyxlQUFBblEsTUFBQW1VLEdBQUEsV0FBQUQsS0FHQTdFLEVBQUErRSxhQUFBLFdBQ0EsR0FBQUMsR0FBQWhGLEVBQUFjLGVBQUExSSxPQUFBLENBQ0E0SCxHQUFBYyxlQUFBekksT0FBQTJNLElBS0FoRixFQUFBaUYsWUFBQSxTQUFBM1AsRUFBQTRQLEdBR0EsR0FBQUMsR0FBQSxFQUVBLE1BQUFuRixFQUFBZ0IsU0FBQUMsV0FDQXZZLFFBQUFDLElBQUFxWCxFQUFBZ0IsU0FBQUMsVUFDQWtFLEdBQ0EzVyxTQUFBd1IsRUFBQWdCLFNBQUFDLFNBQUFtRSxRQUFBNVcsU0FDQTJILEtBQUFwSSxFQUFBc1gsUUFBQXJGLEVBQUFnQixTQUFBQyxTQUFBbUUsUUFBQTFQLE1BQ0FBLEtBQUFzSyxFQUFBZ0IsU0FBQUMsU0FBQW1FLFFBQUExUCxLQUNBNFAsUUFBQXRGLEVBQUFnQixTQUFBQyxTQUFBbUUsUUFBQUcsa0JBQ0FDLElBQUF4RixFQUFBZ0IsU0FBQUMsU0FBQW1FLFFBQUFLLFNBQUF4RSxTQUFBdUUsTUFDQUUsSUFBQTFGLEVBQUFnQixTQUFBQyxTQUFBbUUsUUFBQUssU0FBQXhFLFNBQUF5RSxNQUNBQSxJQUFBMUYsRUFBQWdCLFNBQUFDLFNBQUFtRSxRQUFBSyxTQUFBeEUsU0FBQXlFLE1BQ0FBLElBQUExRixFQUFBZ0IsU0FBQUMsU0FBQW1FLFFBQUFLLFNBQUF4RSxTQUFBeUUsUUF5QkExRixFQUFBdkosT0FBQUYsSUFBQXVHLE1BQ0E2SSxLQUFBM0YsRUFBQTJGLEtBQ0FsUixLQUFBdUwsRUFBQWdCLFNBQUF2TSxLQUNBa0QsTUFBQXFJLEVBQUFnQixTQUFBckosTUFDQXlGLEtBQUE0QyxFQUFBZ0IsU0FBQTVELEtBQ0E5SCxTQUFBQSxFQUNBOUYsSUFBQXdRLEVBQUF4USxJQUVBMkcsS0FBQTZKLEVBQUFnQixTQUFBckosTUFDQWlPLE9BQUE1RixFQUFBUSxhQUNBcUYsWUFBQTdGLEVBQUFTLFVBQ0FRLFNBQUFrRSxFQUNBelksSUFBQXNULEVBQUFnQixTQUFBdFUsSUFDQW9aLE1BQUFaLEVBQ0EvVSxRQUFBSixTQUFBQyxjQUNBZ0gsS0FBQWdKLEVBQUFnQixTQUFBaEssS0FDQTlHLE9BQUE4UCxFQUFBZ0IsU0FBQUUsT0FDQXhKLE9BQUFzSSxFQUFBYyxpQkFDQXpULEtBQUEsU0FBQXNLLEdBRUEsR0FBQW9PLEdBQUEsRUE4QkEsSUEzQkFBLEVBREEsSUFBQWhZLEVBQUFzWCxRQUFBckYsRUFBQWdCLFNBQUFySixPQUNBcUksRUFBQWdCLFNBQUFySixNQUVBNUosRUFBQXNYLFFBQUFyRixFQUFBZ0IsU0FBQXJKLE9BSUFxSSxFQUFBdkosT0FBQXVQLGNBQUFyTyxFQUFBa0csT0FBQXJKLFFBQUEyQixLQUFBNFAsRUFBQXBPLEVBQUFrRyxRQUdBbUMsRUFBQXhNLE1BQUE1QyxRQUFBb1AsRUFBQXhRLEtBQUFrQixNQUFBLHFCQUNBM0csSUFBQWlXLEVBQUE5TyxRQUFBUyxLQUFBc1UsT0FBQXhWLE1BQUEsR0FFQXVQLEVBQUF4TSxNQUFBNUMsUUFBQW9QLEVBQUF4USxLQUFBa0IsTUFBQSxzQkFBQWlILEVBQUFrRyxPQUNBbE4sT0FBQTVHLElBQUFnRyxTQUFBQyxlQUdBLEtBQUFtVixJQUVBbkYsRUFBQXJCLE9BQUE1SSxTQUFBb1AsRUFBQTNXLFVBQ0FrQyxNQUFBaUgsRUFBQWtHLE9BQ0FsTixPQUFBNUcsSUFBQWdHLFNBQUFDLGVBRUFnUSxFQUFBckIsT0FBQTVJLFNBQUFvUCxFQUFBM1csVUFDQWtDLE1BQUEsUUFBQTNHLElBQUFvYixJQUlBLE9BQUFuRixFQUFBZ0IsU0FBQWhLLEtBQ0EsSUFBQSxHQUFBZ00sR0FBQSxFQUFBQSxFQUFBaEQsRUFBQWdCLFNBQUFoSyxLQUFBb0IsU0FBQTRLLEVBQ0FoRCxFQUFBaEosS0FBQWpCLFNBQUFpSyxFQUFBZ0IsU0FBQWhLLEtBQUFnTSxHQUFBeFEsTUFDQTlCLE1BQUFpSCxFQUFBa0csT0FBQWxOLE9BQUE1RyxJQUFBZ0csU0FBQUMsY0FLQWdRLEdBQUFqRCxLQUFBUyxlQUFBN0YsRUFBQWtHLE1BQUFtQyxFQUFBeFEsS0FJQXdRLEVBQUFnQixVQUNBNUQsS0FBQSxPQU9BNEMsRUFBQWtHLFlBQUEsU0FBQUMsR0FDQSxNQUFBbkcsR0FBQXhNLE1BQUEwUyxZQUFBbEcsRUFBQXhRLElBQUEyVyxJQUNBLEdBRUEsR0FNQW5HLEVBQUFvRyxXQUFBLFNBQUFELEdBR0FuRyxFQUFBeE0sTUFBQS9CLFdBQUEwVSxHQUFBblksVUFBQVgsS0FBQSxTQUFBNUUsR0FFQXVYLEVBQUF4TSxNQUFBNUMsUUFBQXVWLEdBQUF6VixNQUFBLHVCQUNBM0csSUFBQXRCLEVBQUFrSixLQUFBMFUsU0FBQTVWLE1BQUEsR0FFQXVQLEVBQUF4TSxNQUFBNUMsUUFBQXVWLEdBQUF6VixNQUFBLHFCQUFBc1AsRUFBQXhRLEtBQ0FtQixPQUFBNUcsSUFBQWdHLFNBQUFDLGlCQUlBZ1EsRUFBQXhNLE1BQUEvQixXQUFBdU8sRUFBQXhRLEtBQUF4QixVQUFBWCxLQUFBLFNBQUE1RSxHQUVBdVgsRUFBQXhNLE1BQUE1QyxRQUFBb1AsRUFBQXhRLEtBQUFrQixNQUFBLHdCQUNBM0csSUFBQXRCLEVBQUFrSixLQUFBMFUsU0FBQTVWLE1BQUEsR0FFQXVQLEVBQUF4TSxNQUFBNUMsUUFBQW9QLEVBQUF4USxLQUFBa0IsTUFBQSxzQkFBQXlWLEdBQ0F4VixPQUFBNUcsSUFBQWdHLFNBQUFDLGtCQU1BZ1EsRUFBQXNHLGFBQUEsU0FBQUgsR0FHQW5HLEVBQUF4TSxNQUFBL0IsV0FBQTBVLEdBQUFuWSxVQUFBWCxLQUFBLFNBQUE1RSxHQUVBdVgsRUFBQXhNLE1BQUE1QyxRQUFBdVYsR0FBQXpWLE1BQUEsdUJBQ0EzRyxJQUFBdEIsRUFBQWtKLEtBQUEwVSxTQUFBNVYsTUFBQSxHQUVBdVAsRUFBQXhNLE1BQUE1QyxRQUFBdVYsR0FBQXpWLE1BQUEscUJBQUFzUCxFQUFBeFEsS0FBQXRGLFdBSUE4VixFQUFBeE0sTUFBQS9CLFdBQUF1TyxFQUFBeFEsS0FBQXhCLFVBQUFYLEtBQUEsU0FBQTVFLEdBRUF1WCxFQUFBeE0sTUFBQTVDLFFBQUFvUCxFQUFBeFEsS0FBQWtCLE1BQUEsd0JBQ0EzRyxJQUFBdEIsRUFBQWtKLEtBQUE0TyxVQUFBOVAsTUFBQSxHQUVBdVAsRUFBQXhNLE1BQUE1QyxRQUFBb1AsRUFBQXhRLEtBQUFrQixNQUFBLHNCQUFBeVYsR0FBQWpjLFlBUUE4VixFQUFBdUcsT0FBQSxTQUFBNU8sR0FFQWpNLFFBQUFpTSxFQUFBMEksV0FBQTNVLFFBQUFpTSxFQUFBMEksVUFBQUwsRUFBQXhRLE1BQ0F3USxFQUFBd0csZUFBQTdPLEdBRUFxSSxFQUFBdkosT0FBQWdRLFlBQUE5TyxFQUFBL0gsSUFBQW9RLEVBQUF4USxLQUFBeEIsVUFBQVgsS0FBQSxTQUFBMEQsR0FDQWlQLEVBQUFFLGtCQUFBeFAsTUFBQWlILEVBQUEvSCxLQUFBN0YsSUFBQWdILEVBQUFtRCxRQUdBOEwsRUFBQXhNLE1BQUEvQixXQUFBa0csRUFBQW5JLEtBQUF4QixVQUFBWCxLQUFBLFNBQUE1RSxHQUVBdVgsRUFBQXhNLE1BQUE1QyxRQUFBK0csRUFBQW5JLEtBQUFrQixNQUFBLHNCQUNBM0csSUFBQXRCLEVBQUFrSixLQUFBK1UsUUFBQWpXLE1BQUEsR0FDQXVQLEVBQUF4TSxNQUFBNUMsUUFBQStHLEVBQUFuSSxLQUFBa0IsTUFBQSx1QkFBQWlILEVBQUEvSCxLQUNBZSxPQUFBNUcsSUFBQWdHLFNBQUFDLG9CQU1BZ1EsRUFBQTJHLGFBQUEsU0FBQWhQLEdBQ0FxSSxFQUFBdkosT0FBQW1RLFdBQUFqUCxFQUFBL0gsSUFBQW9RLEVBQUF4USxLQUVBd1EsRUFBQXhNLE1BQUEvQixXQUFBa0csRUFBQW5JLEtBQUF4QixVQUFBWCxLQUFBLFNBQUE1RSxHQUdBdVgsRUFBQXhNLE1BQUE1QyxRQUFBK0csRUFBQW5JLEtBQUFrQixNQUFBLHNCQUNBM0csSUFBQXRCLEVBQUFrSixLQUFBK1UsUUFBQWpXLE1BQUEsR0FFQXVQLEVBQUF4TSxNQUFBNUMsUUFBQStHLEVBQUFuSSxLQUFBa0IsTUFBQSx1QkFBQWlILEVBQUEvSCxLQUFBMUYsV0FJQThWLEVBQUFFLGtCQUFBeFAsTUFBQWlILEVBQUEvSCxLQUFBMUYsT0FBQSxTQUFBRCxHQUNBQSxFQUNBdkIsUUFBQUMsSUFBQSxTQUFBc0IsR0FFQXZCLFFBQUFDLElBQUEsNEJBS0FxWCxFQUFBNkcsU0FBQSxTQUFBbFAsR0FDQWpNLFFBQUFpTSxFQUFBd0ksU0FBQXpVLFFBQUFpTSxFQUFBd0ksUUFBQUgsRUFBQXhRLE1BQ0F3USxFQUFBMkcsYUFBQWhQLEdBRUFxSSxFQUFBdkosT0FBQXFRLGNBQUFuUCxFQUFBL0gsSUFBQW9RLEVBQUF4USxLQUFBeEIsVUFBQVgsS0FBQSxTQUFBMEQsR0FDQWlQLEVBQUFJLG9CQUFBMVAsTUFBQWlILEVBQUEvSCxLQUFBN0YsSUFBQWdILEVBQUFtRCxXQUlBOEwsRUFBQXdHLGVBQUEsU0FBQTdPLEdBQ0FxSSxFQUFBdkosT0FBQXNRLGFBQUFwUCxFQUFBL0gsSUFBQW9RLEVBQUF4USxLQUNBd1EsRUFBQUksb0JBQUExUCxNQUFBaUgsRUFBQS9ILEtBQUExRixPQUFBLFNBQUFELEdBQ0FBLEVBQ0F2QixRQUFBQyxJQUFBLFNBQUFzQixHQUVBdkIsUUFBQUMsSUFBQSw0QkFLQXFYLEVBQUFnSCxZQUFBLFNBQUFyUCxHQUNBcUksRUFBQXZKLE9BQUFKLE9BQUFzQixFQUFBL0gsSUFBQW9RLEVBQUF4USxLQUFBeEIsVUFBQVgsS0FBQSxTQUFBMEQsR0FDQWlQLEVBQUFNLGNBQUE1UCxNQUFBaUgsRUFBQS9ILEtBQUE3RixJQUFBZ0gsRUFBQWtXLFFBQUFqSCxFQUFBeFEsU0FJQXdRLEVBQUFrSCxjQUFBLFNBQUF2UCxHQUNBcUksRUFBQXZKLE9BQUEwUSxTQUFBeFAsRUFBQS9ILElBQUFvUSxFQUFBeFEsS0FDQXdRLEVBQUFNLGNBQUE1UCxNQUFBaUgsRUFBQS9ILEtBQUExRixPQUFBLFNBQUFELEdBQ0FBLEVBQ0F2QixRQUFBQyxJQUFBLFNBQUFzQixHQUVBdkIsUUFBQUMsSUFBQSwrQmtCbGZBeUIsUUFBQUMsT0FBQSxPQUVBMkssUUFBQSxVQUFBLGtCQUFBLGlCQUFBLGNBQUEsU0FBQU8sRUFBQWpILEVBQUE0RyxHQUNBLEdBQUE3RixHQUFBLEdBQUE4RixVQUFBRCxFQUFBLFVBQ0F1QixFQUFBbEIsRUFBQWxHLEdBSUE1QixHQUhBYSxFQUFBZSxJQUtBK1gsT0FBQSxTQUFBcFksR0FDQSxNQUFBVixHQUFBZSxFQUFBdUcsYUFBQSxRQUFBQyxRQUFBN0csS0FJQXFZLFFBQUEsU0FBQWxSLEdBQ0EsR0FBQTFOLEdBQUE0RyxFQUFBdUcsYUFBQSxRQUFBQyxRQUFBTSxFQUNBLE9BQUE3SCxHQUFBN0YsSUFJQTJJLFVBQUEsU0FBQTVCLEdBQ0EsTUFBQWxCLEdBQUFlLEVBQUF1RyxhQUFBLE9BQUFDLFFBQUFyRyxLQUdBMlUsU0FBQSxTQUFBelQsR0FDQSxNQUFBckIsR0FBQXFCLE1BQUFBLElBRUE0VyxnQkFBQSxhQUdBcFosS0FBQSxTQUFBb0gsR0FDQSxHQUFBN00sR0FBQTRHLEVBQUF1RyxhQUFBLFlBQUFDLFFBQUFQLEVBQ0EsT0FBQWhILEdBQUE3RixJQUdBaU4sS0FBQSxTQUFBQyxHQUNBLEdBQUFsTixHQUFBNEcsRUFBQXVHLGFBQUEsUUFBQUMsUUFBQUYsRUFDQSxPQUFBSixHQUFBOU0sSUFJQThlLFlBQUEsU0FBQTVSLEdBQ0EsTUFBQXRHLEdBQUF1RyxhQUFBLFFBQUFDLFFBQUFGLElBR0FxUSxjQUFBLFNBQUF3QixHQUNBLE1BQUEsSUFBQXJTLFVBQUFELEVBQUEsVUFBQXNTLElBR0FsWCxlQUFBLFNBQUFxRixHQUNBLE1BQUFySCxHQUFBZSxFQUFBdUcsYUFBQSxRQUFBQyxRQUFBRixHQUFBOFIsYUFBQSxLQUdBQyxjQUFBLFNBQUEvUixLQUdBcEcsU0FBQSxTQUFBb0csR0FDQSxNQUFBckgsR0FBQWIsRUFBQThaLFlBQUE1UixLQUlBakcsVUFBQSxTQUFBK04sR0FDQSxHQUFBaFYsR0FBQTRHLEVBQUFxQixNQUFBK00sRUFBQSxXQUNBLE9BQUFuUCxHQUFBN0YsSUFJQTZiLFNBQUEsU0FBQTdHLEdBQ0EsTUFBQW5QLEdBQUFlLEVBQUFxQixNQUFBK00sRUFBQSxjQUlBK0csV0FBQSxTQUFBL0csR0FDQSxNQUFBbEksR0FBQWxHLEVBQUFxQixNQUFBK00sRUFBQSxlQUVBZ0gsY0FBQSxTQUFBaEgsR0FDQSxNQUFBcE8sR0FBQXFCLE1BQUErTSxFQUFBLG1CQUdBbUMsYUFBQSxTQUFBbkMsRUFBQXFDLEdBQ0EsTUFBQXhSLEdBQUFlLEVBQUFxQixNQUFBK00sRUFBQSxZQUFBcUMsRUFBQSxjQUlBNkUsZ0JBQUEsU0FBQWxILEVBQUFxQyxHQUVBLE1BQUF4UixHQUFBZSxFQUFBcUIsTUFBQStNLEVBQUEsWUFBQXFDLEVBQUEsY0FJQTZILFdBQUEsU0FBQWxLLEdBQ0EsT0FDQXBPLElBQUFBLEVBQUFxQixNQUFBK00sRUFBQSxZQUNBbUssTUFBQXRaLEVBQUFlLEVBQUFxQixNQUFBK00sRUFBQSxlQUtBb0ssYUFBQSxTQUFBcEssR0FDQSxPQUNBcE8sSUFBQUEsRUFBQXFCLE1BQUErTSxFQUFBLGNBQ0FtSyxNQUFBdFosRUFBQWUsRUFBQXFCLE1BQUErTSxFQUFBLGlCQUtBM00sYUFBQSxTQUFBMk0sR0FDQSxPQUNBcE8sSUFBQUEsRUFBQXFCLE1BQUErTSxFQUFBLGNBQ0FqTixJQUFBK0UsRUFBQWxHLEVBQUFxQixNQUFBK00sRUFBQSxpQkFJQWdKLFlBQUEsU0FBQWhKLEVBQUFqTyxHQUVBLE1BREFILEdBQUFxQixNQUFBK00sRUFBQSxZQUFBL00sTUFBQWxCLEdBQUF6RixJQUFBZ0csU0FBQUMsZUFDQXVGLEVBQUFsRyxFQUFBcUIsTUFBQStNLEVBQUEsWUFBQS9NLE1BQUFsQixLQUdBb1gsV0FBQSxTQUFBbkosRUFBQWpPLEdBT0EsTUFOQUgsR0FBQXFCLE1BQUErTSxFQUFBLFlBQUEvTSxNQUFBbEIsR0FBQXRGLE9BQUEsU0FBQUQsR0FDQUEsRUFDQXZCLFFBQUFDLElBQUEsU0FBQXNCLEdBRUF2QixRQUFBQyxJQUFBLDJCQUVBMEcsRUFBQXFCLE1BQUErTSxFQUFBLGFBR0FxSixjQUFBLFNBQUFySixFQUFBak8sR0FFQSxNQURBSCxHQUFBcUIsTUFBQStNLEVBQUEsY0FBQS9NLE1BQUFsQixHQUFBekYsSUFBQWdHLFNBQUFDLGVBQ0F1RixFQUFBbEcsRUFBQXFCLE1BQUErTSxFQUFBLGNBQUEvTSxNQUFBbEIsS0FHQXVYLGFBQUEsU0FBQXRKLEVBQUFqTyxHQU9BLE1BTkFILEdBQUFxQixNQUFBK00sRUFBQSxjQUFBL00sTUFBQWxCLEdBQUF0RixPQUFBLFNBQUFELEdBQ0FBLEVBQ0F2QixRQUFBQyxJQUFBLFNBQUFzQixHQUVBdkIsUUFBQUMsSUFBQSwyQkFFQTBHLEVBQUFxQixNQUFBK00sRUFBQSxlQUdBcEgsT0FBQSxTQUFBb0gsRUFBQWpPLEdBVUEsTUFUQUgsR0FBQXFCLE1BQUErTSxFQUFBLGNBQUEvTSxNQUFBLFdBQUFBLE1BQUFsQixHQUFBekYsSUFBQWdHLFNBQUFDLGVBQ0F1RixFQUFBbEcsRUFBQXFCLE1BQUErTSxFQUFBLGNBQUEvTSxNQUFBLFVBQUExQyxVQUFBWCxLQUFBLFNBQUE1RSxHQUNBLE9BQUFBLEVBQUFzSSxPQUFBckYsU0FBQWpELEVBQUFzSSxNQUNBMUIsRUFBQXFCLE1BQUErTSxFQUFBLGNBQUEvTSxNQUFBLFNBQUEzRyxJQUFBLEdBRUFzRixFQUFBcUIsTUFBQStNLEVBQUEsY0FBQS9NLE1BQUEsU0FBQTNHLElBQUF0QixFQUFBeUwsT0FBQSxLQUlBcUIsRUFBQWxHLEVBQUFxQixNQUFBK00sRUFBQSxnQkFHQTBKLFNBQUEsU0FBQTFKLEVBQUFqTyxHQVVBLE1BVEFILEdBQUFxQixNQUFBK00sRUFBQSxjQUFBL00sTUFBQSxXQUFBQSxNQUFBbEIsR0FBQXRGLE9BQUEsU0FBQUQsR0FDQUEsRUFDQXZCLFFBQUFDLElBQUEsU0FBQXNCLElBRUF2QixRQUFBQyxJQUFBLHlCQUNBNE0sRUFBQWxHLEVBQUFxQixNQUFBK00sRUFBQSxjQUFBL00sTUFBQSxVQUFBMUMsVUFBQVgsS0FBQSxTQUFBNUUsR0FDQTRHLEVBQUFxQixNQUFBK00sRUFBQSxjQUFBL00sTUFBQSxTQUFBM0csSUFBQXRCLEVBQUF5TCxPQUFBLFFBR0E3RSxFQUFBcUIsTUFBQStNLEVBQUEsZUFHQWxOLFNBQUEsU0FBQWtOLEdBQ0EsT0FDQXBPLElBQUFBLEVBQUFxQixNQUFBK00sR0FBQS9NLE1BQUEsU0FDQUYsSUFBQStFLEVBQUFsRyxFQUFBcUIsTUFBQStNLEdBQUEvTSxNQUFBLFlBSUFoRCxXQUFBLFdBQ0EsTUFBQVksR0FBQWUsRUFBQXVHLGFBQUEsV0FBQWtTLFlBQUEsTUFHQTdZLFlBQUEsU0FBQUQsR0FDQSxNQUFBVixHQUFBZSxFQUFBdUcsYUFBQSxRQUFBQyxRQUFBN0csS0FJQXVILElBQUFqSSxFQUFBZSxHQUVBbUgsSUFBQUMsRUFDQXBILElBQUFBLEdBR0EsT0FBQTVCLE1DaE1BckQsUUFBQUMsT0FBQSxPQUNBd0MsV0FBQSxlQUFBLFNBQUEsYUFBQSxTQUFBLFVBQUEsTUFBQSxPQUFBLFFBQUEsU0FBQSxXQUFBLFNBQUEsY0FBQSxVQUFBLFVBQUEsWUFBQSxTQUFBaUcsRUFBQXpCLEVBQUFwRSxFQUFBOGEsRUFBQUMsRUFFQTlhLEVBQUFpQyxFQUFBMUIsRUFBQXdhLEVBQUFDLEVBQUF0UixFQUVBMUYsRUFBQWhDLEVBQUFpQyxHQUVBekksUUFBQUMsSUFBQSxjQUVBLElBQUF3ZixHQUFBOVUsSUFHQThVLEdBQUFqWCxRQUFBQSxFQUNBaVgsRUFBQWhiLEtBQUFELEVBQ0FpYixFQUFBM1UsTUFBQXJFLEVBQ0FnWixFQUFBMVIsT0FBQWhKLEVBQ0EwYSxFQUFBQyxTQUFBSCxFQUNBRSxFQUFBalosUUFBQUEsRUFDQWlaLEVBQUFyUixLQUFBRixFQUNBdVIsRUFBQWxiLE9BQUFBLEVBQ0FrYixFQUFBaFgsVUFBQUEsRUFFQWdYLEVBQUFoUixTQUFBLEdBQ0FnUixFQUFBM2EsS0FBQSxHQUVBMmEsRUFBQUUsU0FBQSxXQUVBRixFQUFBRyxXQUFBLEVBR0FILEVBQUFJLFlBQUEsU0FBQS9ZLEdBQ0EyWSxFQUFBM2EsS0FBQTJhLEVBQUExUixPQUFBckYsVUFBQTVCLElBTUEyWSxFQUFBSyxhQUFBLFdBQ0FMLEVBQUFDLFNBQUF6VCxNQUFBLFNBQUE4VCxHQUNBTixFQUFBQyxTQUFBTSxlQUFBLFNBQUFELEdBQ0EsY0FBQUEsRUFBQUUsUUFDQTdWLEVBQUE4VixVQUFBLEVBQ0FULEVBQUFDLFNBQUFTLElBQUEsTUFBQSxTQUFBSixHQUNBL2YsUUFBQUMsSUFBQThmLE1BR0EvZixRQUFBQyxJQUFBLHNCQVFBd2YsRUFBQVcsZ0JBQUFYLEVBQUFqWCxRQUdBaVgsRUFBQVksWUFBQSxTQUFBdlosR0FDQSxNQUFBMlksR0FBQTFSLE9BQUFyRixVQUFBNUIsSUFLQTJZLEVBQUEzSCxnQkFDQTJILEVBQUFsUixrQkFDQWtSLEVBQUFqUixnQkFDQWlSLEVBQUFsUyxXQUFBLEdBTUFrUyxFQUFBYSxrQkFBQSxTQUFBeFosR0FDQTJZLEVBQUFsUyxXQUFBa1MsRUFBQXJSLEtBQUFiLFdBQUF6RyxJQUdBdEMsRUFBQW1DLElBQUFDLFdBQ0E2WSxFQUFBYSxrQkFBQTliLEVBQUFtQyxJQUFBQyxVQUFBRSxLQUdBMlksRUFBQS9RLFdBQUEsU0FBQTRMLEVBQUEzTCxHQUNBOFEsRUFBQWpSLGFBQUE4TCxJQUFBLEVBQ0FtRixFQUFBclIsS0FBQWYsU0FBQXNCLEVBQUEsYUFDQTNHLE1BQUF4RCxFQUFBbUMsSUFBQUMsVUFBQUUsS0FBQW1CLE9BQUE1RyxJQUFBZ0csU0FBQUMsZ0JBUUFtWSxFQUFBckYsV0FBQSxTQUFBQyxHQUNBM1ksUUFBQWQsUUFBQXlaLEVBQUEsU0FBQUUsRUFBQXBELEdBQ0EsR0FBQXFELEdBQUEsR0FBQUMsV0FDQUQsR0FBQUUsT0FBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUFFLE9BQUFDLE1BQ0EyRSxHQUFBM0gsYUFBQVgsR0FBQXlELEVBQ0E2RSxFQUFBM1UsTUFBQWUsV0FBQXJILEVBQUFtQyxJQUFBQyxVQUFBRSxLQUFBZ0YsUUFBQXlVLE1BQUEzRixJQUNBNEUsR0FBQWdCLFFBQUEsUUFBQUMsU0FBQSxTQUFBQyxTQUFBLE9BRUFsRyxFQUFBTyxjQUFBUixFQUFBUyxTQU9BeUUsRUFBQWtCLFlBQUEsU0FBQUMsR0FDQW5CLEVBQUFqWCxRQUFBcVksUUFBQXhaLFNBQUFDLGNBR0EsT0FBQW1ZLEVBQUFsSCxXQUNBa0UsZ0JBQ0EzVyxTQUFBMlosRUFBQWxILFNBQUFtRSxRQUFBNVcsU0FDQWtILEtBQUF5UyxFQUFBbEgsU0FBQW1FLFFBQUExUCxLQUNBNFAsUUFBQTZDLEVBQUFsSCxTQUFBbUUsUUFBQUcsa0JBQ0FDLElBQUEyQyxFQUFBbEgsU0FBQW1FLFFBQUFLLFNBQUF4RSxTQUFBdUUsTUFDQUUsSUFBQXlDLEVBQUFsSCxTQUFBbUUsUUFBQUssU0FBQXhFLFNBQUF5RSxPQUdBeUMsRUFBQWpYLFFBQUFzWSxhQUFBckUsZ0JBR0FnRCxFQUFBalgsUUFBQXVZLFFBQUFwYyxLQUFBLFdBQ0E2YSxHQUFBZ0IsUUFBQSxRQUFBQyxTQUFBLFNBQUFDLFNBQUEsTUFDQTFkLFNBQUE0ZCxHQUNBcmMsRUFBQUssR0FBQWdjLEtBSEFuQixTQUtBLFNBQUFsZSxHQUNBaWUsR0FBQWdCLFFBQUEsb0JBQUFDLFNBQUEsU0FBQUMsU0FBQSxTQU1BakIsRUFBQXVCLFdBQUEsV0FFQXZCLEVBQUEzVSxNQUFBZSxXQUFBckgsRUFBQW1DLElBQUFDLFVBQUFFLEtBQUFnRixRQUVBbVYsVUFBQXhCLEVBQUFqWCxRQUFBeVksVUFDQUMsU0FBQXpCLEVBQUFqWCxRQUFBMFksV0FJQXpCLEVBQUEzVSxNQUFBZSxXQUFBckgsRUFBQW1DLElBQUFDLFVBQUFFLElBQUEsUUFBQW1CLE9BQUE1RztBQUNBOGYsT0FBQSxjQUNBQyxRQUFBM0IsRUFBQVcsZ0JBQUFhLFVBQUEsSUFBQXhCLEVBQUFXLGdCQUFBYyxTQUNBelosUUFBQUosU0FBQUMsZ0JBR0FrWSxHQUFBZ0IsUUFBQSxRQUFBQyxTQUFBLFNBQUFDLFNBQUEsT0FLQWpCLEVBQUE0QixVQUFBLFdBQ0E1QixFQUFBM1UsTUFBQWUsV0FBQXJILEVBQUFtQyxJQUFBQyxVQUFBRSxLQUFBZ0YsUUFBQXdWLFVBQUE3QixFQUFBalgsUUFBQThZLFlBRUE5QixHQUFBZ0IsUUFBQSxRQUFBQyxTQUFBLFNBQUFDLFNBQUEsT0FJQWpCLEVBQUE4QixjQUFBLFdBRUE5QixFQUFBalgsUUFBQXVZLFFBQUFwYyxLQUFBLFdBQ0FKLEVBQUFLLEdBQUEsZ0JBTUE2YSxFQUFBK0IsY0FBQSxXQUVBL0IsRUFBQTNVLE1BQUEyVyxtQkFBQWhDLEVBQUFqWCxRQUFBUSxhQUFBN0gsS0FBQSxRQUFBLFNBQUE2RSxHQUNBLE1BQUEsUUFBQUEsRUFBQTFFLE1BQ0FtZSxFQUFBRyxXQUFBLEVBRUFILEVBQUFHLFdBQUEsUUNqTEFsZSxRQUFBQyxPQUFBLE9BQ0EySyxRQUFBLFNBQUEsaUJBQUEsa0JBQUEsY0FBQSxRQUFBLFNBQUExRyxFQUFBaUgsRUFBQUwsRUFBQTZLLEdBQ0EsR0FBQWpLLEdBQUEsR0FBQVgsVUFBQUQsRUFBQSxTQUNBMUIsRUFBQWxGLEVBQUF3SCxHQUVBM0csR0FDQWlCLGNBQUEsV0FDQSxNQUFBMlAsSUFDQXJULElBQUEsd0JBQ0EwZCxPQUFBLFNBSUFDLGtCQUFBLFdBQ0EsTUFBQXRLLElBQ0FyVCxJQUFBLHdCQUNBMGQsT0FBQSxRQUNBL2MsS0FBQSxTQUFBNUUsR0FDQSxNQUFBQSxHQUFBQSxRQUlBeUksUUFBQSxTQUFBMUIsR0FDQSxNQUFBZ0UsR0FBQThXLFdBQUE5YSxJQUtBd0IscUJBQUEsU0FBQXVaLEdBQ0EsTUFBQWpjLEdBQUF3SCxFQUFBRixhQUFBLGVBQUFDLFFBQUEwVSxLQUlBSixtQkFBQSxTQUFBSSxHQUNBLE1BQUF6VSxHQUFBRixhQUFBLGVBQUFDLFFBQUEwVSxJQUlBOVksV0FBQSxTQUFBakMsR0FDQSxNQUFBK0YsR0FBQU8sRUFBQXBGLE1BQUFsQixLQUdBZ2IsZUFBQSxTQUFBaGIsR0FDQSxNQUFBLFFBQUFBLEdBQUEsS0FBQUEsRUFDQWdFLEVBQUE4VyxXQUFBOWEsR0FBQWtDLFlBREEsUUFNQWdNLFlBQUEsU0FBQWxPLEdBQ0EsTUFBQXNHLEdBQUFwRixNQUFBbEIsRUFBQSx1QkFJQTBXLFlBQUEsU0FBQTFXLEVBQUFpYixHQUVBLEdBQUFwVSxJQUFBLEVBQ0FoSCxFQUFBLEdBQUE4RixVQUFBRCxFQUFBLFNBQUExRixFQUFBLHVCQUFBaWIsRUFJQSxPQUhBcGIsR0FBQXhGLEtBQUEsUUFBQSxTQUFBNkUsR0FDQTJILEVBQUEzSCxFQUFBNEgsV0FFQUQsR0FJQXFVLG1CQUFBLFNBQUEvVyxFQUFBZ1gsRUFBQUMsR0FFQSxHQUFBdmIsR0FBQSxHQUFBOEYsVUFBQUQsRUFDQTdGLEdBQUF3YixnQkFDQWxYLE1BQUFBLEVBQ0FtWCxZQUFBSCxFQUNBSSxZQUFBSCxHQUNBLFNBQUEzZ0IsR0FDQSxHQUFBQSxFQUNBLE9BQUFBLEVBQUFtVSxNQUNBLElBQUEsbUJBQ0ExVixRQUFBQyxJQUFBLG9EQUNBLE1BQ0EsS0FBQSxlQUNBRCxRQUFBQyxJQUFBLDZDQUNBLE1BQ0EsU0FDQUQsUUFBQUMsSUFBQSwyQkFBQXNCLE9BR0F2QixTQUFBQyxJQUFBLDBDQUtBaUksUUFBQSxTQUFBcEIsR0FDQSxNQUFBc0csR0FBQXBGLE1BQUFsQixJQUdBMlEsUUFBQSxTQUFBM1EsR0FDQSxNQUFBc0csR0FBQXBGLE1BQUFsQixHQUFBa0IsTUFBQSxZQUdBMlAsVUFBQSxTQUFBN1EsR0FDQSxNQUFBc0csR0FBQXBGLE1BQUFsQixHQUFBa0IsTUFBQSxjQUlBNlAsVUFBQSxTQUFBL1EsR0FDQSxNQUFBc0csR0FBQXBGLE1BQUFsQixHQUFBa0IsTUFBQSxjQUdBNkQsV0FBQSxTQUFBL0UsR0FDQSxNQUFBc0csR0FBQXBGLE1BQUFsQixJQUdBZ0gsSUFBQWhELEVBR0EsT0FBQXJFLE1DbEhBL0UsUUFBQUMsT0FBQSxPQUNBMkssUUFBQSxvQkFBQSxXQVdBLE9BRUFnVyxlQUFBLFdBRUEsR0FBQUMsR0FBQSxtRUFHQUMsRUFBQSxFQU1BQyxLQUdBQyxHQUFBLEdBQUFDLE9BQUFDLFVBQ0FDLEVBQUFILElBQUFGLENBQ0FBLEdBQUFFLENBR0EsS0FBQSxHQURBSSxHQUFBLEdBQUF2aUIsT0FBQSxHQUNBNFcsRUFBQSxFQUFBQSxHQUFBLEVBQUFBLElBQ0EyTCxFQUFBM0wsR0FBQW9MLEVBQUFRLE9BQUFMLEVBQUEsSUFFQUEsRUFBQU0sS0FBQUMsTUFBQVAsRUFBQSxHQUVBLElBQUEsSUFBQUEsRUFBQSxLQUFBLElBQUFRLE9BQUEsaURBRUEsSUFBQTlHLEdBQUEwRyxFQUFBSyxLQUFBLEdBRUEsSUFBQU4sRUFJQSxDQUVBLElBQUExTCxFQUFBLEdBQUFBLEdBQUEsR0FBQSxLQUFBc0wsRUFBQXRMLEdBQUFBLElBQ0FzTCxFQUFBdEwsR0FBQSxDQUVBc0wsR0FBQXRMLFNBUkEsS0FBQUEsRUFBQSxFQUFBLEdBQUFBLEVBQUFBLElBQ0FzTCxFQUFBdEwsR0FBQTZMLEtBQUFDLE1BQUEsR0FBQUQsS0FBQUksU0FTQSxLQUFBak0sRUFBQSxFQUFBLEdBQUFBLEVBQUFBLElBQ0FpRixHQUFBbUcsRUFBQVEsT0FBQU4sRUFBQXRMLEdBRUEsSUFBQSxJQUFBaUYsRUFBQTFNLE9BQUEsS0FBQSxJQUFBd1QsT0FBQSx1QkFFQSxPQUFBOUciLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogTWFpbiBtb2R1bGUgb2YgdGhlIGFwcGxpY2F0aW9uLlxuICovXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ0FwcCcsIFtcbiAgICAnZmlyZWJhc2UnLFxuICAgICdhbmd1bGFyLW1kNScsIC8vIEVuY3J5cHQgZW1haWxcbiAgICAnbmdSb3V0ZScsXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ25nTWF0ZXJpYWwnLCAvLyBJbnRlcmZhY2VcbiAgICAnYW5ndWxhck1vbWVudCcsIC8vIFRpbWUgbWFuYWdlbWVudFxuICAgICdmbG93JywgLy8gSW1hZ2UgdXBsb2FkXG4gICAgJ3NsdWdpZmllcicsIC8vIENyZWF0ZSBTbHVnc1xuICAgICduZ0F1dG9jb21wbGV0ZScsIC8vIEdvb2dsZSBwbGFjZXNcbiAgICAnbmdUYWdzSW5wdXQnLCAvLyBUYWdzXG4gICAgJ2NnTm90aWZ5JywgLy8gTm90aWZpY2F0aW9uIC0gaHR0cHM6Ly9naXRodWIuY29tL2Nncm9zcy9hbmd1bGFyLW5vdGlmeVxuICAgICdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJywgLy8gVHJhbnNsYXRpb24gLSBodHRwczovL2FuZ3VsYXItdHJhbnNsYXRlLmdpdGh1Yi5pby9cbiAgICAnZmFjZWJvb2snLCAgICAgICAvLyAgRmFjZWJvb2sgLSBodHRwczovL2dpdGh1Yi5jb20vQ2l1bC9hbmd1bGFyLWZhY2Vib29rXG4gICAgJ2FuZ3VsYXItZmxleHNsaWRlcicsIC8vIEltYWdlIHNsaWRlciAtIGh0dHBzOi8vZ2l0aHViLmNvbS90aGVuaWtzby9hbmd1bGFyLWZsZXhzbGlkZXJcblxuICAgIC8vIEVtb3RpY29uIC0tIGh0dHA6Ly9taXN0aWMxMDAuZ2l0aHViLmlvL2FuZ3VsYXItc21pbGllcy9cbiAgICAnbmdTYW5pdGl6ZScsXG4gICAgJ3VpLmJvb3RzdHJhcCcsICAgLy8gIE9SIG1nY3JlYS5uZ1N0cmFwXG4gICAgJ2FuZ3VsYXItc21pbGllcycsXG5cbiAgICAnbmdDb29raWVzJywgICAgICAvLyAgY29va2llcyBzdHVmZlxuICAgICdub3RpZmljYXRpb24nLCAgIC8vICB3ZWIgbm90aWZpY2F0aW9uIC0gaHR0cHM6Ly9naXRodWIuY29tL25lb3ppcm8vYW5ndWxhci1ub3RpZmljYXRpb25cblxuICBdKVxuXG4gIC5jb25maWcoZnVuY3Rpb24gKCRtZFRoZW1pbmdQcm92aWRlcikge1xuICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdzbGFjaycsIHtcbiAgICAgICc1MCc6ICdmZmViZWUnLFxuICAgICAgJzEwMCc6ICdmZmNkZDInLFxuICAgICAgJzIwMCc6ICdlZjlhOWEnLFxuICAgICAgJzMwMCc6ICdlNTczNzMnLFxuICAgICAgJzQwMCc6ICdlZjUzNTAnLFxuICAgICAgJzUwMCc6ICc0RDM5NEInLCAvLyBwcmltYXJ5IGNvbG91clxuICAgICAgJzYwMCc6ICdlNTM5MzUnLFxuICAgICAgJzcwMCc6ICdkMzJmMmYnLFxuICAgICAgJzgwMCc6ICdjNjI4MjgnLFxuICAgICAgJzkwMCc6ICdiNzFjMWMnLFxuICAgICAgJ0ExMDAnOiAnZmY4YTgwJyxcbiAgICAgICdBMjAwJzogJ2ZmNTI1MicsXG4gICAgICAnQTQwMCc6ICdmZjE3NDQnLFxuICAgICAgJ0E3MDAnOiAnZDUwMDAwJyxcbiAgICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsIC8vIHdoZXRoZXIsIGJ5IGRlZmF1bHQsIHRleHQgKGNvbnRyYXN0KVxuICAgICAgLy8gb24gdGhpcyBwYWxldHRlIHNob3VsZCBiZSBkYXJrIG9yIGxpZ2h0XG4gICAgICAnY29udHJhc3REYXJrQ29sb3JzJzogWyc1MCcsICcxMDAnLCAvLyBodWVzIHdoaWNoIGNvbnRyYXN0IHNob3VsZCBiZSAnZGFyaycgYnkgZGVmYXVsdFxuICAgICAgICAnMjAwJywgJzMwMCcsICc0MDAnLCAnQTEwMCddLFxuICAgICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiB1bmRlZmluZWQgLy8gY291bGQgYWxzbyBzcGVjaWZ5IHRoaXMgaWYgZGVmYXVsdCB3YXMgJ2RhcmsnXG4gICAgfSlcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgLnByaW1hcnlQYWxldHRlKCdzbGFjaycpXG4gIH0pXG5cbiAgLy8gRmFjZWJvb2sgQ29uZmlnXG4gIC5jb25maWcoXG4gICAgZnVuY3Rpb24gKEZhY2Vib29rUHJvdmlkZXIpIHtcbiAgICAgIHZhciBteUFwcElkID0gJzkzMTM3NjEyMDI2Mzg1NidcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuc2V0QXBwSWQobXlBcHBJZClcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuaW5pdChteUFwcElkKVxuICAgIH1cbiAgKVxuXG4gIC8vU2VjdXJpdHkgZm9yIFRyYW5zbGF0ZVxuICAuY29uZmlnKGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIucHJlZmVycmVkTGFuZ3VhZ2UoJ0VuZycpO1xuICAgIC8vIEVuYWJsZSBlc2NhcGluZyBvZiBIVE1MXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSgnZXNjYXBlJyk7XG4gIH0pXG5cblxuXG4gIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsJGNvbnRyb2xsZXJQcm92aWRlcikge1xuXG4gICAgYXBwLnJlZ2lzdGVyQ3RybCA9ICRjb250cm9sbGVyUHJvdmlkZXIucmVnaXN0ZXI7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgIGRhc2hib2FyZEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHJlcXVpcmVOb0F1dGg6IGZ1bmN0aW9uICgkc3RhdGUsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJylcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdsb2dpbi1mb3JtQGhvbWUnOiB7XG4gICAgICAgICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2xvZ2luLWZvcm0uaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vVHJlbmRpbmdcbiAgICAgIC5zdGF0ZSgndHJlbmRpbmcnLCB7XG4gICAgICAgIHVybDogJy9leHBsb3JlL3RyZW5kaW5nJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgIGRhc2hib2FyZEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL3RyZW5kLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBmZWVkOiBmdW5jdGlvbiAoVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5sYXRlc3RGZWVkKClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gQ2F0ZWdvcnkgTGFuZGluZ1xuICAgICAgLnN0YXRlKCdjYXRlZ29yeScsIHtcbiAgICAgICAgdXJsOiAnL2NhdGVnb3J5L3tTbHVnfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIC8vY29udHJvbGxlcjogJ0NhdGVDdHJsIGFzIGNhdGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY2F0ZWdvcnkvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgQ2F0ZWdvcnkgZGV0YWlsc1xuICAgICAgICAgICAgICBjYXRlTmFtZTogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgQ2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2F0ZWdvcnkuZ2V0TmFtZSgkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgbGlzdCBvZiBjYXRlZ29yeSB0b3BpY3MgaGVyZVxuICAgICAgICAgICAgICBjYXRlVG9waWNzOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxpc3QoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFBsYWNlcyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncGxhY2VzJywge1xuICAgICAgICB1cmw6ICcvcGxhY2VzL3twbGFjZV9zbHVnfS97cGxhY2VfaWR9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHBsYWNlcyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFjZXNDdHJsIGFzIHBsYWNlc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwbGFjZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcGxhY2VMYW5kaW5nOiBmdW5jdGlvbiAoUGxhY2VzLCBUb3BpY3MsICRzdGF0ZVBhcmFtcywgJGZpcmViYXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVxuICAgICAgICAgICAgICAgIFBsYWNlcy5nZXRQbGFjZVJlZigkc3RhdGVQYXJhbXMucGxhY2VfaWQpLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgZGF0YSA9IHNuYXBzaG90LnZhbCgpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzbmFwc2hvdC52YWwoKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgIC8vIHJldHVybiAgJGZpcmViYXNlQXJyYXkoUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gVGFnIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0YWcnLCB7XG4gICAgICAgIHVybDogJy90YWcve1RhZ30nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdoZWFkZXJAdGFnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RhZ0N0cmwgYXMgdGFnQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RhZy9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdGFnTmFtZTogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc3RhdGVQYXJhbXMuVGFnXG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgdGFnTGFuZGluZzogZnVuY3Rpb24gKFRvcGljcywgJHN0YXRlUGFyYW1zLCBUYWdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhZyA9ICRzdGF0ZVBhcmFtcy5UYWdcbiAgICAgICAgICAgICAgICAvLyB2YXIgZmIgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpXG4gICAgICAgICAgICAgICAgLy8gdmFyIGRhdGFSZXQgPSAnJ1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBzaG93KFRhZ3MudG9waWNUYWdzKHRhZykpXG4gICAgICAgICAgICAgICAgLypyZXR1cm4gZmIuY2hpbGQoJ3RhZ3MvJyArIHRhZylcbiAgICAgICAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIGZ1bmN0aW9uICh0YWdTbmFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yZGVyQnlDaGlsZChcInRhZ3NcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcXVhbFRvKHRhZylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbigndmFsdWUnLCBmdW5jdGlvbiAodG9waWNTbmFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvISpkYXRhUmV0ID0gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRmaXJlYmFzZUFycmF5KGRhdGFSZXQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVJldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgKiEvXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KSovXG4gICAgICAgICAgICAgICAgLy8gdmFyIHRhZ09iaiA9IFRhZ3MuZ2V0VGFnT2JqZWN0KHRhZylcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gdGFnT2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgIHJldHVybiBUb3BpY3MudG9waWNzQnlUYWcodGFnKS5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGV4dGVuZCh7fSwgdGFnT2JqLiR2YWx1ZSwgc25hcC52YWwoKSkpXG4gICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiBleHRlbmQoe30sIHRhZ09iai4kdmFsdWUsIHNuYXAudmFsKCkpXG4gICAgICAgICAgICAgICAgLy8gICB9KVxuICAgICAgICAgICAgICAgIC8vIH0pXG5cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZiLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZhciBkYXRhID0gc25hcHNob3QudmFsKClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbihkYXRhU25hcCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBpbmRleCA9IHdvcmQuaW5kZXhPZignICcpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGZpcnN0ID0gZGF0YVNuYXAuTmFtZS5zdWJzdHJpbmcoMCwgaW5kZXgpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGxhc3QgPSB3b3JkLnN1YnN0cmluZyhpbmRleCArIDEpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGNhbmRpZGF0ZSA9IGRhdGFTbmFwLk5hbWVcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAoY2FuZGlkYXRlLmluZGV4T2YoZmlyc3QpID49IDAgJiYgY2FuZGlkYXRlLmluZGV4T2YobGFzdCkgPj0gMClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YVNuYXAuQ0lEKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHJlamVjdCgnU29tZSBzb3J0IG9mIGZhaWx1cmUnKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAvLyAgICAgfSlcbiAgICAgICAgICAgICAgICAvLyB9KVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy50b3BpY3NCeVRhZyh0YWcpXG4gICAgICAgICAgICAgIC8vIC5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXApe1xuICAgICAgICAgICAgICAvLyB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRvcGljIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0b3BpYycsIHtcbiAgICAgICAgdXJsOiAnL3tTbHVnfScsXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAvKlNsdWc6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsJHN0YXRlLEF1dGgpIHtcbiAgICAgICAgICAgICRzdGF0ZVBhcmFtcy5TbHVnID0gZGVjb2RlVVJJQ29tcG9uZW50KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgaWYoJHN0YXRlUGFyYW1zLlNsdWcgPT0gJycpe1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0qL1xuICAgICAgICB9LFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVG9waWNMYW5kaW5nQ3RybCBhcyB0b3BpY0xhbmRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndG9waWNzL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoQXV0aCwgVXNlcnMsICRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljVWlkID0gJydcbiAgICAgICAgICAgICAgICAvLyBJZiB1c2VyIGxvZ2luLCBjaGVjayBpZiB0aGV5IGFyZSB0aGUgdG9waWMgb3duZXJcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdG9waWNVaWQgPSBkYXRhWzBdLnVpZFxuICAgICAgICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkudWlkID09IHRvcGljVWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdG9waWNMYW5kaW5nOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJlcGx5TGlzdDogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzLCAkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXkgPSAnJ1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygndG9waWMtbm90Zm91bmQnKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5yZXBseUxpc3QodG9waWNLZXkpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdmlld0RhdGE6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXksIHZpZXdzXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmogPSB7J3VzZXJJUCc6ICcnLCAnY3JlYXRlZCc6IHRpbWV9XG4gICAgICAgICAgICAgICAgVXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmoudXNlcklQID0gZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iai51c2VySVAgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0VG9waWNCeVNsdWcoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgICAgdmlld3MgPSBUb3BpY3MuZ2V0Vmlld3ModG9waWNLZXkpXG5cbiAgICAgICAgICAgICAgICAgICAgdmlld3Mub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY291bnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuY291bnQgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gYXV0aC51aWRcbiAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnB1c2goKS5zZXQoaGlzdG9yeU9iailcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgndmlld3MnKS5jaGlsZCh0b3BpY0tleSkucHVzaCgpLnNldChoaXN0b3J5T2JqKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdzLm9ialxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZvbGxvd2VyczogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5nZXRUb3BpY0J5U2x1Zygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldEZvbGxvd2Vycyh0b3BpY0tleSkub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFRvcGljIG5vdCBmb3VuZFxuICAgICAgLnN0YXRlKCd0b3BpYy1ub3Rmb3VuZCcsIHtcbiAgICAgICAgdXJsOiAnL2Vyci9ub3Rmb3VuZCdcbiAgICAgIH0pXG5cbiAgICAgIC8vIFByb2ZpbGUgbGFuZGluZyBwYWdlXG4gICAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICAgIHVybDogJy9wcm9maWxlL3tOYW1lfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uIChBdXRoLCBVc2VycywgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKEF1dGgucmVmLmdldEF1dGgoKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVswXS4kaWQgPT0gQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoVXNlcnMsIFRvcGljcywgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGVbMF0uJGlkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmNyZWF0ZWRCeShwcm9maWxlWzBdLiRpZClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQHByb2ZpbGUnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gUHJvZmlsZSBsYW5kaW5nIHBhZ2VcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdhY2Njb3VudEVkaXQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdwYXNzd29yZEVkaXRAYWNjY291bnRFZGl0Jzoge1xuICAgICAgICAgICAgdXJsOiAnL2FjY291bnQvY2hhbmdlUGFzc3dvcmQnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3Bhc3N3ZC5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3VzZXJFZGl0QGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQtZm9ybScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvZWRpdC1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uICgkc3RhdGUsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50UGFzc3dvcmQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3Bhc3N3ZC5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50VXNlckVkaXQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQtZm9ybScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0LWZvcm0uaHRtbCdcbiAgICAgIH0pXG5cbiAgICAgIC8vIERhc2hib2FyZFxuICAgICAgLy8gQHByb2ZpbGVDdHJsXG4gICAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZGFzaGJvYXJkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGFzaGJvYXJkL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uICgkc3RhdGUsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgbm8gc3RhdCBvYmplY3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9maWxlLnN0YXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvY29tbWVudC9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBubyBkaXNwbGF5bmFtZSAtIGdvIHRvIGdldF9zdGFydGVkXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2dldF9zdGFydGVkJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3JcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIG5lc3RlZCBsaXN0IHdpdGggY3VzdG9tIGNvbnRyb2xsZXJcbiAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkLmxpc3QnLCB7XG4gICAgICAgIHVybDogJy9mZWVkL3tTbHVnfScsXG4gICAgICAgIC8vdGVtcGxhdGVVcmw6ICcvZmVlZHMvZmVlZC5odG1sJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0NhdGVDdHJsIGFzIGNhdGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY2F0ZWdvcnkvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgQ2F0ZWdvcnkgZGV0YWlsc1xuICAgICAgICAgICAgICBjYXRlTmFtZTogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgQ2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2F0ZWdvcnkuZ2V0TmFtZSgkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgbGlzdCBvZiBjYXRlZ29yeSB0b3BpY3MgaGVyZVxuICAgICAgICAgICAgICBjYXRlVG9waWNzOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxpc3QoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBGb2xsbG93IENhdGVnb3J5XG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZm9sbG93X2NhdGVzJywge1xuICAgICAgICB1cmw6ICcvdXNlci9mb2xsb3ctY2F0ZWdvcmllcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvZm9sbG93LWNhdGVnb3JpZXMuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHVzZXJQb3N0czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogZnVuY3Rpb24gKFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgYXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gR2V0dGluZyBzdGFydGVkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZ2V0X3N0YXJ0ZWQnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2dldF9zdGFydGVkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9nZXRfc3RhcnRlZC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGdldF9zdGFydGVkJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvdXNlci9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9sb2dpbi5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2xvZ2luLWZvcm1AbG9naW4nOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2xvZ2luLWZvcm0uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJy91c2VyL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgQXV0aCkge1xuICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKVxuICB9KVxuXG4gIC5maWx0ZXIoJ29yZGVyT2JqZWN0QnknLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpdGVtcywgZmllbGQsIHJldmVyc2UpIHtcbiAgICAgIHZhciBmaWx0ZXJlZCA9IFtdXG4gICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGZpbHRlcmVkLnB1c2goaXRlbS4kaWQpLnNldChpdGVtKVxuICAgICAgfSlcbiAgICAgIGZpbHRlcmVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIChhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xKVxuICAgICAgfSlcbiAgICAgIGlmIChyZXZlcnNlKSBmaWx0ZXJlZC5yZXZlcnNlKClcbiAgICAgIHJldHVybiBmaWx0ZXJlZFxuICAgIH1cbiAgfSlcblxuICAuZmlsdGVyKCdkZWNvZGVVUkknLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dCA/IGRlY29kZVVSSSh0ZXh0KSA6ICcnXG4gICAgfVxuICB9KVxuXG4gIC8vIEZvcm1hdHRpbmcgdGV4dHMgdG8gaW5jbHVkZSBuZXcgbGluZVxuICAuZmlsdGVyKCdubDJicicsIGZ1bmN0aW9uICgkc2NlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dCA/ICRzY2UudHJ1c3RBc0h0bWwodGV4dC5yZXBsYWNlKC9cXG4vZywgJzxici8+JykpIDogJydcbiAgICB9XG4gIH0pXG5cbiAgLmNvbnN0YW50KCdGaXJlYmFzZVVybCcsICdodHRwczovL2JteHl6LmZpcmViYXNlaW8uY29tLycpXG5cbmZ1bmN0aW9uIHNob3cgKGRhdGEpIHtcbiAgY29uc29sZS5sb2coZGF0YSlcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpXG59XG5cbi8vIGZvciBqb2luaW5nIC0gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va2F0b3d1bGYvNjU5ODIzOFxuZnVuY3Rpb24gZXh0ZW5kIChiYXNlKSB7XG4gIHZhciBwYXJ0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcbiAgcGFydHMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgIGlmIChwICYmIHR5cGVvZiAocCkgPT09ICdvYmplY3QnKSB7XG4gICAgICBmb3IgKHZhciBrIGluIHApIHtcbiAgICAgICAgaWYgKHAuaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICBiYXNlW2tdID0gcFtrXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICByZXR1cm4gYmFzZVxufVxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdUb3BpY0N0cmwnLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaHR0cCxGaXJlYmFzZVVybCwkdHJhbnNsYXRlLCRub3RpZmljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOb3RpU2VydmljZSxUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2x1ZyxQbGFjZXMsIExhbmd1YWdlcyxBcmNoaXZlKXtcblxuICAgIGNvbnNvbGUubG9nKFwidG9waWNDdHJsXCIpO1xuXG4gICAgdmFyIHRvcGljQ3RybCA9IHRoaXM7XG5cblxuICAgIC8vUGFyc2VyIGhlcmVcbiAgICB0b3BpY0N0cmwudGFncyAgICAgID0gVGFncztcbiAgICB0b3BpY0N0cmwudG9waWNzICAgID0gVG9waWNzO1xuICAgIHRvcGljQ3RybC5hdXRoICAgICAgPSBBdXRoO1xuICAgIHRvcGljQ3RybC51c2VycyAgICAgPSBVc2VycztcbiAgICB0b3BpY0N0cmwubGFuZ3VhZ2VzID0gTGFuZ3VhZ2VzO1xuICAgIHRvcGljQ3RybC5wbGFjZXMgICAgPSBQbGFjZXM7XG4gICAgdG9waWNDdHJsLmFyY2hpdmUgICA9IEFyY2hpdmU7XG4gICAgdG9waWNDdHJsLm5vdGkgICAgICA9IE5vdGlTZXJ2aWNlO1xuXG4gICAgaWYodG9waWNDdHJsLmF1dGgucmVmLmdldEF1dGgoKSAhPSBudWxsICl7XG4gICAgICB0b3BpY0N0cmwucHJvZmlsZSAgPSB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpY0N0cmwuYXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudWlkID0gdG9waWNDdHJsLnByb2ZpbGUuJGlkO1xuICAgICAgdG9waWNDdHJsLnVzZXJSZWYgPSB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyVXB2b3RlZFRvcGljcyA9IHRvcGljQ3RybC51c2Vycy51cHZvdGVzKHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJEb3dudm90ZWRUb3BpY3MgPSB0b3BpY0N0cmwudXNlcnMuZG93bnZvdGVzKHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJGb2xsb3dpbmcgPSB0b3BpY0N0cmwudXNlcnMuZm9sbG93aW5nKHRvcGljQ3RybC51aWQpO1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgdG9waWNDdHJsLnByb2ZpbGUgPScnO1xuICAgICAgdG9waWNDdHJsLnVpZCA9ICcnO1xuICAgICAgdG9waWNDdHJsLnVzZXJSZWYgPSAnJztcbiAgICB9XG5cblxuXG4gICAgLy9QcmVzZXQgUGFyYW1ldGVyc1xuICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MgID0gW107XG4gICAgdG9waWNDdHJsLmltYWdlVGV4dCAgICAgPSBbXTtcbiAgICB0b3BpY0N0cmwuaW5SZXBseUFyciAgICA9IFtdO1xuICAgIHRvcGljQ3RybC5sb2FkQnVzeSAgICAgID0gZmFsc2U7XG4gICAgdG9waWNDdHJsLnNsdWdSZXR1cm4gICAgPSBudWxsO1xuICAgIHRvcGljQ3RybC5jcml0ZXJpYSAgICAgID0gZmFsc2U7XG4gICAgdG9waWNDdHJsLmNyaXRlcmlhUmVwbHkgPSBudWxsO1xuICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYT1mYWxzZTtcbiAgICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSA9IG51bGw7XG5cbiAgICAvL2lmIGFsbG93IG51bGwgaW4gdGhlIGZvcm1cbiAgICB0b3BpY0N0cmwubmV3VG9waWMgICAgICA9IHtcbiAgICAgICdsb2NhdGlvbic6ICcnLFxuICAgICAgJ3VybCcgOiAnJyxcbiAgICAgICdpcEluZm8nOiAnJyxcbiAgICAgICd0YWdzJzogJycsXG4gICAgICAnYm9keSc6ICcnXG4gICAgfVxuXG5cbiAgICAvL0NhbGMgYXZlcmFnZSByZXZpZXcgaW5wdXQgaW4gcmVwbHlcbiAgICB0b3BpY0N0cmwuYXZnUmV2aWV3UmVwbHkgPSBmdW5jdGlvbigpe1xuXG4gICAgICB2YXIgb2JqQ291bnQgPSBPYmplY3Qua2V5cyh0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSkubGVuZ3RoO1xuICAgICAgdmFyIGF2ZyA9IDBcbiAgICAgIGZvcih2YXIgaT0wO2k8b2JqQ291bnQ7aSsrKXtcbiAgICAgICAgYXZnID0gYXZnICsgdG9waWNDdHJsLmNyaXRlcmlhUmVwbHlbaV07XG4gICAgICB9XG5cbiAgICAgIHRvcGljQ3RybC5yZXBseVJldmlld0F2ZXJhZ2UgPSBhdmcvb2JqQ291bnQ7XG5cbiAgICAgIGNvbnNvbGUubG9nKHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5KTtcblxuICAgICAgdG9waWNDdHJsLmNyaXRSZXBseURhdGEgPSB7IGF2ZzogdG9waWNDdHJsLnJlcGx5UmV2aWV3QXZlcmFnZSwgZGF0YTogdG9waWNDdHJsLmNyaXRlcmlhUmVwbHl9XG4gICAgfVxuXG5cbiAgICAvL0dldCB0aGUgYXZlcmFnZSBzY29yZSBmcm9tIGNyaXRlcmlhIHZhbHVlc1xuICAgIHRvcGljQ3RybC5hdmdSZXZpZXdTY29yZSA9IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgaWYoZGF0YSlcbiAgICAgIHtcbiAgICAgIHZhciBhdmcgPTA7XG4gICAgICBmb3IodmFyIGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7XG4gICAgICAgIGF2ZyA9IGF2ZyArIGRhdGFbaV0ucmF0aW5nO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF2Zy9kYXRhLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vTGFiZWwgZm9yIHJlbW92ZSB0b3BpY3NcbiAgICAkdHJhbnNsYXRlKFsnS0VZX1JFTU9WRScsICdLRVlfQ0FOQ0VMJywnS0VZX0NPTkZfUkVNT1ZFJywnS0VZX0NPTkZfUkVNX0MnXSkudGhlbihmdW5jdGlvbiAodHJhbnNsYXRpb25zKSB7XG4gICAgICB0b3BpY0N0cmwucmVtb3ZlVHJhbnMgPSB0cmFuc2xhdGlvbnMuS0VZX1JFTU9WRTtcbiAgICAgIHRvcGljQ3RybC5jYW5jZWxUcmFucyA9IHRyYW5zbGF0aW9ucy5LRVlfQ0FOQ0VMO1xuICAgICAgdG9waWNDdHJsLmNvbmZpcm1SZW0gID0gdHJhbnNsYXRpb25zLktFWV9DT05GX1JFTU9WRTtcbiAgICAgIHRvcGljQ3RybC5jb25maXJtUmVtQ29udGVudCA9ICB0cmFuc2xhdGlvbnMuS0VZX0NPTkZfUkVNX0M7XG4gICAgfSk7XG5cblxuICAgIHRvcGljQ3RybC51c2VyTmFtZSA9IGZ1bmN0aW9uKHVzZXJJZCl7XG4gICAgICBpZih1c2VySWQhPSBudWxsKXtcbiAgICAgICAgLy9yZXR1cm4gdG9waWNDdHJsLnVzZXJzLmdldERpc3BsYXlOYW1lKHVzZXJJZCk7XG4gICAgICB9XG4gICAgfVxuXG5cblxuXG4gICAgLy9Mb2dpbiBmb3IgbWF0ZXJpYWxcbiAgICB0b3BpY0N0cmwuc2hvd01kTG9naW4gPSBmdW5jdGlvbihldikge1xuICAgICAgdmFyIHVzZUZ1bGxTY3JlZW4gPSAoJG1kTWVkaWEoJ3NtJykgfHwgJG1kTWVkaWEoJ3hzJykpICYmICRzY29wZS5jdXN0b21GdWxsc2NyZWVuO1xuICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgIC8vY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL21kLWxvZ2luLWZvcm0uaHRtbCcsXG4gICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgZnVsbHNjcmVlbjogdXNlRnVsbFNjcmVlblxuICAgICAgICB9KVxuICAgIH1cblxuXG5cbiAgICB0b3BpY0N0cmwuZGVjb2RlVGV4dCA9IGZ1bmN0aW9uKHRleHQpe1xuICAgICAgLy9yZXR1cm4gJGZpbHRlcignc2x1Z2lmeScpKGl0ZW0ubmFtZSk7XG4gICAgICBjb25zb2xlLmxvZyhkZWNvZGVVUkkodGV4dCkpO1xuICAgICAgcmV0dXJuIGRlY29kZVVSSSh0ZXh0KTtcbiAgICB9XG5cblxuICAgIHRvcGljQ3RybC5sb2FkTW9yZSA9IGZ1bmN0aW9uKGl0ZW1zKSB7XG4gICAgICB0b3BpY0N0cmwubG9hZEJ1c3kgPSB0cnVlO1xuICAgICAgdmFyIGRhdGEgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGF0YS5wdXNoKGl0ZW1zW2ldKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmxvYWRUYWdzID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRvcGljQ3RybC50YWdzLnRhZ3NVcmwoKSk7XG4gICAgfTtcblxuXG4gICAgLyp0b3BpY0N0cmwudXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mbyA9IGRhdGE7XG4gICAgfSk7Ki9cblxuXG4gICAgLy9VcGxvYWQgUHJvZmlsZSBpbWFnZVxuICAgIHRvcGljQ3RybC51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMsaW5kZXgpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpbmRleCkge1xuICAgICAgICB2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIHVyaSA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5nc1tpbmRleF0gPSB1cmk7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmbG93RmlsZS5maWxlKTtcbiAgICAgIH0pXG4gICAgfTtcblxuXG4gICAgLy9TaG93IGNvbmZpcm0gcmVtb3ZlIHRvcGljXG4gICAgdG9waWNDdHJsLnNob3dDb25maXJtUmVtb3ZlID0gZnVuY3Rpb24oZXYsdG9waWNfb3duZXIsb2JqKXtcbiAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgLnRpdGxlKHRvcGljQ3RybC5jb25maXJtUmVtKVxuICAgICAgICAudGV4dENvbnRlbnQodG9waWNDdHJsLmNvbmZpcm1SZW1Db250ZW50KVxuICAgICAgICAudGFyZ2V0RXZlbnQoZXYpXG4gICAgICAgIC5vayh0b3BpY0N0cmwucmVtb3ZlVHJhbnMpXG4gICAgICAgIC5jYW5jZWwodG9waWNDdHJsLmNhbmNlbFRyYW5zKTtcbiAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHRvcGljQ3RybC5yZW1vdmVUb3BpYyh0b3BpY19vd25lcixvYmopKXtcbiAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL1JlbW92ZSB0b3BpY1xuICAgIHRvcGljQ3RybC5yZW1vdmVUb3BpYyA9IGZ1bmN0aW9uKHRvcGljX293bmVyLG9iail7XG4gICAgICAvL3ZlcmlmeSBpZiB0aGUgdG9waWMgb3duZXIgYW5kIHRoZSBsb2dpbiBvd25lciBpcyB0aGUgc2FtZSBwcGxcbiAgICAgIGlmKHRvcGljX293bmVyID09IHRvcGljQ3RybC51aWQpe1xuICAgICAgICBtb3ZlRmJSZWNvcmQodG9waWNDdHJsLnRvcGljcy5yZWZDaGlsZChvYmouJGlkKSwgdG9waWNDdHJsLmFyY2hpdmUuYWRkQ2hpbGQob2JqLiRpZCkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vUmVwbHkgdG8gdG9waWNcbiAgICB0b3BpY0N0cmwucmVwbHkgPSBmdW5jdGlvbih0b3BpY09iail7XG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlBcnIodG9waWNPYmouJGlkKS4kYWRkKHtcbiAgICAgICAgdG9waWNJZDogIHRvcGljT2JqLiRpZCxcbiAgICAgICAgYm9keTogICAgIHRvcGljQ3RybC5uZXdSZXBseS5ib2R5LFxuICAgICAgICB1aWQ6ICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgcmV2aWV3OiAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhLFxuICAgICAgICBjcmVhdGVkOiAgbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgfSkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAvL05vdGlmeSB0b3BpYyBvd25lclxuICAgICAgICAvL3RvcGljT2JqIHJlZmVycyB0byB0aGUgcHJvcGVydHkgb2YgdGhpcyBvYmplY3RcbiAgICAgICAgdG9waWNDdHJsLm5vdGkudXBkYXRlTm90aWZpY2F0aW9uQ291bnQodG9waWNPYmouJGlkLHRvcGljT2JqLnVpZCx0b3BpY0N0cmwudWlkKTtcbiAgICAgIH0pXG5cblxuXG5cblxuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnQodG9waWNPYmouJGlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgaWYoIWRhdGEuY291bnQpe1xuICAgICAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudFJlZih0b3BpY09iai4kaWQpLnNldCgxKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50UmVmKHRvcGljT2JqLiRpZClcbiAgICAgICAgICAgIC5zZXQoZGF0YS5jb3VudCArMSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG5cbiAgICAgIC8vU3RhdCB1cGRhdGUgZm9yIHVzZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvY291bnQnKVxuICAgICAgICAuc2V0KHRvcGljQ3RybC5wcm9maWxlLnN0YXQuY29tbWVudC5jb3VudCArIDEpO1xuXG4gICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L3RvcGljcy8nK3RvcGljT2JqLiRpZClcbiAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgfVxuXG5cblxuICAgIC8vUmVwbHkgaW4gcmVwbHlcbiAgICB0b3BpY0N0cmwucmVwbHlJblJlcGx5ID0gZnVuY3Rpb24odG9waWNJZCxyZXBseUlkKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlJblJlcGx5QXJyKHRvcGljSWQscmVwbHlJZCkuJGFkZCh7XG4gICAgICAgIGJvZHk6ICAgICB0b3BpY0N0cmwucmVwbHlJblJlcGx5LmJvZHksXG4gICAgICAgIHVpZDogICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICBjcmVhdGVkOiAgbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgfSlcbiAgICB9XG5cblxuXG4gICAgdG9waWNDdHJsLmFkZE5ld0Nob2ljZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5ld0l0ZW1ObyA9IHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5sZW5ndGgrMTtcbiAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5wdXNoKHsnaWQnOidjcml0ZXJpYScrbmV3SXRlbU5vfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5yZW1vdmVDaG9pY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBsYXN0SXRlbSA9IHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5sZW5ndGgtMTtcbiAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5zcGxpY2UobGFzdEl0ZW0pO1xuICAgIH07XG5cblxuICAgIC8vQ3JlYXRlIG5ldyB0b3BpY1xuICAgIHRvcGljQ3RybC5jcmVhdGVUb3BpYyA9IGZ1bmN0aW9uKGNhdGVnb3J5LGlzRHJhZnQpe1xuXG4gICAgICAvL0NoZWNrIGlmIHdlIGhhdmUgbG9jYXRpb24gZGV0YWlsc1xuICAgICAgdmFyIGxvY2F0aW9uRGV0YWlsID0gJyc7XG5cbiAgICAgIGlmKHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbiAhPT0gJycgKXtcbiAgICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uKTtcbiAgICAgICAgbG9jYXRpb25EZXRhaWwgPSB7XG4gICAgICAgICAgcGxhY2VfaWQ6IHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLnBsYWNlX2lkLFxuICAgICAgICAgIHNsdWc6ICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMubmFtZSksXG4gICAgICAgICAgbmFtZTogICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLm5hbWUsXG4gICAgICAgICAgYWRkcmVzczogIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmZvcm1hdHRlZF9hZGRyZXNzLFxuICAgICAgICAgIGxhdDogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgIC8qIERFQlVHIEZPUk0gVkFMVUVcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgIHR5cGU6ICAgICAgICAgICB0b3BpY0N0cmwudHlwZSxcbiAgICAgICAgbGFuZzogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sYW5nLFxuICAgICAgICB0b3BpYzogICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRvcGljLFxuICAgICAgICBib2R5OiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmJvZHksXG4gICAgICAgIGNhdGVnb3J5OiAgICAgICBjYXRlZ29yeSxcbiAgICAgICAgdWlkOiAgICAgICAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIHNsdWc6ICAgICAgICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSxcbiAgICAgICAgcGhvdG9zOiAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MsXG4gICAgICAgIHBob3Rvc190ZXh0OiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0LFxuICAgICAgICBsb2NhdGlvbjogICAgICAgbG9jYXRpb25EZXRhaWwsXG4gICAgICAgIHVybDogICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudXJsLFxuICAgICAgICBkcmFmdDogICAgICAgICAgaXNEcmFmdCxcbiAgICAgICAgY3JlYXRlZDogICAgICAgIG1vbWVudCgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHRhZ3M6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudGFncyxcbiAgICAgICAgdXNlcklQOiAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuaXBJbmZvXG4gICAgICB9O1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAqL1xuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLmFyci4kYWRkKHtcbiAgICAgICAgICB0eXBlOiAgICAgICAgICAgdG9waWNDdHJsLnR5cGUsXG4gICAgICAgICAgbGFuZzogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sYW5nLFxuICAgICAgICAgIHRvcGljOiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgICAgYm9keTogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5ib2R5LFxuICAgICAgICAgIGNhdGVnb3J5OiAgICAgICBjYXRlZ29yeSxcbiAgICAgICAgICB1aWQ6ICAgICAgICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgICAvL3NsdWc6ICAgICAgICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSxcbiAgICAgICAgICBzbHVnOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRvcGljLFxuICAgICAgICAgIHBob3RvczogICAgICAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzLFxuICAgICAgICAgIHBob3Rvc190ZXh0OiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0LFxuICAgICAgICAgIGxvY2F0aW9uOiAgICAgICBsb2NhdGlvbkRldGFpbCxcbiAgICAgICAgICB1cmw6ICAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnVybCxcbiAgICAgICAgICBkcmFmdDogICAgICAgICAgaXNEcmFmdCxcbiAgICAgICAgICBjcmVhdGVkOiAgICAgICAgbW9tZW50KCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB0YWdzOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRhZ3MsXG4gICAgICAgICAgdXNlcklQOiAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm8sXG4gICAgICAgICAgcmV2aWV3OiAgICAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYSxcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbih0b3BpYyl7XG5cbiAgICAgICAgICB2YXIgc2x1Z1RleHQgPScnO1xuICAgICAgICAgIC8vaWYgd2UgYXJlIHVuYWJsZSB0byBjb252ZXJ0IHRvIHNsdWcgdGhlbiB3ZSB1c2UgdGhlIHRvcGljIHRleHQsIGVsc2UgdXNlIHNsdWdcbiAgICAgICAgICBpZihTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSA9PScnKXtcbiAgICAgICAgICAgIHNsdWdUZXh0ID0gdG9waWNDdHJsLm5ld1RvcGljLnRvcGljO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgc2x1Z1RleHQgPSBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL1VwZGF0ZSBzbHVnIHdpdGggdG9waWMgS2V5XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5nZXRUb3BpY0J5S2V5KHRvcGljLmtleSgpKS51cGRhdGUoe1wic2x1Z1wiOnNsdWdUZXh0K3RvcGljLmtleSgpfSk7XG5cbiAgICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL2NvdW50JylcbiAgICAgICAgICAgIC5zZXQodG9waWNDdHJsLnByb2ZpbGUuc3RhdC5wb3N0ZWQuY291bnQgKyAxKTtcblxuICAgICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L3Bvc3RlZC90b3BpY3MvJyt0b3BpYy5rZXkoKSlcbiAgICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuXG4gICAgICAgICAgLy9JZiB0aGVyZSBpcyBsb2NhdGlvblxuICAgICAgICAgIGlmKGxvY2F0aW9uRGV0YWlsICE9PSAnJyl7XG5cbiAgICAgICAgICAgIHRvcGljQ3RybC5wbGFjZXMuYWRkQ2hpbGQobG9jYXRpb25EZXRhaWwucGxhY2VfaWQpXG4gICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKHRvcGljLmtleSgpKVxuICAgICAgICAgICAgICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuXG4gICAgICAgICAgICB0b3BpY0N0cmwucGxhY2VzLmFkZENoaWxkKGxvY2F0aW9uRGV0YWlsLnBsYWNlX2lkKVxuICAgICAgICAgICAgICAuY2hpbGQoJ2luZm8nKS5zZXQobG9jYXRpb25EZXRhaWwpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vaWYgdGhlcmUgYXJlIHRhZ3NcbiAgICAgICAgICBpZih0b3BpY0N0cmwubmV3VG9waWMudGFncyAhPT0gbnVsbCl7XG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdG9waWNDdHJsLm5ld1RvcGljLnRhZ3MubGVuZ3RoOyArK2luZGV4KSB7XG4gICAgICAgICAgICAgIHRvcGljQ3RybC50YWdzLmFkZENoaWxkKHRvcGljQ3RybC5uZXdUb3BpYy50YWdzW2luZGV4XS50ZXh0KVxuICAgICAgICAgICAgICAgIC5jaGlsZCh0b3BpYy5rZXkoKSkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL05vdGlmeSBmb2xsb3dlclxuICAgICAgICAgIHRvcGljQ3RybC5ub3RpLm5vdGlmeUZvbGxvd2VyKHRvcGljLmtleSgpLHRvcGljQ3RybC51aWQpO1xuXG5cbiAgICAgICAgICAvL1Jlc2V0IGZvcm0gaGVyZVxuICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYyA9IHtcbiAgICAgICAgICAgIGJvZHk6ICcnXG4gICAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vQ2hlY2sgaWYgdXNlciBpcyBhbHJlYWR5IGZvbGxvd2luZyB1c2VyXG4gICAgdG9waWNDdHJsLmNoZWNrRm9sbG93ID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG4gICAgICBpZih0b3BpY0N0cmwudXNlcnMuY2hlY2tGb2xsb3codG9waWNDdHJsLnVpZCxmb2xsb3dfdWlkKSl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vRm9sbG93IFVzZXJcbiAgICB0b3BpY0N0cmwuZm9sbG93VXNlciA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgYmVpbmcgZm9sbG93LCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2VyXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZShmb2xsb3dfdWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCArIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL3VpZC8nKyB0b3BpY0N0cmwudWlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBpcyBmb2xsb3dpbmcsIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93aW5nXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgKyAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvdWlkLycrIGZvbGxvd191aWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVW5mb2xsb3cgVXNlclxuICAgIHRvcGljQ3RybC51bmZvbGxvd1VzZXIgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGJlaW5nIGZvbGxvdywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUoZm9sbG93X3VpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci91aWQvJysgdG9waWNDdHJsLnVpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGlzIGZvbGxvd2luZywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dpbmdcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dpbmcuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvdWlkLycrIGZvbGxvd191aWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cbiAgICB9XG5cblxuXG4gICAgIC8vdXB2b3RlXG4gICAgdG9waWNDdHJsLnVwdm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcblxuICAgICAgaWYodG9waWMuZG93bnZvdGVzICE9IHVuZGVmaW5lZCAmJiB0b3BpYy5kb3dudm90ZXNbdG9waWNDdHJsLnVpZF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgdG9waWNDdHJsLmNhbmNlbERvd252b3RlKHRvcGljKTtcbiAgICAgIH1cbiAgICAgIHRvcGljQ3RybC50b3BpY3MudXB2b3RlVG9waWModG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyVXB2b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS4kdmFsdWUpO1xuXG4gICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWMudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQudXB2b3RlZC5jb3VudCArIDEpO1xuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvdG9waWNzLycrdG9waWMuJGlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICB9KTtcblxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5jYW5jZWxVcHZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZG9VcHZvdGUodG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcblxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWMudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC51cHZvdGVkLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL3RvcGljcy8nK3RvcGljLiRpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuXG4gICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gICAgLy9kb3dudm90ZVxuICAgIHRvcGljQ3RybC5kb3dudm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIGlmKHRvcGljLnVwdm90ZXMgIT0gdW5kZWZpbmVkICYmIHRvcGljLnVwdm90ZXNbdG9waWNDdHJsLnVpZF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgdG9waWNDdHJsLmNhbmNlbFVwdm90ZSh0b3BpYyk7XG4gICAgICB9XG4gICAgICB0b3BpY0N0cmwudG9waWNzLmRvd252b3RlVG9waWModG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLiR2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmNhbmNlbERvd252b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmRvRG93bnZvdGUodG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICAgIC8vZm9sbG93IHRvcGljXG4gICAgdG9waWNDdHJsLmZvbGxvd1RvcGljID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy5mb2xsb3codG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLmhpc3RvcnlbdG9waWNDdHJsLnVpZF0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC51bmZvbGxvd1RvcGljID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmZvbGxvdyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJGb2xsb3dpbmcuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gIH0pO1xuXG5cbi8vaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va2F0b3d1bGYvNjA5OTA0MlxuZnVuY3Rpb24gbW92ZUZiUmVjb3JkKG9sZFJlZiwgbmV3UmVmKSB7XG4gIG9sZFJlZi5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgbmV3UmVmLnNldChzbmFwLnZhbCgpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgb2xkUmVmLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodHlwZW9mKGNvbnNvbGUpICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNYWluIG1vZHVsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gKi9cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnQXBwJywgW1xuICAgICdmaXJlYmFzZScsXG4gICAgJ2FuZ3VsYXItbWQ1JywgLy8gRW5jcnlwdCBlbWFpbFxuICAgICduZ1JvdXRlJyxcbiAgICAndWkucm91dGVyJyxcbiAgICAnbmdNYXRlcmlhbCcsIC8vIEludGVyZmFjZVxuICAgICdhbmd1bGFyTW9tZW50JywgLy8gVGltZSBtYW5hZ2VtZW50XG4gICAgJ2Zsb3cnLCAvLyBJbWFnZSB1cGxvYWRcbiAgICAnc2x1Z2lmaWVyJywgLy8gQ3JlYXRlIFNsdWdzXG4gICAgJ25nQXV0b2NvbXBsZXRlJywgLy8gR29vZ2xlIHBsYWNlc1xuICAgICduZ1RhZ3NJbnB1dCcsIC8vIFRhZ3NcbiAgICAnY2dOb3RpZnknLCAvLyBOb3RpZmljYXRpb24gLSBodHRwczovL2dpdGh1Yi5jb20vY2dyb3NzL2FuZ3VsYXItbm90aWZ5XG4gICAgJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnLCAvLyBUcmFuc2xhdGlvbiAtIGh0dHBzOi8vYW5ndWxhci10cmFuc2xhdGUuZ2l0aHViLmlvL1xuICAgICdmYWNlYm9vaycsICAgICAgIC8vICBGYWNlYm9vayAtIGh0dHBzOi8vZ2l0aHViLmNvbS9DaXVsL2FuZ3VsYXItZmFjZWJvb2tcbiAgICAnYW5ndWxhci1mbGV4c2xpZGVyJywgLy8gSW1hZ2Ugc2xpZGVyIC0gaHR0cHM6Ly9naXRodWIuY29tL3RoZW5pa3NvL2FuZ3VsYXItZmxleHNsaWRlclxuXG4gICAgLy8gRW1vdGljb24gLS0gaHR0cDovL21pc3RpYzEwMC5naXRodWIuaW8vYW5ndWxhci1zbWlsaWVzL1xuICAgICduZ1Nhbml0aXplJyxcbiAgICAndWkuYm9vdHN0cmFwJywgICAvLyAgT1IgbWdjcmVhLm5nU3RyYXBcbiAgICAnYW5ndWxhci1zbWlsaWVzJyxcblxuICAgICduZ0Nvb2tpZXMnLCAgICAgIC8vICBjb29raWVzIHN0dWZmXG4gICAgJ25vdGlmaWNhdGlvbicsICAgLy8gIHdlYiBub3RpZmljYXRpb24gLSBodHRwczovL2dpdGh1Yi5jb20vbmVvemlyby9hbmd1bGFyLW5vdGlmaWNhdGlvblxuXG4gIF0pXG5cbiAgLmNvbmZpZyhbXCIkbWRUaGVtaW5nUHJvdmlkZXJcIiwgZnVuY3Rpb24gKCRtZFRoZW1pbmdQcm92aWRlcikge1xuICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdzbGFjaycsIHtcbiAgICAgICc1MCc6ICdmZmViZWUnLFxuICAgICAgJzEwMCc6ICdmZmNkZDInLFxuICAgICAgJzIwMCc6ICdlZjlhOWEnLFxuICAgICAgJzMwMCc6ICdlNTczNzMnLFxuICAgICAgJzQwMCc6ICdlZjUzNTAnLFxuICAgICAgJzUwMCc6ICc0RDM5NEInLCAvLyBwcmltYXJ5IGNvbG91clxuICAgICAgJzYwMCc6ICdlNTM5MzUnLFxuICAgICAgJzcwMCc6ICdkMzJmMmYnLFxuICAgICAgJzgwMCc6ICdjNjI4MjgnLFxuICAgICAgJzkwMCc6ICdiNzFjMWMnLFxuICAgICAgJ0ExMDAnOiAnZmY4YTgwJyxcbiAgICAgICdBMjAwJzogJ2ZmNTI1MicsXG4gICAgICAnQTQwMCc6ICdmZjE3NDQnLFxuICAgICAgJ0E3MDAnOiAnZDUwMDAwJyxcbiAgICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsIC8vIHdoZXRoZXIsIGJ5IGRlZmF1bHQsIHRleHQgKGNvbnRyYXN0KVxuICAgICAgLy8gb24gdGhpcyBwYWxldHRlIHNob3VsZCBiZSBkYXJrIG9yIGxpZ2h0XG4gICAgICAnY29udHJhc3REYXJrQ29sb3JzJzogWyc1MCcsICcxMDAnLCAvLyBodWVzIHdoaWNoIGNvbnRyYXN0IHNob3VsZCBiZSAnZGFyaycgYnkgZGVmYXVsdFxuICAgICAgICAnMjAwJywgJzMwMCcsICc0MDAnLCAnQTEwMCddLFxuICAgICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiB1bmRlZmluZWQgLy8gY291bGQgYWxzbyBzcGVjaWZ5IHRoaXMgaWYgZGVmYXVsdCB3YXMgJ2RhcmsnXG4gICAgfSlcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgLnByaW1hcnlQYWxldHRlKCdzbGFjaycpXG4gIH1dKVxuXG4gIC8vIEZhY2Vib29rIENvbmZpZ1xuICAuY29uZmlnKFxuICAgIFtcIkZhY2Vib29rUHJvdmlkZXJcIiwgZnVuY3Rpb24gKEZhY2Vib29rUHJvdmlkZXIpIHtcbiAgICAgIHZhciBteUFwcElkID0gJzkzMTM3NjEyMDI2Mzg1NidcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuc2V0QXBwSWQobXlBcHBJZClcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuaW5pdChteUFwcElkKVxuICAgIH1dXG4gIClcblxuICAvL1NlY3VyaXR5IGZvciBUcmFuc2xhdGVcbiAgLmNvbmZpZyhbXCIkdHJhbnNsYXRlUHJvdmlkZXJcIiwgZnVuY3Rpb24gKCR0cmFuc2xhdGVQcm92aWRlcikge1xuICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnRW5nJyk7XG4gICAgLy8gRW5hYmxlIGVzY2FwaW5nIG9mIEhUTUxcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIudXNlU2FuaXRpemVWYWx1ZVN0cmF0ZWd5KCdlc2NhcGUnKTtcbiAgfV0pXG5cblxuXG4gIC5jb25maWcoW1wiJHN0YXRlUHJvdmlkZXJcIiwgXCIkdXJsUm91dGVyUHJvdmlkZXJcIiwgXCIkY29udHJvbGxlclByb3ZpZGVyXCIsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCRjb250cm9sbGVyUHJvdmlkZXIpIHtcblxuICAgIGFwcC5yZWdpc3RlckN0cmwgPSAkY29udHJvbGxlclByb3ZpZGVyLnJlZ2lzdGVyO1xuXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgdXJsOiAnLycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzICBkYXNoYm9hcmRDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaG9tZS9ob21lLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICByZXF1aXJlTm9BdXRoOiBbXCIkc3RhdGVcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJylcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnbG9naW4tZm9ybUBob21lJzoge1xuICAgICAgICAgICAgLy9jb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9sb2dpbi1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuXG4gICAgICAvL1RyZW5kaW5nXG4gICAgICAuc3RhdGUoJ3RyZW5kaW5nJywge1xuICAgICAgICB1cmw6ICcvZXhwbG9yZS90cmVuZGluZycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzICBkYXNoYm9hcmRDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaG9tZS90cmVuZC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgZmVlZDogW1wiVG9waWNzXCIsIGZ1bmN0aW9uIChUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxhdGVzdEZlZWQoKVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gQ2F0ZWdvcnkgTGFuZGluZ1xuICAgICAgLnN0YXRlKCdjYXRlZ29yeScsIHtcbiAgICAgICAgdXJsOiAnL2NhdGVnb3J5L3tTbHVnfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIC8vY29udHJvbGxlcjogJ0NhdGVDdHJsIGFzIGNhdGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY2F0ZWdvcnkvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgQ2F0ZWdvcnkgZGV0YWlsc1xuICAgICAgICAgICAgICBjYXRlTmFtZTogW1wiJHN0YXRlUGFyYW1zXCIsIFwiQ2F0ZWdvcnlcIiwgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgQ2F0ZWdvcnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2F0ZWdvcnkuZ2V0TmFtZSgkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAvLyBHZXR0aW5nIGxpc3Qgb2YgY2F0ZWdvcnkgdG9waWNzIGhlcmVcbiAgICAgICAgICAgICAgY2F0ZVRvcGljczogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGlzdCgkc3RhdGVQYXJhbXMuU2x1ZylcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFBsYWNlcyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncGxhY2VzJywge1xuICAgICAgICB1cmw6ICcvcGxhY2VzL3twbGFjZV9zbHVnfS97cGxhY2VfaWR9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHBsYWNlcyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFjZXNDdHJsIGFzIHBsYWNlc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwbGFjZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcGxhY2VMYW5kaW5nOiBbXCJQbGFjZXNcIiwgXCJUb3BpY3NcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBmdW5jdGlvbiAoUGxhY2VzLCBUb3BpY3MsICRzdGF0ZVBhcmFtcywgJGZpcmViYXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVxuICAgICAgICAgICAgICAgIFBsYWNlcy5nZXRQbGFjZVJlZigkc3RhdGVQYXJhbXMucGxhY2VfaWQpLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgZGF0YSA9IHNuYXBzaG90LnZhbCgpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzbmFwc2hvdC52YWwoKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgIC8vIHJldHVybiAgJGZpcmViYXNlQXJyYXkoUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRhZyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgndGFnJywge1xuICAgICAgICB1cmw6ICcvdGFnL3tUYWd9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHRhZyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUYWdDdHJsIGFzIHRhZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0YWcvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHRhZ05hbWU6IFtcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzdGF0ZVBhcmFtcy5UYWdcbiAgICAgICAgICAgICAgfV0sXG5cbiAgICAgICAgICAgICAgdGFnTGFuZGluZzogW1wiVG9waWNzXCIsIFwiJHN0YXRlUGFyYW1zXCIsIFwiVGFnc1wiLCBmdW5jdGlvbiAoVG9waWNzLCAkc3RhdGVQYXJhbXMsIFRhZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFnID0gJHN0YXRlUGFyYW1zLlRhZ1xuICAgICAgICAgICAgICAgIC8vIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybClcbiAgICAgICAgICAgICAgICAvLyB2YXIgZGF0YVJldCA9ICcnXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHNob3coVGFncy50b3BpY1RhZ3ModGFnKSlcbiAgICAgICAgICAgICAgICAvKnJldHVybiBmYi5jaGlsZCgndGFncy8nICsgdGFnKVxuICAgICAgICAgICAgICAgICAgICAub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHRhZ1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmIuY2hpbGQoJ3RvcGljcycpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVxdWFsVG8odGFnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIGZ1bmN0aW9uICh0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNob3coIGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8hKmRhdGFSZXQgPSBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkoZGF0YVJldCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhUmV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAqIS9cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pKi9cbiAgICAgICAgICAgICAgICAvLyB2YXIgdGFnT2JqID0gVGFncy5nZXRUYWdPYmplY3QodGFnKVxuICAgICAgICAgICAgICAgIC8vIHJldHVybiB0YWdPYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vICAgcmV0dXJuIFRvcGljcy50b3BpY3NCeVRhZyh0YWcpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZXh0ZW5kKHt9LCB0YWdPYmouJHZhbHVlLCBzbmFwLnZhbCgpKSlcbiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIGV4dGVuZCh7fSwgdGFnT2JqLiR2YWx1ZSwgc25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICAgICAgLy8gfSlcblxuICAgICAgICAgICAgICAgIC8vIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgZmIub25jZSgndmFsdWUnLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIGRhdGEgPSBzbmFwc2hvdC52YWwoKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFTbmFwKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gd29yZC5pbmRleE9mKCcgJylcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZmlyc3QgPSBkYXRhU25hcC5OYW1lLnN1YnN0cmluZygwLCBpbmRleClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgbGFzdCA9IHdvcmQuc3Vic3RyaW5nKGluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgY2FuZGlkYXRlID0gZGF0YVNuYXAuTmFtZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChjYW5kaWRhdGUuaW5kZXhPZihmaXJzdCkgPj0gMCAmJiBjYW5kaWRhdGUuaW5kZXhPZihsYXN0KSA+PSAwKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhU25hcC5DSUQpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVqZWN0KCdTb21lIHNvcnQgb2YgZmFpbHVyZScpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC8vICAgICB9KVxuICAgICAgICAgICAgICAgIC8vIH0pXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLnRvcGljc0J5VGFnKHRhZylcbiAgICAgICAgICAgICAgLy8gLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcCl7XG4gICAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRvcGljIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0b3BpYycsIHtcbiAgICAgICAgdXJsOiAnL3tTbHVnfScsXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAvKlNsdWc6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsJHN0YXRlLEF1dGgpIHtcbiAgICAgICAgICAgICRzdGF0ZVBhcmFtcy5TbHVnID0gZGVjb2RlVVJJQ29tcG9uZW50KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgaWYoJHN0YXRlUGFyYW1zLlNsdWcgPT0gJycpe1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0qL1xuICAgICAgICB9LFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVG9waWNMYW5kaW5nQ3RybCBhcyB0b3BpY0xhbmRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndG9waWNzL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBpc093bmVyOiBbXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCJUb3BpY3NcIiwgZnVuY3Rpb24gKEF1dGgsIFVzZXJzLCAkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHZhciB0b3BpY1VpZCA9ICcnXG4gICAgICAgICAgICAgICAgLy8gSWYgdXNlciBsb2dpbiwgY2hlY2sgaWYgdGhleSBhcmUgdGhlIHRvcGljIG93bmVyXG4gICAgICAgICAgICAgICAgaWYgKEF1dGgucmVmLmdldEF1dGgoKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5mb3J0b3BpYygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbMF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgIHRvcGljVWlkID0gZGF0YVswXS51aWRcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCA9PSB0b3BpY1VpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICB0b3BpY0xhbmRpbmc6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCk7XG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICByZXBseUxpc3Q6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBcIiRzdGF0ZVwiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MsICRzdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSA9ICcnXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5mb3J0b3BpYygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9waWNLZXkgPSBkYXRhWzBdLiRpZFxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCd0b3BpYy1ub3Rmb3VuZCcpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLnJlcGx5TGlzdCh0b3BpY0tleSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgdmlld0RhdGE6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5LCB2aWV3c1xuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5T2JqID0geyd1c2VySVAnOiAnJywgJ2NyZWF0ZWQnOiB0aW1lfVxuICAgICAgICAgICAgICAgIFVzZXJzLmdldExvY2F0aW9uSVAoKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBoaXN0b3J5T2JqLnVzZXJJUCA9IGRhdGEuZGF0YVxuICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmoudXNlcklQID0gZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldFRvcGljQnlTbHVnKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbMF0uJGlkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzID0gVG9waWNzLmdldFZpZXdzKHRvcGljS2V5KVxuXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzLm9iai4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvdW50ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzLnJlZi5jaGlsZCgnY291bnQnKS5zZXQoMSlcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdjb3VudCcpLnNldChkYXRhLmNvdW50ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHVpZCA9IGF1dGgudWlkXG4gICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdoaXN0b3J5JykuY2hpbGQodWlkKS5wdXNoKCkuc2V0KGhpc3RvcnlPYmopXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3ZpZXdzJykuY2hpbGQodG9waWNLZXkpLnB1c2goKS5zZXQoaGlzdG9yeU9iailcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3cy5vYmpcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgZm9sbG93ZXJzOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCJUb3BpY3NcIiwgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5nZXRUb3BpY0J5U2x1Zygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldEZvbGxvd2Vycyh0b3BpY0tleSkub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBUb3BpYyBub3QgZm91bmRcbiAgICAgIC5zdGF0ZSgndG9waWMtbm90Zm91bmQnLCB7XG4gICAgICAgIHVybDogJy9lcnIvbm90Zm91bmQnXG4gICAgICB9KVxuXG4gICAgICAvLyBQcm9maWxlIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCdwcm9maWxlJywge1xuICAgICAgICB1cmw6ICcvcHJvZmlsZS97TmFtZX0nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBpc093bmVyOiBbXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCIkc3RhdGVQYXJhbXNcIiwgZnVuY3Rpb24gKEF1dGgsIFVzZXJzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlWzBdLiRpZCA9PSBBdXRoLnJlZi5nZXRBdXRoKCkudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBbXCJVc2Vyc1wiLCBcIlRvcGljc1wiLCBcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbiAoVXNlcnMsIFRvcGljcywgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGVbMF0uJGlkICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmNyZWF0ZWRCeShwcm9maWxlWzBdLiRpZClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogW1wiJHN0YXRlXCIsIFwiJHN0YXRlUGFyYW1zXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBwcm9maWxlJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFByb2ZpbGUgbGFuZGluZyBwYWdlXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnYWNjY291bnRFZGl0Jywge1xuICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAncGFzc3dvcmRFZGl0QGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9wYXNzd2QuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICd1c2VyRWRpdEBhY2Njb3VudEVkaXQnOiB7XG4gICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0LWZvcm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvZWRpdC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBbXCIkc3RhdGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIGZ1bmN0aW9uICgkc3RhdGUsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgYXV0aDogW1wiJHN0YXRlXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50UGFzc3dvcmQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3Bhc3N3ZC5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50VXNlckVkaXQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQtZm9ybScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0LWZvcm0uaHRtbCdcbiAgICAgIH0pXG5cbiAgICAgIC8vIERhc2hib2FyZFxuICAgICAgLy8gQHByb2ZpbGVDdHJsXG4gICAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZGFzaGJvYXJkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGFzaGJvYXJkL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIiRzdGF0ZVwiLCBcIiRyb290U2NvcGVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBubyBzdGF0IG9iamVjdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2ZpbGUuc3RhdCkge1xuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIGRpc3BsYXluYW1lIC0gZ28gdG8gZ2V0X3N0YXJ0ZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBhdXRoOiBbXCIkc3RhdGVcIiwgXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gbmVzdGVkIGxpc3Qgd2l0aCBjdXN0b20gY29udHJvbGxlclxuICAgICAgLnN0YXRlKCdkYXNoYm9hcmQubGlzdCcsIHtcbiAgICAgICAgdXJsOiAnL2ZlZWQve1NsdWd9JyxcbiAgICAgICAgLy90ZW1wbGF0ZVVybDogJy9mZWVkcy9mZWVkLmh0bWwnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2F0ZUN0cmwgYXMgY2F0ZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjYXRlZ29yeS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBDYXRlZ29yeSBkZXRhaWxzXG4gICAgICAgICAgICAgIGNhdGVOYW1lOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCJDYXRlZ29yeVwiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDYXRlZ29yeS5nZXROYW1lKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgbGlzdCBvZiBjYXRlZ29yeSB0b3BpY3MgaGVyZVxuICAgICAgICAgICAgICBjYXRlVG9waWNzOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCJUb3BpY3NcIiwgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5saXN0KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIEZvbGxsb3cgQ2F0ZWdvcnlcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdmb2xsb3dfY2F0ZXMnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2ZvbGxvdy1jYXRlZ29yaWVzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9mb2xsb3ctY2F0ZWdvcmllcy5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBbXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIGF1dGg6IFtcIiRzdGF0ZVwiLCBcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gR2V0dGluZyBzdGFydGVkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZ2V0X3N0YXJ0ZWQnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2dldF9zdGFydGVkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9nZXRfc3RhcnRlZC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBbXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIGF1dGg6IFtcIiRzdGF0ZVwiLCBcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBnZXRfc3RhcnRlZCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvbG9naW4nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvbG9naW4uaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdsb2dpbi1mb3JtQGxvZ2luJzoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9sb2dpbi1mb3JtLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvdXNlci9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9yZWdpc3Rlci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIHJlcXVpcmVOb0F1dGg6IFtcIiRzdGF0ZVwiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgQXV0aCkge1xuICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJylcbiAgfV0pXG5cbiAgLmZpbHRlcignb3JkZXJPYmplY3RCeScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGl0ZW1zLCBmaWVsZCwgcmV2ZXJzZSkge1xuICAgICAgdmFyIGZpbHRlcmVkID0gW11cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtLiRpZCkuc2V0KGl0ZW0pXG4gICAgICB9KVxuICAgICAgZmlsdGVyZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gKGFbZmllbGRdID4gYltmaWVsZF0gPyAxIDogLTEpXG4gICAgICB9KVxuICAgICAgaWYgKHJldmVyc2UpIGZpbHRlcmVkLnJldmVyc2UoKVxuICAgICAgcmV0dXJuIGZpbHRlcmVkXG4gICAgfVxuICB9KVxuXG4gIC5maWx0ZXIoJ2RlY29kZVVSSScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gZGVjb2RlVVJJKHRleHQpIDogJydcbiAgICB9XG4gIH0pXG5cbiAgLy8gRm9ybWF0dGluZyB0ZXh0cyB0byBpbmNsdWRlIG5ldyBsaW5lXG4gIC5maWx0ZXIoJ25sMmJyJywgW1wiJHNjZVwiLCBmdW5jdGlvbiAoJHNjZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgcmV0dXJuIHRleHQgPyAkc2NlLnRydXN0QXNIdG1sKHRleHQucmVwbGFjZSgvXFxuL2csICc8YnIvPicpKSA6ICcnXG4gICAgfVxuICB9XSlcblxuICAuY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vYm14eXouZmlyZWJhc2Vpby5jb20vJylcblxuZnVuY3Rpb24gc2hvdyAoZGF0YSkge1xuICBjb25zb2xlLmxvZyhkYXRhKVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMilcbn1cblxuLy8gZm9yIGpvaW5pbmcgLSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82NTk4MjM4XG5mdW5jdGlvbiBleHRlbmQgKGJhc2UpIHtcbiAgdmFyIHBhcnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKVxuICBwYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7XG4gICAgaWYgKHAgJiYgdHlwZW9mIChwKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAodmFyIGsgaW4gcCkge1xuICAgICAgICBpZiAocC5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICAgIGJhc2Vba10gPSBwW2tdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIHJldHVybiBiYXNlXG59XG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignQXV0aEN0cmwnLCBbXCIkc2NvcGVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCIkc3RhdGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJG1kU2lkZW5hdlwiLCBcIiR0cmFuc2xhdGVcIiwgXCIkY29va2llc1wiLCBcIk5vdGlTZXJ2aWNlXCIsIFwiJG5vdGlmaWNhdGlvblwiLCBmdW5jdGlvbigkc2NvcGUsQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLCRtZFNpZGVuYXYsJHRyYW5zbGF0ZSwgJGNvb2tpZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlTZXJ2aWNlLCRub3RpZmljYXRpb24pe1xuXG4gICAgY29uc29sZS5sb2coXCJhdXRoQ3RybFwiKTtcblxuICAgIHZhciBhdXRoQ3RybCA9IHRoaXM7XG5cbiAgICAvL0FzayBmb3Igbm90aWZpY2F0aW9uIHBlcm1pc3Npb25cbiAgICAkbm90aWZpY2F0aW9uLnJlcXVlc3RQZXJtaXNzaW9uKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHBlcm1pc3Npb24pOyAvLyBkZWZhdWx0LCBncmFudGVkLCBkZW5pZWRcbiAgICAgIH0pO1xuXG4gICAgLy9QYXJzZXJcbiAgICBhdXRoQ3RybC5hdXRoICAgICA9IEF1dGg7XG4gICAgYXV0aEN0cmwudXNlcnMgICAgPSBVc2VycztcbiAgICBhdXRoQ3RybC5ub3RpZmljYXRpb24gPSBOb3RpU2VydmljZTtcblxuXG4gICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgID0gYXV0aEN0cmwudXNlcnMuZ2V0UHJvZmlsZShBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgPScnXG4gICAgfVxuXG5cbiAgICBhdXRoQ3RybC51c2VyID0ge1xuICAgICAgZW1haWw6ICcnLFxuICAgICAgcGFzc3dvcmQ6ICcnXG4gICAgfTtcblxuXG5cbiAgICAvL0dldCB0aGUgYmFkZ2Ugbm90aWZpY2F0aW9uXG4gICAgLyphdXRoQ3RybC5iYWRnZU5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICByZXR1cm4gYXV0aEN0cmwubm90aWZpY2F0aW9uLmFkZEFyckNoaWxkKGF1dGhDdHJsLnByb2ZpbGUuJGlkICsgJy91bnJlYWQnKS4kbG9hZGVkKCk7XG4gICAgfVxuXG4gICAgYXV0aEN0cmwuYmFkZ2VWYWx1ZSA9IGF1dGhDdHJsLmJhZGdlTm90aWZpY2F0aW9uO1xuXG4gICAgY29uc29sZS5sb2coYXV0aEN0cmwuYmFkZ2VOb3RpZmljYXRpb24pOyovXG5cbiAgICAkc2NvcGUuYmFkZ2VOb3RpZmNhdGlvbiA9IGF1dGhDdHJsLmJhZGdlTm90aWZpY2F0aW9uO1xuXG4gICAgLy9SZXNldCBjb3VudGVyXG4gICAgYXV0aEN0cmwucmVzZXRDb3VudGVyID0gZnVuY3Rpb24oKXtcbiAgICAgIGF1dGhDdHJsLm5vdGlmaWNhdGlvbi5yZXNldFVucmVhZChhdXRoQ3RybC5wcm9maWxlLiRpZCk7XG4gICAgfVxuXG4gICAgYXV0aEN0cmwuY2hhbmdlVmFsID0gZnVuY3Rpb24oKXtcbiAgICAgIGNvbnNvbGUubG9nKCdiYWRnZSB2YWx1ZSAnK2F1dGhDdHJsLmJhZGdlTm90aWZpY2F0aW9uLiR2YWx1ZSk7XG5cbiAgICB9XG5cbiAgICAvKiRzY29wZS4kd2F0Y2goXCJuYW1lXCIsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgaWYgKCRzY29wZS5uYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgJHNjb3BlLmdyZWV0aW5nID0gXCJHcmVldGluZ3MgXCIgKyAkc2NvcGUubmFtZTtcbiAgICAgIH1cbiAgICB9KTsqL1xuXG5cbiAgICAvL0NoYW5nZSBsYW5ndWFnZVxuICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgJHRyYW5zbGF0ZS51c2UobGFuZ0tleSk7XG4gICAgICAvLyBTZXR0aW5nIGEgY29va2llXG4gICAgICAkY29va2llcy5wdXQoJ3VzZXJMYW5nJywgbGFuZ0tleSk7XG4gICAgICAvL0lmIHVzZXIgcmVnaXN0ZXJlZCAtIHVwZGF0ZSB0aGlzIGluIHRoZWlyIHByZWZlcmVuY2VcbiAgICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XG4gICAgICAgIGF1dGhDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKHtcImxhbmdcIjpsYW5nS2V5fSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvL0NoZWNrayB1c2VyIHNlbGVjdGVkIGxhbmd1YWdlXG4gICAgaWYoIWF1dGhDdHJsLnByb2ZpbGUubGFuZyl7XG4gICAgICBpZigkY29va2llcy5nZXQoJ3VzZXJMYW5nJykpe1xuICAgICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKCRjb29raWVzLmdldCgndXNlckxhbmcnKSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgYXV0aEN0cmwudG9nZ2xlTGFuZygnRW5nJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKGF1dGhDdHJsLnByb2ZpbGUubGFuZyk7XG4gICAgfVxuXG5cbiAgICAvL0xvZ2luXG4gICAgYXV0aEN0cmwubG9naW4gPSBmdW5jdGlvbiAoKXtcbiAgICAgIGF1dGhDdHJsLmF1dGguYXV0aC4kYXV0aFdpdGhQYXNzd29yZChhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uIChhdXRoKXtcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcil7XG4gICAgICAgIGF1dGhDdHJsLmVycm9yID0gZXJyb3I7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy9Mb2dvdXRcbiAgICBhdXRoQ3RybC5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgQXV0aC5hdXRoLiR1bmF1dGgoKTtcbiAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICB9XG5cbiAgICAvL1JlZ2lzdGVyIHVzZXJcbiAgICBhdXRoQ3RybC5yZWdpc3RlciA9IGZ1bmN0aW9uICgpe1xuICAgICAgQXV0aC5hdXRoLiRjcmVhdGVVc2VyKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKHVzZXIpe1xuICAgICAgICBhdXRoQ3RybC5sb2dpbigpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcbiAgICAgICAgYXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ0F1dGgnLCBbXCIkZmlyZWJhc2VBdXRoXCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24oJGZpcmViYXNlQXV0aCwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XHJcbiAgICB2YXIgYXV0aCA9ICRmaXJlYmFzZUF1dGgocmVmKTtcclxuXHJcbiAgICB2YXIgQXV0aCA9IHtcclxuICAgICAgcmVmOnJlZixcclxuICAgICAgYXV0aDogYXV0aCxcclxuXHJcbiAgICAgIGdldFVpZDpmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciB1aWQgPSByZWYuZ2V0QXV0aCgpO1xyXG4gICAgICAgIGlmKHVpZCAhPSBudWxsICl7XHJcbiAgICAgICAgICByZXR1cm4gcmVmLmdldEF1dGgoKS51aWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBBdXRoO1xyXG4gIH1dKTtcclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ0NhdGVDdHJsJywgW1wiJHN0YXRlXCIsIFwiQ2F0ZWdvcnlcIiwgXCJjYXRlTmFtZVwiLCBcImNhdGVUb3BpY3NcIiwgZnVuY3Rpb24oJHN0YXRlLCBDYXRlZ29yeSxjYXRlTmFtZSxjYXRlVG9waWNzKXtcbiAgICB2YXIgY2F0ZUN0cmwgPSB0aGlzO1xuXG4gICAgLy9QYXJzZXJzXG4gICAgY2F0ZUN0cmwuY2F0ZU5hbWUgICA9IGNhdGVOYW1lO1xuICAgIGNhdGVDdHJsLmNhdGVnb3J5ICAgPSBDYXRlZ29yeTtcbiAgICBjYXRlQ3RybC5jYXRlVG9waWNzID0gY2F0ZVRvcGljcztcblxuXG4gICAgY29uc29sZS5sb2coXCJDYXRlQ3RybFwiKTtcbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuXHJcbiAgLy9Ub3BpYyBsaXN0XHJcbiAgLmZhY3RvcnkoJ0NhdGVTZXJ2aWNlJywgW1wiJGZpcmViYXNlT2JqZWN0XCIsIFwiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5ICwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcycpO1xyXG4gICAgdmFyIGNhdGVnb3JpZXMgPSAkZmlyZWJhc2VPYmplY3QocmVmKTtcclxuXHJcbiAgICB2YXIgQ2F0ZSA9IHtcclxuXHJcbiAgICAgIG5hbWU6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcInNsdWdcIikuZXF1YWxUbyh0b3BpY19zbHVnKTtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QodXNlcnNSZWYuY2hpbGQodWlkKSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oY2hpbGRuYW1lKXtcclxuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKGNoaWxkbmFtZSlcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGZvbGxvd0xpc3Q6ZnVuY3Rpb24odWlkKXtcclxuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoXCJuZXdzL2ZvbGxvd2VyXCIpLmVxdWFsVG8odWlkKTtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1bkZvbGxvdzpmdW5jdGlvbihzbHVnLHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcy8nK3NsdWcrJy9mb2xsb3dlci8nK3VpZCk7XHJcbiAgICAgICAgcmVmLnJlbW92ZSgpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgdXNlckZvbGxvdzpmdW5jdGlvbihzbHVnLHVpZCl7XHJcbiAgICAgICAgdmFyIGZvbGxvdz1mYWxzZTtcclxuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzLycrc2x1ZysnL2ZvbGxvd2VyLycrdWlkKTtcclxuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XHJcbiAgICAgICAgICBmb2xsb3cgPSBzbmFwc2hvdC5leGlzdHMoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBmb2xsb3c7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogJGZpcmViYXNlQXJyYXkocmVmKSxcclxuICAgICAgYWxsOmNhdGVnb3JpZXNcclxuICAgIH1cclxuICAgIHJldHVybiBDYXRlO1xyXG4gIH1dKVxyXG5cclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuXHJcbiAgLy9Ub3BpYyBsaXN0XHJcbiAgLmZhY3RvcnkoJ1Bvc3QnLCBbXCIkZmlyZWJhc2VPYmplY3RcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3RvcGljcycpO1xyXG4gICAgdmFyIHRvcGljcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG5cclxuICAgIHZhciBUUyA9IHtcclxuICAgICAgdG9waWNOYW1lOiBmdW5jdGlvbih0b3BpY19zbHVnKXtcclxuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoXCJzbHVnXCIpLmVxdWFsVG8odG9waWNfc2x1Zyk7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChkYXRhKTtcclxuICAgICAgfSxcclxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QodXNlcnNSZWYuY2hpbGQodWlkKSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFsbDp0b3BpY3NcclxuICAgIH1cclxuICAgIHJldHVybiBUUztcclxuICB9XSlcclxuXHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJywgW1wiQXV0aFwiLCBcIiRzdGF0ZVwiLCBcIkNhdGVnb3J5XCIsIFwiQ2F0ZVNlcnZpY2VcIiwgXCJUYWdzXCIsIFwiVG9waWNzXCIsIGZ1bmN0aW9uKEF1dGgsICRzdGF0ZSxDYXRlZ29yeSxDYXRlU2VydmljZSxUYWdzLFRvcGljc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgIHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuICAgIGRhc2hib2FyZEN0cmwuYXV0aCA9IEF1dGg7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmNhdGUgICAgICAgID0gQ2F0ZVNlcnZpY2U7XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlZ29yaWVzICA9IENhdGVnb3J5O1xuICAgIGRhc2hib2FyZEN0cmwudG9waWNzICAgICAgPSBUb3BpY3M7XG4gICAgZGFzaGJvYXJkQ3RybC50b3BpY19ncmlkICA9IGZhbHNlO1xuICAgIGRhc2hib2FyZEN0cmwudGFncyAgICAgICAgPSBUYWdzLmFycjtcblxuICAgIGRhc2hib2FyZEN0cmwudXNlckNhdGVGb2xsb3cgID0gW107XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBkYXNoYm9hcmRDdHJsLmZvbGxvd0xpc3QgICAgICA9ICcnO1xuICAgIGRhc2hib2FyZEN0cmwudXNlckZlZWQgPSdudWxsJztcblxuICAgIGRhc2hib2FyZEN0cmwubGF0ZXN0RmVlZCA9IGRhc2hib2FyZEN0cmwudG9waWNzLmxhdGVzdEZlZWQoKTtcblxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGNhdGVfc2x1Zyl7XG4gICAgICBkYXNoYm9hcmRDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIkRhc2hib2FyZEN0cmxcIik7XG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG5cbiAgLmRpcmVjdGl2ZSgnbWFpbkhlYWRlcicsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXG4gICAgICB0cmFuc2NsdWRlOiAgIHRydWUsXG4gICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgIH1cblxuICB9KVxuXG4gIC8vQmFkZ2Ugbm90aWZpY2F0aW9uXG4gIC5kaXJlY3RpdmUoJ2JhZGdlTm90aWZpY2F0aW9uJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvYmFkZ2Utbm90aWZpY2F0aW9uLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgbm90aWZpY2F0aW9uOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0xpc3Qgb2YgY2F0ZWdvcmllcyBvbiB0aGUgc2lkZXJiYXJcbiAgLmRpcmVjdGl2ZSgncmV2aWV3U2NvcmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9yZXZpZXctc3VtbWFyeS1saXN0Lmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcmV2aWV3OiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0ZvbGxvdyBCdXR0b25cbiAgLmRpcmVjdGl2ZSgndXNlckZvbGxvd2VyQnRuJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9mb2xsb3ctdXNlci5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGZvbGxvdzogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9DYXRlZ29yeSBmb2xsb3cgYnV0dG9uXG4gIC5kaXJlY3RpdmUoJ2NhdGVGb2xsb3dCdG4nLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWZvbGxvdy1idG4uaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBjYXRlOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXG4gIC5kaXJlY3RpdmUoJ3RvcGljR3JpZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvY2F0ZWdvcnktZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuICAvL0dyaWQgVGFncyBmb3Igc2lkZWJhclxuICAuZGlyZWN0aXZlKCd0YWdHcmlkJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90YWctZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuXG4gIC5kaXJlY3RpdmUoJ3RvcGljQ3JlYXRlJywgZnVuY3Rpb24oKXtcblxuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtY3JlYXRlLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdG9waWM6ICc9J1xuICAgICAgfVxuICAgIH1cblxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNMaXN0JywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtbGlzdC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljczogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNBY3Rpb25zQ2FyZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWFjdGlvbnMtY2FyZC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL2ZvciB0YWdzIC0gbWF4IHRhZ3NcbiAgLmRpcmVjdGl2ZSgnZW5mb3JjZU1heFRhZ3MnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ0N0cmwpIHtcbiAgICAgIHZhciBtYXhUYWdzID0gYXR0cnMubWF4VGFncyA/IHBhcnNlSW50KGF0dHJzLm1heFRhZ3MsICc0JykgOiBudWxsO1xuXG4gICAgICBuZ0N0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgJiYgbWF4VGFncyAmJiB2YWx1ZS5sZW5ndGggPiBtYXhUYWdzKSB7XG4gICAgICAgICAgdmFsdWUuc3BsaWNlKHZhbHVlLmxlbmd0aCAtIDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29uZmlnKFsnJHRyYW5zbGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCR0cmFuc2xhdGVQcm92aWRlcikge1xyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnRyYW5zbGF0aW9ucygnRW5nJywge1xyXG4gICAgICAnS0VZX0RBU0hCT0FSRCc6ICAnRGFzaGJvYXJkJyxcclxuICAgICAgJ0tFWV9MQU5HVUFHRVMnOiAgJ0xhbmd1YWdlcycsXHJcbiAgICAgICdLRVlfSE9NRSc6ICAgICAgICdIb21lJyxcclxuICAgICAgJ0tFWV9SRUdJU1RFUic6ICAgJ1JlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9MT0dJTic6ICAgICAgJ0xvZyBpbicsXHJcbiAgICAgICdLRVlfTE9HT1VUJzogICAgICdMb2cgb3V0JyxcclxuICAgICAgJ0tFWV9GT0xMT1cnOiAgICAgJ0ZvbGxvdycsXHJcbiAgICAgICdLRVlfRk9MTE9XRVInOiAgICdGb2xsb3dlcicsXHJcbiAgICAgICdLRVlfVU5GT0xMT1cnOiAgICdVbmZvbGxvdycsXHJcbiAgICAgICdLRVlfRk9MTE9XSU5HJzogICdGb2xsb3dpbmcnLFxyXG4gICAgICAnS0VZX1BPU1QnOiAgICAgICAnUG9zdCcsXHJcbiAgICAgICdLRVlfUE9TVEVEJzogICAgICdQb3N0ZWQnLFxyXG4gICAgICAnS0VZX1VQVk9URSc6ICAgICAnVXB2b3RlJyxcclxuICAgICAgJ0tFWV9VUFZPVEVEJzogICAgJ1Vwdm90ZWQnLFxyXG4gICAgICAnS0VZX0RXTl9WT1RFJzogICAnRG93bnZvdGUnLFxyXG4gICAgICAnS0VZX0RXTl9WT1RFRCc6ICAnRG93bnZvdGVkJyxcclxuICAgICAgJ0tFWV9WSUVXJzogICAgICAgJ1ZpZXcnLFxyXG4gICAgICAnS0VZX1JFTU9WRSc6ICAgICAnUmVtb3ZlJyxcclxuICAgICAgJ0tFWV9DQU5DRUwnOiAgICAgJ0NhbmNlbCcsXHJcbiAgICAgICdLRVlfUVVFU1RJT04nOiAgICdRdWVzdGlvbicsXHJcbiAgICAgICdLRVlfVE9QSUMnOiAgICAgICdUb3BpYycsXHJcbiAgICAgICdLRVlfQ0hHX1BXRCc6ICAgICdDaGFuZ2UgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX1BBU1NXT1JEJzogICAnUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX09MRF9QV0QnOiAgICAnT2xkIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9ORVdfUFdEJzogICAgJ05ldyBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfTkVXX1BXRF9DJzogICdOZXcgcGFzc3dvcmQgY29uZmlybWF0aW9uJyxcclxuICAgICAgJ0tFWV9TQVZFJzogICAgICAgJ1NhdmUnLFxyXG4gICAgICAnS0VZX1NBVkVfRFJBRlQnOiAnU2F2ZSBhcyBkcmFmdCcsXHJcbiAgICAgICdLRVlfVEFHUyc6ICAgICAgICdUYWdzJyxcclxuICAgICAgJ0tFWV9FWFBMT1JFJzogICAgJ0V4cGxvcmUnLFxyXG4gICAgICAnS0VZX0ZFQVRfQ0FUJzogICAgJ0ZlYXR1cmVzIGNhdGVnb3JpZXMnLFxyXG4gICAgICAnS0VZX0NPTU1FTlRTJzogICAnQ29tbWVudHMnLFxyXG4gICAgICAnS0VZX1JFUExZJzogICAgICAnUmVwbHknLFxyXG4gICAgICAnS0VZX1JFVklFVyc6ICAgICAnUmV2aWV3JyxcclxuICAgICAgJ0tFWV9FRElUJzogICAgICAgJ0VkaXQnLFxyXG4gICAgICAnS0VZX1RSRU5EJzogICAgICAnVHJlbmQnLFxyXG4gICAgICAnS0VZX1RSRU5ESU5HJzogICAnVHJlbmRpbmcnLFxyXG4gICAgICAnS0VZX1dSSVRFX1JFUExZJzonV3JpdGUgYSByZXBseScsXHJcbiAgICAgICdLRVlfTEFURVNUX0ZFRUQnOidMYXRlc3QgRmVlZCcsXHJcblxyXG4gICAgICAvL1JlbW92ZSB0b3BpY1xyXG4gICAgICAnS0VZX0NPTkZfUkVNT1ZFJzonQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZT8nLFxyXG4gICAgICAnS0VZX0NPTkZfUkVNX0MnOiAnT25jZSByZW1vdmUsIHlvdSB3aWxsIG5vdCBiZSBhYmxldG8gdG8gZ2V0IHRoaXMgdG9waWMgYmFjaycsXHJcblxyXG5cclxuICAgICAgLy9TRU5URU5DRVxyXG4gICAgICAnS0VZX1dIQVRfT05fVVJfTUlORCc6ICAnV2hhdFxcJ3Mgb24geW91ciBtaW5kPycsXHJcbiAgICAgICdLRVlfWU9VX1dBTlRfRk9MTE9XJzogICdZb3UgbWF5IHdhbnQgdG8gZm9sbG93JyxcclxuICAgICAgJ0tFWV9OT19BQ0NUX1JFR0lTVEVSJzogJ0RvblxcJ3QgaGF2ZSBhY2NvdW50PyBSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfQ0FOVF9DSE5HX1VTRVInOiAgICdEb25cXCd0IGhhdmUgYWNjb3VudD8gUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX1lPVVJfQUNDT1VOVCc6ICAgICAnWW91ciBhY2NvdW50JyxcclxuICAgICAgJ0tFWV9OT1RISU5HX0hFUkUnOiAgICAgJ05vdGhpbmcgaGVyZSwgeWV0JyxcclxuICAgICAgJ0tFWV9XSE9fVE9fRk9MTE9XJzogICAgJ1dobyB0byBmb2xsb3cnLFxyXG4gICAgICAnS0VZX0NBVF9XSUxMX0FQUEVBUic6ICAnRm9sbG93IHNvbWUgY2F0ZWdvcmllcyBhbmQgaXQgd2lsbCBhcHBlYXIgaGVyZScsXHJcbiAgICAgICdLRVlfV0hUX1VSX1NUT1JZJzogICAgICdXaGF0XFwncyB5b3VyIHN0b3J5JyxcclxuICAgICAgJ0tFWV9XUlRfQ09NTUVOVCc6ICAgICAgJ1dyaXRlIGEgY29tbWVudCcsXHJcblxyXG5cclxuXHJcbiAgICAgIC8vVVNFUiBJTlBVVFxyXG4gICAgICAnS0VZX0ZJUlNUTkFNRSc6ICAnRmlyc3QgbmFtZScsXHJcbiAgICAgICdLRVlfTEFTVE5BTUUnOiAgICdMYXN0IG5hbWUnLFxyXG4gICAgICAnS0VZX0JJUlRIREFZJzogICAnQmlydGhkYXknLFxyXG4gICAgICAnS0VZX01PTlRIJzogICAgICAnTW9udGgnLFxyXG4gICAgICAnS0VZX0RBWSc6ICAgICAgICAnRGF5JyxcclxuICAgICAgJ0tFWV9FTUFJTCc6ICAgICAgJ0VtYWlsJyxcclxuICAgICAgJ0tFWV9DT05GX0VNQUlMJzogJ0NvbmZpcm0gRW1haWwnLFxyXG4gICAgICAnS0VZX0dFTkRFUic6ICAgICAnR2VuZGVyJyxcclxuICAgICAgJ0tFWV9NQUxFJzogICAgICAgJ01hbGUnLFxyXG4gICAgICAnS0VZX0ZFTUFMRSc6ICAgICAnRmVtYWxlJyxcclxuICAgICAgJ0tFWV9VU0VSTkFNRSc6ICAgJ1VzZXJuYW1lJyxcclxuICAgICAgJ0tFWV9MT0NBVElPTic6ICAgJ0xvY2F0aW9uJyxcclxuXHJcbiAgICAgIC8vVXNlciBFZGl0XHJcbiAgICAgICdLRVlfRURfUFJPRklMRSc6ICdFZGl0IFByb2ZpbGUnLFxyXG4gICAgICAnS0VZX0VEX0NIR19QV0QnOiAnQ2hhbmdlIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9FRF9QUk9GSUxFJzogJ0VkaXQgUHJvZmlsZScsXHJcbiAgICAgICdLRVlfRURfU0lURSc6ICAgICdXZWJzaXRlJyxcclxuICAgICAgJ0tFWV9FRF9QSE9ORSc6ICAgJ1Bob25lJyxcclxuICAgICAgJ0tFWV9FRF9CSU8nOiAgICAgJ0Jpb2dyYXBoeScsXHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnRyYW5zbGF0aW9ucygn4LmE4LiX4LiiJywge1xyXG4gICAgICAnS0VZX0RBU0hCT0FSRCc6ICAn4Lir4LmJ4Lit4LiH4LiX4Lix4LmJ4LiH4Lir4Lih4LiUJyxcclxuICAgICAgJ0tFWV9MQU5HVUFHRVMnOiAgJ+C4oOC4suC4qeC4sicsXHJcbiAgICAgICdLRVlfSE9NRSc6ICAgICAgICfguKvguJnguYnguLLguYHguKPguIEnLFxyXG4gICAgICAnS0VZX1JFR0lTVEVSJzogICAn4Liq4Lih4Lix4LiE4Lij4LmD4LiK4LmJJyxcclxuICAgICAgJ0tFWV9MT0dJTic6ICAgICAgJ+C5gOC4guC5ieC4suC4quC4ueC5iOC4o+C4sOC4muC4micsXHJcbiAgICAgICdLRVlfRk9MTE9XJzogICAgICfguJXguLTguJTguJXguLLguKEnLFxyXG4gICAgICAnS0VZX1BPU1QnOiAgICAgICAn4LmC4Lie4Liq4LiV4LmMJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnByZWZlcnJlZExhbmd1YWdlKCdlbicpO1xyXG4gIH1dKVxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdOb3RpQ3RybCcsIFtcIiRzdGF0ZVwiLCBcIkNhdGVnb3J5XCIsIFwiVG9waWNzXCIsIFwiTm90aVNlcnZpY2VcIiwgZnVuY3Rpb24oJHN0YXRlLENhdGVnb3J5LFRvcGljcyxOb3RpU2VydmljZSl7XHJcbiAgICB2YXIgbm90aUN0cmwgPSB0aGlzO1xyXG5cclxuXHJcbiAgICBub3RpQ3RybC50b3BpY3MgPSBUb3BpY3M7XHJcbiAgICBub3RpQ3RybC5mZWVkICAgPSBmZWVkO1xyXG4gICAgbm90aUN0cmwubm90aVNlcnZpY2UgPSBOb3RpU2VydmljZTtcclxuXHJcbiAgICBub3RpQ3RybC5ub3RpZnlUbyA9ZnVuY3Rpb24odWlkKXtcclxuICAgICAgcmV0dXJuIG5vdGlDdHJsLmFyci5wdXNoKHVpZCkuJGFkZCh1aWQpXHJcbiAgICB9XHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAuZmFjdG9yeSgnTm90aVNlcnZpY2UnLCBbXCIkZmlyZWJhc2VPYmplY3RcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIFwiVXNlcnNcIiwgXCIkbm90aWZpY2F0aW9uXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXkgLCBGaXJlYmFzZVVybCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVc2Vycywkbm90aWZpY2F0aW9uKXtcclxuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbicpO1xyXG4gICAgdmFyIG5vdGkgPSAkZmlyZWJhc2VPYmplY3QocmVmKTtcclxuICAgIHZhciB1c2VycyA9IFVzZXJzO1xyXG5cclxuICAgIHZhciBvYnNlcnZlckNhbGxiYWNrcyA9IFtdO1xyXG5cclxuXHJcbiAgICB2YXIgTm90aWZpY2F0aW9uID0ge1xyXG5cclxuICAgICAgLy9EaXNwbGF5IHVucmVhZFxyXG4gICAgICB1bnJlYWROb3RpZmljYXRpb246ZnVuY3Rpb24odWlkKXtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQrJy91bnJlYWQnKTtcclxuICAgICAgICB2YXIgY291bnRlcjtcclxuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLGZ1bmN0aW9uKHNuYXBzaG90KXtcclxuICAgICAgICAgIGNvdW50ZXIgPSBzbmFwc2hvdC52YWwoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIG5vdGlmaWNhdGlvbl9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nK3VpZCk7XHJcbiAgICAgICAgbm90aWZpY2F0aW9uX3JlZi5vbihcImNoaWxkX2FkZGVkXCIsZnVuY3Rpb24oKXtcclxuICAgICAgICAgICRub3RpZmljYXRpb24oJ05ldyBtZXNzYWdlIGZyb20gUWFueWEnLCB7XHJcbiAgICAgICAgICAgIGJvZHk6ICdIZWxsbyAnK3VpZCxcclxuICAgICAgICAgICAgZGlyOiAnYXV0bycsXHJcbiAgICAgICAgICAgIGxhbmc6ICdlbicsXHJcbiAgICAgICAgICAgIHRhZzogJ215LXRhZycsXHJcbiAgICAgICAgICAgIGljb246ICdodHRwOi8vd3d3LmNsLmNhbS5hYy51ay9yZXNlYXJjaC9zcmcvbmV0b3MvaW1hZ2VzL3FzZW5zZS1sb2dvLnBuZycsXHJcbiAgICAgICAgICAgIC8vZGVsYXk6IDEwMDAsIC8vIGluIG1zXHJcbiAgICAgICAgICAgIGZvY3VzV2luZG93T25DbGljazogdHJ1ZSAvLyBmb2N1cyB0aGUgd2luZG93IG9uIGNsaWNrXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiBjb3VudGVyIDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vTm90aWZ5IGZvbGxvd2Vyc1xyXG4gICAgICBub3RpZnlGb2xsb3dlcjpmdW5jdGlvbih0b3BpY0lkLHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiA9IHVzZXJzLmdldEZvbGxvd2VyKHVpZCk7XHJcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xyXG4gICAgICAgICAgc25hcHNob3QuZm9yRWFjaChmdW5jdGlvbihjaGlsZFNuYXBzaG90KSB7XHJcbiAgICAgICAgICAgIC8vdXBkYXRlIG5vdGlmaWNhdGlvbiBhbmQgZGV0YWlsc1xyXG4gICAgICAgICAgICBOb3RpZmljYXRpb24udXBkYXRlTm90aWZpY2F0aW9uQ291bnQodG9waWNJZCxjaGlsZFNuYXBzaG90LmtleSgpKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vQWRkIGRldGFpbCBmb3IgdGhpcyBub3RpZmljdGlhb25cclxuICAgICAgbm90aWZ5TG9nOmZ1bmN0aW9uKHRvcGljSWQsdWlkLGZyb21fdWlkKXtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ1aWQgXCIrdWlkKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImZyb20gdWlkIFwiKyBmcm9tX3VpZCk7XHJcblxyXG4gICAgICAgIE5vdGlmaWNhdGlvbi5hZGRDaGlsZCh1aWQpLnB1c2goKS5zZXQoe1xyXG4gICAgICAgICAgdG9waWNJZDogICAgdG9waWNJZCxcclxuICAgICAgICAgIGZyb206ICAgICAgIGZyb21fdWlkLFxyXG4gICAgICAgICAgaXNfcmVhZDogICAgZmFsc2UsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9LFxyXG5cclxuXHJcbiAgICAgIC8vUmVzZXQgdW5yZWFkIGNvdW50ZXJcclxuICAgICAgcmVzZXRVbnJlYWQ6ZnVuY3Rpb24odWlkKXtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQrJy91bnJlYWQnKTtcclxuICAgICAgICByZWYuc2V0KDApO1xyXG4gICAgICB9LFxyXG5cclxuXHJcbiAgICAgIC8vVXBkYXRlIG5vdGlmaWNhdGlvblxyXG4gICAgICAvL0BwYXJhbXMgdWlkIC0gd2hvIHRoaXMgbm90aWZpY2F0aW9uIGlzIGdvaW5nIHRvXHJcbiAgICAgIHVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50OmZ1bmN0aW9uKHRvcGljSWQsdWlkLGZyb21fdWlkKXtcclxuXHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XHJcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xyXG4gICAgICAgICAgLy9kZWZhdWx0IHVucmVhZCBpcyAxXHJcbiAgICAgICAgIGlmKHNuYXBzaG90LnZhbCgpID09ICdudWxsJyl7XHJcbiAgICAgICAgICAgIHJlZi5zZXQoMSlcclxuICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICByZWYuc2V0KHNuYXBzaG90LnZhbCgpICsgMSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSByZWFkIGZhaWxlZDogXCIgKyBlcnJvck9iamVjdC5jb2RlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy9BZGQgdG8gbG9nXHJcbiAgICAgICAgTm90aWZpY2F0aW9uLm5vdGlmeUxvZyh0b3BpY0lkLHVpZCxmcm9tX3VpZCk7XHJcblxyXG4gICAgICB9LFxyXG5cclxuXHJcbiAgICAgIGFkZENoaWxkOmZ1bmN0aW9uKGNoaWxkKXtcclxuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKGNoaWxkKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFkZEFyckNoaWxkOmZ1bmN0aW9uKGNoaWxkKXtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZChjaGlsZCkpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYXJyOiAkZmlyZWJhc2VBcnJheShyZWYpLFxyXG4gICAgICBhbGw6IG5vdGlcclxuICAgIH1cclxuICAgIHJldHVybiBOb3RpZmljYXRpb247XHJcbiAgfV0pXHJcblxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdQbGFjZXNDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRtZERpYWxvZ1wiLCBcIiRtZE1lZGlhXCIsIFwiVGFnc1wiLCBcIlRvcGljc1wiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIlNsdWdcIiwgXCJMYW5ndWFnZXNcIiwgXCJwbGFjZUxhbmRpbmdcIiwgZnVuY3Rpb24oJHN0YXRlLCRzY29wZSwkcm9vdFNjb3BlLCAkbWREaWFsb2csICRtZE1lZGlhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFncywgVG9waWNzLCBBdXRoLCBVc2VycywgU2x1ZyxMYW5ndWFnZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZUxhbmRpbmcpIHtcclxuXHJcbiAgICB2YXIgcGxhY2VzQ3RybCA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZyhwbGFjZUxhbmRpbmcpO1xyXG4gICAgcGxhY2VzQ3RybC5wbGFjZUxhbmRpbmcgPSBwbGFjZUxhbmRpbmc7XHJcblxyXG4gIH1dKTtcclxuXHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ1BsYWNlcycsIFtcIiRmaXJlYmFzZUFycmF5XCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuXHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydwbGFjZXMnKTtcclxuICAgIHZhciBwbGFjZURldGFpbF9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlc19kZXRhaWxzJyk7XHJcblxyXG4gICAgdmFyIHBsYWNlcyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIFBsYWNlcyA9IHtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRQbGFjZURldGFpbENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiBwbGFjZURldGFpbF9yZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0UGxhY2VSZWY6ZnVuY3Rpb24ocGxhY2VfaWQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQocGxhY2VfaWQrJy9pbmZvJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogcGxhY2VzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGxhY2VzO1xyXG4gIH1dKVxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL0NhdGVnb3J5IGxpc3RcclxuICAuZmFjdG9yeSgnQ2F0ZWdvcnknLCBbXCIkZmlyZWJhc2VPYmplY3RcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMnKTtcclxuICAgIHZhciBjYXRlZ29yaWVzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XHJcbiAgICB2YXIgdG9waWNBcnIgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xyXG5cclxuICAgIHZhciBDYXRlZ29yeSA9IHtcclxuICAgICAgZ2V0TmFtZTogZnVuY3Rpb24oc2x1Zyl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZWYuY2hpbGQoc2x1Zyk7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChkYXRhKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFsbDogY2F0ZWdvcmllc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIENhdGVnb3J5O1xyXG4gIH1dKVxyXG5cclxuXHJcbiAgLy9MYW5ndWFnZXNcclxuICAuZmFjdG9yeSgnTGFuZ3VhZ2VzJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbGFuZ3VhZ2VzJyk7XHJcbiAgICB2YXIgbGFuZyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgcmV0dXJuIGxhbmc7XHJcbiAgfV0pXHJcblxyXG5cclxuICAvL0xhbmd1YWdlc1xyXG4gIC5mYWN0b3J5KCdBcmNoaXZlJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnYXJjaGl2ZScpO1xyXG4gICAgdmFyIGFyY2hpdmUgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xyXG5cclxuICAgIHZhciBBcmNoaXZlID17XHJcbiAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihzbHVnKXtcclxuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHNsdWcpO1xyXG4gICAgICB9LFxyXG4gICAgICByZWY6IHJlZixcclxuICAgICAgYXJyOiBhcmNoaXZlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gQXJjaGl2ZTtcclxuICB9XSk7XHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ1RhZ0N0cmwnLCBbXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCIkc3RhdGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwidGFnTGFuZGluZ1wiLCBcInRhZ05hbWVcIiwgZnVuY3Rpb24oQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdMYW5kaW5nLHRhZ05hbWUpIHtcclxuXHJcbiAgICB2YXIgdGFnQ3RybCA9IHRoaXM7XHJcbiAgICB0YWdDdHJsLnRhZ0xhbmRpbmcgID0gdGFnTGFuZGluZztcclxuICAgIHRhZ0N0cmwudGFnTmFtZSAgICAgPSB0YWdOYW1lO1xyXG5cclxuICB9XSk7XHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5mYWN0b3J5KCdUYWdzJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCIkZmlyZWJhc2VPYmplY3RcIiwgXCJGaXJlYmFzZVVybFwiLCBcIiRxXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkcSl7XG5cbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd0YWdzJyk7XG4gICAgdmFyIHRhZ3MgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xuXG4gICAgdmFyIFRhZ3MgPSB7XG5cbiAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKGNoaWxkbmFtZSlcbiAgICAgIH0sXG5cbiAgICAgIHRhZ3NVcmw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZik7XG4gICAgICB9LFxuXG4gICAgICBnZXRUYWdSZWY6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0YWcpO1xuICAgICAgfSxcblxuICAgICAgZ2V0VGFnT2JqZWN0OmZ1bmN0aW9uKHRhZyl7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRhZykpXG4gICAgICB9LFxuXG4gICAgICB0b3BpY1RhZ3M6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICB2YXIgZmIgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuICAgICAgICB2YXIgZGF0YVJldCA9ICcnO1xuXG4gICAgICAgIHJldHVybiBmYi5jaGlsZCgndGFncy8nK3RhZylcbiAgICAgICAgICAub24oJ2NoaWxkX2FkZGVkJywgZnVuY3Rpb24odGFnU25hcCl7XG4gICAgICAgICAgICBmYi5jaGlsZCgndG9waWNzJylcbiAgICAgICAgICAgICAgLm9yZGVyQnlDaGlsZChcInRhZ3NcIilcbiAgICAgICAgICAgICAgLmVxdWFsVG8odGFnKVxuICAgICAgICAgICAgICAub24oJ2NoaWxkX2FkZGVkJywgZnVuY3Rpb24odG9waWNTbmFwKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIC8vc2hvdyggZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGFSZXQpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICB9LFxuXG4gICAgICBhcnI6IHRhZ3NcblxuICAgIH1cbiAgICByZXR1cm4gVGFncztcbiAgfV0pXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignVG9waWNMYW5kaW5nQ3RybCcsIFtcIiRzdGF0ZVwiLCBcIiRzY29wZVwiLCBcIlNsdWdcIiwgXCJUb3BpY3NcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCJpc093bmVyXCIsIFwidG9waWNMYW5kaW5nXCIsIFwicmVwbHlMaXN0XCIsIFwidmlld0RhdGFcIiwgXCJmb2xsb3dlcnNcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgJHNjb3BlLCBTbHVnLCBUb3BpY3MsIEF1dGgsIFVzZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPd25lcix0b3BpY0xhbmRpbmcsIHJlcGx5TGlzdCwgdmlld0RhdGEsIGZvbGxvd2Vycykge1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpY0xhbmRpbmdDdHJsXCIpO1xuXG4gICAgdmFyIHRvcGljTGFuZGluZ0N0cmwgPSB0aGlzXG5cblxuICAgIHRvcGljTGFuZGluZ0N0cmwuYXV0aCAgICAgICAgID0gQXV0aDtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLnVzZXJzICAgICAgICA9IFVzZXJzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNMYW5kaW5nID0gdG9waWNMYW5kaW5nO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNzICAgICAgID0gVG9waWNzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0ICAgID0gcmVwbHlMaXN0O1xuICAgIHRvcGljTGFuZGluZ0N0cmwudmlld3MgICAgICAgID0gdmlld0RhdGE7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5mb2xsb3dlcnMgICAgPSBmb2xsb3dlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5pc093bmVyICAgICAgPSBpc093bmVyO1xuXG5cblxuXG4gICAgLy9HZXR0aW5nIFJlcGxpZXMgaW4gcmVwbGllc1xuICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFyciA9IFtdO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgZm9yKHZhciBpPTA7IGk8dG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QubGVuZ3RoO2krKyl7XG4gICAgICAgIHZhciB0b3BpY0lkID0gdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3RbaV0udG9waWNJZDtcbiAgICAgICAgdmFyIHJlcGx5SWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS4kaWQ7XG4gICAgICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFycltpXSA9IHRvcGljTGFuZGluZ0N0cmwudG9waWNzLnJlcGx5SW5SZXBseSh0b3BpY0lkLHJlcGx5SWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5KCk7XG4gIH1dKVxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1RvcGljQ3RybCcsIFtcIiRzdGF0ZVwiLCBcIiRzY29wZVwiLCBcIiRyb290U2NvcGVcIiwgXCIkbWREaWFsb2dcIiwgXCIkbWRNZWRpYVwiLCBcIiRodHRwXCIsIFwiRmlyZWJhc2VVcmxcIiwgXCIkdHJhbnNsYXRlXCIsIFwiJG5vdGlmaWNhdGlvblwiLCBcIk5vdGlTZXJ2aWNlXCIsIFwiVGFnc1wiLCBcIlRvcGljc1wiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIlNsdWdcIiwgXCJQbGFjZXNcIiwgXCJMYW5ndWFnZXNcIiwgXCJBcmNoaXZlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwkc2NvcGUsJHJvb3RTY29wZSwgJG1kRGlhbG9nLCAkbWRNZWRpYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLEZpcmViYXNlVXJsLCR0cmFuc2xhdGUsJG5vdGlmaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlTZXJ2aWNlLFRhZ3MsIFRvcGljcywgQXV0aCwgVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTbHVnLFBsYWNlcywgTGFuZ3VhZ2VzLEFyY2hpdmUpe1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpY0N0cmxcIik7XG5cbiAgICB2YXIgdG9waWNDdHJsID0gdGhpcztcblxuXG4gICAgLy9QYXJzZXIgaGVyZVxuICAgIHRvcGljQ3RybC50YWdzICAgICAgPSBUYWdzO1xuICAgIHRvcGljQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgdG9waWNDdHJsLmF1dGggICAgICA9IEF1dGg7XG4gICAgdG9waWNDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHRvcGljQ3RybC5sYW5ndWFnZXMgPSBMYW5ndWFnZXM7XG4gICAgdG9waWNDdHJsLnBsYWNlcyAgICA9IFBsYWNlcztcbiAgICB0b3BpY0N0cmwuYXJjaGl2ZSAgID0gQXJjaGl2ZTtcbiAgICB0b3BpY0N0cmwubm90aSAgICAgID0gTm90aVNlcnZpY2U7XG5cbiAgICBpZih0b3BpY0N0cmwuYXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcbiAgICAgIHRvcGljQ3RybC5wcm9maWxlICA9IHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC5hdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICAgIHRvcGljQ3RybC51aWQgPSB0b3BpY0N0cmwucHJvZmlsZS4kaWQ7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9IHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzID0gdG9waWNDdHJsLnVzZXJzLnVwdm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcyA9IHRvcGljQ3RybC51c2Vycy5kb3dudm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZyA9IHRvcGljQ3RybC51c2Vycy5mb2xsb3dpbmcodG9waWNDdHJsLnVpZCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0b3BpY0N0cmwucHJvZmlsZSA9Jyc7XG4gICAgICB0b3BpY0N0cmwudWlkID0gJyc7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9ICcnO1xuICAgIH1cblxuXG5cbiAgICAvL1ByZXNldCBQYXJhbWV0ZXJzXG4gICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyAgPSBbXTtcbiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0ICAgICA9IFtdO1xuICAgIHRvcGljQ3RybC5pblJlcGx5QXJyICAgID0gW107XG4gICAgdG9waWNDdHJsLmxvYWRCdXN5ICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuc2x1Z1JldHVybiAgICA9IG51bGw7XG4gICAgdG9waWNDdHJsLmNyaXRlcmlhICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSA9IG51bGw7XG4gICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhPWZhbHNlO1xuICAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhID0gbnVsbDtcblxuICAgIC8vaWYgYWxsb3cgbnVsbCBpbiB0aGUgZm9ybVxuICAgIHRvcGljQ3RybC5uZXdUb3BpYyAgICAgID0ge1xuICAgICAgJ2xvY2F0aW9uJzogJycsXG4gICAgICAndXJsJyA6ICcnLFxuICAgICAgJ2lwSW5mbyc6ICcnLFxuICAgICAgJ3RhZ3MnOiAnJyxcbiAgICAgICdib2R5JzogJydcbiAgICB9XG5cblxuICAgIC8vQ2FsYyBhdmVyYWdlIHJldmlldyBpbnB1dCBpbiByZXBseVxuICAgIHRvcGljQ3RybC5hdmdSZXZpZXdSZXBseSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHZhciBvYmpDb3VudCA9IE9iamVjdC5rZXlzKHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5KS5sZW5ndGg7XG4gICAgICB2YXIgYXZnID0gMFxuICAgICAgZm9yKHZhciBpPTA7aTxvYmpDb3VudDtpKyspe1xuICAgICAgICBhdmcgPSBhdmcgKyB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseVtpXTtcbiAgICAgIH1cblxuICAgICAgdG9waWNDdHJsLnJlcGx5UmV2aWV3QXZlcmFnZSA9IGF2Zy9vYmpDb3VudDtcblxuICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLmNyaXRlcmlhUmVwbHkpO1xuXG4gICAgICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSA9IHsgYXZnOiB0b3BpY0N0cmwucmVwbHlSZXZpZXdBdmVyYWdlLCBkYXRhOiB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseX1cbiAgICB9XG5cblxuICAgIC8vR2V0IHRoZSBhdmVyYWdlIHNjb3JlIGZyb20gY3JpdGVyaWEgdmFsdWVzXG4gICAgdG9waWNDdHJsLmF2Z1Jldmlld1Njb3JlID0gZnVuY3Rpb24oZGF0YSl7XG4gICAgICBpZihkYXRhKVxuICAgICAge1xuICAgICAgdmFyIGF2ZyA9MDtcbiAgICAgIGZvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtcbiAgICAgICAgYXZnID0gYXZnICsgZGF0YVtpXS5yYXRpbmc7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXZnL2RhdGEubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9MYWJlbCBmb3IgcmVtb3ZlIHRvcGljc1xuICAgICR0cmFuc2xhdGUoWydLRVlfUkVNT1ZFJywgJ0tFWV9DQU5DRUwnLCdLRVlfQ09ORl9SRU1PVkUnLCdLRVlfQ09ORl9SRU1fQyddKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbnMpIHtcbiAgICAgIHRvcGljQ3RybC5yZW1vdmVUcmFucyA9IHRyYW5zbGF0aW9ucy5LRVlfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNhbmNlbFRyYW5zID0gdHJhbnNsYXRpb25zLktFWV9DQU5DRUw7XG4gICAgICB0b3BpY0N0cmwuY29uZmlybVJlbSAgPSB0cmFuc2xhdGlvbnMuS0VZX0NPTkZfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNvbmZpcm1SZW1Db250ZW50ID0gIHRyYW5zbGF0aW9ucy5LRVlfQ09ORl9SRU1fQztcbiAgICB9KTtcblxuXG4gICAgdG9waWNDdHJsLnVzZXJOYW1lID0gZnVuY3Rpb24odXNlcklkKXtcbiAgICAgIGlmKHVzZXJJZCE9IG51bGwpe1xuICAgICAgICAvL3JldHVybiB0b3BpY0N0cmwudXNlcnMuZ2V0RGlzcGxheU5hbWUodXNlcklkKTtcbiAgICAgIH1cbiAgICB9XG5cblxuXG5cbiAgICAvL0xvZ2luIGZvciBtYXRlcmlhbFxuICAgIHRvcGljQ3RybC5zaG93TWRMb2dpbiA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICB2YXIgdXNlRnVsbFNjcmVlbiA9ICgkbWRNZWRpYSgnc20nKSB8fCAkbWRNZWRpYSgneHMnKSkgJiYgJHNjb3BlLmN1c3RvbUZ1bGxzY3JlZW47XG4gICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgLy9jb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvbWQtbG9naW4tZm9ybS5odG1sJyxcbiAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICB0YXJnZXRFdmVudDogZXYsXG4gICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICBmdWxsc2NyZWVuOiB1c2VGdWxsU2NyZWVuXG4gICAgICAgIH0pXG4gICAgfVxuXG5cblxuICAgIHRvcGljQ3RybC5kZWNvZGVUZXh0ID0gZnVuY3Rpb24odGV4dCl7XG4gICAgICAvL3JldHVybiAkZmlsdGVyKCdzbHVnaWZ5JykoaXRlbS5uYW1lKTtcbiAgICAgIGNvbnNvbGUubG9nKGRlY29kZVVSSSh0ZXh0KSk7XG4gICAgICByZXR1cm4gZGVjb2RlVVJJKHRleHQpO1xuICAgIH1cblxuXG4gICAgdG9waWNDdHJsLmxvYWRNb3JlID0gZnVuY3Rpb24oaXRlbXMpIHtcbiAgICAgIHRvcGljQ3RybC5sb2FkQnVzeSA9IHRydWU7XG4gICAgICB2YXIgZGF0YSA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkYXRhLnB1c2goaXRlbXNbaV0pO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICByZXR1cm4gZGF0YVxuICAgIH07XG5cbiAgICB0b3BpY0N0cmwubG9hZFRhZ3MgPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLnRhZ3MudGFnc1VybCgpKTtcbiAgICB9O1xuXG5cbiAgICAvKnRvcGljQ3RybC51c2Vycy5nZXRMb2NhdGlvbklQKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICB0b3BpY0N0cmwubmV3VG9waWMuaXBJbmZvID0gZGF0YTtcbiAgICB9KTsqL1xuXG5cbiAgICAvL1VwbG9hZCBQcm9maWxlIGltYWdlXG4gICAgdG9waWNDdHJsLnVwbG9hZEZpbGUgPSBmdW5jdGlvbihmaWxlcyxpbmRleCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGZpbGVzLCBmdW5jdGlvbiAoZmxvd0ZpbGUsIGluZGV4KSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzW2luZGV4XSA9IHVyaTtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGZsb3dGaWxlLmZpbGUpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICAvL1Nob3cgY29uZmlybSByZW1vdmUgdG9waWNcbiAgICB0b3BpY0N0cmwuc2hvd0NvbmZpcm1SZW1vdmUgPSBmdW5jdGlvbihldix0b3BpY19vd25lcixvYmope1xuICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAudGl0bGUodG9waWNDdHJsLmNvbmZpcm1SZW0pXG4gICAgICAgIC50ZXh0Q29udGVudCh0b3BpY0N0cmwuY29uZmlybVJlbUNvbnRlbnQpXG4gICAgICAgIC50YXJnZXRFdmVudChldilcbiAgICAgICAgLm9rKHRvcGljQ3RybC5yZW1vdmVUcmFucylcbiAgICAgICAgLmNhbmNlbCh0b3BpY0N0cmwuY2FuY2VsVHJhbnMpO1xuICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgaWYodG9waWNDdHJsLnJlbW92ZVRvcGljKHRvcGljX293bmVyLG9iaikpe1xuICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vUmVtb3ZlIHRvcGljXG4gICAgdG9waWNDdHJsLnJlbW92ZVRvcGljID0gZnVuY3Rpb24odG9waWNfb3duZXIsb2JqKXtcbiAgICAgIC8vdmVyaWZ5IGlmIHRoZSB0b3BpYyBvd25lciBhbmQgdGhlIGxvZ2luIG93bmVyIGlzIHRoZSBzYW1lIHBwbFxuICAgICAgaWYodG9waWNfb3duZXIgPT0gdG9waWNDdHJsLnVpZCl7XG4gICAgICAgIG1vdmVGYlJlY29yZCh0b3BpY0N0cmwudG9waWNzLnJlZkNoaWxkKG9iai4kaWQpLCB0b3BpY0N0cmwuYXJjaGl2ZS5hZGRDaGlsZChvYmouJGlkKSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9SZXBseSB0byB0b3BpY1xuICAgIHRvcGljQ3RybC5yZXBseSA9IGZ1bmN0aW9uKHRvcGljT2JqKXtcblxuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUFycih0b3BpY09iai4kaWQpLiRhZGQoe1xuICAgICAgICB0b3BpY0lkOiAgdG9waWNPYmouJGlkLFxuICAgICAgICBib2R5OiAgICAgdG9waWNDdHJsLm5ld1JlcGx5LmJvZHksXG4gICAgICAgIHVpZDogICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICByZXZpZXc6ICAgdG9waWNDdHJsLmNyaXRSZXBseURhdGEsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vTm90aWZ5IHRvcGljIG93bmVyXG4gICAgICAgIC8vdG9waWNPYmogcmVmZXJzIHRvIHRoZSBwcm9wZXJ0eSBvZiB0aGlzIG9iamVjdFxuICAgICAgICB0b3BpY0N0cmwubm90aS51cGRhdGVOb3RpZmljYXRpb25Db3VudCh0b3BpY09iai4kaWQsdG9waWNPYmoudWlkLHRvcGljQ3RybC51aWQpO1xuICAgICAgfSlcblxuXG5cblxuXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudCh0b3BpY09iai4kaWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICBpZighZGF0YS5jb3VudCl7XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50UmVmKHRvcGljT2JqLiRpZCkuc2V0KDEpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnRSZWYodG9waWNPYmouJGlkKVxuICAgICAgICAgICAgLnNldChkYXRhLmNvdW50ICsxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgLy9TdGF0IHVwZGF0ZSBmb3IgdXNlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvY29tbWVudC9jb3VudCcpXG4gICAgICAgIC5zZXQodG9waWNDdHJsLnByb2ZpbGUuc3RhdC5jb21tZW50LmNvdW50ICsgMSk7XG5cbiAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvdG9waWNzLycrdG9waWNPYmouJGlkKVxuICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG4gICAgLy9SZXBseSBpbiByZXBseVxuICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbih0b3BpY0lkLHJlcGx5SWQpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUluUmVwbHlBcnIodG9waWNJZCxyZXBseUlkKS4kYWRkKHtcbiAgICAgICAgYm9keTogICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkuYm9keSxcbiAgICAgICAgdWlkOiAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KVxuICAgIH1cblxuXG5cbiAgICB0b3BpY0N0cmwuYWRkTmV3Q2hvaWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbmV3SXRlbU5vID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aCsxO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnB1c2goeydpZCc6J2NyaXRlcmlhJytuZXdJdGVtTm99KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLnJlbW92ZUNob2ljZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxhc3RJdGVtID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aC0xO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnNwbGljZShsYXN0SXRlbSk7XG4gICAgfTtcblxuXG4gICAgLy9DcmVhdGUgbmV3IHRvcGljXG4gICAgdG9waWNDdHJsLmNyZWF0ZVRvcGljID0gZnVuY3Rpb24oY2F0ZWdvcnksaXNEcmFmdCl7XG5cbiAgICAgIC8vQ2hlY2sgaWYgd2UgaGF2ZSBsb2NhdGlvbiBkZXRhaWxzXG4gICAgICB2YXIgbG9jYXRpb25EZXRhaWwgPSAnJztcblxuICAgICAgaWYodG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uICE9PSAnJyApe1xuICAgICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24pO1xuICAgICAgICBsb2NhdGlvbkRldGFpbCA9IHtcbiAgICAgICAgICBwbGFjZV9pZDogdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgc2x1ZzogICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5uYW1lKSxcbiAgICAgICAgICBuYW1lOiAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMubmFtZSxcbiAgICAgICAgICBhZGRyZXNzOiAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgLyogREVCVUcgRk9STSBWQUxVRVxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgdHlwZTogICAgICAgICAgIHRvcGljQ3RybC50eXBlLFxuICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgIHRvcGljOiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgIGJvZHk6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuYm9keSxcbiAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICB1aWQ6ICAgICAgICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICBwaG90b3M6ICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyxcbiAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgIGxvY2F0aW9uOiAgICAgICBsb2NhdGlvbkRldGFpbCxcbiAgICAgICAgdXJsOiAgICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy51cmwsXG4gICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICBjcmVhdGVkOiAgICAgICAgbW9tZW50KCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdGFnczogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLFxuICAgICAgICB1c2VySVA6ICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm9cbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICovXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MuYXJyLiRhZGQoe1xuICAgICAgICAgIHR5cGU6ICAgICAgICAgICB0b3BpY0N0cmwudHlwZSxcbiAgICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgICAgdG9waWM6ICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyxcbiAgICAgICAgICBib2R5OiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmJvZHksXG4gICAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICAgIHVpZDogICAgICAgICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICAgIC8vc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICAgIHNsdWc6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgICAgcGhvdG9zOiAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MsXG4gICAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgICAgbG9jYXRpb246ICAgICAgIGxvY2F0aW9uRGV0YWlsLFxuICAgICAgICAgIHVybDogICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudXJsLFxuICAgICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICAgIGNyZWF0ZWQ6ICAgICAgICBtb21lbnQoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHRhZ3M6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudGFncyxcbiAgICAgICAgICB1c2VySVA6ICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mbyxcbiAgICAgICAgICByZXZpZXc6ICAgICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHRvcGljKXtcblxuICAgICAgICAgIHZhciBzbHVnVGV4dCA9Jyc7XG4gICAgICAgICAgLy9pZiB3ZSBhcmUgdW5hYmxlIHRvIGNvbnZlcnQgdG8gc2x1ZyB0aGVuIHdlIHVzZSB0aGUgdG9waWMgdGV4dCwgZWxzZSB1c2Ugc2x1Z1xuICAgICAgICAgIGlmKFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpID09Jycpe1xuICAgICAgICAgICAgc2x1Z1RleHQgPSB0b3BpY0N0cmwubmV3VG9waWMudG9waWM7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBzbHVnVGV4dCA9IFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vVXBkYXRlIHNsdWcgd2l0aCB0b3BpYyBLZXlcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLmdldFRvcGljQnlLZXkodG9waWMua2V5KCkpLnVwZGF0ZSh7XCJzbHVnXCI6c2x1Z1RleHQrdG9waWMua2V5KCl9KTtcblxuICAgICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKVxuICAgICAgICAgICAgLnNldCh0b3BpY0N0cmwucHJvZmlsZS5zdGF0LnBvc3RlZC5jb3VudCArIDEpO1xuXG4gICAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL3RvcGljcy8nK3RvcGljLmtleSgpKVxuICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAvL0lmIHRoZXJlIGlzIGxvY2F0aW9uXG4gICAgICAgICAgaWYobG9jYXRpb25EZXRhaWwgIT09ICcnKXtcblxuICAgICAgICAgICAgdG9waWNDdHJsLnBsYWNlcy5hZGRDaGlsZChsb2NhdGlvbkRldGFpbC5wbGFjZV9pZClcbiAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQodG9waWMua2V5KCkpXG4gICAgICAgICAgICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAgIHRvcGljQ3RybC5wbGFjZXMuYWRkQ2hpbGQobG9jYXRpb25EZXRhaWwucGxhY2VfaWQpXG4gICAgICAgICAgICAgIC5jaGlsZCgnaW5mbycpLnNldChsb2NhdGlvbkRldGFpbCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9pZiB0aGVyZSBhcmUgdGFnc1xuICAgICAgICAgIGlmKHRvcGljQ3RybC5uZXdUb3BpYy50YWdzICE9PSBudWxsKXtcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0b3BpY0N0cmwubmV3VG9waWMudGFncy5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgICAgICAgdG9waWNDdHJsLnRhZ3MuYWRkQ2hpbGQodG9waWNDdHJsLm5ld1RvcGljLnRhZ3NbaW5kZXhdLnRleHQpXG4gICAgICAgICAgICAgICAgLmNoaWxkKHRvcGljLmtleSgpKS5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vTm90aWZ5IGZvbGxvd2VyXG4gICAgICAgICAgdG9waWNDdHJsLm5vdGkubm90aWZ5Rm9sbG93ZXIodG9waWMua2V5KCksdG9waWNDdHJsLnVpZCk7XG5cblxuICAgICAgICAgIC8vUmVzZXQgZm9ybSBoZXJlXG4gICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljID0ge1xuICAgICAgICAgICAgYm9keTogJydcbiAgICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy9DaGVjayBpZiB1c2VyIGlzIGFscmVhZHkgZm9sbG93aW5nIHVzZXJcbiAgICB0b3BpY0N0cmwuY2hlY2tGb2xsb3cgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcbiAgICAgIGlmKHRvcGljQ3RybC51c2Vycy5jaGVja0ZvbGxvdyh0b3BpY0N0cmwudWlkLGZvbGxvd191aWQpKXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9Gb2xsb3cgVXNlclxuICAgIHRvcGljQ3RybC5mb2xsb3dVc2VyID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBiZWluZyBmb2xsb3csIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93ZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKGZvbGxvd191aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50ICsgMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvdWlkLycrIHRvcGljQ3RybC51aWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICB9KTtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGlzIGZvbGxvd2luZywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dpbmdcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCArIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy91aWQvJysgZm9sbG93X3VpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9VbmZvbGxvdyBVc2VyXG4gICAgdG9waWNDdHJsLnVuZm9sbG93VXNlciA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgYmVpbmcgZm9sbG93LCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2VyXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZShmb2xsb3dfdWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL3VpZC8nKyB0b3BpY0N0cmwudWlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgaXMgZm9sbG93aW5nLCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2luZ1xuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2luZy5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy91aWQvJysgZm9sbG93X3VpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuICAgIH1cblxuXG5cbiAgICAgLy91cHZvdGVcbiAgICB0b3BpY0N0cmwudXB2b3RlID0gZnVuY3Rpb24odG9waWMpe1xuXG4gICAgICBpZih0b3BpYy5kb3dudm90ZXMgIT0gdW5kZWZpbmVkICYmIHRvcGljLmRvd252b3Rlc1t0b3BpY0N0cmwudWlkXSAhPSB1bmRlZmluZWQpe1xuICAgICAgICB0b3BpY0N0cmwuY2FuY2VsRG93bnZvdGUodG9waWMpO1xuICAgICAgfVxuICAgICAgdG9waWNDdHJsLnRvcGljcy51cHZvdGVUb3BpYyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLiR2YWx1ZSk7XG5cbiAgICAgICAgLy9TdGF0IHVwZGF0ZVxuICAgICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpYy51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC51cHZvdGVkLmNvdW50ICsgMSk7XG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC90b3BpY3MvJyt0b3BpYy4kaWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmNhbmNlbFVwdm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5kb1Vwdm90ZSh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpYy51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgLy9TdGF0IHVwZGF0ZVxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LnVwdm90ZWQuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvdG9waWNzLycrdG9waWMuJGlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG5cbiAgICAgIHRvcGljQ3RybC51c2VyVXB2b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgICAvL2Rvd252b3RlXG4gICAgdG9waWNDdHJsLmRvd252b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgaWYodG9waWMudXB2b3RlcyAhPSB1bmRlZmluZWQgJiYgdG9waWMudXB2b3Rlc1t0b3BpY0N0cmwudWlkXSAhPSB1bmRlZmluZWQpe1xuICAgICAgICB0b3BpY0N0cmwuY2FuY2VsVXB2b3RlKHRvcGljKTtcbiAgICAgIH1cbiAgICAgIHRvcGljQ3RybC50b3BpY3MuZG93bnZvdGVUb3BpYyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJEb3dudm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuJHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwuY2FuY2VsRG93bnZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZG9Eb3dudm90ZSh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJEb3dudm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gICAgLy9mb2xsb3cgdG9waWNcbiAgICB0b3BpY0N0cmwuZm9sbG93VG9waWMgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLmZvbGxvdyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJGb2xsb3dpbmcuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuaGlzdG9yeVt0b3BpY0N0cmwudWlkXSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLnVuZm9sbG93VG9waWMgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZm9sbG93KHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgfV0pO1xuXG5cbi8vaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va2F0b3d1bGYvNjA5OTA0MlxuZnVuY3Rpb24gbW92ZUZiUmVjb3JkKG9sZFJlZiwgbmV3UmVmKSB7XG4gIG9sZFJlZi5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgbmV3UmVmLnNldChzbmFwLnZhbCgpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgb2xkUmVmLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodHlwZW9mKGNvbnNvbGUpICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC8vIFRvcGljIGxpc3RcbiAgLmZhY3RvcnkoJ1RvcGljcycsIFtcIiRmaXJlYmFzZU9iamVjdFwiLCBcIiRmaXJlYmFzZUFycmF5XCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24gKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKSB7XG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MnKVxuICAgIHZhciB0b3BpY3MgPSAkZmlyZWJhc2VPYmplY3QocmVmKVxuICAgIHZhciB0b3BpY3NBcnIgPSAkZmlyZWJhc2VBcnJheShyZWYpXG4gICAgdmFyIHRvcGljS2V5ID0gJydcblxuICAgIHZhciBUb3BpY3MgPSB7XG4gICAgICAvLyBHZXQgdG9waWMgdGFnXG4gICAgICBnZXRUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBHZXQgdG9waWMgc2x1Z1xuICAgICAgZ2V0U2x1ZzogZnVuY3Rpb24gKHNsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyhzbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldHRpbmcgdGhlIGxpc3Qgb2YgdG9waWNzIGNyZWF0ZWQgYnkgdXNlcl9pZFxuICAgICAgY3JlYXRlZEJ5OiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd1aWQnKS5lcXVhbFRvKHVpZCkpXG5cbiAgICAgIH0sXG4gICAgICByZWZDaGlsZDogZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpXG4gICAgICB9LFxuICAgICAgY291bnRVc2VyVG9waWNzOiBmdW5jdGlvbiAoKSB7fSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpYyBiYXNlIG9uIGNhdGVnb3J5XG4gICAgICBsaXN0OiBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdjYXRlZ29yeScpLmVxdWFsVG8oY2F0ZWdvcnkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgbmFtZTogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBSZWZcbiAgICAgIGZvcnRvcGljUmVmOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gcmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZylcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlLZXk6IGZ1bmN0aW9uICh0b3BpY19rZXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MvJyArIHRvcGljX2tleSlcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlTbHVnOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZykubGltaXRUb0ZpcnN0KDEpKVxuICAgICAgfSxcblxuICAgICAgaW5jcmVtZW50VmlldzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHt9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBhcnJheVxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShUb3BpY3MuZm9ydG9waWNSZWYodG9waWNfc2x1ZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBsaXN0aW5nXG4gICAgICByZXBseUxpc3Q6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IEFycmF5XG4gICAgICByZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzJykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBjb3VudFxuICAgICAgcmVwbHlDb3VudDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nKSlcbiAgICAgIH0sXG4gICAgICByZXBseUNvdW50UmVmOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvY291bnQnKVxuICAgICAgfSxcblxuICAgICAgcmVwbHlJblJlcGx5OiBmdW5jdGlvbiAodG9waWNJZCwgcmVwbHlJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJyArIHJlcGx5SWQgKyAnL2luUmVwbHknKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGluIFJlcGx5IEFycmF5XG4gICAgICByZXBseUluUmVwbHlBcnI6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycrcmVwbHlJZCsnL2luUmVwbHknKSkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gdXB2b3Rlc1xuICAgICAgZ2V0VXB2b3RlczogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByZWY6IHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGRvd252b3Rlc1xuICAgICAgZ2V0RG93bnZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLFxuICAgICAgICAgIGFycmF5OiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGZvbGxvd2Vyc1xuICAgICAgZ2V0Rm9sbG93ZXJzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgdXB2b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykuY2hpbGQodWlkKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZG9VcHZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpXG4gICAgICB9LFxuXG4gICAgICBkb3dudm90ZVRvcGljOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb0Rvd252b3RlOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnZhbHVlID09PSBudWxsIHx8IGRhdGEudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlICsgMSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykpXG4gICAgICB9LFxuXG4gICAgICB1bmZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlIC0gMSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJylcbiAgICAgIH0sXG5cbiAgICAgIGdldFZpZXdzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkKS5jaGlsZCgndmlld3MnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgbGF0ZXN0RmVlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnY3JlYXRlZCcpLmxpbWl0VG9MYXN0KDEwKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljc0J5VGFnOiBmdW5jdGlvbiAodGFnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd0YWdzJykuZXF1YWxUbyh0YWcpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmV0dXJuIGFycmF5XG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXG5cbiAgICAgIGFsbDogdG9waWNzLFxuICAgICAgcmVmOiByZWZcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRvcGljc1xuXG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIFtcIiRzY29wZVwiLCBcIiRyb290U2NvcGVcIiwgXCIkc3RhdGVcIiwgXCIkZmlsdGVyXCIsIFwibWQ1XCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIFwiVG9waWNzXCIsIFwiRmFjZWJvb2tcIiwgXCJub3RpZnlcIiwgXCJDYXRlU2VydmljZVwiLCBcInByb2ZpbGVcIiwgXCJpc093bmVyXCIsIFwidXNlclBvc3RzXCIsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCAkZmlsdGVyLCBtZDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXV0aCxVc2VycyxUb3BpY3MsIEZhY2Vib29rLG5vdGlmeSxDYXRlU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUsaXNPd25lcix1c2VyUG9zdHMpe1xuXG4gICAgY29uc29sZS5sb2coXCJQcm9maWxlQ3RybFwiKTtcblxuICAgIHZhciBwcm9maWxlQ3RybCA9IHRoaXM7XG5cbiAgICAvL1BhcnNlclxuICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUgICA9IHByb2ZpbGU7XG4gICAgcHJvZmlsZUN0cmwuYXV0aCAgICAgID0gQXV0aDtcbiAgICBwcm9maWxlQ3RybC51c2VycyAgICAgPSBVc2VycztcbiAgICBwcm9maWxlQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgcHJvZmlsZUN0cmwuZmFjZWJvb2sgID0gRmFjZWJvb2s7XG4gICAgcHJvZmlsZUN0cmwuaXNPd25lciAgID0gaXNPd25lcjtcbiAgICBwcm9maWxlQ3RybC5jYXRlICAgICAgPSBDYXRlU2VydmljZTtcbiAgICBwcm9maWxlQ3RybC4kc3RhdGUgICAgPSAkc3RhdGU7XG4gICAgcHJvZmlsZUN0cmwudXNlclBvc3RzID0gdXNlclBvc3RzO1xuXG4gICAgcHJvZmlsZUN0cmwudXNlckZlZWQgID0gJyc7XG4gICAgcHJvZmlsZUN0cmwuZmVlZCA9ICcnO1xuXG4gICAgcHJvZmlsZUN0cmwuZWRpdEluaXQgPSAndXNlckVkaXQnO1xuXG4gICAgcHJvZmlsZUN0cmwubmFtZUV4aXN0PSBmYWxzZTtcblxuXG4gICAgcHJvZmlsZUN0cmwuZ2V0VXNlclBvc3QgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZmVlZCA9IHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuXG4gICAgLypMaW5rIGFjY291bnQgd2l0aCBmYWNlYm9vayovXG4gICAgcHJvZmlsZUN0cmwubGlua0ZhY2Vib29rID0gZnVuY3Rpb24oKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmxvZ2luKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmdldExvZ2luU3RhdHVzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9nZ2VkSW4gPSB0cnVlO1xuICAgICAgICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2suYXBpKCcvbWUnLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdCBsb2dnZWQgaW5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9UaGUgb3JpZ2luYWwgdmFsdWUgZnJvbSBwcm9maWxlXG4gICAgcHJvZmlsZUN0cmwub2xkUHJvZmlsZVZhbHVlID0gcHJvZmlsZUN0cmwucHJvZmlsZTtcblxuXG4gICAgcHJvZmlsZUN0cmwudXNlckNyZWF0ZWQgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcmV0dXJuIHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuICAgIC8vUHJlc2V0IFBhcmFtZXRlcnNcbiAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3MgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC51c2VyQ2F0ZUZvbGxvdyAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5mb2xsb3dMaXN0ICAgICAgPSAnJztcblxuXG5cblxuXG4gICAgcHJvZmlsZUN0cmwuZm9sbG93Q2F0ZUxpc3RBcnIgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZm9sbG93TGlzdCA9IHByb2ZpbGVDdHJsLmNhdGUuZm9sbG93TGlzdCh1aWQpO1xuICAgIH1cblxuICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XG4gICAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlTGlzdEFycihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICB9XG5cbiAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlID0gZnVuY3Rpb24oaW5kZXgsY2F0ZV9zbHVnKXtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGVJc0ZvbGxvd1tpbmRleF0gID0gdHJ1ZTtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG5cblxuICAgIC8vVXBsb2FkIFByb2ZpbGUgaW1hZ2VcbiAgICBwcm9maWxlQ3RybC51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpKSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3NbaV0gPSB1cmk7XG4gICAgICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wicGhvdG9cIjogdXJpfSlcbiAgICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGZsb3dGaWxlLmZpbGUpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICAvL1NhdmUgcHJvZmlsZSB3aXRoIHByb2ZpbGVDdHJsLnByb2ZpbGVcbiAgICAvL3BhcmFtczogcmVkaXJlY3QsIGlmIGV4aXN0IHRoZW4gcmVkaXJlY3QgYWZ0ZXIgc2F2ZVxuICAgIHByb2ZpbGVDdHJsLnNhdmVQcm9maWxlID0gZnVuY3Rpb24ocmVkaXJlY3Qpe1xuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS51cGRhdGVkID0gbW9tZW50KCkudG9JU09TdHJpbmcoKTtcblxuXG4gICAgICBpZihwcm9maWxlQ3RybC5sb2NhdGlvbiAhPT0gbnVsbCApIHtcbiAgICAgICAgbG9jYXRpb25EZXRhaWwgPSB7XG4gICAgICAgICAgcGxhY2VfaWQ6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5uYW1lLFxuICAgICAgICAgIGFkZHJlc3M6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgfVxuXG4gICAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUudXNlckxvY2F0aW9uID0gbG9jYXRpb25EZXRhaWw7XG4gICAgICB9XG5cbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgaWYocmVkaXJlY3QgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgJHN0YXRlLmdvKHJlZGlyZWN0KTtcbiAgICAgICAgfVxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgbm90aWZ5KHttZXNzYWdlOidFcnJvciBzYXZpbmcgZGF0YScscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVXBkYXRlIG5hbWVcbiAgICBwcm9maWxlQ3RybC51cGRhdGVOYW1lID0gZnVuY3Rpb24oKXtcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICBcImZpcnN0bmFtZVwiOiAgcHJvZmlsZUN0cmwucHJvZmlsZS5maXJzdG5hbWUsXG4gICAgICAgICAgXCJsYXN0bmFtZVwiOiAgIHByb2ZpbGVDdHJsLnByb2ZpbGUubGFzdG5hbWUsXG4gICAgICAgIH1cbiAgICAgIClcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKycvbG9nJykucHVzaCgpLnNldCh7XG4gICAgICAgIGFjdGlvbjogICBcIm5hbWVfY2hhbmdlXCIsXG4gICAgICAgIG9sZG5hbWU6ICBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUuZmlyc3RuYW1lICsgXCItXCIgKyBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUubGFzdG5hbWUsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VwZGF0ZSBCaW9cbiAgICBwcm9maWxlQ3RybC51cGRhdGVCaW8gPSBmdW5jdGlvbigpe1xuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wiYmlvZ3JhcGh5XCI6IHByb2ZpbGVDdHJsLnByb2ZpbGUuYmlvZ3JhcGh5fSlcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICBwcm9maWxlQ3RybC51cGRhdGVQcm9maWxlID0gZnVuY3Rpb24oKXtcbiAgICAgIC8vcHJvZmlsZUN0cmwucHJvZmlsZS5lbWFpbEhhc2ggPSBtZDUuY3JlYXRlSGFzaChhdXRoLnBhc3N3b3JkLmVtYWlsKTtcbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL0NoZWNrIGlmIHVzZXIgZXhpc3QsIHJldHVybiBmYWxzZSBpZiB0aGV5IGRvXG4gICAgcHJvZmlsZUN0cmwuY2hlY2tVc2VybmFtZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLmNoZWNrVXNlcm5hbWVFeGlzdChwcm9maWxlQ3RybC5wcm9maWxlLmRpc3BsYXlOYW1lKS5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgIGlmKHNuYXBzaG90LnZhbCgpICE9PSBudWxsKXtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PXRydWU7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PWZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmZhY3RvcnkoJ1VzZXJzJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCIkZmlyZWJhc2VPYmplY3RcIiwgXCJGaXJlYmFzZVVybFwiLCBcIiRodHRwXCIsIGZ1bmN0aW9uICgkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCwgJGh0dHApIHtcbiAgICB2YXIgdXNlcnNSZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwgKyAndXNlcnMnKVxuICAgIHZhciB1c2VycyA9ICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmKVxuXG4gICAgdmFyIFVzZXJzID0ge1xuICAgICAgZ2V0TG9jYXRpb25JUDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgIHVybDogJ2h0dHA6Ly9pcGluZm8uaW8vanNvbicsXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9KVxuICAgICAgfSxcblxuICAgICAgZ2V0TG9jYXRpb25JUERhdGE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxuICAgICAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHJldHVybiBkYXRhLmRhdGFcbiAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHJldHVybiB1c2Vycy4kZ2V0UmVjb3JkKHVpZCk7XG4gICAgICB9LFxuXG5cbiAgICAgIC8vU2VhcmNoIGFuZCByZXR1cm4gdXNlcm5hbWVcbiAgICAgIGdldFByb2ZpbGVCeVVzZXJuYW1lOmZ1bmN0aW9uKHVzZXJuYW1lKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmLm9yZGVyQnlDaGlsZCgnZGlzcGxheU5hbWUnKS5lcXVhbFRvKHVzZXJuYW1lKSk7XG4gICAgICB9LFxuXG4gICAgICAvL0NoZWNrIGlmIHVzZXJuYW1lIGV4aXN0LCBpZiBub3QgcmV0dXJuIG51bGxcbiAgICAgIGNoZWNrVXNlcm5hbWVFeGlzdDpmdW5jdGlvbih1c2VybmFtZSl7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5vcmRlckJ5Q2hpbGQoJ2Rpc3BsYXlOYW1lJykuZXF1YWxUbyh1c2VybmFtZSk7XG4gICAgICB9LFxuXG5cbiAgICAgIGdldFByb2ZpbGU6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgZ2V0RGlzcGxheU5hbWU6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgaWYgKHVpZCAhPT0gbnVsbCB8fCB1aWQgIT09ICcnKSB7XG4gICAgICAgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5kaXNwbGF5TmFtZTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy9HZXQgdXNlciBGb2xsb3dlcnNcbiAgICAgIGdldEZvbGxvd2VyOmZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQrJy9zdGF0L2ZvbGxvd2VyL3VpZCcpO1xuICAgICAgfSxcblxuICAgICAgLy9DaGVjayBpZiB1c2VyIGlzIGFscmVhZHkgZm9sbG93aW5nXG4gICAgICBjaGVja0ZvbGxvdzpmdW5jdGlvbih1aWQsZm9sbG93X2lkKXtcblxuICAgICAgICB2YXIgZm9sbG93PWZhbHNlO1xuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd1c2Vycy8nK3VpZCsnL3N0YXQvZm9sbG93aW5nL3VpZC8nK2ZvbGxvd19pZCk7XG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICBmb2xsb3cgPSBzbmFwc2hvdC5leGlzdHMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcbiAgICAgIH0sXG5cbiAgICAgIC8vQ2hhbmdlIHBhc3N3b3JkXG4gICAgICB1c2VyQ2hhbmdlUGFzc3dvcmQ6ZnVuY3Rpb24oZW1haWwsb2xkcGFzcyxuZXdwYXNzKXtcblxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcbiAgICAgICAgcmVmLmNoYW5nZVBhc3N3b3JkKHtcbiAgICAgICAgICBlbWFpbDogZW1haWwsXG4gICAgICAgICAgb2xkUGFzc3dvcmQ6IG9sZHBhc3MsXG4gICAgICAgICAgbmV3UGFzc3dvcmQ6IG5ld3Bhc3NcbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZXJyb3IuY29kZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiSU5WQUxJRF9QQVNTV09SRFwiOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgcGFzc3dvcmQgaXMgaW5jb3JyZWN0LlwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcIklOVkFMSURfVVNFUlwiOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgZG9lcyBub3QgZXhpc3QuXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgY2hhbmdpbmcgcGFzc3dvcmQ6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIHBhc3N3b3JkIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgdXNlclJlZjogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKVxuICAgICAgfSxcblxuICAgICAgdXB2b3RlczogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKS5jaGlsZCgndXB2b3RlcycpXG4gICAgICB9LFxuXG4gICAgICBkb3dudm90ZXM6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2Rvd252b3RlcycpXG4gICAgICB9LFxuXG4gICAgICAvL1VzZXIgZm9sbG93aW5nIHRvcGljXG4gICAgICBmb2xsb3dpbmc6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2ZvbGxvd2luZycpXG4gICAgICB9LFxuXG4gICAgICB1c2VyQXJyUmVmOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpXG4gICAgICB9LFxuXG4gICAgICBhbGw6IHVzZXJzXG4gICAgfVxuXG4gICAgcmV0dXJuIFVzZXJzXG4gIH1dKVxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnVW5pcXVlSURHZW5lcmF0b3InLCBmdW5jdGlvbigpeyAgXHJcbiAgICAvKipcclxuICAgICAqIEZhbmN5IElEIGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgMjAtY2hhcmFjdGVyIHN0cmluZyBpZGVudGlmaWVycyB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICAgICAqXHJcbiAgICAgKiAxLiBUaGV5J3JlIGJhc2VkIG9uIHRpbWVzdGFtcCBzbyB0aGF0IHRoZXkgc29ydCAqYWZ0ZXIqIGFueSBleGlzdGluZyBpZHMuXHJcbiAgICAgKiAyLiBUaGV5IGNvbnRhaW4gNzItYml0cyBvZiByYW5kb20gZGF0YSBhZnRlciB0aGUgdGltZXN0YW1wIHNvIHRoYXQgSURzIHdvbid0IGNvbGxpZGUgd2l0aCBvdGhlciBjbGllbnRzJyBJRHMuXHJcbiAgICAgKiAzLiBUaGV5IHNvcnQgKmxleGljb2dyYXBoaWNhbGx5KiAoc28gdGhlIHRpbWVzdGFtcCBpcyBjb252ZXJ0ZWQgdG8gY2hhcmFjdGVycyB0aGF0IHdpbGwgc29ydCBwcm9wZXJseSkuXHJcbiAgICAgKiA0LiBUaGV5J3JlIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZy4gIEV2ZW4gaWYgeW91IGdlbmVyYXRlIG1vcmUgdGhhbiBvbmUgaW4gdGhlIHNhbWUgdGltZXN0YW1wLCB0aGVcclxuICAgICAqICAgIGxhdHRlciBvbmVzIHdpbGwgc29ydCBhZnRlciB0aGUgZm9ybWVyIG9uZXMuICBXZSBkbyB0aGlzIGJ5IHVzaW5nIHRoZSBwcmV2aW91cyByYW5kb20gYml0c1xyXG4gICAgICogICAgYnV0IFwiaW5jcmVtZW50aW5nXCIgdGhlbSBieSAxIChvbmx5IGluIHRoZSBjYXNlIG9mIGEgdGltZXN0YW1wIGNvbGxpc2lvbikuXHJcbiAgICAgKi9cclxuICAgICByZXR1cm4ge1xyXG5cclxuICAgICAgICBnZW5lcmF0ZVB1c2hJRDpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgIC8vIE1vZGVsZWQgYWZ0ZXIgYmFzZTY0IHdlYi1zYWZlIGNoYXJzLCBidXQgb3JkZXJlZCBieSBBU0NJSS5cclxuICAgICAgICAgICAgdmFyIFBVU0hfQ0hBUlMgPSAnLTAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWl9hYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eic7XHJcblxyXG4gICAgICAgICAgICAvLyBUaW1lc3RhbXAgb2YgbGFzdCBwdXNoLCB1c2VkIHRvIHByZXZlbnQgbG9jYWwgY29sbGlzaW9ucyBpZiB5b3UgcHVzaCB0d2ljZSBpbiBvbmUgbXMuXHJcbiAgICAgICAgICAgIHZhciBsYXN0UHVzaFRpbWUgPSAwO1xyXG5cclxuICAgICAgICAgICAgLy8gV2UgZ2VuZXJhdGUgNzItYml0cyBvZiByYW5kb21uZXNzIHdoaWNoIGdldCB0dXJuZWQgaW50byAxMiBjaGFyYWN0ZXJzIGFuZCBhcHBlbmRlZCB0byB0aGVcclxuICAgICAgICAgICAgLy8gdGltZXN0YW1wIHRvIHByZXZlbnQgY29sbGlzaW9ucyB3aXRoIG90aGVyIGNsaWVudHMuICBXZSBzdG9yZSB0aGUgbGFzdCBjaGFyYWN0ZXJzIHdlXHJcbiAgICAgICAgICAgIC8vIGdlbmVyYXRlZCBiZWNhdXNlIGluIHRoZSBldmVudCBvZiBhIGNvbGxpc2lvbiwgd2UnbGwgdXNlIHRob3NlIHNhbWUgY2hhcmFjdGVycyBleGNlcHRcclxuICAgICAgICAgICAgLy8gXCJpbmNyZW1lbnRlZFwiIGJ5IG9uZS5cclxuICAgICAgICAgICAgdmFyIGxhc3RSYW5kQ2hhcnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgdmFyIGR1cGxpY2F0ZVRpbWUgPSAobm93ID09PSBsYXN0UHVzaFRpbWUpO1xyXG4gICAgICAgICAgICAgIGxhc3RQdXNoVGltZSA9IG5vdztcclxuXHJcbiAgICAgICAgICAgICAgdmFyIHRpbWVTdGFtcENoYXJzID0gbmV3IEFycmF5KDgpO1xyXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSA3OyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgdGltZVN0YW1wQ2hhcnNbaV0gPSBQVVNIX0NIQVJTLmNoYXJBdChub3cgJSA2NCk7XHJcbiAgICAgICAgICAgICAgICAvLyBOT1RFOiBDYW4ndCB1c2UgPDwgaGVyZSBiZWNhdXNlIGphdmFzY3JpcHQgd2lsbCBjb252ZXJ0IHRvIGludCBhbmQgbG9zZSB0aGUgdXBwZXIgYml0cy5cclxuICAgICAgICAgICAgICAgIG5vdyA9IE1hdGguZmxvb3Iobm93IC8gNjQpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAobm93ICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ1dlIHNob3VsZCBoYXZlIGNvbnZlcnRlZCB0aGUgZW50aXJlIHRpbWVzdGFtcC4nKTtcclxuXHJcbiAgICAgICAgICAgICAgdmFyIGlkID0gdGltZVN0YW1wQ2hhcnMuam9pbignJyk7XHJcblxyXG4gICAgICAgICAgICAgIGlmICghZHVwbGljYXRlVGltZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDY0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHRpbWVzdGFtcCBoYXNuJ3QgY2hhbmdlZCBzaW5jZSBsYXN0IHB1c2gsIHVzZSB0aGUgc2FtZSByYW5kb20gbnVtYmVyLCBleGNlcHQgaW5jcmVtZW50ZWQgYnkgMS5cclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDExOyBpID49IDAgJiYgbGFzdFJhbmRDaGFyc1tpXSA9PT0gNjM7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICBsYXN0UmFuZENoYXJzW2ldID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxhc3RSYW5kQ2hhcnNbaV0rKztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlkICs9IFBVU0hfQ0hBUlMuY2hhckF0KGxhc3RSYW5kQ2hhcnNbaV0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZihpZC5sZW5ndGggIT0gMjApIHRocm93IG5ldyBFcnJvcignTGVuZ3RoIHNob3VsZCBiZSAyMC4nKTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGlkO1xyXG4gICAgICAgICAgICAvLyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIH0pIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdBdXRoQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSxBdXRoLCBVc2VycywgJHN0YXRlLCRyb290U2NvcGUsJG1kU2lkZW5hdiwkdHJhbnNsYXRlLCAkY29va2llcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aVNlcnZpY2UsJG5vdGlmaWNhdGlvbil7XG5cbiAgICBjb25zb2xlLmxvZyhcImF1dGhDdHJsXCIpO1xuXG4gICAgdmFyIGF1dGhDdHJsID0gdGhpcztcblxuICAgIC8vQXNrIGZvciBub3RpZmljYXRpb24gcGVybWlzc2lvblxuICAgICRub3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHBlcm1pc3Npb24pIHtcbiAgICAgICAgY29uc29sZS5sb2cocGVybWlzc2lvbik7IC8vIGRlZmF1bHQsIGdyYW50ZWQsIGRlbmllZFxuICAgICAgfSk7XG5cbiAgICAvL1BhcnNlclxuICAgIGF1dGhDdHJsLmF1dGggICAgID0gQXV0aDtcbiAgICBhdXRoQ3RybC51c2VycyAgICA9IFVzZXJzO1xuICAgIGF1dGhDdHJsLm5vdGlmaWNhdGlvbiA9IE5vdGlTZXJ2aWNlO1xuXG5cbiAgICBpZihBdXRoLnJlZi5nZXRBdXRoKCkgIT0gbnVsbCApe1xuICAgICAgYXV0aEN0cmwucHJvZmlsZSAgPSBhdXRoQ3RybC51c2Vycy5nZXRQcm9maWxlKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgYXV0aEN0cmwucHJvZmlsZSA9JydcbiAgICB9XG5cblxuICAgIGF1dGhDdHJsLnVzZXIgPSB7XG4gICAgICBlbWFpbDogJycsXG4gICAgICBwYXNzd29yZDogJydcbiAgICB9O1xuXG5cblxuICAgIC8vR2V0IHRoZSBiYWRnZSBub3RpZmljYXRpb25cbiAgICAvKmF1dGhDdHJsLmJhZGdlTm90aWZpY2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgIHJldHVybiBhdXRoQ3RybC5ub3RpZmljYXRpb24uYWRkQXJyQ2hpbGQoYXV0aEN0cmwucHJvZmlsZS4kaWQgKyAnL3VucmVhZCcpLiRsb2FkZWQoKTtcbiAgICB9XG5cbiAgICBhdXRoQ3RybC5iYWRnZVZhbHVlID0gYXV0aEN0cmwuYmFkZ2VOb3RpZmljYXRpb247XG5cbiAgICBjb25zb2xlLmxvZyhhdXRoQ3RybC5iYWRnZU5vdGlmaWNhdGlvbik7Ki9cblxuICAgICRzY29wZS5iYWRnZU5vdGlmY2F0aW9uID0gYXV0aEN0cmwuYmFkZ2VOb3RpZmljYXRpb247XG5cbiAgICAvL1Jlc2V0IGNvdW50ZXJcbiAgICBhdXRoQ3RybC5yZXNldENvdW50ZXIgPSBmdW5jdGlvbigpe1xuICAgICAgYXV0aEN0cmwubm90aWZpY2F0aW9uLnJlc2V0VW5yZWFkKGF1dGhDdHJsLnByb2ZpbGUuJGlkKTtcbiAgICB9XG5cbiAgICBhdXRoQ3RybC5jaGFuZ2VWYWwgPSBmdW5jdGlvbigpe1xuICAgICAgY29uc29sZS5sb2coJ2JhZGdlIHZhbHVlICcrYXV0aEN0cmwuYmFkZ2VOb3RpZmljYXRpb24uJHZhbHVlKTtcblxuICAgIH1cblxuICAgIC8qJHNjb3BlLiR3YXRjaChcIm5hbWVcIiwgZnVuY3Rpb24obmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICBpZiAoJHNjb3BlLm5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAkc2NvcGUuZ3JlZXRpbmcgPSBcIkdyZWV0aW5ncyBcIiArICRzY29wZS5uYW1lO1xuICAgICAgfVxuICAgIH0pOyovXG5cblxuICAgIC8vQ2hhbmdlIGxhbmd1YWdlXG4gICAgYXV0aEN0cmwudG9nZ2xlTGFuZyA9IGZ1bmN0aW9uIChsYW5nS2V5KSB7XG4gICAgICAkdHJhbnNsYXRlLnVzZShsYW5nS2V5KTtcbiAgICAgIC8vIFNldHRpbmcgYSBjb29raWVcbiAgICAgICRjb29raWVzLnB1dCgndXNlckxhbmcnLCBsYW5nS2V5KTtcbiAgICAgIC8vSWYgdXNlciByZWdpc3RlcmVkIC0gdXBkYXRlIHRoaXMgaW4gdGhlaXIgcHJlZmVyZW5jZVxuICAgICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpKXtcbiAgICAgICAgYXV0aEN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wibGFuZ1wiOmxhbmdLZXl9KVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vQ2hlY2trIHVzZXIgc2VsZWN0ZWQgbGFuZ3VhZ2VcbiAgICBpZighYXV0aEN0cmwucHJvZmlsZS5sYW5nKXtcbiAgICAgIGlmKCRjb29raWVzLmdldCgndXNlckxhbmcnKSl7XG4gICAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoJGNvb2tpZXMuZ2V0KCd1c2VyTGFuZycpKTtcbiAgICAgIH1lbHNle1xuICAgICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKCdFbmcnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoYXV0aEN0cmwucHJvZmlsZS5sYW5nKTtcbiAgICB9XG5cblxuICAgIC8vTG9naW5cbiAgICBhdXRoQ3RybC5sb2dpbiA9IGZ1bmN0aW9uICgpe1xuICAgICAgYXV0aEN0cmwuYXV0aC5hdXRoLiRhdXRoV2l0aFBhc3N3b3JkKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKGF1dGgpe1xuICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcbiAgICAgICAgYXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvL0xvZ291dFxuICAgIGF1dGhDdHJsLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICBBdXRoLmF1dGguJHVuYXV0aCgpO1xuICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgIH1cblxuICAgIC8vUmVnaXN0ZXIgdXNlclxuICAgIGF1dGhDdHJsLnJlZ2lzdGVyID0gZnVuY3Rpb24gKCl7XG4gICAgICBBdXRoLmF1dGguJGNyZWF0ZVVzZXIoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbiAodXNlcil7XG4gICAgICAgIGF1dGhDdHJsLmxvZ2luKCk7XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3Ipe1xuICAgICAgICBhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnQXV0aCcsIGZ1bmN0aW9uKCRmaXJlYmFzZUF1dGgsIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xyXG4gICAgdmFyIGF1dGggPSAkZmlyZWJhc2VBdXRoKHJlZik7XHJcblxyXG4gICAgdmFyIEF1dGggPSB7XHJcbiAgICAgIHJlZjpyZWYsXHJcbiAgICAgIGF1dGg6IGF1dGgsXHJcblxyXG4gICAgICBnZXRVaWQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgdWlkID0gcmVmLmdldEF1dGgoKTtcclxuICAgICAgICBpZih1aWQgIT0gbnVsbCApe1xyXG4gICAgICAgICAgcmV0dXJuIHJlZi5nZXRBdXRoKCkudWlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gQXV0aDtcclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdDYXRlQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgQ2F0ZWdvcnksY2F0ZU5hbWUsY2F0ZVRvcGljcyl7XG4gICAgdmFyIGNhdGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2Vyc1xuICAgIGNhdGVDdHJsLmNhdGVOYW1lICAgPSBjYXRlTmFtZTtcbiAgICBjYXRlQ3RybC5jYXRlZ29yeSAgID0gQ2F0ZWdvcnk7XG4gICAgY2F0ZUN0cmwuY2F0ZVRvcGljcyA9IGNhdGVUb3BpY3M7XG5cblxuICAgIGNvbnNvbGUubG9nKFwiQ2F0ZUN0cmxcIik7XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcblxyXG4gIC8vVG9waWMgbGlzdFxyXG4gIC5mYWN0b3J5KCdDYXRlU2VydmljZScsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXkgLCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzJyk7XHJcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG5cclxuICAgIHZhciBDYXRlID0ge1xyXG5cclxuICAgICAgbmFtZTogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKFwic2x1Z1wiKS5lcXVhbFRvKHRvcGljX3NsdWcpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZm9sbG93TGlzdDpmdW5jdGlvbih1aWQpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcIm5ld3MvZm9sbG93ZXJcIikuZXF1YWxUbyh1aWQpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVuRm9sbG93OmZ1bmN0aW9uKHNsdWcsdWlkKXtcclxuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzLycrc2x1ZysnL2ZvbGxvd2VyLycrdWlkKTtcclxuICAgICAgICByZWYucmVtb3ZlKCk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1c2VyRm9sbG93OmZ1bmN0aW9uKHNsdWcsdWlkKXtcclxuICAgICAgICB2YXIgZm9sbG93PWZhbHNlO1xyXG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMvJytzbHVnKycvZm9sbG93ZXIvJyt1aWQpO1xyXG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcclxuICAgICAgICAgIGZvbGxvdyA9IHNuYXBzaG90LmV4aXN0cygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcclxuICAgICAgfSxcclxuICAgICAgYXJyOiAkZmlyZWJhc2VBcnJheShyZWYpLFxyXG4gICAgICBhbGw6Y2F0ZWdvcmllc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIENhdGU7XHJcbiAgfSlcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL1RvcGljIGxpc3RcclxuICAuZmFjdG9yeSgnUG9zdCcsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndG9waWNzJyk7XHJcbiAgICB2YXIgdG9waWNzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XHJcblxyXG4gICAgdmFyIFRTID0ge1xyXG4gICAgICB0b3BpY05hbWU6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcInNsdWdcIikuZXF1YWxUbyh0b3BpY19zbHVnKTtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xyXG4gICAgICB9LFxyXG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcclxuICAgICAgfSxcclxuICAgICAgYWxsOnRvcGljc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFRTO1xyXG4gIH0pXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZEN0cmwnLCBmdW5jdGlvbihBdXRoLCAkc3RhdGUsQ2F0ZWdvcnksQ2F0ZVNlcnZpY2UsVGFncyxUb3BpY3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICB2YXIgZGFzaGJvYXJkQ3RybCA9IHRoaXM7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmF1dGggPSBBdXRoO1xuXG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlICAgICAgICA9IENhdGVTZXJ2aWNlO1xuICAgIGRhc2hib2FyZEN0cmwuY2F0ZWdvcmllcyAgPSBDYXRlZ29yeTtcbiAgICBkYXNoYm9hcmRDdHJsLnRvcGljcyAgICAgID0gVG9waWNzO1xuICAgIGRhc2hib2FyZEN0cmwudG9waWNfZ3JpZCAgPSBmYWxzZTtcbiAgICBkYXNoYm9hcmRDdHJsLnRhZ3MgICAgICAgID0gVGFncy5hcnI7XG5cbiAgICBkYXNoYm9hcmRDdHJsLnVzZXJDYXRlRm9sbG93ICA9IFtdO1xuICAgIGRhc2hib2FyZEN0cmwuY2F0ZUlzRm9sbG93ICAgID0gW107XG4gICAgZGFzaGJvYXJkQ3RybC5mb2xsb3dMaXN0ICAgICAgPSAnJztcbiAgICBkYXNoYm9hcmRDdHJsLnVzZXJGZWVkID0nbnVsbCc7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmxhdGVzdEZlZWQgPSBkYXNoYm9hcmRDdHJsLnRvcGljcy5sYXRlc3RGZWVkKCk7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmZvbGxvd0NhdGUgPSBmdW5jdGlvbihjYXRlX3NsdWcpe1xuICAgICAgZGFzaGJvYXJkQ3RybC5jYXRlLmFkZENoaWxkKGNhdGVfc2x1ZysnL2ZvbGxvd2VyJylcbiAgICAgICAgLmNoaWxkKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coXCJEYXNoYm9hcmRDdHJsXCIpO1xuICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuXG4gIC5kaXJlY3RpdmUoJ21haW5IZWFkZXInLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAgICAgJ0UnLFxuICAgICAgdHJhbnNjbHVkZTogICB0cnVlLFxuICAgICAgLy9jb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICB9XG5cbiAgfSlcblxuICAvL0JhZGdlIG5vdGlmaWNhdGlvblxuICAuZGlyZWN0aXZlKCdiYWRnZU5vdGlmaWNhdGlvbicsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXG4gICAgICB0cmFuc2NsdWRlOiAgIHRydWUsXG4gICAgICAvL2NvbnRyb2xsZXI6ICAgJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAgJ3RlbXBsYXRlcy9odG1sL2JhZGdlLW5vdGlmaWNhdGlvbi5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIG5vdGlmaWNhdGlvbjogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXG4gIC5kaXJlY3RpdmUoJ3Jldmlld1Njb3JlJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICAgJ1RvcGljQ3RybCBhcyB0b3BpY0N0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvcmV2aWV3LXN1bW1hcnktbGlzdC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHJldmlldzogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9Gb2xsb3cgQnV0dG9uXG4gIC5kaXJlY3RpdmUoJ3VzZXJGb2xsb3dlckJ0bicsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXG4gICAgICB0cmFuc2NsdWRlOiAgIHRydWUsXG4gICAgICAvL2NvbnRyb2xsZXI6ICAgJ1RvcGljQ3RybCBhcyB0b3BpY0N0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvZm9sbG93LXVzZXIuaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBmb2xsb3c6ICc9J1xuICAgICAgfVxuICAgIH1cbiAgfSlcblxuXG4gIC8vQ2F0ZWdvcnkgZm9sbG93IGJ1dHRvblxuICAuZGlyZWN0aXZlKCdjYXRlRm9sbG93QnRuJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9jYXRlZ29yeS1mb2xsb3ctYnRuLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgY2F0ZTogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG4gIC8vTGlzdCBvZiBjYXRlZ29yaWVzIG9uIHRoZSBzaWRlcmJhclxuICAuZGlyZWN0aXZlKCd0b3BpY0dyaWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWdyaWQuaHRtbCdcbiAgICB9XG4gIH0pXG5cbiAgLy9HcmlkIFRhZ3MgZm9yIHNpZGViYXJcbiAgLmRpcmVjdGl2ZSgndGFnR3JpZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdGFnLWdyaWQuaHRtbCdcbiAgICB9XG4gIH0pXG5cblxuICAuZGlyZWN0aXZlKCd0b3BpY0NyZWF0ZScsIGZ1bmN0aW9uKCl7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWNyZWF0ZS5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljOiAnPSdcbiAgICAgIH1cbiAgICB9XG5cbiAgfSlcblxuXG4gIC5kaXJlY3RpdmUoJ3RvcGljTGlzdCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWxpc3QuaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICB0b3BpY3M6ICc9J1xuICAgICAgfVxuICAgIH1cbiAgfSlcblxuXG4gIC5kaXJlY3RpdmUoJ3RvcGljQWN0aW9uc0NhcmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogJ1RvcGljQ3RybCBhcyB0b3BpY0N0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90b3BpYy1hY3Rpb25zLWNhcmQuaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICB0b3BpYzogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9mb3IgdGFncyAtIG1heCB0YWdzXG4gIC5kaXJlY3RpdmUoJ2VuZm9yY2VNYXhUYWdzJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdDdHJsKSB7XG4gICAgICB2YXIgbWF4VGFncyA9IGF0dHJzLm1heFRhZ3MgPyBwYXJzZUludChhdHRycy5tYXhUYWdzLCAnNCcpIDogbnVsbDtcblxuICAgICAgbmdDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIG1heFRhZ3MgJiYgdmFsdWUubGVuZ3RoID4gbWF4VGFncykge1xuICAgICAgICAgIHZhbHVlLnNwbGljZSh2YWx1ZS5sZW5ndGggLSAxLCAxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb25maWcoWyckdHJhbnNsYXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHRyYW5zbGF0ZVByb3ZpZGVyKSB7XHJcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIudHJhbnNsYXRpb25zKCdFbmcnLCB7XHJcbiAgICAgICdLRVlfREFTSEJPQVJEJzogICdEYXNoYm9hcmQnLFxyXG4gICAgICAnS0VZX0xBTkdVQUdFUyc6ICAnTGFuZ3VhZ2VzJyxcclxuICAgICAgJ0tFWV9IT01FJzogICAgICAgJ0hvbWUnLFxyXG4gICAgICAnS0VZX1JFR0lTVEVSJzogICAnUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX0xPR0lOJzogICAgICAnTG9nIGluJyxcclxuICAgICAgJ0tFWV9MT0dPVVQnOiAgICAgJ0xvZyBvdXQnLFxyXG4gICAgICAnS0VZX0ZPTExPVyc6ICAgICAnRm9sbG93JyxcclxuICAgICAgJ0tFWV9GT0xMT1dFUic6ICAgJ0ZvbGxvd2VyJyxcclxuICAgICAgJ0tFWV9VTkZPTExPVyc6ICAgJ1VuZm9sbG93JyxcclxuICAgICAgJ0tFWV9GT0xMT1dJTkcnOiAgJ0ZvbGxvd2luZycsXHJcbiAgICAgICdLRVlfUE9TVCc6ICAgICAgICdQb3N0JyxcclxuICAgICAgJ0tFWV9QT1NURUQnOiAgICAgJ1Bvc3RlZCcsXHJcbiAgICAgICdLRVlfVVBWT1RFJzogICAgICdVcHZvdGUnLFxyXG4gICAgICAnS0VZX1VQVk9URUQnOiAgICAnVXB2b3RlZCcsXHJcbiAgICAgICdLRVlfRFdOX1ZPVEUnOiAgICdEb3dudm90ZScsXHJcbiAgICAgICdLRVlfRFdOX1ZPVEVEJzogICdEb3dudm90ZWQnLFxyXG4gICAgICAnS0VZX1ZJRVcnOiAgICAgICAnVmlldycsXHJcbiAgICAgICdLRVlfUkVNT1ZFJzogICAgICdSZW1vdmUnLFxyXG4gICAgICAnS0VZX0NBTkNFTCc6ICAgICAnQ2FuY2VsJyxcclxuICAgICAgJ0tFWV9RVUVTVElPTic6ICAgJ1F1ZXN0aW9uJyxcclxuICAgICAgJ0tFWV9UT1BJQyc6ICAgICAgJ1RvcGljJyxcclxuICAgICAgJ0tFWV9DSEdfUFdEJzogICAgJ0NoYW5nZSBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfUEFTU1dPUkQnOiAgICdQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfT0xEX1BXRCc6ICAgICdPbGQgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX05FV19QV0QnOiAgICAnTmV3IFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9ORVdfUFdEX0MnOiAgJ05ldyBwYXNzd29yZCBjb25maXJtYXRpb24nLFxyXG4gICAgICAnS0VZX1NBVkUnOiAgICAgICAnU2F2ZScsXHJcbiAgICAgICdLRVlfU0FWRV9EUkFGVCc6ICdTYXZlIGFzIGRyYWZ0JyxcclxuICAgICAgJ0tFWV9UQUdTJzogICAgICAgJ1RhZ3MnLFxyXG4gICAgICAnS0VZX0VYUExPUkUnOiAgICAnRXhwbG9yZScsXHJcbiAgICAgICdLRVlfRkVBVF9DQVQnOiAgICAnRmVhdHVyZXMgY2F0ZWdvcmllcycsXHJcbiAgICAgICdLRVlfQ09NTUVOVFMnOiAgICdDb21tZW50cycsXHJcbiAgICAgICdLRVlfUkVQTFknOiAgICAgICdSZXBseScsXHJcbiAgICAgICdLRVlfUkVWSUVXJzogICAgICdSZXZpZXcnLFxyXG4gICAgICAnS0VZX0VESVQnOiAgICAgICAnRWRpdCcsXHJcbiAgICAgICdLRVlfVFJFTkQnOiAgICAgICdUcmVuZCcsXHJcbiAgICAgICdLRVlfVFJFTkRJTkcnOiAgICdUcmVuZGluZycsXHJcbiAgICAgICdLRVlfV1JJVEVfUkVQTFknOidXcml0ZSBhIHJlcGx5JyxcclxuICAgICAgJ0tFWV9MQVRFU1RfRkVFRCc6J0xhdGVzdCBGZWVkJyxcclxuXHJcbiAgICAgIC8vUmVtb3ZlIHRvcGljXHJcbiAgICAgICdLRVlfQ09ORl9SRU1PVkUnOidBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVtb3ZlPycsXHJcbiAgICAgICdLRVlfQ09ORl9SRU1fQyc6ICdPbmNlIHJlbW92ZSwgeW91IHdpbGwgbm90IGJlIGFibGV0byB0byBnZXQgdGhpcyB0b3BpYyBiYWNrJyxcclxuXHJcblxyXG4gICAgICAvL1NFTlRFTkNFXHJcbiAgICAgICdLRVlfV0hBVF9PTl9VUl9NSU5EJzogICdXaGF0XFwncyBvbiB5b3VyIG1pbmQ/JyxcclxuICAgICAgJ0tFWV9ZT1VfV0FOVF9GT0xMT1cnOiAgJ1lvdSBtYXkgd2FudCB0byBmb2xsb3cnLFxyXG4gICAgICAnS0VZX05PX0FDQ1RfUkVHSVNURVInOiAnRG9uXFwndCBoYXZlIGFjY291bnQ/IFJlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9DQU5UX0NITkdfVVNFUic6ICAgJ0RvblxcJ3QgaGF2ZSBhY2NvdW50PyBSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfWU9VUl9BQ0NPVU5UJzogICAgICdZb3VyIGFjY291bnQnLFxyXG4gICAgICAnS0VZX05PVEhJTkdfSEVSRSc6ICAgICAnTm90aGluZyBoZXJlLCB5ZXQnLFxyXG4gICAgICAnS0VZX1dIT19UT19GT0xMT1cnOiAgICAnV2hvIHRvIGZvbGxvdycsXHJcbiAgICAgICdLRVlfQ0FUX1dJTExfQVBQRUFSJzogICdGb2xsb3cgc29tZSBjYXRlZ29yaWVzIGFuZCBpdCB3aWxsIGFwcGVhciBoZXJlJyxcclxuICAgICAgJ0tFWV9XSFRfVVJfU1RPUlknOiAgICAgJ1doYXRcXCdzIHlvdXIgc3RvcnknLFxyXG4gICAgICAnS0VZX1dSVF9DT01NRU5UJzogICAgICAnV3JpdGUgYSBjb21tZW50JyxcclxuXHJcblxyXG5cclxuICAgICAgLy9VU0VSIElOUFVUXHJcbiAgICAgICdLRVlfRklSU1ROQU1FJzogICdGaXJzdCBuYW1lJyxcclxuICAgICAgJ0tFWV9MQVNUTkFNRSc6ICAgJ0xhc3QgbmFtZScsXHJcbiAgICAgICdLRVlfQklSVEhEQVknOiAgICdCaXJ0aGRheScsXHJcbiAgICAgICdLRVlfTU9OVEgnOiAgICAgICdNb250aCcsXHJcbiAgICAgICdLRVlfREFZJzogICAgICAgICdEYXknLFxyXG4gICAgICAnS0VZX0VNQUlMJzogICAgICAnRW1haWwnLFxyXG4gICAgICAnS0VZX0NPTkZfRU1BSUwnOiAnQ29uZmlybSBFbWFpbCcsXHJcbiAgICAgICdLRVlfR0VOREVSJzogICAgICdHZW5kZXInLFxyXG4gICAgICAnS0VZX01BTEUnOiAgICAgICAnTWFsZScsXHJcbiAgICAgICdLRVlfRkVNQUxFJzogICAgICdGZW1hbGUnLFxyXG4gICAgICAnS0VZX1VTRVJOQU1FJzogICAnVXNlcm5hbWUnLFxyXG4gICAgICAnS0VZX0xPQ0FUSU9OJzogICAnTG9jYXRpb24nLFxyXG5cclxuICAgICAgLy9Vc2VyIEVkaXRcclxuICAgICAgJ0tFWV9FRF9QUk9GSUxFJzogJ0VkaXQgUHJvZmlsZScsXHJcbiAgICAgICdLRVlfRURfQ0hHX1BXRCc6ICdDaGFuZ2UgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX0VEX1BST0ZJTEUnOiAnRWRpdCBQcm9maWxlJyxcclxuICAgICAgJ0tFWV9FRF9TSVRFJzogICAgJ1dlYnNpdGUnLFxyXG4gICAgICAnS0VZX0VEX1BIT05FJzogICAnUGhvbmUnLFxyXG4gICAgICAnS0VZX0VEX0JJTyc6ICAgICAnQmlvZ3JhcGh5JyxcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIudHJhbnNsYXRpb25zKCfguYTguJfguKInLCB7XHJcbiAgICAgICdLRVlfREFTSEJPQVJEJzogICfguKvguYnguK3guIfguJfguLHguYnguIfguKvguKHguJQnLFxyXG4gICAgICAnS0VZX0xBTkdVQUdFUyc6ICAn4Lig4Liy4Lip4LiyJyxcclxuICAgICAgJ0tFWV9IT01FJzogICAgICAgJ+C4q+C4meC5ieC4suC5geC4o+C4gScsXHJcbiAgICAgICdLRVlfUkVHSVNURVInOiAgICfguKrguKHguLHguITguKPguYPguIrguYknLFxyXG4gICAgICAnS0VZX0xPR0lOJzogICAgICAn4LmA4LiC4LmJ4Liy4Liq4Li54LmI4Lij4Liw4Lia4LiaJyxcclxuICAgICAgJ0tFWV9GT0xMT1cnOiAgICAgJ+C4leC4tOC4lOC4leC4suC4oScsXHJcbiAgICAgICdLRVlfUE9TVCc6ICAgICAgICfguYLguJ7guKrguJXguYwnXHJcbiAgICB9KTtcclxuXHJcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIucHJlZmVycmVkTGFuZ3VhZ2UoJ2VuJyk7XHJcbiAgfV0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdOb3RpQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSxDYXRlZ29yeSxUb3BpY3MsTm90aVNlcnZpY2Upe1xyXG4gICAgdmFyIG5vdGlDdHJsID0gdGhpcztcclxuXHJcblxyXG4gICAgbm90aUN0cmwudG9waWNzID0gVG9waWNzO1xyXG4gICAgbm90aUN0cmwuZmVlZCAgID0gZmVlZDtcclxuICAgIG5vdGlDdHJsLm5vdGlTZXJ2aWNlID0gTm90aVNlcnZpY2U7XHJcblxyXG4gICAgbm90aUN0cmwubm90aWZ5VG8gPWZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgIHJldHVybiBub3RpQ3RybC5hcnIucHVzaCh1aWQpLiRhZGQodWlkKVxyXG4gICAgfVxyXG4gIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuXHJcbiAgLmZhY3RvcnkoJ05vdGlTZXJ2aWNlJywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSAsIEZpcmViYXNlVXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLCRub3RpZmljYXRpb24pe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uJyk7XHJcbiAgICB2YXIgbm90aSA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG4gICAgdmFyIHVzZXJzID0gVXNlcnM7XHJcblxyXG4gICAgdmFyIG9ic2VydmVyQ2FsbGJhY2tzID0gW107XHJcblxyXG5cclxuICAgIHZhciBOb3RpZmljYXRpb24gPSB7XHJcblxyXG4gICAgICAvL0Rpc3BsYXkgdW5yZWFkXHJcbiAgICAgIHVucmVhZE5vdGlmaWNhdGlvbjpmdW5jdGlvbih1aWQpe1xyXG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nK3VpZCsnL3VucmVhZCcpO1xyXG4gICAgICAgIHZhciBjb3VudGVyO1xyXG4gICAgICAgIHJlZi5vbihcInZhbHVlXCIsZnVuY3Rpb24oc25hcHNob3Qpe1xyXG4gICAgICAgICAgY291bnRlciA9IHNuYXBzaG90LnZhbCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgbm90aWZpY2F0aW9uX3JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKTtcclxuICAgICAgICBub3RpZmljYXRpb25fcmVmLm9uKFwiY2hpbGRfYWRkZWRcIixmdW5jdGlvbigpe1xyXG4gICAgICAgICAgJG5vdGlmaWNhdGlvbignTmV3IG1lc3NhZ2UgZnJvbSBRYW55YScsIHtcclxuICAgICAgICAgICAgYm9keTogJ0hlbGxvICcrdWlkLFxyXG4gICAgICAgICAgICBkaXI6ICdhdXRvJyxcclxuICAgICAgICAgICAgbGFuZzogJ2VuJyxcclxuICAgICAgICAgICAgdGFnOiAnbXktdGFnJyxcclxuICAgICAgICAgICAgaWNvbjogJ2h0dHA6Ly93d3cuY2wuY2FtLmFjLnVrL3Jlc2VhcmNoL3NyZy9uZXRvcy9pbWFnZXMvcXNlbnNlLWxvZ28ucG5nJyxcclxuICAgICAgICAgICAgLy9kZWxheTogMTAwMCwgLy8gaW4gbXNcclxuICAgICAgICAgICAgZm9jdXNXaW5kb3dPbkNsaWNrOiB0cnVlIC8vIGZvY3VzIHRoZSB3aW5kb3cgb24gY2xpY2tcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGNvdW50ZXIgO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy9Ob3RpZnkgZm9sbG93ZXJzXHJcbiAgICAgIG5vdGlmeUZvbGxvd2VyOmZ1bmN0aW9uKHRvcGljSWQsdWlkKXtcclxuICAgICAgICB2YXIgcmVmID0gdXNlcnMuZ2V0Rm9sbG93ZXIodWlkKTtcclxuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XHJcbiAgICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkU25hcHNob3QpIHtcclxuICAgICAgICAgICAgLy91cGRhdGUgbm90aWZpY2F0aW9uIGFuZCBkZXRhaWxzXHJcbiAgICAgICAgICAgIE5vdGlmaWNhdGlvbi51cGRhdGVOb3RpZmljYXRpb25Db3VudCh0b3BpY0lkLGNoaWxkU25hcHNob3Qua2V5KCkpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy9BZGQgZGV0YWlsIGZvciB0aGlzIG5vdGlmaWN0aWFvblxyXG4gICAgICBub3RpZnlMb2c6ZnVuY3Rpb24odG9waWNJZCx1aWQsZnJvbV91aWQpe1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcInVpZCBcIit1aWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZnJvbSB1aWQgXCIrIGZyb21fdWlkKTtcclxuXHJcbiAgICAgICAgTm90aWZpY2F0aW9uLmFkZENoaWxkKHVpZCkucHVzaCgpLnNldCh7XHJcbiAgICAgICAgICB0b3BpY0lkOiAgICB0b3BpY0lkLFxyXG4gICAgICAgICAgZnJvbTogICAgICAgZnJvbV91aWQsXHJcbiAgICAgICAgICBpc19yZWFkOiAgICBmYWxzZSxcclxuICAgICAgICAgIHRpbWVzdGFtcDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0sXHJcblxyXG5cclxuICAgICAgLy9SZXNldCB1bnJlYWQgY291bnRlclxyXG4gICAgICByZXNldFVucmVhZDpmdW5jdGlvbih1aWQpe1xyXG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nK3VpZCsnL3VucmVhZCcpO1xyXG4gICAgICAgIHJlZi5zZXQoMCk7XHJcbiAgICAgIH0sXHJcblxyXG5cclxuICAgICAgLy9VcGRhdGUgbm90aWZpY2F0aW9uXHJcbiAgICAgIC8vQHBhcmFtcyB1aWQgLSB3aG8gdGhpcyBub3RpZmljYXRpb24gaXMgZ29pbmcgdG9cclxuICAgICAgdXBkYXRlTm90aWZpY2F0aW9uQ291bnQ6ZnVuY3Rpb24odG9waWNJZCx1aWQsZnJvbV91aWQpe1xyXG5cclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQrJy91bnJlYWQnKTtcclxuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XHJcbiAgICAgICAgICAvL2RlZmF1bHQgdW5yZWFkIGlzIDFcclxuICAgICAgICAgaWYoc25hcHNob3QudmFsKCkgPT0gJ251bGwnKXtcclxuICAgICAgICAgICAgcmVmLnNldCgxKVxyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJlZi5zZXQoc25hcHNob3QudmFsKCkgKyAxKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JPYmplY3QpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHJlYWQgZmFpbGVkOiBcIiArIGVycm9yT2JqZWN0LmNvZGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL0FkZCB0byBsb2dcclxuICAgICAgICBOb3RpZmljYXRpb24ubm90aWZ5TG9nKHRvcGljSWQsdWlkLGZyb21fdWlkKTtcclxuXHJcbiAgICAgIH0sXHJcblxyXG5cclxuICAgICAgYWRkQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQXJyQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKGNoaWxkKSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXHJcbiAgICAgIGFsbDogbm90aVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcclxuICB9KVxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ1BsYWNlc0N0cmwnLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLCBTbHVnLExhbmd1YWdlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlTGFuZGluZykge1xyXG5cclxuICAgIHZhciBwbGFjZXNDdHJsID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKHBsYWNlTGFuZGluZyk7XHJcbiAgICBwbGFjZXNDdHJsLnBsYWNlTGFuZGluZyA9IHBsYWNlTGFuZGluZztcclxuXHJcbiAgfSk7XHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnUGxhY2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuXHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydwbGFjZXMnKTtcclxuICAgIHZhciBwbGFjZURldGFpbF9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlc19kZXRhaWxzJyk7XHJcblxyXG4gICAgdmFyIHBsYWNlcyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIFBsYWNlcyA9IHtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRQbGFjZURldGFpbENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiBwbGFjZURldGFpbF9yZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0UGxhY2VSZWY6ZnVuY3Rpb24ocGxhY2VfaWQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQocGxhY2VfaWQrJy9pbmZvJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogcGxhY2VzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGxhY2VzO1xyXG4gIH0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL0NhdGVnb3J5IGxpc3RcclxuICAuZmFjdG9yeSgnQ2F0ZWdvcnknLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5LCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzJyk7XHJcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG4gICAgdmFyIHRvcGljQXJyID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICB2YXIgQ2F0ZWdvcnkgPSB7XHJcbiAgICAgIGdldE5hbWU6IGZ1bmN0aW9uKHNsdWcpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHNsdWcpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhbGw6IGNhdGVnb3JpZXNcclxuICAgIH1cclxuICAgIHJldHVybiBDYXRlZ29yeTtcclxuICB9KVxyXG5cclxuXHJcbiAgLy9MYW5ndWFnZXNcclxuICAuZmFjdG9yeSgnTGFuZ3VhZ2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2xhbmd1YWdlcycpO1xyXG4gICAgdmFyIGxhbmcgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xyXG5cclxuICAgIHJldHVybiBsYW5nO1xyXG4gIH0pXHJcblxyXG5cclxuICAvL0xhbmd1YWdlc1xyXG4gIC5mYWN0b3J5KCdBcmNoaXZlJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2FyY2hpdmUnKTtcclxuICAgIHZhciBhcmNoaXZlID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICB2YXIgQXJjaGl2ZSA9e1xyXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChzbHVnKTtcclxuICAgICAgfSxcclxuICAgICAgcmVmOiByZWYsXHJcbiAgICAgIGFycjogYXJjaGl2ZVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFyY2hpdmU7XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdUYWdDdHJsJywgZnVuY3Rpb24oQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdMYW5kaW5nLHRhZ05hbWUpIHtcclxuXHJcbiAgICB2YXIgdGFnQ3RybCA9IHRoaXM7XHJcbiAgICB0YWdDdHJsLnRhZ0xhbmRpbmcgID0gdGFnTGFuZGluZztcclxuICAgIHRhZ0N0cmwudGFnTmFtZSAgICAgPSB0YWdOYW1lO1xyXG5cclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5mYWN0b3J5KCdUYWdzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksICRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwsICRxKXtcblxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3RhZ3MnKTtcbiAgICB2YXIgdGFncyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICB2YXIgVGFncyA9IHtcblxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxuICAgICAgfSxcblxuICAgICAgdGFnc1VybDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmKTtcbiAgICAgIH0sXG5cbiAgICAgIGdldFRhZ1JlZjpmdW5jdGlvbih0YWcpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRhZyk7XG4gICAgICB9LFxuXG4gICAgICBnZXRUYWdPYmplY3Q6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljVGFnczpmdW5jdGlvbih0YWcpe1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG4gICAgICAgIHZhciBkYXRhUmV0ID0gJyc7XG5cbiAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0YWdzLycrdGFnKVxuICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0YWdTbmFwKXtcbiAgICAgICAgICAgIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAuZXF1YWxUbyh0YWcpXG4gICAgICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgLy9zaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YVJldCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIGFycjogdGFnc1xuXG4gICAgfVxuICAgIHJldHVybiBUYWdzO1xuICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdUb3BpY0xhbmRpbmdDdHJsJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHNjb3BlLCBTbHVnLCBUb3BpY3MsIEF1dGgsIFVzZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPd25lcix0b3BpY0xhbmRpbmcsIHJlcGx5TGlzdCwgdmlld0RhdGEsIGZvbGxvd2Vycykge1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpY0xhbmRpbmdDdHJsXCIpO1xuXG4gICAgdmFyIHRvcGljTGFuZGluZ0N0cmwgPSB0aGlzXG5cblxuICAgIHRvcGljTGFuZGluZ0N0cmwuYXV0aCAgICAgICAgID0gQXV0aDtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLnVzZXJzICAgICAgICA9IFVzZXJzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNMYW5kaW5nID0gdG9waWNMYW5kaW5nO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNzICAgICAgID0gVG9waWNzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0ICAgID0gcmVwbHlMaXN0O1xuICAgIHRvcGljTGFuZGluZ0N0cmwudmlld3MgICAgICAgID0gdmlld0RhdGE7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5mb2xsb3dlcnMgICAgPSBmb2xsb3dlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5pc093bmVyICAgICAgPSBpc093bmVyO1xuXG5cblxuXG4gICAgLy9HZXR0aW5nIFJlcGxpZXMgaW4gcmVwbGllc1xuICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFyciA9IFtdO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgZm9yKHZhciBpPTA7IGk8dG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QubGVuZ3RoO2krKyl7XG4gICAgICAgIHZhciB0b3BpY0lkID0gdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3RbaV0udG9waWNJZDtcbiAgICAgICAgdmFyIHJlcGx5SWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS4kaWQ7XG4gICAgICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFycltpXSA9IHRvcGljTGFuZGluZ0N0cmwudG9waWNzLnJlcGx5SW5SZXBseSh0b3BpY0lkLHJlcGx5SWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5KCk7XG4gIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLy8gVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnVG9waWNzJywgZnVuY3Rpb24gKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKSB7XG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MnKVxuICAgIHZhciB0b3BpY3MgPSAkZmlyZWJhc2VPYmplY3QocmVmKVxuICAgIHZhciB0b3BpY3NBcnIgPSAkZmlyZWJhc2VBcnJheShyZWYpXG4gICAgdmFyIHRvcGljS2V5ID0gJydcblxuICAgIHZhciBUb3BpY3MgPSB7XG4gICAgICAvLyBHZXQgdG9waWMgdGFnXG4gICAgICBnZXRUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBHZXQgdG9waWMgc2x1Z1xuICAgICAgZ2V0U2x1ZzogZnVuY3Rpb24gKHNsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyhzbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldHRpbmcgdGhlIGxpc3Qgb2YgdG9waWNzIGNyZWF0ZWQgYnkgdXNlcl9pZFxuICAgICAgY3JlYXRlZEJ5OiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd1aWQnKS5lcXVhbFRvKHVpZCkpXG5cbiAgICAgIH0sXG4gICAgICByZWZDaGlsZDogZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpXG4gICAgICB9LFxuICAgICAgY291bnRVc2VyVG9waWNzOiBmdW5jdGlvbiAoKSB7fSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpYyBiYXNlIG9uIGNhdGVnb3J5XG4gICAgICBsaXN0OiBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdjYXRlZ29yeScpLmVxdWFsVG8oY2F0ZWdvcnkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgbmFtZTogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBSZWZcbiAgICAgIGZvcnRvcGljUmVmOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gcmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZylcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlLZXk6IGZ1bmN0aW9uICh0b3BpY19rZXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MvJyArIHRvcGljX2tleSlcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlTbHVnOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZykubGltaXRUb0ZpcnN0KDEpKVxuICAgICAgfSxcblxuICAgICAgaW5jcmVtZW50VmlldzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHt9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBhcnJheVxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShUb3BpY3MuZm9ydG9waWNSZWYodG9waWNfc2x1ZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBsaXN0aW5nXG4gICAgICByZXBseUxpc3Q6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IEFycmF5XG4gICAgICByZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzJykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBjb3VudFxuICAgICAgcmVwbHlDb3VudDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nKSlcbiAgICAgIH0sXG4gICAgICByZXBseUNvdW50UmVmOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvY291bnQnKVxuICAgICAgfSxcblxuICAgICAgcmVwbHlJblJlcGx5OiBmdW5jdGlvbiAodG9waWNJZCwgcmVwbHlJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJyArIHJlcGx5SWQgKyAnL2luUmVwbHknKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGluIFJlcGx5IEFycmF5XG4gICAgICByZXBseUluUmVwbHlBcnI6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycrcmVwbHlJZCsnL2luUmVwbHknKSkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gdXB2b3Rlc1xuICAgICAgZ2V0VXB2b3RlczogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByZWY6IHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGRvd252b3Rlc1xuICAgICAgZ2V0RG93bnZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLFxuICAgICAgICAgIGFycmF5OiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGZvbGxvd2Vyc1xuICAgICAgZ2V0Rm9sbG93ZXJzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgdXB2b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykuY2hpbGQodWlkKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZG9VcHZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpXG4gICAgICB9LFxuXG4gICAgICBkb3dudm90ZVRvcGljOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb0Rvd252b3RlOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnZhbHVlID09PSBudWxsIHx8IGRhdGEudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlICsgMSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykpXG4gICAgICB9LFxuXG4gICAgICB1bmZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlIC0gMSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJylcbiAgICAgIH0sXG5cbiAgICAgIGdldFZpZXdzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkKS5jaGlsZCgndmlld3MnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgbGF0ZXN0RmVlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnY3JlYXRlZCcpLmxpbWl0VG9MYXN0KDEwKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljc0J5VGFnOiBmdW5jdGlvbiAodGFnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd0YWdzJykuZXF1YWxUbyh0YWcpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmV0dXJuIGFycmF5XG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXG5cbiAgICAgIGFsbDogdG9waWNzLFxuICAgICAgcmVmOiByZWZcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRvcGljc1xuXG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCAkZmlsdGVyLCBtZDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXV0aCxVc2VycyxUb3BpY3MsIEZhY2Vib29rLG5vdGlmeSxDYXRlU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUsaXNPd25lcix1c2VyUG9zdHMpe1xuXG4gICAgY29uc29sZS5sb2coXCJQcm9maWxlQ3RybFwiKTtcblxuICAgIHZhciBwcm9maWxlQ3RybCA9IHRoaXM7XG5cbiAgICAvL1BhcnNlclxuICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUgICA9IHByb2ZpbGU7XG4gICAgcHJvZmlsZUN0cmwuYXV0aCAgICAgID0gQXV0aDtcbiAgICBwcm9maWxlQ3RybC51c2VycyAgICAgPSBVc2VycztcbiAgICBwcm9maWxlQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgcHJvZmlsZUN0cmwuZmFjZWJvb2sgID0gRmFjZWJvb2s7XG4gICAgcHJvZmlsZUN0cmwuaXNPd25lciAgID0gaXNPd25lcjtcbiAgICBwcm9maWxlQ3RybC5jYXRlICAgICAgPSBDYXRlU2VydmljZTtcbiAgICBwcm9maWxlQ3RybC4kc3RhdGUgICAgPSAkc3RhdGU7XG4gICAgcHJvZmlsZUN0cmwudXNlclBvc3RzID0gdXNlclBvc3RzO1xuXG4gICAgcHJvZmlsZUN0cmwudXNlckZlZWQgID0gJyc7XG4gICAgcHJvZmlsZUN0cmwuZmVlZCA9ICcnO1xuXG4gICAgcHJvZmlsZUN0cmwuZWRpdEluaXQgPSAndXNlckVkaXQnO1xuXG4gICAgcHJvZmlsZUN0cmwubmFtZUV4aXN0PSBmYWxzZTtcblxuXG4gICAgcHJvZmlsZUN0cmwuZ2V0VXNlclBvc3QgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZmVlZCA9IHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuXG4gICAgLypMaW5rIGFjY291bnQgd2l0aCBmYWNlYm9vayovXG4gICAgcHJvZmlsZUN0cmwubGlua0ZhY2Vib29rID0gZnVuY3Rpb24oKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmxvZ2luKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmdldExvZ2luU3RhdHVzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9nZ2VkSW4gPSB0cnVlO1xuICAgICAgICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2suYXBpKCcvbWUnLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdCBsb2dnZWQgaW5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9UaGUgb3JpZ2luYWwgdmFsdWUgZnJvbSBwcm9maWxlXG4gICAgcHJvZmlsZUN0cmwub2xkUHJvZmlsZVZhbHVlID0gcHJvZmlsZUN0cmwucHJvZmlsZTtcblxuXG4gICAgcHJvZmlsZUN0cmwudXNlckNyZWF0ZWQgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcmV0dXJuIHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuICAgIC8vUHJlc2V0IFBhcmFtZXRlcnNcbiAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3MgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC51c2VyQ2F0ZUZvbGxvdyAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5mb2xsb3dMaXN0ICAgICAgPSAnJztcblxuXG5cblxuXG4gICAgcHJvZmlsZUN0cmwuZm9sbG93Q2F0ZUxpc3RBcnIgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZm9sbG93TGlzdCA9IHByb2ZpbGVDdHJsLmNhdGUuZm9sbG93TGlzdCh1aWQpO1xuICAgIH1cblxuICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XG4gICAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlTGlzdEFycihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICB9XG5cbiAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlID0gZnVuY3Rpb24oaW5kZXgsY2F0ZV9zbHVnKXtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGVJc0ZvbGxvd1tpbmRleF0gID0gdHJ1ZTtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG5cblxuICAgIC8vVXBsb2FkIFByb2ZpbGUgaW1hZ2VcbiAgICBwcm9maWxlQ3RybC51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpKSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3NbaV0gPSB1cmk7XG4gICAgICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wicGhvdG9cIjogdXJpfSlcbiAgICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGZsb3dGaWxlLmZpbGUpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICAvL1NhdmUgcHJvZmlsZSB3aXRoIHByb2ZpbGVDdHJsLnByb2ZpbGVcbiAgICAvL3BhcmFtczogcmVkaXJlY3QsIGlmIGV4aXN0IHRoZW4gcmVkaXJlY3QgYWZ0ZXIgc2F2ZVxuICAgIHByb2ZpbGVDdHJsLnNhdmVQcm9maWxlID0gZnVuY3Rpb24ocmVkaXJlY3Qpe1xuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS51cGRhdGVkID0gbW9tZW50KCkudG9JU09TdHJpbmcoKTtcblxuXG4gICAgICBpZihwcm9maWxlQ3RybC5sb2NhdGlvbiAhPT0gbnVsbCApIHtcbiAgICAgICAgbG9jYXRpb25EZXRhaWwgPSB7XG4gICAgICAgICAgcGxhY2VfaWQ6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5uYW1lLFxuICAgICAgICAgIGFkZHJlc3M6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgfVxuXG4gICAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUudXNlckxvY2F0aW9uID0gbG9jYXRpb25EZXRhaWw7XG4gICAgICB9XG5cbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgaWYocmVkaXJlY3QgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgJHN0YXRlLmdvKHJlZGlyZWN0KTtcbiAgICAgICAgfVxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgbm90aWZ5KHttZXNzYWdlOidFcnJvciBzYXZpbmcgZGF0YScscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVXBkYXRlIG5hbWVcbiAgICBwcm9maWxlQ3RybC51cGRhdGVOYW1lID0gZnVuY3Rpb24oKXtcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICBcImZpcnN0bmFtZVwiOiAgcHJvZmlsZUN0cmwucHJvZmlsZS5maXJzdG5hbWUsXG4gICAgICAgICAgXCJsYXN0bmFtZVwiOiAgIHByb2ZpbGVDdHJsLnByb2ZpbGUubGFzdG5hbWUsXG4gICAgICAgIH1cbiAgICAgIClcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKycvbG9nJykucHVzaCgpLnNldCh7XG4gICAgICAgIGFjdGlvbjogICBcIm5hbWVfY2hhbmdlXCIsXG4gICAgICAgIG9sZG5hbWU6ICBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUuZmlyc3RuYW1lICsgXCItXCIgKyBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUubGFzdG5hbWUsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VwZGF0ZSBCaW9cbiAgICBwcm9maWxlQ3RybC51cGRhdGVCaW8gPSBmdW5jdGlvbigpe1xuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wiYmlvZ3JhcGh5XCI6IHByb2ZpbGVDdHJsLnByb2ZpbGUuYmlvZ3JhcGh5fSlcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICBwcm9maWxlQ3RybC51cGRhdGVQcm9maWxlID0gZnVuY3Rpb24oKXtcbiAgICAgIC8vcHJvZmlsZUN0cmwucHJvZmlsZS5lbWFpbEhhc2ggPSBtZDUuY3JlYXRlSGFzaChhdXRoLnBhc3N3b3JkLmVtYWlsKTtcbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL0NoZWNrIGlmIHVzZXIgZXhpc3QsIHJldHVybiBmYWxzZSBpZiB0aGV5IGRvXG4gICAgcHJvZmlsZUN0cmwuY2hlY2tVc2VybmFtZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLmNoZWNrVXNlcm5hbWVFeGlzdChwcm9maWxlQ3RybC5wcm9maWxlLmRpc3BsYXlOYW1lKS5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgIGlmKHNuYXBzaG90LnZhbCgpICE9PSBudWxsKXtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PXRydWU7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PWZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmZhY3RvcnkoJ1VzZXJzJywgZnVuY3Rpb24gKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkaHR0cCkge1xuICAgIHZhciB1c2Vyc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd1c2VycycpXG4gICAgdmFyIHVzZXJzID0gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYpXG5cbiAgICB2YXIgVXNlcnMgPSB7XG4gICAgICBnZXRMb2NhdGlvbklQOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgdXJsOiAnaHR0cDovL2lwaW5mby5pby9qc29uJyxcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnXG4gICAgICAgIH0pXG4gICAgICB9LFxuXG4gICAgICBnZXRMb2NhdGlvbklQRGF0YTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgIHVybDogJ2h0dHA6Ly9pcGluZm8uaW8vanNvbicsXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGEuZGF0YVxuICAgICAgICB9KVxuICAgICAgfSxcblxuICAgICAgcHJvZmlsZTogZnVuY3Rpb24odWlkKXtcbiAgICAgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKTtcbiAgICAgIH0sXG5cblxuICAgICAgLy9TZWFyY2ggYW5kIHJldHVybiB1c2VybmFtZVxuICAgICAgZ2V0UHJvZmlsZUJ5VXNlcm5hbWU6ZnVuY3Rpb24odXNlcm5hbWUpe1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYub3JkZXJCeUNoaWxkKCdkaXNwbGF5TmFtZScpLmVxdWFsVG8odXNlcm5hbWUpKTtcbiAgICAgIH0sXG5cbiAgICAgIC8vQ2hlY2sgaWYgdXNlcm5hbWUgZXhpc3QsIGlmIG5vdCByZXR1cm4gbnVsbFxuICAgICAgY2hlY2tVc2VybmFtZUV4aXN0OmZ1bmN0aW9uKHVzZXJuYW1lKXtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLm9yZGVyQnlDaGlsZCgnZGlzcGxheU5hbWUnKS5lcXVhbFRvKHVzZXJuYW1lKTtcbiAgICAgIH0sXG5cblxuICAgICAgZ2V0UHJvZmlsZTogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpXG4gICAgICB9LFxuXG4gICAgICBnZXREaXNwbGF5TmFtZTogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICBpZiAodWlkICE9PSBudWxsIHx8IHVpZCAhPT0gJycpIHtcbiAgICAgICAgICByZXR1cm4gdXNlcnMuJGdldFJlY29yZCh1aWQpLmRpc3BsYXlOYW1lO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICAvL0dldCB1c2VyIEZvbGxvd2Vyc1xuICAgICAgZ2V0Rm9sbG93ZXI6ZnVuY3Rpb24odWlkKXtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCsnL3N0YXQvZm9sbG93ZXIvdWlkJyk7XG4gICAgICB9LFxuXG4gICAgICAvL0NoZWNrIGlmIHVzZXIgaXMgYWxyZWFkeSBmb2xsb3dpbmdcbiAgICAgIGNoZWNrRm9sbG93OmZ1bmN0aW9uKHVpZCxmb2xsb3dfaWQpe1xuXG4gICAgICAgIHZhciBmb2xsb3c9ZmFsc2U7XG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3VzZXJzLycrdWlkKycvc3RhdC9mb2xsb3dpbmcvdWlkLycrZm9sbG93X2lkKTtcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgIGZvbGxvdyA9IHNuYXBzaG90LmV4aXN0cygpO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZm9sbG93O1xuICAgICAgfSxcblxuICAgICAgLy9DaGFuZ2UgcGFzc3dvcmRcbiAgICAgIHVzZXJDaGFuZ2VQYXNzd29yZDpmdW5jdGlvbihlbWFpbCxvbGRwYXNzLG5ld3Bhc3Mpe1xuXG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuICAgICAgICByZWYuY2hhbmdlUGFzc3dvcmQoe1xuICAgICAgICAgIGVtYWlsOiBlbWFpbCxcbiAgICAgICAgICBvbGRQYXNzd29yZDogb2xkcGFzcyxcbiAgICAgICAgICBuZXdQYXNzd29yZDogbmV3cGFzc1xuICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgc3dpdGNoIChlcnJvci5jb2RlKSB7XG4gICAgICAgICAgICAgIGNhc2UgXCJJTlZBTElEX1BBU1NXT1JEXCI6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgc3BlY2lmaWVkIHVzZXIgYWNjb3VudCBwYXNzd29yZCBpcyBpbmNvcnJlY3QuXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIFwiSU5WQUxJRF9VU0VSXCI6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgc3BlY2lmaWVkIHVzZXIgYWNjb3VudCBkb2VzIG5vdCBleGlzdC5cIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciBjaGFuZ2luZyBwYXNzd29yZDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzZXIgcGFzc3dvcmQgY2hhbmdlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LFxuXG4gICAgICB1c2VyUmVmOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpXG4gICAgICB9LFxuXG4gICAgICB1cHZvdGVzOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCd1cHZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGRvd252b3RlczogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKS5jaGlsZCgnZG93bnZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIC8vVXNlciBmb2xsb3dpbmcgdG9waWNcbiAgICAgIGZvbGxvd2luZzogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKS5jaGlsZCgnZm9sbG93aW5nJylcbiAgICAgIH0sXG5cbiAgICAgIHVzZXJBcnJSZWY6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZClcbiAgICAgIH0sXG5cbiAgICAgIGFsbDogdXNlcnNcbiAgICB9XG5cbiAgICByZXR1cm4gVXNlcnNcbiAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5mYWN0b3J5KCdVbmlxdWVJREdlbmVyYXRvcicsIGZ1bmN0aW9uKCl7ICBcclxuICAgIC8qKlxyXG4gICAgICogRmFuY3kgSUQgZ2VuZXJhdG9yIHRoYXQgY3JlYXRlcyAyMC1jaGFyYWN0ZXIgc3RyaW5nIGlkZW50aWZpZXJzIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxyXG4gICAgICpcclxuICAgICAqIDEuIFRoZXkncmUgYmFzZWQgb24gdGltZXN0YW1wIHNvIHRoYXQgdGhleSBzb3J0ICphZnRlciogYW55IGV4aXN0aW5nIGlkcy5cclxuICAgICAqIDIuIFRoZXkgY29udGFpbiA3Mi1iaXRzIG9mIHJhbmRvbSBkYXRhIGFmdGVyIHRoZSB0aW1lc3RhbXAgc28gdGhhdCBJRHMgd29uJ3QgY29sbGlkZSB3aXRoIG90aGVyIGNsaWVudHMnIElEcy5cclxuICAgICAqIDMuIFRoZXkgc29ydCAqbGV4aWNvZ3JhcGhpY2FsbHkqIChzbyB0aGUgdGltZXN0YW1wIGlzIGNvbnZlcnRlZCB0byBjaGFyYWN0ZXJzIHRoYXQgd2lsbCBzb3J0IHByb3Blcmx5KS5cclxuICAgICAqIDQuIFRoZXkncmUgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nLiAgRXZlbiBpZiB5b3UgZ2VuZXJhdGUgbW9yZSB0aGFuIG9uZSBpbiB0aGUgc2FtZSB0aW1lc3RhbXAsIHRoZVxyXG4gICAgICogICAgbGF0dGVyIG9uZXMgd2lsbCBzb3J0IGFmdGVyIHRoZSBmb3JtZXIgb25lcy4gIFdlIGRvIHRoaXMgYnkgdXNpbmcgdGhlIHByZXZpb3VzIHJhbmRvbSBiaXRzXHJcbiAgICAgKiAgICBidXQgXCJpbmNyZW1lbnRpbmdcIiB0aGVtIGJ5IDEgKG9ubHkgaW4gdGhlIGNhc2Ugb2YgYSB0aW1lc3RhbXAgY29sbGlzaW9uKS5cclxuICAgICAqL1xyXG4gICAgIHJldHVybiB7XHJcblxyXG4gICAgICAgIGdlbmVyYXRlUHVzaElEOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgLy8gTW9kZWxlZCBhZnRlciBiYXNlNjQgd2ViLXNhZmUgY2hhcnMsIGJ1dCBvcmRlcmVkIGJ5IEFTQ0lJLlxyXG4gICAgICAgICAgICB2YXIgUFVTSF9DSEFSUyA9ICctMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaX2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JztcclxuXHJcbiAgICAgICAgICAgIC8vIFRpbWVzdGFtcCBvZiBsYXN0IHB1c2gsIHVzZWQgdG8gcHJldmVudCBsb2NhbCBjb2xsaXNpb25zIGlmIHlvdSBwdXNoIHR3aWNlIGluIG9uZSBtcy5cclxuICAgICAgICAgICAgdmFyIGxhc3RQdXNoVGltZSA9IDA7XHJcblxyXG4gICAgICAgICAgICAvLyBXZSBnZW5lcmF0ZSA3Mi1iaXRzIG9mIHJhbmRvbW5lc3Mgd2hpY2ggZ2V0IHR1cm5lZCBpbnRvIDEyIGNoYXJhY3RlcnMgYW5kIGFwcGVuZGVkIHRvIHRoZVxyXG4gICAgICAgICAgICAvLyB0aW1lc3RhbXAgdG8gcHJldmVudCBjb2xsaXNpb25zIHdpdGggb3RoZXIgY2xpZW50cy4gIFdlIHN0b3JlIHRoZSBsYXN0IGNoYXJhY3RlcnMgd2VcclxuICAgICAgICAgICAgLy8gZ2VuZXJhdGVkIGJlY2F1c2UgaW4gdGhlIGV2ZW50IG9mIGEgY29sbGlzaW9uLCB3ZSdsbCB1c2UgdGhvc2Ugc2FtZSBjaGFyYWN0ZXJzIGV4Y2VwdFxyXG4gICAgICAgICAgICAvLyBcImluY3JlbWVudGVkXCIgYnkgb25lLlxyXG4gICAgICAgICAgICB2YXIgbGFzdFJhbmRDaGFycyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgLy8gcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgICB2YXIgZHVwbGljYXRlVGltZSA9IChub3cgPT09IGxhc3RQdXNoVGltZSk7XHJcbiAgICAgICAgICAgICAgbGFzdFB1c2hUaW1lID0gbm93O1xyXG5cclxuICAgICAgICAgICAgICB2YXIgdGltZVN0YW1wQ2hhcnMgPSBuZXcgQXJyYXkoOCk7XHJcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDc7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICB0aW1lU3RhbXBDaGFyc1tpXSA9IFBVU0hfQ0hBUlMuY2hhckF0KG5vdyAlIDY0KTtcclxuICAgICAgICAgICAgICAgIC8vIE5PVEU6IENhbid0IHVzZSA8PCBoZXJlIGJlY2F1c2UgamF2YXNjcmlwdCB3aWxsIGNvbnZlcnQgdG8gaW50IGFuZCBsb3NlIHRoZSB1cHBlciBiaXRzLlxyXG4gICAgICAgICAgICAgICAgbm93ID0gTWF0aC5mbG9vcihub3cgLyA2NCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChub3cgIT09IDApIHRocm93IG5ldyBFcnJvcignV2Ugc2hvdWxkIGhhdmUgY29udmVydGVkIHRoZSBlbnRpcmUgdGltZXN0YW1wLicpO1xyXG5cclxuICAgICAgICAgICAgICB2YXIgaWQgPSB0aW1lU3RhbXBDaGFycy5qb2luKCcnKTtcclxuXHJcbiAgICAgICAgICAgICAgaWYgKCFkdXBsaWNhdGVUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICBsYXN0UmFuZENoYXJzW2ldID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNjQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdGltZXN0YW1wIGhhc24ndCBjaGFuZ2VkIHNpbmNlIGxhc3QgcHVzaCwgdXNlIHRoZSBzYW1lIHJhbmRvbSBudW1iZXIsIGV4Y2VwdCBpbmNyZW1lbnRlZCBieSAxLlxyXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMTE7IGkgPj0gMCAmJiBsYXN0UmFuZENoYXJzW2ldID09PSA2MzsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxhc3RSYW5kQ2hhcnNbaV0gPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSsrO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWQgKz0gUFVTSF9DSEFSUy5jaGFyQXQobGFzdFJhbmRDaGFyc1tpXSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmKGlkLmxlbmd0aCAhPSAyMCkgdGhyb3cgbmV3IEVycm9yKCdMZW5ndGggc2hvdWxkIGJlIDIwLicpO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gaWQ7XHJcbiAgICAgICAgICAgIC8vIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgfSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
