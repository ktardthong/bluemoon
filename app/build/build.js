"use strict";function show(e){return console.log(e),JSON.stringify(e,null,2)}function extend(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t&&"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}),e}function moveFbRecord(e,t){e.once("value",function(o){t.set(o.val(),function(t){t?"undefined"!=typeof console&&console.error&&console.error(t):e.remove()})})}var app=angular.module("App",["firebase","angular-md5","ngRoute","ui.router","ngMaterial","angularMoment","flow","slugifier","ngAutocomplete","ngTagsInput","cgNotify","pascalprecht.translate","facebook","angular-flexslider","ngSanitize","ui.bootstrap","angular-smilies","ngCookies","notification"]).config(["$mdThemingProvider",function(e){e.definePalette("slack",{50:"ffebee",100:"ffcdd2",200:"ef9a9a",300:"e57373",400:"ef5350",500:"4D394B",600:"e53935",700:"d32f2f",800:"c62828",900:"b71c1c",A100:"ff8a80",A200:"ff5252",A400:"ff1744",A700:"d50000",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("slack")}]).config(["FacebookProvider",function(e){var t="931376120263856";e.setAppId(t),e.init(t)}]).config(["$translateProvider",function(e){e.preferredLanguage("Eng"),e.useSanitizeValueStrategy("escape")}]).config(["$stateProvider","$urlRouterProvider","$controllerProvider",function(e,t,o){app.registerCtrl=o.register,e.state("home",{url:"/",views:{"":{controller:"DashboardCtrl as  dashboardCtrl",templateUrl:"home/home.html",resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("dashboard")},function(e){return e})}]}},"login-form@home":{templateUrl:"templates/html/login-form.html"}}}).state("trending",{url:"/explore/trending",views:{"":{controller:"DashboardCtrl as  dashboardCtrl",templateUrl:"home/trend.html",resolve:{feed:["Topics",function(e){return e.latestFeed()}]}}}}).state("category",{url:"/category/{Slug}",views:{"":{templateUrl:"category/index.html",resolve:{cateName:["$stateParams","Category",function(e,t){return t.getName(e.Slug).$loaded()}],cateTopics:["$stateParams","Topics",function(e,t){return t.list(e.Slug)}]}}}}).state("places",{url:"/places/{place_slug}/{place_id}",views:{"header@places":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"PlacesCtrl as placesCtrl",templateUrl:"place/index.html",resolve:{placeLanding:["Places","Topics","$stateParams","$firebaseArray",function(e,t,o,r){var n;return e.getPlaceRef(o.place_id).on("value",function(e){n=e.val(),console.log(e.val())}),n}]}}}}).state("tag",{url:"/tag/{Tag}",views:{"header@tag":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"TagCtrl as tagCtrl",templateUrl:"tag/index.html",resolve:{tagName:["$stateParams",function(e){return e.Tag}],tagLanding:["Topics","$stateParams","Tags",function(e,t,o){var r=t.Tag;return e.topicsByTag(r)}]}}}}).state("topic",{url:"/{Slug}",resolve:{},views:{"":{controller:"TopicLandingCtrl as topicLandingCtrl",templateUrl:"topics/index.html",resolve:{isOwner:["Auth","Users","$stateParams","Topics",function(e,t,o,r){var n="";return e.ref.getAuth()?r.fortopic(o.Slug).$loaded().then(function(t){return null!=t[0]?(n=t[0].uid,e.ref.getAuth().uid==n?!0:!1):void 0}):!1}],topicLanding:["$stateParams","Topics",function(e,t){return t.fortopic(e.Slug).$loaded()}],replyList:["$stateParams","Topics","$state",function(e,t,o){var r="";return t.fortopic(e.Slug).$loaded().then(function(e){return null!=e[0]?r=e[0].$id:o.go("topic-notfound"),t.replyList(r)})}],viewData:["$stateParams","Topics","Users","Auth",function(e,t,o,r){var n,i,l=moment().toISOString(),a={userIP:"",created:l};return o.getLocationIP().success(function(e){a.userIP=e.data}).then(function(e){a.userIP=e.data}),t.getTopicBySlug(e.Slug).$loaded().then(function(e){return"undefined"!==e[0].$id&&(n=e[0].$id,i=t.getViews(n),i.obj.$loaded().then(function(e){null==e.count?i.ref.child("count").set(1):i.ref.child("count").set(e.count+1)}),r.auth.$requireAuth().then(function(e){var t=e.uid;i.ref.child("history").child(t).push().set(a),o.userRef(e.uid).child("views").child(n).push().set(a)})),i.obj})}],followers:["$stateParams","Topics",function(e,t){return t.getTopicBySlug(e.Slug).$loaded().then(function(e){var o=e[0].$id;return t.getFollowers(o).obj.$loaded().then(function(e){return e})})}]}}}}).state("topic-notfound",{url:"/err/notfound"}).state("profile",{url:"/profile/{Name}",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/index.html",resolve:{isOwner:["Auth","Users","$stateParams",function(e,t,o){return e.ref.getAuth()?t.getProfileByUsername(o.Name).$loaded().then(function(t){return t[0].$id==e.ref.getAuth().uid?!0:!1}):!1}],userPosts:["Users","Topics","$stateParams",function(e,t,o){return e.getProfileByUsername(o.Name).$loaded().then(function(e){return"undefined"!==e[0].$id?t.createdBy(e[0].$id):void 0})}],profile:["$state","$stateParams","$rootScope","Auth","Users",function(e,t,o,r,n){return n.getProfileByUsername(t.Name).$loaded().then(function(e){return e})}]}},"header@profile":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("acccountEdit",{url:"/account/edit",views:{"passwordEdit@acccountEdit":{url:"/account/changePassword",templateUrl:"profile/passwd.html"},"userEdit@acccountEdit":{url:"/account/edit-form",templateUrl:"profile/edit-form.html"},"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/edit.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(t){return t.displayName?t:void e.go("get_started")})},function(t){e.go("home")})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("accountPassword",{url:"/account/changePassword",templateUrl:"profile/passwd.html"}).state("accountUserEdit",{url:"/account/edit-form",templateUrl:"profile/edit-form.html"}).state("dashboard",{url:"/user/dashboard",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"dashboard/index.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(o){return o.stat||(r.userRef(t.uid).child("stat/upvoted/count").set(0),r.userRef(t.uid).child("stat/posted/count").set(0),r.userRef(t.uid).child("stat/comment/count").set(0),r.userRef(t.uid).child("stat/follower/count").set(0),r.userRef(t.uid).child("stat/following/count").set(0)),o.displayName?o:void e.go("get_started")})},function(t){return e.go("home"),t})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("dashboard.list",{url:"/feed/{Slug}",views:{"":{controller:"CateCtrl as cateCtrl",templateUrl:"category/index.html",resolve:{cateName:["$stateParams","Category",function(e,t){return t.getName(e.Slug).$loaded()}],cateTopics:["$stateParams","Topics",function(e,t){return t.list(e.Slug)}]}}}}).state("follow_cates",{url:"/user/follow-categories",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/follow-categories.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}}}}).state("get_started",{url:"/user/get_started",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/get_started.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@get_started":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("login",{url:"/user/login",views:{"":{templateUrl:"auth/login.html"},"login-form@login":{templateUrl:"templates/html/login-form.html"}}}).state("register",{url:"/user/register",views:{"":{templateUrl:"auth/register.html"}},resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("home")},function(e){return e})}]}}),t.otherwise("/")}]).filter("orderObjectBy",function(){return function(e,t,o){var r=[];return angular.forEach(e,function(e){r.push(e.$id).set(e)}),r.sort(function(e,o){return e[t]>o[t]?1:-1}),o&&r.reverse(),r}}).filter("decodeURI",function(){return function(e){return e?decodeURI(e):""}}).filter("nl2br",["$sce",function(e){return function(t){return t?e.trustAsHtml(t.replace(/\n/g,"<br/>")):""}}]).constant("FirebaseUrl","https://bmxyz.firebaseio.com/");angular.module("App").controller("AuthCtrl",["$scope","Auth","Users","$state","$rootScope","$mdSidenav","$translate","$cookies","NotiService","$notification",function(e,t,o,r,n,i,l,a,s,u){console.log("authCtrl");var c=this;u.requestPermission().then(function(e){console.log(e)}),c.auth=t,c.users=o,c.notification=s,c.badgeValue=0,null!=t.ref.getAuth()?c.profile=c.users.getProfile(t.ref.getAuth().uid):c.profile="",c.user={email:"",password:""},e.$watch("badgeValue",function(){return console.log(">>>"+c.badgeValue.value),s.unreadNotification(c.profile.$id).then(function(e){c.badgeValue=e})}),console.log(c.badgeValue),c.resetCounter=function(){c.notification.resetUnread(c.profile.$id)},c.toggleLang=function(e){l.use(e),a.put("userLang",e),t.ref.getAuth()&&c.users.userArrRef(t.ref.getAuth().uid).update({lang:e})},c.profile.lang?c.toggleLang(c.profile.lang):a.get("userLang")?c.toggleLang(a.get("userLang")):c.toggleLang("Eng"),c.login=function(){c.auth.auth.$authWithPassword(c.user).then(function(e){r.go("dashboard")},function(e){c.error=e})},c.logout=function(){t.auth.$unauth(),r.go("login")},c.register=function(){t.auth.$createUser(c.user).then(function(e){c.login()},function(e){c.error=e})}}]),angular.module("App").factory("Auth",["$firebaseAuth","FirebaseUrl",function(e,t){var o=new Firebase(t),r=e(o);console.log("auth service");var n={ref:o,auth:r,getUid:function(){var e=o.getAuth();return null!=e?o.getAuth().uid:!1}};return n}]),angular.module("App").controller("CateCtrl",["$state","Category","cateName","cateTopics",function(e,t,o,r){var n=this;n.cateName=o,n.category=t,n.cateTopics=r,console.log("CateCtrl")}]),angular.module("App").factory("CateService",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r);console.log("category service");var i={name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopic:function(t){return e(usersRef.child(uid))},addChild:function(e){return r.child(e)},followList:function(e){var o=r.orderByChild("news/follower").equalTo(e);return t(o)},unFollow:function(e,t){var r=new Firebase(o+"categories/"+e+"/follower/"+t);r.remove()},userFollow:function(e,t){var r=!1,n=new Firebase(o+"categories/"+e+"/follower/"+t);return n.once("value",function(e){r=e.exists()}),r},arr:t(r),all:n};return i}]),angular.module("App").controller("DashboardCtrl",["Auth","$state","Category","CateService","Tags","Topics",function(e,t,o,r,n,i){var l=this;l.auth=e,l.cate=r,l.categories=o,l.topics=i,l.topic_grid=!1,l.tags=n.arr,l.userCateFollow=[],l.cateIsFollow=[],l.followList="",l.userFeed="null",l.latestFeed=l.topics.latestFeed(),l.followCate=function(t){l.cate.addChild(t+"/follower").child(e.ref.getAuth().uid).push().set(moment().toISOString())},console.log("DashboardCtrl")}]),angular.module("App").directive("mainHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/toolbar/main_toolbar.html"}}).directive("badgeNotification",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/html/badge-notification.html",scope:{notification:"="}}}).directive("reviewScore",function(){return{templateUrl:"templates/html/review-summary-list.html",scope:{review:"="}}}).directive("userFollowerBtn",function(){return{restrict:"E",transclude:!0,templateUrl:"templates/html/follow-user.html",scope:{follow:"="}}}).directive("cateFollowBtn",function(){return{templateUrl:"templates/html/category-follow-btn.html",scope:{cate:"="}}}).directive("topicGrid",function(){return{templateUrl:"templates/html/category-grid.html"}}).directive("tagGrid",function(){return{templateUrl:"templates/html/tag-grid.html"}}).directive("topicCreate",function(){return{templateUrl:"templates/html/topic-create.html",scope:{topic:"="}}}).directive("topicList",function(){return{templateUrl:"templates/html/topic-list.html",scope:{topics:"="}}}).directive("topicActionsCard",function(){return{templateUrl:"templates/html/topic-actions-card.html",scope:{topic:"="}}}).directive("enforceMaxTags",function(){return{require:"ngModel",link:function(e,t,o,r){var n=o.maxTags?parseInt(o.maxTags,"4"):null;r.$parsers.push(function(e){return e&&n&&e.length>n&&e.splice(e.length-1,1),e})}}}),angular.module("App").config(["$translateProvider",function(e){e.translations("Eng",{KEY_DASHBOARD:"Dashboard",KEY_LANGUAGES:"Languages",KEY_HOME:"Home",KEY_REGISTER:"Register",KEY_LOGIN:"Log in",KEY_LOGOUT:"Log out",KEY_FOLLOW:"Follow",KEY_FOLLOWER:"Follower",KEY_UNFOLLOW:"Unfollow",KEY_FOLLOWING:"Following",KEY_POST:"Post",KEY_POSTED:"Posted",KEY_UPVOTE:"Upvote",KEY_UPVOTED:"Upvoted",KEY_DWN_VOTE:"Downvote",KEY_DWN_VOTED:"Downvoted",KEY_VIEW:"View",KEY_REMOVE:"Remove",KEY_CANCEL:"Cancel",KEY_QUESTION:"Question",KEY_TOPIC:"Topic",KEY_CHG_PWD:"Change Password",KEY_PASSWORD:"Password",KEY_OLD_PWD:"Old Password",KEY_NEW_PWD:"New Password",KEY_NEW_PWD_C:"New password confirmation",KEY_SAVE:"Save",KEY_SAVE_DRAFT:"Save as draft",KEY_TAGS:"Tags",KEY_EXPLORE:"Explore",KEY_FEAT_CAT:"Features categories",KEY_COMMENTS:"Comments",KEY_REPLY:"Reply",KEY_REVIEW:"Review",KEY_EDIT:"Edit",KEY_TREND:"Trend",KEY_TRENDING:"Trending",KEY_WRITE_REPLY:"Write a reply",KEY_LATEST_FEED:"Latest Feed",KEY_CONF_REMOVE:"Are you sure you want to remove?",KEY_CONF_REM_C:"Once remove, you will not be ableto to get this topic back",KEY_WHAT_ON_UR_MIND:"What's on your mind?",KEY_YOU_WANT_FOLLOW:"You may want to follow",KEY_NO_ACCT_REGISTER:"Don't have account? Register",KEY_CANT_CHNG_USER:"Don't have account? Register",KEY_YOUR_ACCOUNT:"Your account",KEY_NOTHING_HERE:"Nothing here, yet",KEY_WHO_TO_FOLLOW:"Who to follow",KEY_CAT_WILL_APPEAR:"Follow some categories and it will appear here",KEY_WHT_UR_STORY:"What's your story",KEY_WRT_COMMENT:"Write a comment",KEY_FIRSTNAME:"First name",KEY_LASTNAME:"Last name",KEY_BIRTHDAY:"Birthday",KEY_MONTH:"Month",KEY_DAY:"Day",KEY_EMAIL:"Email",KEY_CONF_EMAIL:"Confirm Email",KEY_GENDER:"Gender",KEY_MALE:"Male",KEY_FEMALE:"Female",KEY_USERNAME:"Username",KEY_LOCATION:"Location",KEY_ED_PROFILE:"Edit Profile",KEY_ED_CHG_PWD:"Change Password",KEY_ED_PROFILE:"Edit Profile",KEY_ED_SITE:"Website",KEY_ED_PHONE:"Phone",KEY_ED_BIO:"Biography"}),e.translations("ไทย",{KEY_DASHBOARD:"ห้องทั้งหมด",KEY_LANGUAGES:"ภาษา",KEY_HOME:"หน้าแรก",KEY_REGISTER:"สมัครใช้",KEY_LOGIN:"เข้าสู่ระบบ",KEY_FOLLOW:"ติดตาม",KEY_POST:"โพสต์"}),e.preferredLanguage("en")}]),angular.module("App").controller("NotiCtrl",["$state","Category","Topics","NotiService",function(e,t,o,r){var n=this;n.topics=o,n.feed=feed,n.notiService=r,n.notifyTo=function(e){return n.arr.push(e).$add(e)}}]),angular.module("App").factory("NotiService",["$firebaseObject","$firebaseArray","FirebaseUrl","Users","$notification","$q",function(e,t,o,r,n,i){var l=new Firebase(o+"notification"),a=e(l),s=r;console.log("noti service");var u={unreadNotification:function(e){var t,r=new Firebase(o+"notification/"+e+"/unread"),l=i.defer();return r.once("value",function(e){t=e.val(),console.log(e.val()),t>0&&(n("New message from Qanya",{body:"You have "+t+" unread messages",dir:"auto",lang:"en",tag:"my-tag",icon:"http://www.cl.cam.ac.uk/research/srg/netos/images/qsense-logo.png",focusWindowOnClick:!0}),l.resolve(t))}),l.promise},notifyFollower:function(e,t){var o=s.getFollower(t);o.once("value",function(t){t.forEach(function(t){u.updateNotificationCount(e,t.key())})})},notifyLog:function(e,t,r){console.log("uid "+t),console.log("from uid "+r);var i=new Firebase(o+"notification/");i.on.addChild(t).push().set({topicId:e,from:r,is_read:!1,timestamp:moment().toISOString()}).then(function(){n("New message from Qanya",{body:"You have new message",dir:"auto",lang:"en",tag:"my-tag",icon:"http://www.cl.cam.ac.uk/research/srg/netos/images/qsense-logo.png",focusWindowOnClick:!0})})},resetUnread:function(e){var t=new Firebase(o+"notification/"+e+"/unread");t.set(0)},updateNotificationCount:function(e,t,r){var n=new Firebase(o+"notification/"+t+"/unread");n.once("value",function(e){"null"==e.val()?n.set(1):n.set(e.val()+1)},function(e){console.log("The read failed: "+e.code)}),u.notifyLog(e,t,r)},addChild:function(e){return l.child(e)},addArrChild:function(t){return e(l.child(t))},arr:t(l),all:a};return u}]),angular.module("App").controller("PlacesCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","Tags","Topics","Auth","Users","Slug","Languages","placeLanding",function(e,t,o,r,n,i,l,a,s,u,c,d){var f=this;console.log(d),f.placeLanding=d}]),angular.module("App").factory("Places",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"places"),r=new Firebase(t+"places_details"),n=e(o),i={addChild:function(e){return o.child(e)},addPlaceDetailChild:function(e){return r.child(e)},getPlaceRef:function(e){return o.child(e+"/info")},arr:n};return i}]),angular.module("App").factory("Category",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r);t(r);console.log("Util category Service");var i={getName:function(t){var o=r.child(t);return e(o)},all:n};return i}]).factory("Languages",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"languages"),r=e(o);return console.log("Util language"),r}]).factory("Archive",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"archive"),r=e(o);console.log("Util language");var n={addChild:function(e){return o.child(e)},ref:o,arr:r};return n}]),angular.module("App").controller("TagCtrl",["Auth","Users","$state","$rootScope","tagLanding","tagName",function(e,t,o,r,n,i){var l=this;l.tagLanding=n,l.tagName=i}]),angular.module("App").factory("Tags",["$firebaseArray","$firebaseObject","FirebaseUrl","$q",function(e,t,o,r){var n=new Firebase(o+"tags"),i=e(n);console.log("tag service");var l={addChild:function(e){return n.child(e)},tagsUrl:function(){return e(n)},getTagRef:function(e){return n.child(e)},getTagObject:function(e){return t(n.child(e))},topicTags:function(e){var t=r.defer(),n=new Firebase(o);return n.child("tags/"+e).on("child_added",function(o){n.child("topics").orderByChild("tags").equalTo(e).on("child_added",function(e){return t.resolve(),extend({},o.val(),e.val())})})},arr:i};return l}]),angular.module("App").controller("TopicLandingCtrl",["$state","$scope","Slug","Topics","Auth","Users","isOwner","topicLanding","replyList","viewData","followers",function(e,t,o,r,n,i,l,a,s,u,c){console.log("topicLandingCtrl");var d=this;d.auth=n,d.users=i,d.topicLanding=a,d.topics=r,d.replyList=s,d.views=u,d.followers=c,d.isOwner=l,d.inReplyArr=[],d.replyInReply=function(){for(var e=0;e<d.replyList.length;e++){var t=d.replyList[e].topicId,o=d.replyList[e].$id;d.inReplyArr[e]=d.topics.replyInReply(t,o)}},d.replyInReply()}]),angular.module("App").controller("TopicCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","$http","FirebaseUrl","$translate","$notification","NotiService","Tags","Topics","Auth","Users","Slug","Places","Languages","Archive",function(e,t,o,r,n,i,l,a,s,u,c,d,f,g,p,h,m,v){console.log("topicCtrl");var w=this;w.tags=c,w.topics=d,w.auth=f,w.users=g,w.languages=m,w.places=h,w.archive=v,w.noti=u,null!=w.auth.ref.getAuth()?(w.profile=w.users.getProfile(w.auth.ref.getAuth().uid),w.uid=w.profile.$id,w.userRef=w.users.userRef(w.uid),w.userUpvotedTopics=w.users.upvotes(w.uid),w.userDownvotedTopics=w.users.downvotes(w.uid),w.userFollowing=w.users.following(w.uid)):(w.profile="",w.uid="",w.userRef=""),w.imageStrings=[],w.imageText=[],w.inReplyArr=[],w.loadBusy=!1,w.slugReturn=null,w.criteria=!1,w.criteriaReply=null,w.reviewCriteria=!1,w.critReplyData=null,w.newTopic={location:"",url:"",ipInfo:"",tags:"",body:""},w.avgReviewReply=function(){for(var e=Object.keys(w.criteriaReply).length,t=0,o=0;e>o;o++)t+=w.criteriaReply[o];w.replyReviewAverage=t/e,console.log(w.criteriaReply),w.critReplyData={avg:w.replyReviewAverage,data:w.criteriaReply}},w.avgReviewScore=function(e){if(e){for(var t=0,o=0;o<e.length;o++)t+=e[o].rating;return t/e.length}},a(["KEY_REMOVE","KEY_CANCEL","KEY_CONF_REMOVE","KEY_CONF_REM_C"]).then(function(e){w.removeTrans=e.KEY_REMOVE,w.cancelTrans=e.KEY_CANCEL,w.confirmRem=e.KEY_CONF_REMOVE,w.confirmRemContent=e.KEY_CONF_REM_C}),w.userName=function(e){},w.showMdLogin=function(e){var o=(n("sm")||n("xs"))&&t.customFullscreen;r.show({templateUrl:"templates/html/md-login-form.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:o})},w.decodeText=function(e){return console.log(decodeURI(e)),decodeURI(e)},w.loadMore=function(e){w.loadBusy=!0;for(var t=[],o=0;o<e.length;o++)t.push(e[o]);return console.log(t),t},w.loadTags=function(e){console.log(w.tags.tagsUrl())},w.uploadFile=function(e,t){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;w.imageStrings[t]=o},o.readAsDataURL(e.file)})},w.showConfirmRemove=function(t,o,n){var i=r.confirm().title(w.confirmRem).textContent(w.confirmRemContent).targetEvent(t).ok(w.removeTrans).cancel(w.cancelTrans);r.show(i).then(function(){w.removeTopic(o,n)&&e.go("dashboard")})},w.removeTopic=function(e,t){return e==w.uid?(moveFbRecord(w.topics.refChild(t.$id),w.archive.addChild(t.$id)),!0):!1},t.$watch("",function(){console.log(">>> watching at topic controller")}),w.reply=function(e){w.topics.replyArr(e.$id).$add({topicId:e.$id,body:w.newReply.body,uid:w.uid,review:w.critReplyData,created:moment().toISOString()}).then(function(){w.noti.updateNotificationCount(e.$id,e.uid,w.uid)}),w.topics.replyCount(e.$id).$loaded().then(function(t){t.count?w.topics.replyCountRef(e.$id).set(t.count+1):w.topics.replyCountRef(e.$id).set(1)}),w.users.userRef(w.uid).child("stat/comment/count").set(w.profile.stat.comment.count+1),w.users.userRef(w.uid).child("stat/comment/topics/"+e.$id).push().set(moment().toISOString())},w.replyInReply=function(e,t){w.topics.replyInReplyArr(e,t).$add({body:w.replyInReply.body,uid:w.uid,created:moment().toISOString()})},w.addNewChoice=function(){var e=w.reviewCriteria.length+1;w.reviewCriteria.push({id:"criteria"+e})},w.removeChoice=function(){var e=w.reviewCriteria.length-1;w.reviewCriteria.splice(e)},w.createTopic=function(e,t){var o="";""!==w.newTopic.location&&(console.log(w.newTopic.location),o={place_id:w.newTopic.location.details.place_id,slug:p.slugify(w.newTopic.location.details.name),name:w.newTopic.location.details.name,address:w.newTopic.location.details.formatted_address,lat:w.newTopic.location.details.geometry.location.lat(),lng:w.newTopic.location.details.geometry.location.lng(),lng:w.newTopic.location.details.geometry.location.lng(),lng:w.newTopic.location.details.geometry.location.lng()}),w.topics.arr.$add({type:w.type,lang:w.newTopic.lang,topic:w.newTopic.topic,body:w.newTopic.body,category:e,uid:w.uid,slug:w.newTopic.topic,photos:w.imageStrings,photos_text:w.imageText,location:o,url:w.newTopic.url,draft:t,created:moment().toISOString(),tags:w.newTopic.tags,userIP:w.newTopic.ipInfo,review:w.reviewCriteria}).then(function(e){var t="";if(t=""==p.slugify(w.newTopic.topic)?w.newTopic.topic:p.slugify(w.newTopic.topic),w.topics.getTopicByKey(e.key()).update({slug:t+e.key()}),w.users.userRef(w.uid).child("stat/posted/count").set(w.profile.stat.posted.count+1),w.users.userRef(w.uid).child("stat/posted/topics/"+e.key()).push().set(moment().toISOString()),""!==o&&(w.places.addChild(o.place_id).child(e.key()).push().set(moment().toISOString()),w.places.addChild(o.place_id).child("info").set(o)),null!==w.newTopic.tags)for(var r=0;r<w.newTopic.tags.length;++r)w.tags.addChild(w.newTopic.tags[r].text).child(e.key()).push().set(moment().toISOString());w.noti.notifyFollower(e.key(),w.uid),w.newTopic={body:""}})},w.checkFollow=function(e){return w.users.checkFollow(w.uid,e)?!0:!1},w.followUser=function(e){w.users.getProfile(e).$loaded().then(function(t){w.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count+1),w.users.userRef(e).child("stat/follower/uid/"+w.uid).push().set(moment().toISOString())}),w.users.getProfile(w.uid).$loaded().then(function(t){w.users.userRef(w.uid).child("stat/following/count").set(t.stat.follower.count+1),w.users.userRef(w.uid).child("stat/following/uid/"+e).push().set(moment().toISOString())})},w.unfollowUser=function(e){w.users.getProfile(e).$loaded().then(function(t){w.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count-1),w.users.userRef(e).child("stat/follower/uid/"+w.uid).remove()}),w.users.getProfile(w.uid).$loaded().then(function(t){w.users.userRef(w.uid).child("stat/following/count").set(t.stat.following.count-1),w.users.userRef(w.uid).child("stat/following/uid/"+e).remove()})},w.upvote=function(e){void 0!=e.downvotes&&void 0!=e.downvotes[w.uid]&&w.cancelDownvote(e),w.topics.upvoteTopic(e.$id,w.uid).$loaded().then(function(t){w.userUpvotedTopics.child(e.$id).set(t.$value),w.users.getProfile(e.uid).$loaded().then(function(t){w.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count+1),w.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).push().set(moment().toISOString())})})},w.cancelUpvote=function(e){w.topics.undoUpvote(e.$id,w.uid),w.users.getProfile(e.uid).$loaded().then(function(t){w.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count-1),w.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).remove()}),w.userUpvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},w.downvote=function(e){void 0!=e.upvotes&&void 0!=e.upvotes[w.uid]&&w.cancelUpvote(e),w.topics.downvoteTopic(e.$id,w.uid).$loaded().then(function(t){w.userDownvotedTopics.child(e.$id).set(t.$value)})},w.cancelDownvote=function(e){w.topics.undoDownvote(e.$id,w.uid),w.userDownvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},w.followTopic=function(e){w.topics.follow(e.$id,w.uid).$loaded().then(function(t){w.userFollowing.child(e.$id).set(t.history[w.uid])})},w.unfollowTopic=function(e){w.topics.unfollow(e.$id,w.uid),w.userFollowing.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})}}]),angular.module("App").factory("Topics",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"topics"),n=e(r);t(r);console.log("topic service");var i={getTag:function(e){return t(r.orderByChild("tags").equalTo(e))},getSlug:function(e){var o=r.orderByChild("slug").equalTo(e);return t(o)},createdBy:function(e){return t(r.orderByChild("uid").equalTo(e))},refChild:function(e){return r.child(e)},countUserTopics:function(){},list:function(e){var o=r.orderByChild("category").equalTo(e);return t(o)},name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopicRef:function(e){return r.orderByChild("slug").equalTo(e)},getTopicByKey:function(e){return new Firebase(o+"topics/"+e)},getTopicBySlug:function(e){return t(r.orderByChild("slug").equalTo(e).limitToFirst(1))},incrementView:function(e){},fortopic:function(e){return t(i.fortopicRef(e))},replyList:function(e){var o=r.child(e+"/replies");return t(o)},replyArr:function(e){return t(r.child(e+"/replies"))},replyCount:function(t){return e(r.child(t+"/replies/"))},replyCountRef:function(e){return r.child(e+"/replies/count")},replyInReply:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},replyInReplyArr:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},getUpvotes:function(e){return{ref:r.child(e+"/upvotes"),array:t(r.child(e+"/upvotes"))}},getDownvotes:function(e){return{ref:r.child(e+"/downvotes"),array:t(r.child(e+"/downvotes"))}},getFollowers:function(t){return{ref:r.child(t+"/followers"),obj:e(r.child(t+"/followers"))}},upvoteTopic:function(t,o){return r.child(t+"/upvotes").child(o).set(moment().toISOString()),e(r.child(t+"/upvotes").child(o))},undoUpvote:function(e,t){return r.child(e+"/upvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/upvotes")},downvoteTopic:function(t,o){return r.child(t+"/downvotes").child(o).set(moment().toISOString()),e(r.child(t+"/downvotes").child(o))},undoDownvote:function(e,t){return r.child(e+"/downvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/downvotes")},follow:function(t,o){return r.child(t+"/followers").child("history").child(o).set(moment().toISOString()),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){null===e.value||void 0===e.value?r.child(t+"/followers").child("count").set(1):r.child(t+"/followers").child("count").set(e.$value+1)}),e(r.child(t+"/followers"))},unfollow:function(t,o){return r.child(t+"/followers").child("history").child(o).remove(function(o){o?console.log("Error:",o):(console.log("Removed successfully!"),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){r.child(t+"/followers").child("count").set(e.$value-1)}))}),r.child(t+"/followers")},getViews:function(t){return{ref:r.child(t).child("views"),obj:e(r.child(t).child("views"))}},latestFeed:function(){return t(r.orderByChild("created").limitToLast(10))},topicsByTag:function(e){return t(r.orderByChild("tags").equalTo(e))},arr:t(r),all:n,ref:r};return i}]),angular.module("App").controller("ProfileCtrl",["$scope","$rootScope","$state","$filter","md5","Auth","Users","Topics","Facebook","notify","CateService","profile","isOwner","userPosts",function(e,t,o,r,n,i,l,a,s,u,c,d,f,g){console.log("ProfileCtrl");var p=this;p.profile=d,p.auth=i,p.users=l,p.topics=a,p.facebook=s,p.isOwner=f,p.cate=c,p.$state=o,p.userPosts=g,p.userFeed="",p.feed="",p.editInit="userEdit",p.nameExist=!1,p.getUserPost=function(e){p.feed=p.topics.createdBy(e)},p.linkFacebook=function(){p.facebook.login(function(t){p.facebook.getLoginStatus(function(t){"connected"===t.status?(e.loggedIn=!0,p.facebook.api("/me",function(e){console.log(e)})):console.log("not logged in")})})},p.oldProfileValue=p.profile,p.userCreated=function(e){return p.topics.createdBy(e)},p.imageStrings=[],p.userCateFollow=[],p.cateIsFollow=[],p.followList="",p.followCateListArr=function(e){p.followList=p.cate.followList(e)},i.ref.getAuth()&&p.followCateListArr(i.ref.getAuth().uid),p.followCate=function(e,t){p.cateIsFollow[e]=!0,p.cate.addChild(t+"/follower").child(i.ref.getAuth().uid).push().set(moment().toISOString())},p.uploadFile=function(e){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;p.imageStrings[t]=o,p.users.userArrRef(i.ref.getAuth().uid).update({photo:o}),u({message:"Saved",position:"center",duration:3e3})},o.readAsDataURL(e.file)})},p.saveProfile=function(e){p.profile.updated=moment().toISOString(),null!==p.location&&(locationDetail={place_id:p.location.details.place_id,name:p.location.details.name,address:p.location.details.formatted_address,lat:p.location.details.geometry.location.lat(),lng:p.location.details.geometry.location.lng()
},p.profile.userLocation=locationDetail),p.profile.$save().then(function(){u({message:"Saved",position:"center",duration:3e3}),void 0!==e&&o.go(e)})["catch"](function(e){u({message:"Error saving data",position:"center",duration:3e3})})},p.updateName=function(){p.users.userArrRef(i.ref.getAuth().uid).update({firstname:p.profile.firstname,lastname:p.profile.lastname}),p.users.userArrRef(i.ref.getAuth().uid+"/log").push().set({action:"name_change",oldname:p.oldProfileValue.firstname+"-"+p.oldProfileValue.lastname,created:moment().toISOString()}),u({message:"Saved",position:"center",duration:3e3})},p.updateBio=function(){p.users.userArrRef(i.ref.getAuth().uid).update({biography:p.profile.biography}),u({message:"Saved",position:"center",duration:3e3})},p.updateProfile=function(){p.profile.$save().then(function(){o.go("dashboard")})},p.checkUsername=function(){p.users.checkUsernameExist(p.profile.displayName).once("value",function(e){return null!==e.val()?p.nameExist=!0:p.nameExist=!1})}}]),angular.module("App").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl","$http",function(e,t,o,r){var n=new Firebase(o+"users"),i=e(n);console.log("User Service");var l={getLocationIP:function(){return r({url:"http://ipinfo.io/json",method:"GET"})},getLocationIPData:function(){return r({url:"http://ipinfo.io/json",method:"GET"}).then(function(e){return e.data})},profile:function(e){return i.$getRecord(e)},getProfileByUsername:function(t){return e(n.orderByChild("displayName").equalTo(t))},checkUsernameExist:function(e){return n.orderByChild("displayName").equalTo(e)},getProfile:function(e){return t(n.child(e))},getDisplayName:function(e){return console.log(e),null!==e||""!==e?i.$getRecord(e).displayName:void 0},getFollower:function(e){return n.child(e+"/stat/follower/uid")},checkFollow:function(e,t){var r=!1,n=new Firebase(o+"users/"+e+"/stat/following/uid/"+t);return n.once("value",function(e){r=e.exists()}),r},userChangePassword:function(e,t,r){var n=new Firebase(o);n.changePassword({email:e,oldPassword:t,newPassword:r},function(e){if(e)switch(e.code){case"INVALID_PASSWORD":console.log("The specified user account password is incorrect.");break;case"INVALID_USER":console.log("The specified user account does not exist.");break;default:console.log("Error changing password:",e)}else console.log("User password changed successfully!")})},userRef:function(e){return n.child(e)},upvotes:function(e){return n.child(e).child("upvotes")},downvotes:function(e){return n.child(e).child("downvotes")},following:function(e){return n.child(e).child("following")},userArrRef:function(e){return n.child(e)},all:i};return l}]),angular.module("App").factory("UniqueIDGenerator",function(){return{generatePushID:function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,o=[],r=(new Date).getTime(),n=r===t;t=r;for(var i=new Array(8),l=7;l>=0;l--)i[l]=e.charAt(r%64),r=Math.floor(r/64);if(0!==r)throw new Error("We should have converted the entire timestamp.");var a=i.join("");if(n){for(l=11;l>=0&&63===o[l];l--)o[l]=0;o[l]++}else for(l=0;12>l;l++)o[l]=Math.floor(64*Math.random());for(l=0;12>l;l++)a+=e.charAt(o[l]);if(20!=a.length)throw new Error("Length should be 20.");return a}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRvcGljcy5jb250cm9sbGVyLmpzIiwiYnVpbGQuanMiLCJhdXRoLmNvbnRyb2xsZXIuanMiLCJhdXRoLnNlcnZpY2UuanMiLCJjYXRlZ29yeS5jb250cm9sbGVyLmpzIiwiY2F0ZWdvcnkuc2VydmljZS5qcyIsImRhc2hib2FyZC5jb250cm9sbGVyLmpzIiwiZGlyZWN0aXZlcy5qcyIsImxhbmcuanMiLCJub3RpZmljYXRpb24uY29udHJvbGxlci5qcyIsIm5vdGlmaWNhdGlvbi5zZXJ2aWNlLmpzIiwicGxhY2UuY29udHJvbGxlci5qcyIsInBsYWNlLnNlcnZpY2UuanMiLCJ1dGlsaXRpZXMuc2VydmljZS5qcyIsInRhZy5jb250cm9sbGVyLmpzIiwidGFnLnNlcnZpY2UuanMiLCJ0b3BpYy1sYW5kaW5nLmNvbnRyb2xsZXIuanMiLCJ0b3BpY3Muc2VydmljZS5qcyIsInByb2ZpbGUuY29udHJvbGxlci5qcyIsInVzZXJzLnNlcnZpY2UuanMiLCJoZWxwZXJzLnNlcnZpY2UuanMiXSwibmFtZXMiOlsic2hvdyIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImV4dGVuZCIsImJhc2UiLCJwYXJ0cyIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwiZm9yRWFjaCIsInAiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJtb3ZlRmJSZWNvcmQiLCJvbGRSZWYiLCJuZXdSZWYiLCJvbmNlIiwic25hcCIsInNldCIsInZhbCIsImVycm9yIiwicmVtb3ZlIiwiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRtZFRoZW1pbmdQcm92aWRlciIsImRlZmluZVBhbGV0dGUiLCI1MCIsIjEwMCIsIjIwMCIsIjMwMCIsIjQwMCIsIjUwMCIsIjYwMCIsIjcwMCIsIjgwMCIsIjkwMCIsIkExMDAiLCJBMjAwIiwiQTQwMCIsIkE3MDAiLCJjb250cmFzdERlZmF1bHRDb2xvciIsImNvbnRyYXN0RGFya0NvbG9ycyIsImNvbnRyYXN0TGlnaHRDb2xvcnMiLCJ1bmRlZmluZWQiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiRmFjZWJvb2tQcm92aWRlciIsIm15QXBwSWQiLCJzZXRBcHBJZCIsImluaXQiLCIkdHJhbnNsYXRlUHJvdmlkZXIiLCJwcmVmZXJyZWRMYW5ndWFnZSIsInVzZVNhbml0aXplVmFsdWVTdHJhdGVneSIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGNvbnRyb2xsZXJQcm92aWRlciIsInJlZ2lzdGVyQ3RybCIsInJlZ2lzdGVyIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsIiIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsImF1dGgiLCIkcmVxdWlyZUF1dGgiLCJ0aGVuIiwiZ28iLCJsb2dpbi1mb3JtQGhvbWUiLCJmZWVkIiwiVG9waWNzIiwibGF0ZXN0RmVlZCIsImNhdGVOYW1lIiwiJHN0YXRlUGFyYW1zIiwiQ2F0ZWdvcnkiLCJnZXROYW1lIiwiU2x1ZyIsIiRsb2FkZWQiLCJjYXRlVG9waWNzIiwibGlzdCIsImhlYWRlckBwbGFjZXMiLCJwbGFjZUxhbmRpbmciLCJQbGFjZXMiLCIkZmlyZWJhc2VBcnJheSIsImdldFBsYWNlUmVmIiwicGxhY2VfaWQiLCJvbiIsInNuYXBzaG90IiwiaGVhZGVyQHRhZyIsInRhZ05hbWUiLCJUYWciLCJ0YWdMYW5kaW5nIiwiVGFncyIsInRhZyIsInRvcGljc0J5VGFnIiwiaXNPd25lciIsIlVzZXJzIiwidG9waWNVaWQiLCJyZWYiLCJnZXRBdXRoIiwiZm9ydG9waWMiLCJ1aWQiLCJ0b3BpY0xhbmRpbmciLCJyZXBseUxpc3QiLCJ0b3BpY0tleSIsIiRpZCIsInZpZXdEYXRhIiwidGltZSIsIm1vbWVudCIsInRvSVNPU3RyaW5nIiwiaGlzdG9yeU9iaiIsInVzZXJJUCIsImNyZWF0ZWQiLCJnZXRMb2NhdGlvbklQIiwic3VjY2VzcyIsImdldFRvcGljQnlTbHVnIiwiZ2V0Vmlld3MiLCJvYmoiLCJjb3VudCIsImNoaWxkIiwicHVzaCIsInVzZXJSZWYiLCJmb2xsb3dlcnMiLCJnZXRGb2xsb3dlcnMiLCJ2YWx1ZSIsImdldFByb2ZpbGVCeVVzZXJuYW1lIiwiTmFtZSIsInByb2ZpbGUiLCJ1c2VyUG9zdHMiLCJjcmVhdGVkQnkiLCIkcm9vdFNjb3BlIiwiaGVhZGVyQHByb2ZpbGUiLCJwYXNzd29yZEVkaXRAYWNjY291bnRFZGl0IiwidXNlckVkaXRAYWNjY291bnRFZGl0IiwiZ2V0UHJvZmlsZSIsImRpc3BsYXlOYW1lIiwic3RhdCIsImhlYWRlckBnZXRfc3RhcnRlZCIsImxvZ2luLWZvcm1AbG9naW4iLCJvdGhlcndpc2UiLCJmaWx0ZXIiLCJpdGVtcyIsImZpZWxkIiwicmV2ZXJzZSIsImZpbHRlcmVkIiwiaXRlbSIsInNvcnQiLCJhIiwiYiIsInRleHQiLCJkZWNvZGVVUkkiLCIkc2NlIiwidHJ1c3RBc0h0bWwiLCJyZXBsYWNlIiwiY29uc3RhbnQiLCIkc2NvcGUiLCIkbWRTaWRlbmF2IiwiJHRyYW5zbGF0ZSIsIiRjb29raWVzIiwiTm90aVNlcnZpY2UiLCIkbm90aWZpY2F0aW9uIiwiYXV0aEN0cmwiLCJ0aGlzIiwicmVxdWVzdFBlcm1pc3Npb24iLCJwZXJtaXNzaW9uIiwidXNlcnMiLCJub3RpZmljYXRpb24iLCJiYWRnZVZhbHVlIiwidXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCIkd2F0Y2giLCJ1bnJlYWROb3RpZmljYXRpb24iLCJyZXNldENvdW50ZXIiLCJyZXNldFVucmVhZCIsInRvZ2dsZUxhbmciLCJsYW5nS2V5IiwidXNlIiwicHV0IiwidXNlckFyclJlZiIsInVwZGF0ZSIsImxhbmciLCJnZXQiLCJsb2dpbiIsIiRhdXRoV2l0aFBhc3N3b3JkIiwibG9nb3V0IiwiJHVuYXV0aCIsIiRjcmVhdGVVc2VyIiwiZmFjdG9yeSIsIiRmaXJlYmFzZUF1dGgiLCJGaXJlYmFzZVVybCIsIkZpcmViYXNlIiwiZ2V0VWlkIiwiY2F0ZUN0cmwiLCJjYXRlZ29yeSIsIiRmaXJlYmFzZU9iamVjdCIsImNhdGVnb3JpZXMiLCJDYXRlIiwibmFtZSIsInRvcGljX3NsdWciLCJvcmRlckJ5Q2hpbGQiLCJlcXVhbFRvIiwidXNlcnNSZWYiLCJhZGRDaGlsZCIsImNoaWxkbmFtZSIsImZvbGxvd0xpc3QiLCJ1bkZvbGxvdyIsInNsdWciLCJ1c2VyRm9sbG93IiwiZm9sbG93IiwiZXhpc3RzIiwiYXJyIiwiYWxsIiwiQ2F0ZVNlcnZpY2UiLCJkYXNoYm9hcmRDdHJsIiwiY2F0ZSIsInRvcGljcyIsInRvcGljX2dyaWQiLCJ0YWdzIiwidXNlckNhdGVGb2xsb3ciLCJjYXRlSXNGb2xsb3ciLCJ1c2VyRmVlZCIsImZvbGxvd0NhdGUiLCJjYXRlX3NsdWciLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJzY29wZSIsInJldmlldyIsInRvcGljIiwicmVxdWlyZSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJuZ0N0cmwiLCJtYXhUYWdzIiwicGFyc2VJbnQiLCIkcGFyc2VycyIsImxlbmd0aCIsInNwbGljZSIsInRyYW5zbGF0aW9ucyIsIktFWV9EQVNIQk9BUkQiLCJLRVlfTEFOR1VBR0VTIiwiS0VZX0hPTUUiLCJLRVlfUkVHSVNURVIiLCJLRVlfTE9HSU4iLCJLRVlfTE9HT1VUIiwiS0VZX0ZPTExPVyIsIktFWV9GT0xMT1dFUiIsIktFWV9VTkZPTExPVyIsIktFWV9GT0xMT1dJTkciLCJLRVlfUE9TVCIsIktFWV9QT1NURUQiLCJLRVlfVVBWT1RFIiwiS0VZX1VQVk9URUQiLCJLRVlfRFdOX1ZPVEUiLCJLRVlfRFdOX1ZPVEVEIiwiS0VZX1ZJRVciLCJLRVlfUkVNT1ZFIiwiS0VZX0NBTkNFTCIsIktFWV9RVUVTVElPTiIsIktFWV9UT1BJQyIsIktFWV9DSEdfUFdEIiwiS0VZX1BBU1NXT1JEIiwiS0VZX09MRF9QV0QiLCJLRVlfTkVXX1BXRCIsIktFWV9ORVdfUFdEX0MiLCJLRVlfU0FWRSIsIktFWV9TQVZFX0RSQUZUIiwiS0VZX1RBR1MiLCJLRVlfRVhQTE9SRSIsIktFWV9GRUFUX0NBVCIsIktFWV9DT01NRU5UUyIsIktFWV9SRVBMWSIsIktFWV9SRVZJRVciLCJLRVlfRURJVCIsIktFWV9UUkVORCIsIktFWV9UUkVORElORyIsIktFWV9XUklURV9SRVBMWSIsIktFWV9MQVRFU1RfRkVFRCIsIktFWV9DT05GX1JFTU9WRSIsIktFWV9DT05GX1JFTV9DIiwiS0VZX1dIQVRfT05fVVJfTUlORCIsIktFWV9ZT1VfV0FOVF9GT0xMT1ciLCJLRVlfTk9fQUNDVF9SRUdJU1RFUiIsIktFWV9DQU5UX0NITkdfVVNFUiIsIktFWV9ZT1VSX0FDQ09VTlQiLCJLRVlfTk9USElOR19IRVJFIiwiS0VZX1dIT19UT19GT0xMT1ciLCJLRVlfQ0FUX1dJTExfQVBQRUFSIiwiS0VZX1dIVF9VUl9TVE9SWSIsIktFWV9XUlRfQ09NTUVOVCIsIktFWV9GSVJTVE5BTUUiLCJLRVlfTEFTVE5BTUUiLCJLRVlfQklSVEhEQVkiLCJLRVlfTU9OVEgiLCJLRVlfREFZIiwiS0VZX0VNQUlMIiwiS0VZX0NPTkZfRU1BSUwiLCJLRVlfR0VOREVSIiwiS0VZX01BTEUiLCJLRVlfRkVNQUxFIiwiS0VZX1VTRVJOQU1FIiwiS0VZX0xPQ0FUSU9OIiwiS0VZX0VEX1BST0ZJTEUiLCJLRVlfRURfQ0hHX1BXRCIsIktFWV9FRF9TSVRFIiwiS0VZX0VEX1BIT05FIiwiS0VZX0VEX0JJTyIsIm5vdGlDdHJsIiwibm90aVNlcnZpY2UiLCJub3RpZnlUbyIsIiRhZGQiLCIkcSIsIm5vdGkiLCJOb3RpZmljYXRpb24iLCJjb3VudGVyIiwiZGVmZXJyZWQiLCJkZWZlciIsImJvZHkiLCJkaXIiLCJpY29uIiwiZm9jdXNXaW5kb3dPbkNsaWNrIiwicHJvbWlzZSIsIm5vdGlmeUZvbGxvd2VyIiwidG9waWNJZCIsImdldEZvbGxvd2VyIiwiY2hpbGRTbmFwc2hvdCIsInVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50Iiwia2V5Iiwibm90aWZ5TG9nIiwiZnJvbV91aWQiLCJmcm9tIiwiaXNfcmVhZCIsInRpbWVzdGFtcCIsImVycm9yT2JqZWN0IiwiY29kZSIsImFkZEFyckNoaWxkIiwiJG1kRGlhbG9nIiwiJG1kTWVkaWEiLCJMYW5ndWFnZXMiLCJwbGFjZXNDdHJsIiwicGxhY2VEZXRhaWxfcmVmIiwicGxhY2VzIiwiYWRkUGxhY2VEZXRhaWxDaGlsZCIsImFyY2hpdmUiLCJBcmNoaXZlIiwidGFnQ3RybCIsInRhZ3NVcmwiLCJnZXRUYWdSZWYiLCJnZXRUYWdPYmplY3QiLCJ0b3BpY1RhZ3MiLCJmYiIsInRhZ1NuYXAiLCJ0b3BpY1NuYXAiLCJ0b3BpY0xhbmRpbmdDdHJsIiwiaW5SZXBseUFyciIsInJlcGx5SW5SZXBseSIsImkiLCJyZXBseUlkIiwiJGh0dHAiLCJ0b3BpY0N0cmwiLCJsYW5ndWFnZXMiLCJ1c2VyVXB2b3RlZFRvcGljcyIsInVwdm90ZXMiLCJ1c2VyRG93bnZvdGVkVG9waWNzIiwiZG93bnZvdGVzIiwidXNlckZvbGxvd2luZyIsImZvbGxvd2luZyIsImltYWdlU3RyaW5ncyIsImltYWdlVGV4dCIsImxvYWRCdXN5Iiwic2x1Z1JldHVybiIsImNyaXRlcmlhIiwiY3JpdGVyaWFSZXBseSIsInJldmlld0NyaXRlcmlhIiwiY3JpdFJlcGx5RGF0YSIsIm5ld1RvcGljIiwibG9jYXRpb24iLCJpcEluZm8iLCJhdmdSZXZpZXdSZXBseSIsIm9iakNvdW50IiwiT2JqZWN0Iiwia2V5cyIsImF2ZyIsInJlcGx5UmV2aWV3QXZlcmFnZSIsImF2Z1Jldmlld1Njb3JlIiwicmF0aW5nIiwicmVtb3ZlVHJhbnMiLCJjYW5jZWxUcmFucyIsImNvbmZpcm1SZW0iLCJjb25maXJtUmVtQ29udGVudCIsInVzZXJOYW1lIiwidXNlcklkIiwic2hvd01kTG9naW4iLCJldiIsInVzZUZ1bGxTY3JlZW4iLCJjdXN0b21GdWxsc2NyZWVuIiwicGFyZW50IiwiZG9jdW1lbnQiLCJ0YXJnZXRFdmVudCIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJmdWxsc2NyZWVuIiwiZGVjb2RlVGV4dCIsImxvYWRNb3JlIiwibG9hZFRhZ3MiLCJxdWVyeSIsInVwbG9hZEZpbGUiLCJmaWxlcyIsImluZGV4IiwiZmxvd0ZpbGUiLCJmaWxlUmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsImV2ZW50IiwidXJpIiwidGFyZ2V0IiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsImZpbGUiLCJzaG93Q29uZmlybVJlbW92ZSIsInRvcGljX293bmVyIiwiY29uZmlybSIsInRpdGxlIiwidGV4dENvbnRlbnQiLCJvayIsImNhbmNlbCIsInJlbW92ZVRvcGljIiwicmVmQ2hpbGQiLCJyZXBseSIsInRvcGljT2JqIiwicmVwbHlBcnIiLCJuZXdSZXBseSIsInJlcGx5Q291bnQiLCJyZXBseUNvdW50UmVmIiwiY29tbWVudCIsInJlcGx5SW5SZXBseUFyciIsImFkZE5ld0Nob2ljZSIsIm5ld0l0ZW1ObyIsImlkIiwicmVtb3ZlQ2hvaWNlIiwibGFzdEl0ZW0iLCJjcmVhdGVUb3BpYyIsImlzRHJhZnQiLCJsb2NhdGlvbkRldGFpbCIsImRldGFpbHMiLCJzbHVnaWZ5IiwiYWRkcmVzcyIsImZvcm1hdHRlZF9hZGRyZXNzIiwibGF0IiwiZ2VvbWV0cnkiLCJsbmciLCJ0eXBlIiwicGhvdG9zIiwicGhvdG9zX3RleHQiLCJkcmFmdCIsInNsdWdUZXh0IiwiZ2V0VG9waWNCeUtleSIsInBvc3RlZCIsImNoZWNrRm9sbG93IiwiZm9sbG93X3VpZCIsImZvbGxvd1VzZXIiLCJmb2xsb3dlciIsInVuZm9sbG93VXNlciIsInVwdm90ZSIsImNhbmNlbERvd252b3RlIiwidXB2b3RlVG9waWMiLCIkdmFsdWUiLCJ1cHZvdGVkIiwiY2FuY2VsVXB2b3RlIiwidW5kb1Vwdm90ZSIsImRvd252b3RlIiwiZG93bnZvdGVUb3BpYyIsInVuZG9Eb3dudm90ZSIsImZvbGxvd1RvcGljIiwiaGlzdG9yeSIsInVuZm9sbG93VG9waWMiLCJ1bmZvbGxvdyIsImdldFRhZyIsImdldFNsdWciLCJjb3VudFVzZXJUb3BpY3MiLCJmb3J0b3BpY1JlZiIsInRvcGljX2tleSIsImxpbWl0VG9GaXJzdCIsImluY3JlbWVudFZpZXciLCJnZXRVcHZvdGVzIiwiYXJyYXkiLCJnZXREb3dudm90ZXMiLCJsaW1pdFRvTGFzdCIsIiRmaWx0ZXIiLCJtZDUiLCJGYWNlYm9vayIsIm5vdGlmeSIsInByb2ZpbGVDdHJsIiwiZmFjZWJvb2siLCJlZGl0SW5pdCIsIm5hbWVFeGlzdCIsImdldFVzZXJQb3N0IiwibGlua0ZhY2Vib29rIiwicmVzcG9uc2UiLCJnZXRMb2dpblN0YXR1cyIsInN0YXR1cyIsImxvZ2dlZEluIiwiYXBpIiwib2xkUHJvZmlsZVZhbHVlIiwidXNlckNyZWF0ZWQiLCJmb2xsb3dDYXRlTGlzdEFyciIsInBob3RvIiwibWVzc2FnZSIsInBvc2l0aW9uIiwiZHVyYXRpb24iLCJzYXZlUHJvZmlsZSIsInJlZGlyZWN0IiwidXBkYXRlZCIsInVzZXJMb2NhdGlvbiIsIiRzYXZlIiwidXBkYXRlTmFtZSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwiYWN0aW9uIiwib2xkbmFtZSIsInVwZGF0ZUJpbyIsImJpb2dyYXBoeSIsInVwZGF0ZVByb2ZpbGUiLCJjaGVja1VzZXJuYW1lIiwiY2hlY2tVc2VybmFtZUV4aXN0IiwibWV0aG9kIiwiZ2V0TG9jYXRpb25JUERhdGEiLCIkZ2V0UmVjb3JkIiwidXNlcm5hbWUiLCJnZXREaXNwbGF5TmFtZSIsImZvbGxvd19pZCIsInVzZXJDaGFuZ2VQYXNzd29yZCIsIm9sZHBhc3MiLCJuZXdwYXNzIiwiY2hhbmdlUGFzc3dvcmQiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwiZ2VuZXJhdGVQdXNoSUQiLCJQVVNIX0NIQVJTIiwibGFzdFB1c2hUaW1lIiwibGFzdFJhbmRDaGFycyIsIm5vdyIsIkRhdGUiLCJnZXRUaW1lIiwiZHVwbGljYXRlVGltZSIsInRpbWVTdGFtcENoYXJzIiwiY2hhckF0IiwiTWF0aCIsImZsb29yIiwiRXJyb3IiLCJqb2luIiwicmFuZG9t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QUVBLE9BQUEvRyIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNYWluIG1vZHVsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gKi9cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnQXBwJywgW1xuICAgICdmaXJlYmFzZScsXG4gICAgJ2FuZ3VsYXItbWQ1JywgLy8gRW5jcnlwdCBlbWFpbFxuICAgICduZ1JvdXRlJyxcbiAgICAndWkucm91dGVyJyxcbiAgICAnbmdNYXRlcmlhbCcsIC8vIEludGVyZmFjZVxuICAgICdhbmd1bGFyTW9tZW50JywgLy8gVGltZSBtYW5hZ2VtZW50XG4gICAgJ2Zsb3cnLCAvLyBJbWFnZSB1cGxvYWRcbiAgICAnc2x1Z2lmaWVyJywgLy8gQ3JlYXRlIFNsdWdzXG4gICAgJ25nQXV0b2NvbXBsZXRlJywgLy8gR29vZ2xlIHBsYWNlc1xuICAgICduZ1RhZ3NJbnB1dCcsIC8vIFRhZ3NcbiAgICAnY2dOb3RpZnknLCAvLyBOb3RpZmljYXRpb24gLSBodHRwczovL2dpdGh1Yi5jb20vY2dyb3NzL2FuZ3VsYXItbm90aWZ5XG4gICAgJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnLCAvLyBUcmFuc2xhdGlvbiAtIGh0dHBzOi8vYW5ndWxhci10cmFuc2xhdGUuZ2l0aHViLmlvL1xuICAgICdmYWNlYm9vaycsICAgICAgIC8vICBGYWNlYm9vayAtIGh0dHBzOi8vZ2l0aHViLmNvbS9DaXVsL2FuZ3VsYXItZmFjZWJvb2tcbiAgICAnYW5ndWxhci1mbGV4c2xpZGVyJywgLy8gSW1hZ2Ugc2xpZGVyIC0gaHR0cHM6Ly9naXRodWIuY29tL3RoZW5pa3NvL2FuZ3VsYXItZmxleHNsaWRlclxuXG4gICAgLy8gRW1vdGljb24gLS0gaHR0cDovL21pc3RpYzEwMC5naXRodWIuaW8vYW5ndWxhci1zbWlsaWVzL1xuICAgICduZ1Nhbml0aXplJyxcbiAgICAndWkuYm9vdHN0cmFwJywgICAvLyAgT1IgbWdjcmVhLm5nU3RyYXBcbiAgICAnYW5ndWxhci1zbWlsaWVzJyxcblxuICAgICduZ0Nvb2tpZXMnLCAgICAgIC8vICBjb29raWVzIHN0dWZmXG4gICAgJ25vdGlmaWNhdGlvbicsICAgLy8gIHdlYiBub3RpZmljYXRpb24gLSBodHRwczovL2dpdGh1Yi5jb20vbmVvemlyby9hbmd1bGFyLW5vdGlmaWNhdGlvblxuXG4gIF0pXG5cbiAgLmNvbmZpZyhmdW5jdGlvbiAoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ3NsYWNrJywge1xuICAgICAgJzUwJzogJ2ZmZWJlZScsXG4gICAgICAnMTAwJzogJ2ZmY2RkMicsXG4gICAgICAnMjAwJzogJ2VmOWE5YScsXG4gICAgICAnMzAwJzogJ2U1NzM3MycsXG4gICAgICAnNDAwJzogJ2VmNTM1MCcsXG4gICAgICAnNTAwJzogJzREMzk0QicsIC8vIHByaW1hcnkgY29sb3VyXG4gICAgICAnNjAwJzogJ2U1MzkzNScsXG4gICAgICAnNzAwJzogJ2QzMmYyZicsXG4gICAgICAnODAwJzogJ2M2MjgyOCcsXG4gICAgICAnOTAwJzogJ2I3MWMxYycsXG4gICAgICAnQTEwMCc6ICdmZjhhODAnLFxuICAgICAgJ0EyMDAnOiAnZmY1MjUyJyxcbiAgICAgICdBNDAwJzogJ2ZmMTc0NCcsXG4gICAgICAnQTcwMCc6ICdkNTAwMDAnLFxuICAgICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JywgLy8gd2hldGhlciwgYnkgZGVmYXVsdCwgdGV4dCAoY29udHJhc3QpXG4gICAgICAvLyBvbiB0aGlzIHBhbGV0dGUgc2hvdWxkIGJlIGRhcmsgb3IgbGlnaHRcbiAgICAgICdjb250cmFzdERhcmtDb2xvcnMnOiBbJzUwJywgJzEwMCcsIC8vIGh1ZXMgd2hpY2ggY29udHJhc3Qgc2hvdWxkIGJlICdkYXJrJyBieSBkZWZhdWx0XG4gICAgICAgICcyMDAnLCAnMzAwJywgJzQwMCcsICdBMTAwJ10sXG4gICAgICAnY29udHJhc3RMaWdodENvbG9ycyc6IHVuZGVmaW5lZCAvLyBjb3VsZCBhbHNvIHNwZWNpZnkgdGhpcyBpZiBkZWZhdWx0IHdhcyAnZGFyaydcbiAgICB9KVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAucHJpbWFyeVBhbGV0dGUoJ3NsYWNrJylcbiAgfSlcblxuICAvLyBGYWNlYm9vayBDb25maWdcbiAgLmNvbmZpZyhcbiAgICBmdW5jdGlvbiAoRmFjZWJvb2tQcm92aWRlcikge1xuICAgICAgdmFyIG15QXBwSWQgPSAnOTMxMzc2MTIwMjYzODU2J1xuICAgICAgRmFjZWJvb2tQcm92aWRlci5zZXRBcHBJZChteUFwcElkKVxuICAgICAgRmFjZWJvb2tQcm92aWRlci5pbml0KG15QXBwSWQpXG4gICAgfVxuICApXG5cbiAgLy9TZWN1cml0eSBmb3IgVHJhbnNsYXRlXG4gIC5jb25maWcoZnVuY3Rpb24gKCR0cmFuc2xhdGVQcm92aWRlcikge1xuICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnRW5nJyk7XG4gICAgLy8gRW5hYmxlIGVzY2FwaW5nIG9mIEhUTUxcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIudXNlU2FuaXRpemVWYWx1ZVN0cmF0ZWd5KCdlc2NhcGUnKTtcbiAgfSlcblxuXG5cbiAgLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwkY29udHJvbGxlclByb3ZpZGVyKSB7XG5cbiAgICBhcHAucmVnaXN0ZXJDdHJsID0gJGNvbnRyb2xsZXJQcm92aWRlci5yZWdpc3RlcjtcblxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyAgZGFzaGJvYXJkQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2hvbWUvaG9tZS5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2xvZ2luLWZvcm1AaG9tZSc6IHtcbiAgICAgICAgICAgIC8vY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvbG9naW4tZm9ybS5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy9UcmVuZGluZ1xuICAgICAgLnN0YXRlKCd0cmVuZGluZycsIHtcbiAgICAgICAgdXJsOiAnL2V4cGxvcmUvdHJlbmRpbmcnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyAgZGFzaGJvYXJkQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2hvbWUvdHJlbmQuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGZlZWQ6IGZ1bmN0aW9uIChUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxhdGVzdEZlZWQoKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuXG4gICAgICAvLyBDYXRlZ29yeSBMYW5kaW5nXG4gICAgICAuc3RhdGUoJ2NhdGVnb3J5Jywge1xuICAgICAgICB1cmw6ICcvY2F0ZWdvcnkve1NsdWd9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgLy9jb250cm9sbGVyOiAnQ2F0ZUN0cmwgYXMgY2F0ZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjYXRlZ29yeS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBDYXRlZ29yeSBkZXRhaWxzXG4gICAgICAgICAgICAgIGNhdGVOYW1lOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDYXRlZ29yeS5nZXROYW1lKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBsaXN0IG9mIGNhdGVnb3J5IHRvcGljcyBoZXJlXG4gICAgICAgICAgICAgIGNhdGVUb3BpY3M6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGlzdCgkc3RhdGVQYXJhbXMuU2x1ZylcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gUGxhY2VzIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCdwbGFjZXMnLCB7XG4gICAgICAgIHVybDogJy9wbGFjZXMve3BsYWNlX3NsdWd9L3twbGFjZV9pZH0nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdoZWFkZXJAcGxhY2VzJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BsYWNlc0N0cmwgYXMgcGxhY2VzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BsYWNlL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBwbGFjZUxhbmRpbmc6IGZ1bmN0aW9uIChQbGFjZXMsIFRvcGljcywgJHN0YXRlUGFyYW1zLCAkZmlyZWJhc2VBcnJheSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhXG4gICAgICAgICAgICAgICAgUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICBkYXRhID0gc25hcHNob3QudmFsKClcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNuYXBzaG90LnZhbCgpKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgLy8gcmV0dXJuICAkZmlyZWJhc2VBcnJheShQbGFjZXMuZ2V0UGxhY2VSZWYoJHN0YXRlUGFyYW1zLnBsYWNlX2lkKSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuXG4gICAgICAvLyBUYWcgbGFuZGluZyBwYWdlXG4gICAgICAuc3RhdGUoJ3RhZycsIHtcbiAgICAgICAgdXJsOiAnL3RhZy97VGFnfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ2hlYWRlckB0YWcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVGFnQ3RybCBhcyB0YWdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGFnL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB0YWdOYW1lOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzdGF0ZVBhcmFtcy5UYWdcbiAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICB0YWdMYW5kaW5nOiBmdW5jdGlvbiAoVG9waWNzLCAkc3RhdGVQYXJhbXMsIFRhZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFnID0gJHN0YXRlUGFyYW1zLlRhZ1xuICAgICAgICAgICAgICAgIC8vIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybClcbiAgICAgICAgICAgICAgICAvLyB2YXIgZGF0YVJldCA9ICcnXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHNob3coVGFncy50b3BpY1RhZ3ModGFnKSlcbiAgICAgICAgICAgICAgICAvKnJldHVybiBmYi5jaGlsZCgndGFncy8nICsgdGFnKVxuICAgICAgICAgICAgICAgICAgICAub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHRhZ1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmIuY2hpbGQoJ3RvcGljcycpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVxdWFsVG8odGFnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIGZ1bmN0aW9uICh0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNob3coIGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8hKmRhdGFSZXQgPSBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkoZGF0YVJldCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhUmV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAqIS9cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pKi9cbiAgICAgICAgICAgICAgICAvLyB2YXIgdGFnT2JqID0gVGFncy5nZXRUYWdPYmplY3QodGFnKVxuICAgICAgICAgICAgICAgIC8vIHJldHVybiB0YWdPYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vICAgcmV0dXJuIFRvcGljcy50b3BpY3NCeVRhZyh0YWcpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZXh0ZW5kKHt9LCB0YWdPYmouJHZhbHVlLCBzbmFwLnZhbCgpKSlcbiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIGV4dGVuZCh7fSwgdGFnT2JqLiR2YWx1ZSwgc25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICAgICAgLy8gfSlcblxuICAgICAgICAgICAgICAgIC8vIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgZmIub25jZSgndmFsdWUnLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIGRhdGEgPSBzbmFwc2hvdC52YWwoKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFTbmFwKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gd29yZC5pbmRleE9mKCcgJylcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZmlyc3QgPSBkYXRhU25hcC5OYW1lLnN1YnN0cmluZygwLCBpbmRleClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgbGFzdCA9IHdvcmQuc3Vic3RyaW5nKGluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgY2FuZGlkYXRlID0gZGF0YVNuYXAuTmFtZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChjYW5kaWRhdGUuaW5kZXhPZihmaXJzdCkgPj0gMCAmJiBjYW5kaWRhdGUuaW5kZXhPZihsYXN0KSA+PSAwKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhU25hcC5DSUQpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVqZWN0KCdTb21lIHNvcnQgb2YgZmFpbHVyZScpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC8vICAgICB9KVxuICAgICAgICAgICAgICAgIC8vIH0pXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLnRvcGljc0J5VGFnKHRhZylcbiAgICAgICAgICAgICAgLy8gLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcCl7XG4gICAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gVG9waWMgbGFuZGluZyBwYWdlXG4gICAgICAuc3RhdGUoJ3RvcGljJywge1xuICAgICAgICB1cmw6ICcve1NsdWd9JyxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIC8qU2x1ZzogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywkc3RhdGUsQXV0aCkge1xuICAgICAgICAgICAgJHN0YXRlUGFyYW1zLlNsdWcgPSBkZWNvZGVVUklDb21wb25lbnQoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICBpZigkc3RhdGVQYXJhbXMuU2x1ZyA9PSAnJyl7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSovXG4gICAgICAgIH0sXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0xhbmRpbmdDdHJsIGFzIHRvcGljTGFuZGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0b3BpY3MvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uIChBdXRoLCBVc2VycywgJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNVaWQgPSAnJ1xuICAgICAgICAgICAgICAgIC8vIElmIHVzZXIgbG9naW4sIGNoZWNrIGlmIHRoZXkgYXJlIHRoZSB0b3BpYyBvd25lclxuICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICB0b3BpY1VpZCA9IGRhdGFbMF0udWlkXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKEF1dGgucmVmLmdldEF1dGgoKS51aWQgPT0gdG9waWNVaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0b3BpY0xhbmRpbmc6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcmVwbHlMaXN0OiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MsICRzdGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSA9ICcnXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5mb3J0b3BpYygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9waWNLZXkgPSBkYXRhWzBdLiRpZFxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCd0b3BpYy1ub3Rmb3VuZCcpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLnJlcGx5TGlzdCh0b3BpY0tleSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB2aWV3RGF0YTogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSwgdmlld3NcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeU9iaiA9IHsndXNlcklQJzogJycsICdjcmVhdGVkJzogdGltZX1cbiAgICAgICAgICAgICAgICBVc2Vycy5nZXRMb2NhdGlvbklQKCkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iai51c2VySVAgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBoaXN0b3J5T2JqLnVzZXJJUCA9IGRhdGEuZGF0YVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5nZXRUb3BpY0J5U2x1Zygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdLiRpZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9waWNLZXkgPSBkYXRhWzBdLiRpZFxuICAgICAgICAgICAgICAgICAgICB2aWV3cyA9IFRvcGljcy5nZXRWaWV3cyh0b3BpY0tleSlcblxuICAgICAgICAgICAgICAgICAgICB2aWV3cy5vYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5jb3VudCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2NvdW50Jykuc2V0KDEpXG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdzLnJlZi5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS5jb3VudCArIDEpXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciB1aWQgPSBhdXRoLnVpZFxuICAgICAgICAgICAgICAgICAgICAgIHZpZXdzLnJlZi5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkucHVzaCgpLnNldChoaXN0b3J5T2JqKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCd2aWV3cycpLmNoaWxkKHRvcGljS2V5KS5wdXNoKCkuc2V0KGhpc3RvcnlPYmopXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdmlld3Mub2JqXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZm9sbG93ZXJzOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldFRvcGljQnlTbHVnKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0Rm9sbG93ZXJzKHRvcGljS2V5KS5vYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gVG9waWMgbm90IGZvdW5kXG4gICAgICAuc3RhdGUoJ3RvcGljLW5vdGZvdW5kJywge1xuICAgICAgICB1cmw6ICcvZXJyL25vdGZvdW5kJ1xuICAgICAgfSlcblxuICAgICAgLy8gUHJvZmlsZSBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncHJvZmlsZScsIHtcbiAgICAgICAgdXJsOiAnL3Byb2ZpbGUve05hbWV9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKEF1dGgsIFVzZXJzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlWzBdLiRpZCA9PSBBdXRoLnJlZi5nZXRBdXRoKCkudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uIChVc2VycywgVG9waWNzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuY3JlYXRlZEJ5KHByb2ZpbGVbMF0uJGlkKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAcHJvZmlsZSc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBQcm9maWxlIGxhbmRpbmcgcGFnZVxuICAgICAgLy8gQHByb2ZpbGVDdHJsXG4gICAgICAuc3RhdGUoJ2FjY2NvdW50RWRpdCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvZWRpdCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ3Bhc3N3b3JkRWRpdEBhY2Njb3VudEVkaXQnOiB7XG4gICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9jaGFuZ2VQYXNzd29yZCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcGFzc3dkLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAndXNlckVkaXRAYWNjY291bnRFZGl0Jzoge1xuICAgICAgICAgICAgdXJsOiAnL2FjY291bnQvZWRpdC1mb3JtJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0LWZvcm0uaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHVzZXJQb3N0czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogZnVuY3Rpb24gKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZS5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdnZXRfc3RhcnRlZCcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGF1dGg6IGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRQYXNzd29yZCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvY2hhbmdlUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcGFzc3dkLmh0bWwnXG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRVc2VyRWRpdCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvZWRpdC1mb3JtJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLy8gRGFzaGJvYXJkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgICB1cmw6ICcvdXNlci9kYXNoYm9hcmQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdkYXNoYm9hcmQvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHVzZXJQb3N0czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogZnVuY3Rpb24gKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBubyBzdGF0IG9iamVjdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2ZpbGUuc3RhdCkge1xuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIGRpc3BsYXluYW1lIC0gZ28gdG8gZ2V0X3N0YXJ0ZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGF1dGg6IGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gbmVzdGVkIGxpc3Qgd2l0aCBjdXN0b20gY29udHJvbGxlclxuICAgICAgLnN0YXRlKCdkYXNoYm9hcmQubGlzdCcsIHtcbiAgICAgICAgdXJsOiAnL2ZlZWQve1NsdWd9JyxcbiAgICAgICAgLy90ZW1wbGF0ZVVybDogJy9mZWVkcy9mZWVkLmh0bWwnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2F0ZUN0cmwgYXMgY2F0ZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjYXRlZ29yeS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBDYXRlZ29yeSBkZXRhaWxzXG4gICAgICAgICAgICAgIGNhdGVOYW1lOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDYXRlZ29yeS5nZXROYW1lKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBsaXN0IG9mIGNhdGVnb3J5IHRvcGljcyBoZXJlXG4gICAgICAgICAgICAgIGNhdGVUb3BpY3M6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGlzdCgkc3RhdGVQYXJhbXMuU2x1ZylcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIEZvbGxsb3cgQ2F0ZWdvcnlcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdmb2xsb3dfY2F0ZXMnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2ZvbGxvdy1jYXRlZ29yaWVzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9mb2xsb3ctY2F0ZWdvcmllcy5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBHZXR0aW5nIHN0YXJ0ZWRcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdnZXRfc3RhcnRlZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZ2V0X3N0YXJ0ZWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL2dldF9zdGFydGVkLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uIChVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGF1dGg6IGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAZ2V0X3N0YXJ0ZWQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgIHVybDogJy91c2VyL2xvZ2luJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL2xvZ2luLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnbG9naW4tZm9ybUBsb2dpbic6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvbG9naW4tZm9ybS5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvcmVnaXN0ZXInLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICByZXF1aXJlTm9BdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBBdXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICByZXR1cm4gZXJyb3JcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpXG4gIH0pXG5cbiAgLmZpbHRlcignb3JkZXJPYmplY3RCeScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGl0ZW1zLCBmaWVsZCwgcmV2ZXJzZSkge1xuICAgICAgdmFyIGZpbHRlcmVkID0gW11cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtLiRpZCkuc2V0KGl0ZW0pXG4gICAgICB9KVxuICAgICAgZmlsdGVyZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gKGFbZmllbGRdID4gYltmaWVsZF0gPyAxIDogLTEpXG4gICAgICB9KVxuICAgICAgaWYgKHJldmVyc2UpIGZpbHRlcmVkLnJldmVyc2UoKVxuICAgICAgcmV0dXJuIGZpbHRlcmVkXG4gICAgfVxuICB9KVxuXG4gIC5maWx0ZXIoJ2RlY29kZVVSSScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gZGVjb2RlVVJJKHRleHQpIDogJydcbiAgICB9XG4gIH0pXG5cbiAgLy8gRm9ybWF0dGluZyB0ZXh0cyB0byBpbmNsdWRlIG5ldyBsaW5lXG4gIC5maWx0ZXIoJ25sMmJyJywgZnVuY3Rpb24gKCRzY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gJHNjZS50cnVzdEFzSHRtbCh0ZXh0LnJlcGxhY2UoL1xcbi9nLCAnPGJyLz4nKSkgOiAnJ1xuICAgIH1cbiAgfSlcblxuICAuY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vYm14eXouZmlyZWJhc2Vpby5jb20vJylcblxuZnVuY3Rpb24gc2hvdyAoZGF0YSkge1xuICBjb25zb2xlLmxvZyhkYXRhKVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMilcbn1cblxuLy8gZm9yIGpvaW5pbmcgLSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82NTk4MjM4XG5mdW5jdGlvbiBleHRlbmQgKGJhc2UpIHtcbiAgdmFyIHBhcnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKVxuICBwYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7XG4gICAgaWYgKHAgJiYgdHlwZW9mIChwKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAodmFyIGsgaW4gcCkge1xuICAgICAgICBpZiAocC5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICAgIGJhc2Vba10gPSBwW2tdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIHJldHVybiBiYXNlXG59XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1RvcGljQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwkc2NvcGUsJHJvb3RTY29wZSwgJG1kRGlhbG9nLCAkbWRNZWRpYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLEZpcmViYXNlVXJsLCR0cmFuc2xhdGUsJG5vdGlmaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlTZXJ2aWNlLFRhZ3MsIFRvcGljcywgQXV0aCwgVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTbHVnLFBsYWNlcywgTGFuZ3VhZ2VzLEFyY2hpdmUpe1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpY0N0cmxcIik7XG5cbiAgICB2YXIgdG9waWNDdHJsID0gdGhpcztcblxuXG4gICAgLy9QYXJzZXIgaGVyZVxuICAgIHRvcGljQ3RybC50YWdzICAgICAgPSBUYWdzO1xuICAgIHRvcGljQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgdG9waWNDdHJsLmF1dGggICAgICA9IEF1dGg7XG4gICAgdG9waWNDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHRvcGljQ3RybC5sYW5ndWFnZXMgPSBMYW5ndWFnZXM7XG4gICAgdG9waWNDdHJsLnBsYWNlcyAgICA9IFBsYWNlcztcbiAgICB0b3BpY0N0cmwuYXJjaGl2ZSAgID0gQXJjaGl2ZTtcbiAgICB0b3BpY0N0cmwubm90aSAgICAgID0gTm90aVNlcnZpY2U7XG5cbiAgICBpZih0b3BpY0N0cmwuYXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcbiAgICAgIHRvcGljQ3RybC5wcm9maWxlICA9IHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC5hdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICAgIHRvcGljQ3RybC51aWQgPSB0b3BpY0N0cmwucHJvZmlsZS4kaWQ7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9IHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzID0gdG9waWNDdHJsLnVzZXJzLnVwdm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcyA9IHRvcGljQ3RybC51c2Vycy5kb3dudm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZyA9IHRvcGljQ3RybC51c2Vycy5mb2xsb3dpbmcodG9waWNDdHJsLnVpZCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0b3BpY0N0cmwucHJvZmlsZSA9Jyc7XG4gICAgICB0b3BpY0N0cmwudWlkID0gJyc7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9ICcnO1xuICAgIH1cblxuXG5cbiAgICAvL1ByZXNldCBQYXJhbWV0ZXJzXG4gICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyAgPSBbXTtcbiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0ICAgICA9IFtdO1xuICAgIHRvcGljQ3RybC5pblJlcGx5QXJyICAgID0gW107XG4gICAgdG9waWNDdHJsLmxvYWRCdXN5ICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuc2x1Z1JldHVybiAgICA9IG51bGw7XG4gICAgdG9waWNDdHJsLmNyaXRlcmlhICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSA9IG51bGw7XG4gICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhPWZhbHNlO1xuICAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhID0gbnVsbDtcblxuICAgIC8vaWYgYWxsb3cgbnVsbCBpbiB0aGUgZm9ybVxuICAgIHRvcGljQ3RybC5uZXdUb3BpYyAgICAgID0ge1xuICAgICAgJ2xvY2F0aW9uJzogJycsXG4gICAgICAndXJsJyA6ICcnLFxuICAgICAgJ2lwSW5mbyc6ICcnLFxuICAgICAgJ3RhZ3MnOiAnJyxcbiAgICAgICdib2R5JzogJydcbiAgICB9XG5cblxuICAgIC8vQ2FsYyBhdmVyYWdlIHJldmlldyBpbnB1dCBpbiByZXBseVxuICAgIHRvcGljQ3RybC5hdmdSZXZpZXdSZXBseSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHZhciBvYmpDb3VudCA9IE9iamVjdC5rZXlzKHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5KS5sZW5ndGg7XG4gICAgICB2YXIgYXZnID0gMFxuICAgICAgZm9yKHZhciBpPTA7aTxvYmpDb3VudDtpKyspe1xuICAgICAgICBhdmcgPSBhdmcgKyB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseVtpXTtcbiAgICAgIH1cblxuICAgICAgdG9waWNDdHJsLnJlcGx5UmV2aWV3QXZlcmFnZSA9IGF2Zy9vYmpDb3VudDtcblxuICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLmNyaXRlcmlhUmVwbHkpO1xuXG4gICAgICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSA9IHsgYXZnOiB0b3BpY0N0cmwucmVwbHlSZXZpZXdBdmVyYWdlLCBkYXRhOiB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseX1cbiAgICB9XG5cblxuICAgIC8vR2V0IHRoZSBhdmVyYWdlIHNjb3JlIGZyb20gY3JpdGVyaWEgdmFsdWVzXG4gICAgdG9waWNDdHJsLmF2Z1Jldmlld1Njb3JlID0gZnVuY3Rpb24oZGF0YSl7XG4gICAgICBpZihkYXRhKVxuICAgICAge1xuICAgICAgdmFyIGF2ZyA9MDtcbiAgICAgIGZvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtcbiAgICAgICAgYXZnID0gYXZnICsgZGF0YVtpXS5yYXRpbmc7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXZnL2RhdGEubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9MYWJlbCBmb3IgcmVtb3ZlIHRvcGljc1xuICAgICR0cmFuc2xhdGUoWydLRVlfUkVNT1ZFJywgJ0tFWV9DQU5DRUwnLCdLRVlfQ09ORl9SRU1PVkUnLCdLRVlfQ09ORl9SRU1fQyddKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbnMpIHtcbiAgICAgIHRvcGljQ3RybC5yZW1vdmVUcmFucyA9IHRyYW5zbGF0aW9ucy5LRVlfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNhbmNlbFRyYW5zID0gdHJhbnNsYXRpb25zLktFWV9DQU5DRUw7XG4gICAgICB0b3BpY0N0cmwuY29uZmlybVJlbSAgPSB0cmFuc2xhdGlvbnMuS0VZX0NPTkZfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNvbmZpcm1SZW1Db250ZW50ID0gIHRyYW5zbGF0aW9ucy5LRVlfQ09ORl9SRU1fQztcbiAgICB9KTtcblxuXG4gICAgdG9waWNDdHJsLnVzZXJOYW1lID0gZnVuY3Rpb24odXNlcklkKXtcbiAgICAgIGlmKHVzZXJJZCE9IG51bGwpe1xuICAgICAgICAvL3JldHVybiB0b3BpY0N0cmwudXNlcnMuZ2V0RGlzcGxheU5hbWUodXNlcklkKTtcbiAgICAgIH1cbiAgICB9XG5cblxuXG5cbiAgICAvL0xvZ2luIGZvciBtYXRlcmlhbFxuICAgIHRvcGljQ3RybC5zaG93TWRMb2dpbiA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICB2YXIgdXNlRnVsbFNjcmVlbiA9ICgkbWRNZWRpYSgnc20nKSB8fCAkbWRNZWRpYSgneHMnKSkgJiYgJHNjb3BlLmN1c3RvbUZ1bGxzY3JlZW47XG4gICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgLy9jb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvbWQtbG9naW4tZm9ybS5odG1sJyxcbiAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICB0YXJnZXRFdmVudDogZXYsXG4gICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICBmdWxsc2NyZWVuOiB1c2VGdWxsU2NyZWVuXG4gICAgICAgIH0pXG4gICAgfVxuXG5cblxuICAgIHRvcGljQ3RybC5kZWNvZGVUZXh0ID0gZnVuY3Rpb24odGV4dCl7XG4gICAgICAvL3JldHVybiAkZmlsdGVyKCdzbHVnaWZ5JykoaXRlbS5uYW1lKTtcbiAgICAgIGNvbnNvbGUubG9nKGRlY29kZVVSSSh0ZXh0KSk7XG4gICAgICByZXR1cm4gZGVjb2RlVVJJKHRleHQpO1xuICAgIH1cblxuXG4gICAgdG9waWNDdHJsLmxvYWRNb3JlID0gZnVuY3Rpb24oaXRlbXMpIHtcbiAgICAgIHRvcGljQ3RybC5sb2FkQnVzeSA9IHRydWU7XG4gICAgICB2YXIgZGF0YSA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBkYXRhLnB1c2goaXRlbXNbaV0pO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICByZXR1cm4gZGF0YVxuICAgIH07XG5cbiAgICB0b3BpY0N0cmwubG9hZFRhZ3MgPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLnRhZ3MudGFnc1VybCgpKTtcbiAgICB9O1xuXG5cbiAgICAvKnRvcGljQ3RybC51c2Vycy5nZXRMb2NhdGlvbklQKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICB0b3BpY0N0cmwubmV3VG9waWMuaXBJbmZvID0gZGF0YTtcbiAgICB9KTsqL1xuXG5cbiAgICAvL1VwbG9hZCBQcm9maWxlIGltYWdlXG4gICAgdG9waWNDdHJsLnVwbG9hZEZpbGUgPSBmdW5jdGlvbihmaWxlcyxpbmRleCkge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGZpbGVzLCBmdW5jdGlvbiAoZmxvd0ZpbGUsIGluZGV4KSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzW2luZGV4XSA9IHVyaTtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGZsb3dGaWxlLmZpbGUpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICAvL1Nob3cgY29uZmlybSByZW1vdmUgdG9waWNcbiAgICB0b3BpY0N0cmwuc2hvd0NvbmZpcm1SZW1vdmUgPSBmdW5jdGlvbihldix0b3BpY19vd25lcixvYmope1xuICAgICAgLy8gQXBwZW5kaW5nIGRpYWxvZyB0byBkb2N1bWVudC5ib2R5IHRvIGNvdmVyIHNpZGVuYXYgaW4gZG9jcyBhcHBcbiAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAudGl0bGUodG9waWNDdHJsLmNvbmZpcm1SZW0pXG4gICAgICAgIC50ZXh0Q29udGVudCh0b3BpY0N0cmwuY29uZmlybVJlbUNvbnRlbnQpXG4gICAgICAgIC50YXJnZXRFdmVudChldilcbiAgICAgICAgLm9rKHRvcGljQ3RybC5yZW1vdmVUcmFucylcbiAgICAgICAgLmNhbmNlbCh0b3BpY0N0cmwuY2FuY2VsVHJhbnMpO1xuICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgaWYodG9waWNDdHJsLnJlbW92ZVRvcGljKHRvcGljX293bmVyLG9iaikpe1xuICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vUmVtb3ZlIHRvcGljXG4gICAgdG9waWNDdHJsLnJlbW92ZVRvcGljID0gZnVuY3Rpb24odG9waWNfb3duZXIsb2JqKXtcbiAgICAgIC8vdmVyaWZ5IGlmIHRoZSB0b3BpYyBvd25lciBhbmQgdGhlIGxvZ2luIG93bmVyIGlzIHRoZSBzYW1lIHBwbFxuICAgICAgaWYodG9waWNfb3duZXIgPT0gdG9waWNDdHJsLnVpZCl7XG4gICAgICAgIG1vdmVGYlJlY29yZCh0b3BpY0N0cmwudG9waWNzLnJlZkNoaWxkKG9iai4kaWQpLCB0b3BpY0N0cmwuYXJjaGl2ZS5hZGRDaGlsZChvYmouJGlkKSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS4kd2F0Y2goJycsZnVuY3Rpb24oKXtcbiAgICAgIGNvbnNvbGUubG9nKFwiPj4+IHdhdGNoaW5nIGF0IHRvcGljIGNvbnRyb2xsZXJcIik7XG4gICAgfSlcblxuXG4gICAgLy9SZXBseSB0byB0b3BpY1xuICAgIHRvcGljQ3RybC5yZXBseSA9IGZ1bmN0aW9uKHRvcGljT2JqKXtcblxuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUFycih0b3BpY09iai4kaWQpLiRhZGQoe1xuICAgICAgICB0b3BpY0lkOiAgdG9waWNPYmouJGlkLFxuICAgICAgICBib2R5OiAgICAgdG9waWNDdHJsLm5ld1JlcGx5LmJvZHksXG4gICAgICAgIHVpZDogICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICByZXZpZXc6ICAgdG9waWNDdHJsLmNyaXRSZXBseURhdGEsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vTm90aWZ5IHRvcGljIG93bmVyXG4gICAgICAgIC8vdG9waWNPYmogcmVmZXJzIHRvIHRoZSBwcm9wZXJ0eSBvZiB0aGlzIG9iamVjdFxuICAgICAgICB0b3BpY0N0cmwubm90aS51cGRhdGVOb3RpZmljYXRpb25Db3VudCh0b3BpY09iai4kaWQsdG9waWNPYmoudWlkLHRvcGljQ3RybC51aWQpO1xuICAgICAgfSlcblxuXG5cblxuXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudCh0b3BpY09iai4kaWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICBpZighZGF0YS5jb3VudCl7XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50UmVmKHRvcGljT2JqLiRpZCkuc2V0KDEpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnRSZWYodG9waWNPYmouJGlkKVxuICAgICAgICAgICAgLnNldChkYXRhLmNvdW50ICsxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgLy9TdGF0IHVwZGF0ZSBmb3IgdXNlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvY29tbWVudC9jb3VudCcpXG4gICAgICAgIC5zZXQodG9waWNDdHJsLnByb2ZpbGUuc3RhdC5jb21tZW50LmNvdW50ICsgMSk7XG5cbiAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvdG9waWNzLycrdG9waWNPYmouJGlkKVxuICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG4gICAgLy9SZXBseSBpbiByZXBseVxuICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbih0b3BpY0lkLHJlcGx5SWQpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUluUmVwbHlBcnIodG9waWNJZCxyZXBseUlkKS4kYWRkKHtcbiAgICAgICAgYm9keTogICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkuYm9keSxcbiAgICAgICAgdWlkOiAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KVxuICAgIH1cblxuXG5cbiAgICB0b3BpY0N0cmwuYWRkTmV3Q2hvaWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbmV3SXRlbU5vID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aCsxO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnB1c2goeydpZCc6J2NyaXRlcmlhJytuZXdJdGVtTm99KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLnJlbW92ZUNob2ljZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxhc3RJdGVtID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aC0xO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnNwbGljZShsYXN0SXRlbSk7XG4gICAgfTtcblxuXG4gICAgLy9DcmVhdGUgbmV3IHRvcGljXG4gICAgdG9waWNDdHJsLmNyZWF0ZVRvcGljID0gZnVuY3Rpb24oY2F0ZWdvcnksaXNEcmFmdCl7XG5cbiAgICAgIC8vQ2hlY2sgaWYgd2UgaGF2ZSBsb2NhdGlvbiBkZXRhaWxzXG4gICAgICB2YXIgbG9jYXRpb25EZXRhaWwgPSAnJztcblxuICAgICAgaWYodG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uICE9PSAnJyApe1xuICAgICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24pO1xuICAgICAgICBsb2NhdGlvbkRldGFpbCA9IHtcbiAgICAgICAgICBwbGFjZV9pZDogdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgc2x1ZzogICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5uYW1lKSxcbiAgICAgICAgICBuYW1lOiAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMubmFtZSxcbiAgICAgICAgICBhZGRyZXNzOiAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgLyogREVCVUcgRk9STSBWQUxVRVxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgdHlwZTogICAgICAgICAgIHRvcGljQ3RybC50eXBlLFxuICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgIHRvcGljOiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgIGJvZHk6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuYm9keSxcbiAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICB1aWQ6ICAgICAgICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICBwaG90b3M6ICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyxcbiAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgIGxvY2F0aW9uOiAgICAgICBsb2NhdGlvbkRldGFpbCxcbiAgICAgICAgdXJsOiAgICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy51cmwsXG4gICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICBjcmVhdGVkOiAgICAgICAgbW9tZW50KCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdGFnczogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLFxuICAgICAgICB1c2VySVA6ICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm9cbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICovXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MuYXJyLiRhZGQoe1xuICAgICAgICAgIHR5cGU6ICAgICAgICAgICB0b3BpY0N0cmwudHlwZSxcbiAgICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgICAgdG9waWM6ICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyxcbiAgICAgICAgICBib2R5OiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmJvZHksXG4gICAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICAgIHVpZDogICAgICAgICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICAgIC8vc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICAgIHNsdWc6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgICAgcGhvdG9zOiAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MsXG4gICAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgICAgbG9jYXRpb246ICAgICAgIGxvY2F0aW9uRGV0YWlsLFxuICAgICAgICAgIHVybDogICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudXJsLFxuICAgICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICAgIGNyZWF0ZWQ6ICAgICAgICBtb21lbnQoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHRhZ3M6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudGFncyxcbiAgICAgICAgICB1c2VySVA6ICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mbyxcbiAgICAgICAgICByZXZpZXc6ICAgICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHRvcGljKXtcblxuICAgICAgICAgIHZhciBzbHVnVGV4dCA9Jyc7XG4gICAgICAgICAgLy9pZiB3ZSBhcmUgdW5hYmxlIHRvIGNvbnZlcnQgdG8gc2x1ZyB0aGVuIHdlIHVzZSB0aGUgdG9waWMgdGV4dCwgZWxzZSB1c2Ugc2x1Z1xuICAgICAgICAgIGlmKFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpID09Jycpe1xuICAgICAgICAgICAgc2x1Z1RleHQgPSB0b3BpY0N0cmwubmV3VG9waWMudG9waWM7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBzbHVnVGV4dCA9IFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vVXBkYXRlIHNsdWcgd2l0aCB0b3BpYyBLZXlcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLmdldFRvcGljQnlLZXkodG9waWMua2V5KCkpLnVwZGF0ZSh7XCJzbHVnXCI6c2x1Z1RleHQrdG9waWMua2V5KCl9KTtcblxuICAgICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKVxuICAgICAgICAgICAgLnNldCh0b3BpY0N0cmwucHJvZmlsZS5zdGF0LnBvc3RlZC5jb3VudCArIDEpO1xuXG4gICAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL3RvcGljcy8nK3RvcGljLmtleSgpKVxuICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAvL0lmIHRoZXJlIGlzIGxvY2F0aW9uXG4gICAgICAgICAgaWYobG9jYXRpb25EZXRhaWwgIT09ICcnKXtcblxuICAgICAgICAgICAgdG9waWNDdHJsLnBsYWNlcy5hZGRDaGlsZChsb2NhdGlvbkRldGFpbC5wbGFjZV9pZClcbiAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQodG9waWMua2V5KCkpXG4gICAgICAgICAgICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAgIHRvcGljQ3RybC5wbGFjZXMuYWRkQ2hpbGQobG9jYXRpb25EZXRhaWwucGxhY2VfaWQpXG4gICAgICAgICAgICAgIC5jaGlsZCgnaW5mbycpLnNldChsb2NhdGlvbkRldGFpbCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9pZiB0aGVyZSBhcmUgdGFnc1xuICAgICAgICAgIGlmKHRvcGljQ3RybC5uZXdUb3BpYy50YWdzICE9PSBudWxsKXtcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCB0b3BpY0N0cmwubmV3VG9waWMudGFncy5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgICAgICAgdG9waWNDdHJsLnRhZ3MuYWRkQ2hpbGQodG9waWNDdHJsLm5ld1RvcGljLnRhZ3NbaW5kZXhdLnRleHQpXG4gICAgICAgICAgICAgICAgLmNoaWxkKHRvcGljLmtleSgpKS5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vTm90aWZ5IGZvbGxvd2VyXG4gICAgICAgICAgdG9waWNDdHJsLm5vdGkubm90aWZ5Rm9sbG93ZXIodG9waWMua2V5KCksdG9waWNDdHJsLnVpZCk7XG5cblxuICAgICAgICAgIC8vUmVzZXQgZm9ybSBoZXJlXG4gICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljID0ge1xuICAgICAgICAgICAgYm9keTogJydcbiAgICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy9DaGVjayBpZiB1c2VyIGlzIGFscmVhZHkgZm9sbG93aW5nIHVzZXJcbiAgICB0b3BpY0N0cmwuY2hlY2tGb2xsb3cgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcbiAgICAgIGlmKHRvcGljQ3RybC51c2Vycy5jaGVja0ZvbGxvdyh0b3BpY0N0cmwudWlkLGZvbGxvd191aWQpKXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9Gb2xsb3cgVXNlclxuICAgIHRvcGljQ3RybC5mb2xsb3dVc2VyID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBiZWluZyBmb2xsb3csIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93ZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKGZvbGxvd191aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50ICsgMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvdWlkLycrIHRvcGljQ3RybC51aWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICB9KTtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGlzIGZvbGxvd2luZywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dpbmdcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCArIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy91aWQvJysgZm9sbG93X3VpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9VbmZvbGxvdyBVc2VyXG4gICAgdG9waWNDdHJsLnVuZm9sbG93VXNlciA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgYmVpbmcgZm9sbG93LCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2VyXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZShmb2xsb3dfdWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL3VpZC8nKyB0b3BpY0N0cmwudWlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgaXMgZm9sbG93aW5nLCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2luZ1xuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2luZy5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy91aWQvJysgZm9sbG93X3VpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuICAgIH1cblxuXG5cbiAgICAgLy91cHZvdGVcbiAgICB0b3BpY0N0cmwudXB2b3RlID0gZnVuY3Rpb24odG9waWMpe1xuXG4gICAgICBpZih0b3BpYy5kb3dudm90ZXMgIT0gdW5kZWZpbmVkICYmIHRvcGljLmRvd252b3Rlc1t0b3BpY0N0cmwudWlkXSAhPSB1bmRlZmluZWQpe1xuICAgICAgICB0b3BpY0N0cmwuY2FuY2VsRG93bnZvdGUodG9waWMpO1xuICAgICAgfVxuICAgICAgdG9waWNDdHJsLnRvcGljcy51cHZvdGVUb3BpYyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLiR2YWx1ZSk7XG5cbiAgICAgICAgLy9TdGF0IHVwZGF0ZVxuICAgICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpYy51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC51cHZvdGVkLmNvdW50ICsgMSk7XG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC90b3BpY3MvJyt0b3BpYy4kaWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmNhbmNlbFVwdm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5kb1Vwdm90ZSh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpYy51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgLy9TdGF0IHVwZGF0ZVxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LnVwdm90ZWQuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvdG9waWNzLycrdG9waWMuJGlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG5cbiAgICAgIHRvcGljQ3RybC51c2VyVXB2b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgICAvL2Rvd252b3RlXG4gICAgdG9waWNDdHJsLmRvd252b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgaWYodG9waWMudXB2b3RlcyAhPSB1bmRlZmluZWQgJiYgdG9waWMudXB2b3Rlc1t0b3BpY0N0cmwudWlkXSAhPSB1bmRlZmluZWQpe1xuICAgICAgICB0b3BpY0N0cmwuY2FuY2VsVXB2b3RlKHRvcGljKTtcbiAgICAgIH1cbiAgICAgIHRvcGljQ3RybC50b3BpY3MuZG93bnZvdGVUb3BpYyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJEb3dudm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuJHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwuY2FuY2VsRG93bnZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZG9Eb3dudm90ZSh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJEb3dudm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gICAgLy9mb2xsb3cgdG9waWNcbiAgICB0b3BpY0N0cmwuZm9sbG93VG9waWMgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLmZvbGxvdyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJGb2xsb3dpbmcuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuaGlzdG9yeVt0b3BpY0N0cmwudWlkXSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLnVuZm9sbG93VG9waWMgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZm9sbG93KHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgfSk7XG5cblxuLy9odHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82MDk5MDQyXG5mdW5jdGlvbiBtb3ZlRmJSZWNvcmQob2xkUmVmLCBuZXdSZWYpIHtcbiAgb2xkUmVmLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICBuZXdSZWYuc2V0KHNuYXAudmFsKCksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICBvbGRSZWYucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0eXBlb2YoY29uc29sZSkgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIE1haW4gbW9kdWxlIG9mIHRoZSBhcHBsaWNhdGlvbi5cbiAqL1xudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHAnLCBbXG4gICAgJ2ZpcmViYXNlJyxcbiAgICAnYW5ndWxhci1tZDUnLCAvLyBFbmNyeXB0IGVtYWlsXG4gICAgJ25nUm91dGUnLFxuICAgICd1aS5yb3V0ZXInLFxuICAgICduZ01hdGVyaWFsJywgLy8gSW50ZXJmYWNlXG4gICAgJ2FuZ3VsYXJNb21lbnQnLCAvLyBUaW1lIG1hbmFnZW1lbnRcbiAgICAnZmxvdycsIC8vIEltYWdlIHVwbG9hZFxuICAgICdzbHVnaWZpZXInLCAvLyBDcmVhdGUgU2x1Z3NcbiAgICAnbmdBdXRvY29tcGxldGUnLCAvLyBHb29nbGUgcGxhY2VzXG4gICAgJ25nVGFnc0lucHV0JywgLy8gVGFnc1xuICAgICdjZ05vdGlmeScsIC8vIE5vdGlmaWNhdGlvbiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9jZ3Jvc3MvYW5ndWxhci1ub3RpZnlcbiAgICAncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScsIC8vIFRyYW5zbGF0aW9uIC0gaHR0cHM6Ly9hbmd1bGFyLXRyYW5zbGF0ZS5naXRodWIuaW8vXG4gICAgJ2ZhY2Vib29rJywgICAgICAgLy8gIEZhY2Vib29rIC0gaHR0cHM6Ly9naXRodWIuY29tL0NpdWwvYW5ndWxhci1mYWNlYm9va1xuICAgICdhbmd1bGFyLWZsZXhzbGlkZXInLCAvLyBJbWFnZSBzbGlkZXIgLSBodHRwczovL2dpdGh1Yi5jb20vdGhlbmlrc28vYW5ndWxhci1mbGV4c2xpZGVyXG5cbiAgICAvLyBFbW90aWNvbiAtLSBodHRwOi8vbWlzdGljMTAwLmdpdGh1Yi5pby9hbmd1bGFyLXNtaWxpZXMvXG4gICAgJ25nU2FuaXRpemUnLFxuICAgICd1aS5ib290c3RyYXAnLCAgIC8vICBPUiBtZ2NyZWEubmdTdHJhcFxuICAgICdhbmd1bGFyLXNtaWxpZXMnLFxuXG4gICAgJ25nQ29va2llcycsICAgICAgLy8gIGNvb2tpZXMgc3R1ZmZcbiAgICAnbm90aWZpY2F0aW9uJywgICAvLyAgd2ViIG5vdGlmaWNhdGlvbiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9uZW96aXJvL2FuZ3VsYXItbm90aWZpY2F0aW9uXG5cbiAgXSlcblxuICAuY29uZmlnKFtcIiRtZFRoZW1pbmdQcm92aWRlclwiLCBmdW5jdGlvbiAoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ3NsYWNrJywge1xuICAgICAgJzUwJzogJ2ZmZWJlZScsXG4gICAgICAnMTAwJzogJ2ZmY2RkMicsXG4gICAgICAnMjAwJzogJ2VmOWE5YScsXG4gICAgICAnMzAwJzogJ2U1NzM3MycsXG4gICAgICAnNDAwJzogJ2VmNTM1MCcsXG4gICAgICAnNTAwJzogJzREMzk0QicsIC8vIHByaW1hcnkgY29sb3VyXG4gICAgICAnNjAwJzogJ2U1MzkzNScsXG4gICAgICAnNzAwJzogJ2QzMmYyZicsXG4gICAgICAnODAwJzogJ2M2MjgyOCcsXG4gICAgICAnOTAwJzogJ2I3MWMxYycsXG4gICAgICAnQTEwMCc6ICdmZjhhODAnLFxuICAgICAgJ0EyMDAnOiAnZmY1MjUyJyxcbiAgICAgICdBNDAwJzogJ2ZmMTc0NCcsXG4gICAgICAnQTcwMCc6ICdkNTAwMDAnLFxuICAgICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JywgLy8gd2hldGhlciwgYnkgZGVmYXVsdCwgdGV4dCAoY29udHJhc3QpXG4gICAgICAvLyBvbiB0aGlzIHBhbGV0dGUgc2hvdWxkIGJlIGRhcmsgb3IgbGlnaHRcbiAgICAgICdjb250cmFzdERhcmtDb2xvcnMnOiBbJzUwJywgJzEwMCcsIC8vIGh1ZXMgd2hpY2ggY29udHJhc3Qgc2hvdWxkIGJlICdkYXJrJyBieSBkZWZhdWx0XG4gICAgICAgICcyMDAnLCAnMzAwJywgJzQwMCcsICdBMTAwJ10sXG4gICAgICAnY29udHJhc3RMaWdodENvbG9ycyc6IHVuZGVmaW5lZCAvLyBjb3VsZCBhbHNvIHNwZWNpZnkgdGhpcyBpZiBkZWZhdWx0IHdhcyAnZGFyaydcbiAgICB9KVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAucHJpbWFyeVBhbGV0dGUoJ3NsYWNrJylcbiAgfV0pXG5cbiAgLy8gRmFjZWJvb2sgQ29uZmlnXG4gIC5jb25maWcoXG4gICAgW1wiRmFjZWJvb2tQcm92aWRlclwiLCBmdW5jdGlvbiAoRmFjZWJvb2tQcm92aWRlcikge1xuICAgICAgdmFyIG15QXBwSWQgPSAnOTMxMzc2MTIwMjYzODU2J1xuICAgICAgRmFjZWJvb2tQcm92aWRlci5zZXRBcHBJZChteUFwcElkKVxuICAgICAgRmFjZWJvb2tQcm92aWRlci5pbml0KG15QXBwSWQpXG4gICAgfV1cbiAgKVxuXG4gIC8vU2VjdXJpdHkgZm9yIFRyYW5zbGF0ZVxuICAuY29uZmlnKFtcIiR0cmFuc2xhdGVQcm92aWRlclwiLCBmdW5jdGlvbiAoJHRyYW5zbGF0ZVByb3ZpZGVyKSB7XG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnByZWZlcnJlZExhbmd1YWdlKCdFbmcnKTtcbiAgICAvLyBFbmFibGUgZXNjYXBpbmcgb2YgSFRNTFxuICAgICR0cmFuc2xhdGVQcm92aWRlci51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3koJ2VzY2FwZScpO1xuICB9XSlcblxuXG5cbiAgLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBcIiRjb250cm9sbGVyUHJvdmlkZXJcIiwgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsJGNvbnRyb2xsZXJQcm92aWRlcikge1xuXG4gICAgYXBwLnJlZ2lzdGVyQ3RybCA9ICRjb250cm9sbGVyUHJvdmlkZXIucmVnaXN0ZXI7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgIGRhc2hib2FyZEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHJlcXVpcmVOb0F1dGg6IFtcIiRzdGF0ZVwiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdsb2dpbi1mb3JtQGhvbWUnOiB7XG4gICAgICAgICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2xvZ2luLWZvcm0uaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vVHJlbmRpbmdcbiAgICAgIC5zdGF0ZSgndHJlbmRpbmcnLCB7XG4gICAgICAgIHVybDogJy9leHBsb3JlL3RyZW5kaW5nJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgIGRhc2hib2FyZEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdob21lL3RyZW5kLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBmZWVkOiBbXCJUb3BpY3NcIiwgZnVuY3Rpb24gKFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGF0ZXN0RmVlZCgpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuXG4gICAgICAvLyBDYXRlZ29yeSBMYW5kaW5nXG4gICAgICAuc3RhdGUoJ2NhdGVnb3J5Jywge1xuICAgICAgICB1cmw6ICcvY2F0ZWdvcnkve1NsdWd9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgLy9jb250cm9sbGVyOiAnQ2F0ZUN0cmwgYXMgY2F0ZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjYXRlZ29yeS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBDYXRlZ29yeSBkZXRhaWxzXG4gICAgICAgICAgICAgIGNhdGVOYW1lOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCJDYXRlZ29yeVwiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBDYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBDYXRlZ29yeS5nZXROYW1lKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIC8vIEdldHRpbmcgbGlzdCBvZiBjYXRlZ29yeSB0b3BpY3MgaGVyZVxuICAgICAgICAgICAgICBjYXRlVG9waWNzOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCJUb3BpY3NcIiwgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5saXN0KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gUGxhY2VzIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCdwbGFjZXMnLCB7XG4gICAgICAgIHVybDogJy9wbGFjZXMve3BsYWNlX3NsdWd9L3twbGFjZV9pZH0nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdoZWFkZXJAcGxhY2VzJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1BsYWNlc0N0cmwgYXMgcGxhY2VzQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BsYWNlL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBwbGFjZUxhbmRpbmc6IFtcIlBsYWNlc1wiLCBcIlRvcGljc1wiLCBcIiRzdGF0ZVBhcmFtc1wiLCBcIiRmaXJlYmFzZUFycmF5XCIsIGZ1bmN0aW9uIChQbGFjZXMsIFRvcGljcywgJHN0YXRlUGFyYW1zLCAkZmlyZWJhc2VBcnJheSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhXG4gICAgICAgICAgICAgICAgUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICBkYXRhID0gc25hcHNob3QudmFsKClcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNuYXBzaG90LnZhbCgpKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAgICAgICAgICAgLy8gcmV0dXJuICAkZmlyZWJhc2VBcnJheShQbGFjZXMuZ2V0UGxhY2VSZWYoJHN0YXRlUGFyYW1zLnBsYWNlX2lkKSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gVGFnIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0YWcnLCB7XG4gICAgICAgIHVybDogJy90YWcve1RhZ30nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdoZWFkZXJAdGFnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RhZ0N0cmwgYXMgdGFnQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RhZy9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdGFnTmFtZTogW1wiJHN0YXRlUGFyYW1zXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHN0YXRlUGFyYW1zLlRhZ1xuICAgICAgICAgICAgICB9XSxcblxuICAgICAgICAgICAgICB0YWdMYW5kaW5nOiBbXCJUb3BpY3NcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCJUYWdzXCIsIGZ1bmN0aW9uIChUb3BpY3MsICRzdGF0ZVBhcmFtcywgVGFncykge1xuICAgICAgICAgICAgICAgIHZhciB0YWcgPSAkc3RhdGVQYXJhbXMuVGFnXG4gICAgICAgICAgICAgICAgLy8gdmFyIGZiID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKVxuICAgICAgICAgICAgICAgIC8vIHZhciBkYXRhUmV0ID0gJydcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gc2hvdyhUYWdzLnRvcGljVGFncyh0YWcpKVxuICAgICAgICAgICAgICAgIC8qcmV0dXJuIGZiLmNoaWxkKCd0YWdzLycgKyB0YWcpXG4gICAgICAgICAgICAgICAgICAgIC5vbigndmFsdWUnLCBmdW5jdGlvbiAodGFnU25hcCkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYi5jaGlsZCgndG9waWNzJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vcmRlckJ5Q2hpbGQoXCJ0YWdzXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXF1YWxUbyh0YWcpXG4gICAgICAgICAgICAgICAgICAgICAgICAub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHRvcGljU25hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvdyggZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLyEqZGF0YVJldCA9IGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkZmlyZWJhc2VBcnJheShkYXRhUmV0KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFSZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICohL1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSkqL1xuICAgICAgICAgICAgICAgIC8vIHZhciB0YWdPYmogPSBUYWdzLmdldFRhZ09iamVjdCh0YWcpXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRhZ09iai4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICByZXR1cm4gVG9waWNzLnRvcGljc0J5VGFnKHRhZykub25jZSgndmFsdWUnLCBmdW5jdGlvbiAoc25hcCkge1xuICAgICAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhleHRlbmQoe30sIHRhZ09iai4kdmFsdWUsIHNuYXAudmFsKCkpKVxuICAgICAgICAgICAgICAgIC8vICAgICByZXR1cm4gZXh0ZW5kKHt9LCB0YWdPYmouJHZhbHVlLCBzbmFwLnZhbCgpKVxuICAgICAgICAgICAgICAgIC8vICAgfSlcbiAgICAgICAgICAgICAgICAvLyB9KVxuXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIC8vICAgICBmYi5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB2YXIgZGF0YSA9IHNuYXBzaG90LnZhbCgpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24oZGF0YVNuYXApIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgaW5kZXggPSB3b3JkLmluZGV4T2YoJyAnKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBmaXJzdCA9IGRhdGFTbmFwLk5hbWUuc3Vic3RyaW5nKDAsIGluZGV4KVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBsYXN0ID0gd29yZC5zdWJzdHJpbmcoaW5kZXggKyAxKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBjYW5kaWRhdGUgPSBkYXRhU25hcC5OYW1lXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5pbmRleE9mKGZpcnN0KSA+PSAwICYmIGNhbmRpZGF0ZS5pbmRleE9mKGxhc3QpID49IDApXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICByZXNvbHZlKGRhdGFTbmFwLkNJRClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICByZWplY3QoJ1NvbWUgc29ydCBvZiBmYWlsdXJlJylcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLy8gICAgIH0pXG4gICAgICAgICAgICAgICAgLy8gfSlcblxuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MudG9waWNzQnlUYWcodGFnKVxuICAgICAgICAgICAgICAvLyAub25jZSgndmFsdWUnLCBmdW5jdGlvbihzbmFwKXtcbiAgICAgICAgICAgICAgLy8gfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gVG9waWMgbGFuZGluZyBwYWdlXG4gICAgICAuc3RhdGUoJ3RvcGljJywge1xuICAgICAgICB1cmw6ICcve1NsdWd9JyxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIC8qU2x1ZzogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywkc3RhdGUsQXV0aCkge1xuICAgICAgICAgICAgJHN0YXRlUGFyYW1zLlNsdWcgPSBkZWNvZGVVUklDb21wb25lbnQoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICBpZigkc3RhdGVQYXJhbXMuU2x1ZyA9PSAnJyl7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSovXG4gICAgICAgIH0sXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0xhbmRpbmdDdHJsIGFzIHRvcGljTGFuZGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0b3BpY3MvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGlzT3duZXI6IFtcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoQXV0aCwgVXNlcnMsICRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljVWlkID0gJydcbiAgICAgICAgICAgICAgICAvLyBJZiB1c2VyIGxvZ2luLCBjaGVjayBpZiB0aGV5IGFyZSB0aGUgdG9waWMgb3duZXJcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdG9waWNVaWQgPSBkYXRhWzBdLnVpZFxuICAgICAgICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkudWlkID09IHRvcGljVWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIHRvcGljTGFuZGluZzogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKTtcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIHJlcGx5TGlzdDogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIFwiJHN0YXRlXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgJHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5ID0gJydcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbMF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3RvcGljLW5vdGZvdW5kJylcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MucmVwbHlMaXN0KHRvcGljS2V5KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICB2aWV3RGF0YTogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXksIHZpZXdzXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmogPSB7J3VzZXJJUCc6ICcnLCAnY3JlYXRlZCc6IHRpbWV9XG4gICAgICAgICAgICAgICAgVXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmoudXNlcklQID0gZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iai51c2VySVAgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0VG9waWNCeVNsdWcoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgICAgdmlld3MgPSBUb3BpY3MuZ2V0Vmlld3ModG9waWNLZXkpXG5cbiAgICAgICAgICAgICAgICAgICAgdmlld3Mub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY291bnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuY291bnQgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gYXV0aC51aWRcbiAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnB1c2goKS5zZXQoaGlzdG9yeU9iailcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgndmlld3MnKS5jaGlsZCh0b3BpY0tleSkucHVzaCgpLnNldChoaXN0b3J5T2JqKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdzLm9ialxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBmb2xsb3dlcnM6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldFRvcGljQnlTbHVnKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0Rm9sbG93ZXJzKHRvcGljS2V5KS5vYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFRvcGljIG5vdCBmb3VuZFxuICAgICAgLnN0YXRlKCd0b3BpYy1ub3Rmb3VuZCcsIHtcbiAgICAgICAgdXJsOiAnL2Vyci9ub3Rmb3VuZCdcbiAgICAgIH0pXG5cbiAgICAgIC8vIFByb2ZpbGUgbGFuZGluZyBwYWdlXG4gICAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICAgIHVybDogJy9wcm9maWxlL3tOYW1lfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGlzT3duZXI6IFtcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbiAoQXV0aCwgVXNlcnMsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlQnlVc2VybmFtZSgkc3RhdGVQYXJhbXMuTmFtZSkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGVbMF0uJGlkID09IEF1dGgucmVmLmdldEF1dGgoKS51aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICB1c2VyUG9zdHM6IFtcIlVzZXJzXCIsIFwiVG9waWNzXCIsIFwiJHN0YXRlUGFyYW1zXCIsIGZ1bmN0aW9uIChVc2VycywgVG9waWNzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuY3JlYXRlZEJ5KHByb2ZpbGVbMF0uJGlkKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBwcm9maWxlOiBbXCIkc3RhdGVcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCIkcm9vdFNjb3BlXCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIGZ1bmN0aW9uICgkc3RhdGUsICRzdGF0ZVBhcmFtcywgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQHByb2ZpbGUnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gUHJvZmlsZSBsYW5kaW5nIHBhZ2VcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdhY2Njb3VudEVkaXQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdwYXNzd29yZEVkaXRAYWNjY291bnRFZGl0Jzoge1xuICAgICAgICAgICAgdXJsOiAnL2FjY291bnQvY2hhbmdlUGFzc3dvcmQnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3Bhc3N3ZC5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ3VzZXJFZGl0QGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQtZm9ybScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvZWRpdC1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIiRzdGF0ZVwiLCBcIiRyb290U2NvcGVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZS5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdnZXRfc3RhcnRlZCcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBhdXRoOiBbXCIkc3RhdGVcIiwgXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRQYXNzd29yZCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvY2hhbmdlUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcGFzc3dkLmh0bWwnXG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRVc2VyRWRpdCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvZWRpdC1mb3JtJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLy8gRGFzaGJvYXJkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgICB1cmw6ICcvdXNlci9kYXNoYm9hcmQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdkYXNoYm9hcmQvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHVzZXJQb3N0czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogW1wiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBmdW5jdGlvbiAoJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoLCBVc2Vycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIHN0YXQgb2JqZWN0XG4gICAgICAgICAgICAgICAgICAgIGlmICghcHJvZmlsZS5zdGF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L3Bvc3RlZC9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgbm8gZGlzcGxheW5hbWUgLSBnbyB0byBnZXRfc3RhcnRlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZS5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdnZXRfc3RhcnRlZCcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIGF1dGg6IFtcIiRzdGF0ZVwiLCBcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuXG4gICAgICAvLyBuZXN0ZWQgbGlzdCB3aXRoIGN1c3RvbSBjb250cm9sbGVyXG4gICAgICAuc3RhdGUoJ2Rhc2hib2FyZC5saXN0Jywge1xuICAgICAgICB1cmw6ICcvZmVlZC97U2x1Z30nLFxuICAgICAgICAvL3RlbXBsYXRlVXJsOiAnL2ZlZWRzL2ZlZWQuaHRtbCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYXRlQ3RybCBhcyBjYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NhdGVnb3J5L2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAvLyBHZXR0aW5nIENhdGVnb3J5IGRldGFpbHNcbiAgICAgICAgICAgICAgY2F0ZU5hbWU6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIkNhdGVnb3J5XCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIENhdGVnb3J5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENhdGVnb3J5LmdldE5hbWUoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBsaXN0IG9mIGNhdGVnb3J5IHRvcGljcyBoZXJlXG4gICAgICAgICAgICAgIGNhdGVUb3BpY3M6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxpc3QoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gRm9sbGxvdyBDYXRlZ29yeVxuICAgICAgLy8gQHByb2ZpbGVDdHJsXG4gICAgICAuc3RhdGUoJ2ZvbGxvd19jYXRlcycsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZm9sbG93LWNhdGVnb3JpZXMnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL2ZvbGxvdy1jYXRlZ29yaWVzLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgYXV0aDogW1wiJHN0YXRlXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBHZXR0aW5nIHN0YXJ0ZWRcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdnZXRfc3RhcnRlZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZ2V0X3N0YXJ0ZWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL2dldF9zdGFydGVkLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgYXV0aDogW1wiJHN0YXRlXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGdldF9zdGFydGVkJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvdXNlci9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9sb2dpbi5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2xvZ2luLWZvcm1AbG9naW4nOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2xvZ2luLWZvcm0uaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICAgIHVybDogJy91c2VyL3JlZ2lzdGVyJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgcmVxdWlyZU5vQXV0aDogW1wiJHN0YXRlXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoJHN0YXRlLCBBdXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICByZXR1cm4gZXJyb3JcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKVxuICB9XSlcblxuICAuZmlsdGVyKCdvcmRlck9iamVjdEJ5JywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaXRlbXMsIGZpZWxkLCByZXZlcnNlKSB7XG4gICAgICB2YXIgZmlsdGVyZWQgPSBbXVxuICAgICAgYW5ndWxhci5mb3JFYWNoKGl0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBmaWx0ZXJlZC5wdXNoKGl0ZW0uJGlkKS5zZXQoaXRlbSlcbiAgICAgIH0pXG4gICAgICBmaWx0ZXJlZC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiAoYVtmaWVsZF0gPiBiW2ZpZWxkXSA/IDEgOiAtMSlcbiAgICAgIH0pXG4gICAgICBpZiAocmV2ZXJzZSkgZmlsdGVyZWQucmV2ZXJzZSgpXG4gICAgICByZXR1cm4gZmlsdGVyZWRcbiAgICB9XG4gIH0pXG5cbiAgLmZpbHRlcignZGVjb2RlVVJJJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgcmV0dXJuIHRleHQgPyBkZWNvZGVVUkkodGV4dCkgOiAnJ1xuICAgIH1cbiAgfSlcblxuICAvLyBGb3JtYXR0aW5nIHRleHRzIHRvIGluY2x1ZGUgbmV3IGxpbmVcbiAgLmZpbHRlcignbmwyYnInLCBbXCIkc2NlXCIsIGZ1bmN0aW9uICgkc2NlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dCA/ICRzY2UudHJ1c3RBc0h0bWwodGV4dC5yZXBsYWNlKC9cXG4vZywgJzxici8+JykpIDogJydcbiAgICB9XG4gIH1dKVxuXG4gIC5jb25zdGFudCgnRmlyZWJhc2VVcmwnLCAnaHR0cHM6Ly9ibXh5ei5maXJlYmFzZWlvLmNvbS8nKVxuXG5mdW5jdGlvbiBzaG93IChkYXRhKSB7XG4gIGNvbnNvbGUubG9nKGRhdGEpXG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKVxufVxuXG4vLyBmb3Igam9pbmluZyAtIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2thdG93dWxmLzY1OTgyMzhcbmZ1bmN0aW9uIGV4dGVuZCAoYmFzZSkge1xuICB2YXIgcGFydHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpXG4gIHBhcnRzLmZvckVhY2goZnVuY3Rpb24gKHApIHtcbiAgICBpZiAocCAmJiB0eXBlb2YgKHApID09PSAnb2JqZWN0Jykge1xuICAgICAgZm9yICh2YXIgayBpbiBwKSB7XG4gICAgICAgIGlmIChwLmhhc093blByb3BlcnR5KGspKSB7XG4gICAgICAgICAgYmFzZVtrXSA9IHBba11cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcbiAgcmV0dXJuIGJhc2Vcbn1cblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdBdXRoQ3RybCcsIFtcIiRzY29wZVwiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIiRzdGF0ZVwiLCBcIiRyb290U2NvcGVcIiwgXCIkbWRTaWRlbmF2XCIsIFwiJHRyYW5zbGF0ZVwiLCBcIiRjb29raWVzXCIsIFwiTm90aVNlcnZpY2VcIiwgXCIkbm90aWZpY2F0aW9uXCIsIGZ1bmN0aW9uKCRzY29wZSxBdXRoLCBVc2VycywgJHN0YXRlLCRyb290U2NvcGUsJG1kU2lkZW5hdiwkdHJhbnNsYXRlLCAkY29va2llcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aVNlcnZpY2UsJG5vdGlmaWNhdGlvbil7XG5cbiAgICBjb25zb2xlLmxvZyhcImF1dGhDdHJsXCIpO1xuXG4gICAgdmFyIGF1dGhDdHJsID0gdGhpcztcblxuICAgIC8vQXNrIGZvciBub3RpZmljYXRpb24gcGVybWlzc2lvblxuICAgICRub3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gKHBlcm1pc3Npb24pIHtcbiAgICAgICAgY29uc29sZS5sb2cocGVybWlzc2lvbik7IC8vIGRlZmF1bHQsIGdyYW50ZWQsIGRlbmllZFxuICAgICAgfSk7XG5cbiAgICAvL1BhcnNlclxuICAgIGF1dGhDdHJsLmF1dGggICAgID0gQXV0aDtcbiAgICBhdXRoQ3RybC51c2VycyAgICA9IFVzZXJzO1xuICAgIGF1dGhDdHJsLm5vdGlmaWNhdGlvbiA9IE5vdGlTZXJ2aWNlO1xuXG4gICAgYXV0aEN0cmwuYmFkZ2VWYWx1ZSA9IDA7XG5cbiAgICBpZihBdXRoLnJlZi5nZXRBdXRoKCkgIT0gbnVsbCApe1xuICAgICAgYXV0aEN0cmwucHJvZmlsZSAgICA9IGF1dGhDdHJsLnVzZXJzLmdldFByb2ZpbGUoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCk7XG4gICAgICAvL2F1dGhDdHJsLmJhZGdlVmFsdWUgPSBhdXRoQ3RybC5ub3RpZmljYXRpb24udW5yZWFkTm90aWZpY2F0aW9uKGF1dGhDdHJsLnByb2ZpbGUuJGlkKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgPScnXG4gICAgfVxuXG4gICAgYXV0aEN0cmwudXNlciA9IHtcbiAgICAgIGVtYWlsOiAnJyxcbiAgICAgIHBhc3N3b3JkOiAnJ1xuICAgIH07XG5cblxuICAgICRzY29wZS4kd2F0Y2goJ2JhZGdlVmFsdWUnLGZ1bmN0aW9uKCl7XG4gICAgICBjb25zb2xlLmxvZyhcIj4+PlwiICsgYXV0aEN0cmwuYmFkZ2VWYWx1ZS52YWx1ZSk7XG4gICAgICByZXR1cm4gTm90aVNlcnZpY2UudW5yZWFkTm90aWZpY2F0aW9uKGF1dGhDdHJsLnByb2ZpbGUuJGlkKS50aGVuKGZ1bmN0aW9uKHZhbCl7XG4gICAgICAgIGF1dGhDdHJsLmJhZGdlVmFsdWUgPSB2YWw7XG4gICAgICB9KTtcblxuXG4gICAgICAvL3JldHVybiBhdXRoQ3RybC5iYWRnZVZhbHVlID0gYXV0aEN0cmwubm90aWZpY2F0aW9uLnVucmVhZE5vdGlmaWNhdGlvbihhdXRoQ3RybC5wcm9maWxlLiRpZCk7XG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKGF1dGhDdHJsLmJhZGdlVmFsdWUpO1xuXG5cbiAgICAvL1Jlc2V0IGNvdW50ZXJcbiAgICBhdXRoQ3RybC5yZXNldENvdW50ZXIgPSBmdW5jdGlvbigpe1xuICAgICAgYXV0aEN0cmwubm90aWZpY2F0aW9uLnJlc2V0VW5yZWFkKGF1dGhDdHJsLnByb2ZpbGUuJGlkKTtcbiAgICB9XG5cblxuICAgIC8vQ2hhbmdlIGxhbmd1YWdlXG4gICAgYXV0aEN0cmwudG9nZ2xlTGFuZyA9IGZ1bmN0aW9uIChsYW5nS2V5KSB7XG4gICAgICAkdHJhbnNsYXRlLnVzZShsYW5nS2V5KTtcbiAgICAgIC8vIFNldHRpbmcgYSBjb29raWVcbiAgICAgICRjb29raWVzLnB1dCgndXNlckxhbmcnLCBsYW5nS2V5KTtcbiAgICAgIC8vSWYgdXNlciByZWdpc3RlcmVkIC0gdXBkYXRlIHRoaXMgaW4gdGhlaXIgcHJlZmVyZW5jZVxuICAgICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpKXtcbiAgICAgICAgYXV0aEN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wibGFuZ1wiOmxhbmdLZXl9KVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vQ2hlY2trIHVzZXIgc2VsZWN0ZWQgbGFuZ3VhZ2VcbiAgICBpZighYXV0aEN0cmwucHJvZmlsZS5sYW5nKXtcbiAgICAgIGlmKCRjb29raWVzLmdldCgndXNlckxhbmcnKSl7XG4gICAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoJGNvb2tpZXMuZ2V0KCd1c2VyTGFuZycpKTtcbiAgICAgIH1lbHNle1xuICAgICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKCdFbmcnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoYXV0aEN0cmwucHJvZmlsZS5sYW5nKTtcbiAgICB9XG5cblxuICAgIC8vTG9naW5cbiAgICBhdXRoQ3RybC5sb2dpbiA9IGZ1bmN0aW9uICgpe1xuICAgICAgYXV0aEN0cmwuYXV0aC5hdXRoLiRhdXRoV2l0aFBhc3N3b3JkKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKGF1dGgpe1xuICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcbiAgICAgICAgYXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvL0xvZ291dFxuICAgIGF1dGhDdHJsLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICBBdXRoLmF1dGguJHVuYXV0aCgpO1xuICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgIH1cblxuICAgIC8vUmVnaXN0ZXIgdXNlclxuICAgIGF1dGhDdHJsLnJlZ2lzdGVyID0gZnVuY3Rpb24gKCl7XG4gICAgICBBdXRoLmF1dGguJGNyZWF0ZVVzZXIoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbiAodXNlcil7XG4gICAgICAgIGF1dGhDdHJsLmxvZ2luKCk7XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3Ipe1xuICAgICAgICBhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmZhY3RvcnkoJ0F1dGgnLCBbXCIkZmlyZWJhc2VBdXRoXCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24oJGZpcmViYXNlQXV0aCwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuICAgIHZhciBhdXRoID0gJGZpcmViYXNlQXV0aChyZWYpO1xuXG4gICAgY29uc29sZS5sb2coXCJhdXRoIHNlcnZpY2VcIik7XG5cbiAgICB2YXIgQXV0aCA9IHtcblxuICAgICAgcmVmOnJlZixcbiAgICAgIGF1dGg6IGF1dGgsXG5cbiAgICAgIGdldFVpZDpmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdWlkID0gcmVmLmdldEF1dGgoKTtcbiAgICAgICAgaWYodWlkICE9IG51bGwgKXtcbiAgICAgICAgICByZXR1cm4gcmVmLmdldEF1dGgoKS51aWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfVxuXG4gICAgcmV0dXJuIEF1dGg7XG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdDYXRlQ3RybCcsIFtcIiRzdGF0ZVwiLCBcIkNhdGVnb3J5XCIsIFwiY2F0ZU5hbWVcIiwgXCJjYXRlVG9waWNzXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgQ2F0ZWdvcnksY2F0ZU5hbWUsY2F0ZVRvcGljcyl7XG4gICAgdmFyIGNhdGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2Vyc1xuICAgIGNhdGVDdHJsLmNhdGVOYW1lICAgPSBjYXRlTmFtZTtcbiAgICBjYXRlQ3RybC5jYXRlZ29yeSAgID0gQ2F0ZWdvcnk7XG4gICAgY2F0ZUN0cmwuY2F0ZVRvcGljcyA9IGNhdGVUb3BpY3M7XG5cblxuICAgIGNvbnNvbGUubG9nKFwiQ2F0ZUN0cmxcIik7XG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC8vVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnQ2F0ZVNlcnZpY2UnLCBbXCIkZmlyZWJhc2VPYmplY3RcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXkgLCBGaXJlYmFzZVVybCl7XG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcycpO1xuICAgIHZhciBjYXRlZ29yaWVzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XG5cbiAgICBjb25zb2xlLmxvZyhcImNhdGVnb3J5IHNlcnZpY2VcIik7XG4gICAgXG4gICAgdmFyIENhdGUgPSB7XG5cbiAgICAgIG5hbWU6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoXCJzbHVnXCIpLmVxdWFsVG8odG9waWNfc2x1Zyk7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XG4gICAgICB9LFxuXG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24odG9waWNfc2x1Zyl7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QodXNlcnNSZWYuY2hpbGQodWlkKSk7XG4gICAgICB9LFxuXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oY2hpbGRuYW1lKXtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXG4gICAgICB9LFxuXG4gICAgICBmb2xsb3dMaXN0OmZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcIm5ld3MvZm9sbG93ZXJcIikuZXF1YWxUbyh1aWQpO1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSk7XG4gICAgICB9LFxuXG4gICAgICB1bkZvbGxvdzpmdW5jdGlvbihzbHVnLHVpZCl7XG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMvJytzbHVnKycvZm9sbG93ZXIvJyt1aWQpO1xuICAgICAgICByZWYucmVtb3ZlKCk7XG4gICAgICB9LFxuXG4gICAgICB1c2VyRm9sbG93OmZ1bmN0aW9uKHNsdWcsdWlkKXtcbiAgICAgICAgdmFyIGZvbGxvdz1mYWxzZTtcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcy8nK3NsdWcrJy9mb2xsb3dlci8nK3VpZCk7XG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICBmb2xsb3cgPSBzbmFwc2hvdC5leGlzdHMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcbiAgICAgIH0sXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXG4gICAgICBhbGw6Y2F0ZWdvcmllc1xuICAgIH1cbiAgICByZXR1cm4gQ2F0ZTtcbiAgfV0pXG5cblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJywgW1wiQXV0aFwiLCBcIiRzdGF0ZVwiLCBcIkNhdGVnb3J5XCIsIFwiQ2F0ZVNlcnZpY2VcIiwgXCJUYWdzXCIsIFwiVG9waWNzXCIsIGZ1bmN0aW9uKEF1dGgsICRzdGF0ZSxDYXRlZ29yeSxDYXRlU2VydmljZSxUYWdzLFRvcGljc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgIHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuICAgIGRhc2hib2FyZEN0cmwuYXV0aCA9IEF1dGg7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmNhdGUgICAgICAgID0gQ2F0ZVNlcnZpY2U7XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlZ29yaWVzICA9IENhdGVnb3J5O1xuICAgIGRhc2hib2FyZEN0cmwudG9waWNzICAgICAgPSBUb3BpY3M7XG4gICAgZGFzaGJvYXJkQ3RybC50b3BpY19ncmlkICA9IGZhbHNlO1xuICAgIGRhc2hib2FyZEN0cmwudGFncyAgICAgICAgPSBUYWdzLmFycjtcblxuICAgIGRhc2hib2FyZEN0cmwudXNlckNhdGVGb2xsb3cgID0gW107XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBkYXNoYm9hcmRDdHJsLmZvbGxvd0xpc3QgICAgICA9ICcnO1xuICAgIGRhc2hib2FyZEN0cmwudXNlckZlZWQgPSdudWxsJztcblxuICAgIGRhc2hib2FyZEN0cmwubGF0ZXN0RmVlZCA9IGRhc2hib2FyZEN0cmwudG9waWNzLmxhdGVzdEZlZWQoKTtcblxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGNhdGVfc2x1Zyl7XG4gICAgICBkYXNoYm9hcmRDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIkRhc2hib2FyZEN0cmxcIik7XG4gIH1dKTtcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG5cbiAgLmRpcmVjdGl2ZSgnbWFpbkhlYWRlcicsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXG4gICAgICB0cmFuc2NsdWRlOiAgIHRydWUsXG4gICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgIH1cblxuICB9KVxuXG4gIC8vQmFkZ2Ugbm90aWZpY2F0aW9uXG4gIC5kaXJlY3RpdmUoJ2JhZGdlTm90aWZpY2F0aW9uJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvYmFkZ2Utbm90aWZpY2F0aW9uLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgbm90aWZpY2F0aW9uOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0xpc3Qgb2YgY2F0ZWdvcmllcyBvbiB0aGUgc2lkZXJiYXJcbiAgLmRpcmVjdGl2ZSgncmV2aWV3U2NvcmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9yZXZpZXctc3VtbWFyeS1saXN0Lmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcmV2aWV3OiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0ZvbGxvdyBCdXR0b25cbiAgLmRpcmVjdGl2ZSgndXNlckZvbGxvd2VyQnRuJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9mb2xsb3ctdXNlci5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGZvbGxvdzogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9DYXRlZ29yeSBmb2xsb3cgYnV0dG9uXG4gIC5kaXJlY3RpdmUoJ2NhdGVGb2xsb3dCdG4nLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWZvbGxvdy1idG4uaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBjYXRlOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXG4gIC5kaXJlY3RpdmUoJ3RvcGljR3JpZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvY2F0ZWdvcnktZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuICAvL0dyaWQgVGFncyBmb3Igc2lkZWJhclxuICAuZGlyZWN0aXZlKCd0YWdHcmlkJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90YWctZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuXG4gIC5kaXJlY3RpdmUoJ3RvcGljQ3JlYXRlJywgZnVuY3Rpb24oKXtcblxuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtY3JlYXRlLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdG9waWM6ICc9J1xuICAgICAgfVxuICAgIH1cblxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNMaXN0JywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtbGlzdC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljczogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNBY3Rpb25zQ2FyZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWFjdGlvbnMtY2FyZC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL2ZvciB0YWdzIC0gbWF4IHRhZ3NcbiAgLmRpcmVjdGl2ZSgnZW5mb3JjZU1heFRhZ3MnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ0N0cmwpIHtcbiAgICAgIHZhciBtYXhUYWdzID0gYXR0cnMubWF4VGFncyA/IHBhcnNlSW50KGF0dHJzLm1heFRhZ3MsICc0JykgOiBudWxsO1xuXG4gICAgICBuZ0N0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgJiYgbWF4VGFncyAmJiB2YWx1ZS5sZW5ndGggPiBtYXhUYWdzKSB7XG4gICAgICAgICAgdmFsdWUuc3BsaWNlKHZhbHVlLmxlbmd0aCAtIDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29uZmlnKFsnJHRyYW5zbGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCR0cmFuc2xhdGVQcm92aWRlcikge1xyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnRyYW5zbGF0aW9ucygnRW5nJywge1xyXG4gICAgICAnS0VZX0RBU0hCT0FSRCc6ICAnRGFzaGJvYXJkJyxcclxuICAgICAgJ0tFWV9MQU5HVUFHRVMnOiAgJ0xhbmd1YWdlcycsXHJcbiAgICAgICdLRVlfSE9NRSc6ICAgICAgICdIb21lJyxcclxuICAgICAgJ0tFWV9SRUdJU1RFUic6ICAgJ1JlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9MT0dJTic6ICAgICAgJ0xvZyBpbicsXHJcbiAgICAgICdLRVlfTE9HT1VUJzogICAgICdMb2cgb3V0JyxcclxuICAgICAgJ0tFWV9GT0xMT1cnOiAgICAgJ0ZvbGxvdycsXHJcbiAgICAgICdLRVlfRk9MTE9XRVInOiAgICdGb2xsb3dlcicsXHJcbiAgICAgICdLRVlfVU5GT0xMT1cnOiAgICdVbmZvbGxvdycsXHJcbiAgICAgICdLRVlfRk9MTE9XSU5HJzogICdGb2xsb3dpbmcnLFxyXG4gICAgICAnS0VZX1BPU1QnOiAgICAgICAnUG9zdCcsXHJcbiAgICAgICdLRVlfUE9TVEVEJzogICAgICdQb3N0ZWQnLFxyXG4gICAgICAnS0VZX1VQVk9URSc6ICAgICAnVXB2b3RlJyxcclxuICAgICAgJ0tFWV9VUFZPVEVEJzogICAgJ1Vwdm90ZWQnLFxyXG4gICAgICAnS0VZX0RXTl9WT1RFJzogICAnRG93bnZvdGUnLFxyXG4gICAgICAnS0VZX0RXTl9WT1RFRCc6ICAnRG93bnZvdGVkJyxcclxuICAgICAgJ0tFWV9WSUVXJzogICAgICAgJ1ZpZXcnLFxyXG4gICAgICAnS0VZX1JFTU9WRSc6ICAgICAnUmVtb3ZlJyxcclxuICAgICAgJ0tFWV9DQU5DRUwnOiAgICAgJ0NhbmNlbCcsXHJcbiAgICAgICdLRVlfUVVFU1RJT04nOiAgICdRdWVzdGlvbicsXHJcbiAgICAgICdLRVlfVE9QSUMnOiAgICAgICdUb3BpYycsXHJcbiAgICAgICdLRVlfQ0hHX1BXRCc6ICAgICdDaGFuZ2UgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX1BBU1NXT1JEJzogICAnUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX09MRF9QV0QnOiAgICAnT2xkIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9ORVdfUFdEJzogICAgJ05ldyBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfTkVXX1BXRF9DJzogICdOZXcgcGFzc3dvcmQgY29uZmlybWF0aW9uJyxcclxuICAgICAgJ0tFWV9TQVZFJzogICAgICAgJ1NhdmUnLFxyXG4gICAgICAnS0VZX1NBVkVfRFJBRlQnOiAnU2F2ZSBhcyBkcmFmdCcsXHJcbiAgICAgICdLRVlfVEFHUyc6ICAgICAgICdUYWdzJyxcclxuICAgICAgJ0tFWV9FWFBMT1JFJzogICAgJ0V4cGxvcmUnLFxyXG4gICAgICAnS0VZX0ZFQVRfQ0FUJzogICAgJ0ZlYXR1cmVzIGNhdGVnb3JpZXMnLFxyXG4gICAgICAnS0VZX0NPTU1FTlRTJzogICAnQ29tbWVudHMnLFxyXG4gICAgICAnS0VZX1JFUExZJzogICAgICAnUmVwbHknLFxyXG4gICAgICAnS0VZX1JFVklFVyc6ICAgICAnUmV2aWV3JyxcclxuICAgICAgJ0tFWV9FRElUJzogICAgICAgJ0VkaXQnLFxyXG4gICAgICAnS0VZX1RSRU5EJzogICAgICAnVHJlbmQnLFxyXG4gICAgICAnS0VZX1RSRU5ESU5HJzogICAnVHJlbmRpbmcnLFxyXG4gICAgICAnS0VZX1dSSVRFX1JFUExZJzonV3JpdGUgYSByZXBseScsXHJcbiAgICAgICdLRVlfTEFURVNUX0ZFRUQnOidMYXRlc3QgRmVlZCcsXHJcblxyXG4gICAgICAvL1JlbW92ZSB0b3BpY1xyXG4gICAgICAnS0VZX0NPTkZfUkVNT1ZFJzonQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZT8nLFxyXG4gICAgICAnS0VZX0NPTkZfUkVNX0MnOiAnT25jZSByZW1vdmUsIHlvdSB3aWxsIG5vdCBiZSBhYmxldG8gdG8gZ2V0IHRoaXMgdG9waWMgYmFjaycsXHJcblxyXG5cclxuICAgICAgLy9TRU5URU5DRVxyXG4gICAgICAnS0VZX1dIQVRfT05fVVJfTUlORCc6ICAnV2hhdFxcJ3Mgb24geW91ciBtaW5kPycsXHJcbiAgICAgICdLRVlfWU9VX1dBTlRfRk9MTE9XJzogICdZb3UgbWF5IHdhbnQgdG8gZm9sbG93JyxcclxuICAgICAgJ0tFWV9OT19BQ0NUX1JFR0lTVEVSJzogJ0RvblxcJ3QgaGF2ZSBhY2NvdW50PyBSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfQ0FOVF9DSE5HX1VTRVInOiAgICdEb25cXCd0IGhhdmUgYWNjb3VudD8gUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX1lPVVJfQUNDT1VOVCc6ICAgICAnWW91ciBhY2NvdW50JyxcclxuICAgICAgJ0tFWV9OT1RISU5HX0hFUkUnOiAgICAgJ05vdGhpbmcgaGVyZSwgeWV0JyxcclxuICAgICAgJ0tFWV9XSE9fVE9fRk9MTE9XJzogICAgJ1dobyB0byBmb2xsb3cnLFxyXG4gICAgICAnS0VZX0NBVF9XSUxMX0FQUEVBUic6ICAnRm9sbG93IHNvbWUgY2F0ZWdvcmllcyBhbmQgaXQgd2lsbCBhcHBlYXIgaGVyZScsXHJcbiAgICAgICdLRVlfV0hUX1VSX1NUT1JZJzogICAgICdXaGF0XFwncyB5b3VyIHN0b3J5JyxcclxuICAgICAgJ0tFWV9XUlRfQ09NTUVOVCc6ICAgICAgJ1dyaXRlIGEgY29tbWVudCcsXHJcblxyXG5cclxuXHJcbiAgICAgIC8vVVNFUiBJTlBVVFxyXG4gICAgICAnS0VZX0ZJUlNUTkFNRSc6ICAnRmlyc3QgbmFtZScsXHJcbiAgICAgICdLRVlfTEFTVE5BTUUnOiAgICdMYXN0IG5hbWUnLFxyXG4gICAgICAnS0VZX0JJUlRIREFZJzogICAnQmlydGhkYXknLFxyXG4gICAgICAnS0VZX01PTlRIJzogICAgICAnTW9udGgnLFxyXG4gICAgICAnS0VZX0RBWSc6ICAgICAgICAnRGF5JyxcclxuICAgICAgJ0tFWV9FTUFJTCc6ICAgICAgJ0VtYWlsJyxcclxuICAgICAgJ0tFWV9DT05GX0VNQUlMJzogJ0NvbmZpcm0gRW1haWwnLFxyXG4gICAgICAnS0VZX0dFTkRFUic6ICAgICAnR2VuZGVyJyxcclxuICAgICAgJ0tFWV9NQUxFJzogICAgICAgJ01hbGUnLFxyXG4gICAgICAnS0VZX0ZFTUFMRSc6ICAgICAnRmVtYWxlJyxcclxuICAgICAgJ0tFWV9VU0VSTkFNRSc6ICAgJ1VzZXJuYW1lJyxcclxuICAgICAgJ0tFWV9MT0NBVElPTic6ICAgJ0xvY2F0aW9uJyxcclxuXHJcbiAgICAgIC8vVXNlciBFZGl0XHJcbiAgICAgICdLRVlfRURfUFJPRklMRSc6ICdFZGl0IFByb2ZpbGUnLFxyXG4gICAgICAnS0VZX0VEX0NIR19QV0QnOiAnQ2hhbmdlIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9FRF9QUk9GSUxFJzogJ0VkaXQgUHJvZmlsZScsXHJcbiAgICAgICdLRVlfRURfU0lURSc6ICAgICdXZWJzaXRlJyxcclxuICAgICAgJ0tFWV9FRF9QSE9ORSc6ICAgJ1Bob25lJyxcclxuICAgICAgJ0tFWV9FRF9CSU8nOiAgICAgJ0Jpb2dyYXBoeScsXHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnRyYW5zbGF0aW9ucygn4LmE4LiX4LiiJywge1xyXG4gICAgICAnS0VZX0RBU0hCT0FSRCc6ICAn4Lir4LmJ4Lit4LiH4LiX4Lix4LmJ4LiH4Lir4Lih4LiUJyxcclxuICAgICAgJ0tFWV9MQU5HVUFHRVMnOiAgJ+C4oOC4suC4qeC4sicsXHJcbiAgICAgICdLRVlfSE9NRSc6ICAgICAgICfguKvguJnguYnguLLguYHguKPguIEnLFxyXG4gICAgICAnS0VZX1JFR0lTVEVSJzogICAn4Liq4Lih4Lix4LiE4Lij4LmD4LiK4LmJJyxcclxuICAgICAgJ0tFWV9MT0dJTic6ICAgICAgJ+C5gOC4guC5ieC4suC4quC4ueC5iOC4o+C4sOC4muC4micsXHJcbiAgICAgICdLRVlfRk9MTE9XJzogICAgICfguJXguLTguJTguJXguLLguKEnLFxyXG4gICAgICAnS0VZX1BPU1QnOiAgICAgICAn4LmC4Lie4Liq4LiV4LmMJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnByZWZlcnJlZExhbmd1YWdlKCdlbicpO1xyXG4gIH1dKVxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdOb3RpQ3RybCcsIFtcIiRzdGF0ZVwiLCBcIkNhdGVnb3J5XCIsIFwiVG9waWNzXCIsIFwiTm90aVNlcnZpY2VcIiwgZnVuY3Rpb24oJHN0YXRlLENhdGVnb3J5LFRvcGljcyxOb3RpU2VydmljZSl7XHJcbiAgICB2YXIgbm90aUN0cmwgPSB0aGlzO1xyXG5cclxuXHJcbiAgICBub3RpQ3RybC50b3BpY3MgPSBUb3BpY3M7XHJcbiAgICBub3RpQ3RybC5mZWVkICAgPSBmZWVkO1xyXG4gICAgbm90aUN0cmwubm90aVNlcnZpY2UgPSBOb3RpU2VydmljZTtcclxuXHJcbiAgICBub3RpQ3RybC5ub3RpZnlUbyA9ZnVuY3Rpb24odWlkKXtcclxuICAgICAgcmV0dXJuIG5vdGlDdHJsLmFyci5wdXNoKHVpZCkuJGFkZCh1aWQpXHJcbiAgICB9XHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuXG4gIC5mYWN0b3J5KCdOb3RpU2VydmljZScsIFtcIiRmaXJlYmFzZU9iamVjdFwiLCBcIiRmaXJlYmFzZUFycmF5XCIsIFwiRmlyZWJhc2VVcmxcIiwgXCJVc2Vyc1wiLCBcIiRub3RpZmljYXRpb25cIiwgXCIkcVwiLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5ICwgRmlyZWJhc2VVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLCRub3RpZmljYXRpb24sJHEpe1xuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbicpO1xuICAgIHZhciBub3RpID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XG4gICAgdmFyIHVzZXJzID0gVXNlcnM7XG5cbiAgICBjb25zb2xlLmxvZygnbm90aSBzZXJ2aWNlJyk7XG5cbiAgICB2YXIgTm90aWZpY2F0aW9uID0ge1xuXG4gICAgICAvL0Rpc3BsYXkgdW5yZWFkXG4gICAgICB1bnJlYWROb3RpZmljYXRpb246ZnVuY3Rpb24odWlkKXtcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XG4gICAgICAgIHZhciBjb3VudGVyO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIixmdW5jdGlvbihzbmFwc2hvdCl7XG4gICAgICAgICAgY291bnRlciA9IHNuYXBzaG90LnZhbCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHNuYXBzaG90LnZhbCgpKTtcblxuICAgICAgICAgIGlmKGNvdW50ZXIgPiAwKXtcbiAgICAgICAgICAgICRub3RpZmljYXRpb24oJ05ldyBtZXNzYWdlIGZyb20gUWFueWEnLCB7XG4gICAgICAgICAgICAgIGJvZHk6ICdZb3UgaGF2ZSAnK2NvdW50ZXIgKycgdW5yZWFkIG1lc3NhZ2VzJyxcbiAgICAgICAgICAgICAgZGlyOiAnYXV0bycsXG4gICAgICAgICAgICAgIGxhbmc6ICdlbicsXG4gICAgICAgICAgICAgIHRhZzogJ215LXRhZycsXG4gICAgICAgICAgICAgIGljb246ICdodHRwOi8vd3d3LmNsLmNhbS5hYy51ay9yZXNlYXJjaC9zcmcvbmV0b3MvaW1hZ2VzL3FzZW5zZS1sb2dvLnBuZycsXG4gICAgICAgICAgICAgIC8vZGVsYXk6IDEwMDAsIC8vIGluIG1zXG4gICAgICAgICAgICAgIGZvY3VzV2luZG93T25DbGljazogdHJ1ZSAvLyBmb2N1cyB0aGUgd2luZG93IG9uIGNsaWNrXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoY291bnRlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIH0sXG5cblxuICAgICAgLy9Ob3RpZnkgZm9sbG93ZXJzXG4gICAgICBub3RpZnlGb2xsb3dlcjpmdW5jdGlvbih0b3BpY0lkLHVpZCl7XG4gICAgICAgIHZhciByZWYgPSB1c2Vycy5nZXRGb2xsb3dlcih1aWQpO1xuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgc25hcHNob3QuZm9yRWFjaChmdW5jdGlvbihjaGlsZFNuYXBzaG90KSB7XG4gICAgICAgICAgICAvL3VwZGF0ZSBub3RpZmljYXRpb24gYW5kIGRldGFpbHNcbiAgICAgICAgICAgIE5vdGlmaWNhdGlvbi51cGRhdGVOb3RpZmljYXRpb25Db3VudCh0b3BpY0lkLGNoaWxkU25hcHNob3Qua2V5KCkpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9LFxuXG4gICAgICAvL0FkZCBkZXRhaWwgZm9yIHRoaXMgbm90aWZpY3RpYW9uXG4gICAgICBub3RpZnlMb2c6ZnVuY3Rpb24odG9waWNJZCx1aWQsZnJvbV91aWQpe1xuICAgICAgICBjb25zb2xlLmxvZyhcInVpZCBcIit1aWQpO1xuICAgICAgICBjb25zb2xlLmxvZyhcImZyb20gdWlkIFwiKyBmcm9tX3VpZCk7XG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nKTtcbiAgICAgICAgcmVmLm9uLmFkZENoaWxkKHVpZCkucHVzaCgpLnNldCh7XG4gICAgICAgICAgdG9waWNJZDogICAgdG9waWNJZCxcbiAgICAgICAgICBmcm9tOiAgICAgICBmcm9tX3VpZCxcbiAgICAgICAgICBpc19yZWFkOiAgICBmYWxzZSxcbiAgICAgICAgICB0aW1lc3RhbXA6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAkbm90aWZpY2F0aW9uKCdOZXcgbWVzc2FnZSBmcm9tIFFhbnlhJywge1xuICAgICAgICAgICAgYm9keTogJ1lvdSBoYXZlIG5ldyBtZXNzYWdlJyxcbiAgICAgICAgICAgIGRpcjogJ2F1dG8nLFxuICAgICAgICAgICAgbGFuZzogJ2VuJyxcbiAgICAgICAgICAgIHRhZzogJ215LXRhZycsXG4gICAgICAgICAgICBpY29uOiAnaHR0cDovL3d3dy5jbC5jYW0uYWMudWsvcmVzZWFyY2gvc3JnL25ldG9zL2ltYWdlcy9xc2Vuc2UtbG9nby5wbmcnLFxuICAgICAgICAgICAgLy9kZWxheTogMTAwMCwgLy8gaW4gbXNcbiAgICAgICAgICAgIGZvY3VzV2luZG93T25DbGljazogdHJ1ZSAvLyBmb2N1cyB0aGUgd2luZG93IG9uIGNsaWNrXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICB9LFxuXG5cbiAgICAgIC8vUmVzZXQgdW5yZWFkIGNvdW50ZXJcbiAgICAgIHJlc2V0VW5yZWFkOmZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nK3VpZCsnL3VucmVhZCcpO1xuICAgICAgICByZWYuc2V0KDApO1xuICAgICAgfSxcblxuXG4gICAgICAvL1VwZGF0ZSBub3RpZmljYXRpb25cbiAgICAgIC8vQHBhcmFtcyB1aWQgLSB3aG8gdGhpcyBub3RpZmljYXRpb24gaXMgZ29pbmcgdG9cbiAgICAgIHVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50OmZ1bmN0aW9uKHRvcGljSWQsdWlkLGZyb21fdWlkKXtcblxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQrJy91bnJlYWQnKTtcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgIC8vZGVmYXVsdCB1bnJlYWQgaXMgMVxuICAgICAgICAgaWYoc25hcHNob3QudmFsKCkgPT0gJ251bGwnKXtcbiAgICAgICAgICAgIHJlZi5zZXQoMSlcbiAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHJlZi5zZXQoc25hcHNob3QudmFsKCkgKyAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvck9iamVjdCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHJlYWQgZmFpbGVkOiBcIiArIGVycm9yT2JqZWN0LmNvZGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL0FkZCB0byBsb2dcbiAgICAgICAgTm90aWZpY2F0aW9uLm5vdGlmeUxvZyh0b3BpY0lkLHVpZCxmcm9tX3VpZCk7XG5cblxuXG4gICAgICB9LFxuXG5cbiAgICAgIGFkZENoaWxkOmZ1bmN0aW9uKGNoaWxkKXtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZCk7XG4gICAgICB9LFxuXG4gICAgICBhZGRBcnJDaGlsZDpmdW5jdGlvbihjaGlsZCl7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKGNoaWxkKSk7XG4gICAgICB9LFxuXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXG4gICAgICBhbGw6IG5vdGlcbiAgICB9XG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcblxuXG4gICAgZnVuY3Rpb24gbm90aWZpY2F0aW9uQWxlcnQodWlkLGhlYWQsYm9keSl7XG4gICAgICB2YXIgbm90aWZpY2F0aW9uX3JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKTtcbiAgICAgIG5vdGlmaWNhdGlvbl9yZWYub25jZShcImNoaWxkX2FkZGVkXCIsZnVuY3Rpb24oKXtcbiAgICAgICAgJG5vdGlmaWNhdGlvbihoZWFkLCB7XG4gICAgICAgICAgYm9keTogYm9keSxcbiAgICAgICAgICBkaXI6ICdhdXRvJyxcbiAgICAgICAgICBsYW5nOiAnZW4nLFxuICAgICAgICAgIHRhZzogJ215LXRhZycsXG4gICAgICAgICAgaWNvbjogJ2h0dHA6Ly93d3cuY2wuY2FtLmFjLnVrL3Jlc2VhcmNoL3NyZy9uZXRvcy9pbWFnZXMvcXNlbnNlLWxvZ28ucG5nJyxcbiAgICAgICAgICAvL2RlbGF5OiAxMDAwLCAvLyBpbiBtc1xuICAgICAgICAgIGZvY3VzV2luZG93T25DbGljazogdHJ1ZSAvLyBmb2N1cyB0aGUgd2luZG93IG9uIGNsaWNrXG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICB9XG4gIH1dKVxuXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdQbGFjZXNDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRtZERpYWxvZ1wiLCBcIiRtZE1lZGlhXCIsIFwiVGFnc1wiLCBcIlRvcGljc1wiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIlNsdWdcIiwgXCJMYW5ndWFnZXNcIiwgXCJwbGFjZUxhbmRpbmdcIiwgZnVuY3Rpb24oJHN0YXRlLCRzY29wZSwkcm9vdFNjb3BlLCAkbWREaWFsb2csICRtZE1lZGlhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFncywgVG9waWNzLCBBdXRoLCBVc2VycywgU2x1ZyxMYW5ndWFnZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZUxhbmRpbmcpIHtcclxuXHJcbiAgICB2YXIgcGxhY2VzQ3RybCA9IHRoaXM7XHJcbiAgICBjb25zb2xlLmxvZyhwbGFjZUxhbmRpbmcpO1xyXG4gICAgcGxhY2VzQ3RybC5wbGFjZUxhbmRpbmcgPSBwbGFjZUxhbmRpbmc7XHJcblxyXG4gIH1dKTtcclxuXHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ1BsYWNlcycsIFtcIiRmaXJlYmFzZUFycmF5XCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuXHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydwbGFjZXMnKTtcclxuICAgIHZhciBwbGFjZURldGFpbF9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlc19kZXRhaWxzJyk7XHJcblxyXG4gICAgdmFyIHBsYWNlcyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIFBsYWNlcyA9IHtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRQbGFjZURldGFpbENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiBwbGFjZURldGFpbF9yZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0UGxhY2VSZWY6ZnVuY3Rpb24ocGxhY2VfaWQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQocGxhY2VfaWQrJy9pbmZvJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogcGxhY2VzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGxhY2VzO1xyXG4gIH1dKVxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAvL0NhdGVnb3J5IGxpc3RcbiAgLmZhY3RvcnkoJ0NhdGVnb3J5JywgW1wiJGZpcmViYXNlT2JqZWN0XCIsIFwiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5LCBGaXJlYmFzZVVybCl7XG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcycpO1xuICAgIHZhciBjYXRlZ29yaWVzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XG4gICAgdmFyIHRvcGljQXJyID0gJGZpcmViYXNlQXJyYXkocmVmKTtcblxuICAgIGNvbnNvbGUubG9nKFwiVXRpbCBjYXRlZ29yeSBTZXJ2aWNlXCIpO1xuXG4gICAgdmFyIENhdGVnb3J5ID0ge1xuICAgICAgZ2V0TmFtZTogZnVuY3Rpb24oc2x1Zyl7XG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHNsdWcpO1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xuICAgICAgfSxcblxuICAgICAgYWxsOiBjYXRlZ29yaWVzXG4gICAgfVxuICAgIHJldHVybiBDYXRlZ29yeTtcbiAgfV0pXG5cblxuICAvL0xhbmd1YWdlc1xuICAuZmFjdG9yeSgnTGFuZ3VhZ2VzJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2xhbmd1YWdlcycpO1xuICAgIHZhciBsYW5nID0gJGZpcmViYXNlQXJyYXkocmVmKTtcblxuICAgIGNvbnNvbGUubG9nKFwiVXRpbCBsYW5ndWFnZVwiKTtcblxuICAgIHJldHVybiBsYW5nO1xuICB9XSlcblxuXG4gIC8vTGFuZ3VhZ2VzXG4gIC5mYWN0b3J5KCdBcmNoaXZlJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2FyY2hpdmUnKTtcbiAgICB2YXIgYXJjaGl2ZSA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICBjb25zb2xlLmxvZyhcIlV0aWwgbGFuZ3VhZ2VcIik7XG5cbiAgICB2YXIgQXJjaGl2ZSA9e1xuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKHNsdWcpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHNsdWcpO1xuICAgICAgfSxcbiAgICAgIHJlZjogcmVmLFxuICAgICAgYXJyOiBhcmNoaXZlXG4gICAgfVxuICAgIHJldHVybiBBcmNoaXZlO1xuICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdUYWdDdHJsJywgW1wiQXV0aFwiLCBcIlVzZXJzXCIsIFwiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcInRhZ0xhbmRpbmdcIiwgXCJ0YWdOYW1lXCIsIGZ1bmN0aW9uKEF1dGgsIFVzZXJzLCAkc3RhdGUsJHJvb3RTY29wZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzb2x2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTGFuZGluZyx0YWdOYW1lKSB7XHJcblxyXG4gICAgdmFyIHRhZ0N0cmwgPSB0aGlzO1xyXG4gICAgdGFnQ3RybC50YWdMYW5kaW5nICA9IHRhZ0xhbmRpbmc7XHJcbiAgICB0YWdDdHJsLnRhZ05hbWUgICAgID0gdGFnTmFtZTtcclxuXHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuZmFjdG9yeSgnVGFncycsIFtcIiRmaXJlYmFzZUFycmF5XCIsIFwiJGZpcmViYXNlT2JqZWN0XCIsIFwiRmlyZWJhc2VVcmxcIiwgXCIkcVwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCwgJHEpe1xuXG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndGFncycpO1xuICAgIHZhciB0YWdzID0gJGZpcmViYXNlQXJyYXkocmVmKTtcblxuICAgIGNvbnNvbGUubG9nKFwidGFnIHNlcnZpY2VcIik7XG5cbiAgICB2YXIgVGFncyA9IHtcblxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxuICAgICAgfSxcblxuICAgICAgdGFnc1VybDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmKTtcbiAgICAgIH0sXG5cbiAgICAgIGdldFRhZ1JlZjpmdW5jdGlvbih0YWcpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRhZyk7XG4gICAgICB9LFxuXG4gICAgICBnZXRUYWdPYmplY3Q6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljVGFnczpmdW5jdGlvbih0YWcpe1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG4gICAgICAgIHZhciBkYXRhUmV0ID0gJyc7XG5cbiAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0YWdzLycrdGFnKVxuICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0YWdTbmFwKXtcbiAgICAgICAgICAgIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAuZXF1YWxUbyh0YWcpXG4gICAgICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgLy9zaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YVJldCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIGFycjogdGFnc1xuXG4gICAgfVxuICAgIHJldHVybiBUYWdzO1xuICB9XSlcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdUb3BpY0xhbmRpbmdDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiU2x1Z1wiLCBcIlRvcGljc1wiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcImlzT3duZXJcIiwgXCJ0b3BpY0xhbmRpbmdcIiwgXCJyZXBseUxpc3RcIiwgXCJ2aWV3RGF0YVwiLCBcImZvbGxvd2Vyc1wiLCBmdW5jdGlvbiAoJHN0YXRlLCAkc2NvcGUsIFNsdWcsIFRvcGljcywgQXV0aCwgVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc093bmVyLHRvcGljTGFuZGluZywgcmVwbHlMaXN0LCB2aWV3RGF0YSwgZm9sbG93ZXJzKSB7XG5cbiAgICBjb25zb2xlLmxvZyhcInRvcGljTGFuZGluZ0N0cmxcIik7XG5cbiAgICB2YXIgdG9waWNMYW5kaW5nQ3RybCA9IHRoaXNcblxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5hdXRoICAgICAgICAgPSBBdXRoO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudXNlcnMgICAgICAgID0gVXNlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY0xhbmRpbmcgPSB0b3BpY0xhbmRpbmc7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY3MgICAgICAgPSBUb3BpY3M7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QgICAgPSByZXBseUxpc3Q7XG4gICAgdG9waWNMYW5kaW5nQ3RybC52aWV3cyAgICAgICAgPSB2aWV3RGF0YTtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmZvbGxvd2VycyAgICA9IGZvbGxvd2VycztcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmlzT3duZXIgICAgICA9IGlzT3duZXI7XG5cblxuXG5cbiAgICAvL0dldHRpbmcgUmVwbGllcyBpbiByZXBsaWVzXG4gICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyID0gW107XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbigpe1xuXG4gICAgICBmb3IodmFyIGk9MDsgaTx0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdC5sZW5ndGg7aSsrKXtcbiAgICAgICAgdmFyIHRvcGljSWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS50b3BpY0lkO1xuICAgICAgICB2YXIgcmVwbHlJZCA9IHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0W2ldLiRpZDtcbiAgICAgICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyW2ldID0gdG9waWNMYW5kaW5nQ3RybC50b3BpY3MucmVwbHlJblJlcGx5KHRvcGljSWQscmVwbHlJZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkoKTtcbiAgfV0pXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignVG9waWNDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRtZERpYWxvZ1wiLCBcIiRtZE1lZGlhXCIsIFwiJGh0dHBcIiwgXCJGaXJlYmFzZVVybFwiLCBcIiR0cmFuc2xhdGVcIiwgXCIkbm90aWZpY2F0aW9uXCIsIFwiTm90aVNlcnZpY2VcIiwgXCJUYWdzXCIsIFwiVG9waWNzXCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIFwiU2x1Z1wiLCBcIlBsYWNlc1wiLCBcIkxhbmd1YWdlc1wiLCBcIkFyY2hpdmVcIiwgZnVuY3Rpb24oJHN0YXRlLCRzY29wZSwkcm9vdFNjb3BlLCAkbWREaWFsb2csICRtZE1lZGlhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAsRmlyZWJhc2VVcmwsJHRyYW5zbGF0ZSwkbm90aWZpY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aVNlcnZpY2UsVGFncywgVG9waWNzLCBBdXRoLCBVc2VycyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNsdWcsUGxhY2VzLCBMYW5ndWFnZXMsQXJjaGl2ZSl7XG5cbiAgICBjb25zb2xlLmxvZyhcInRvcGljQ3RybFwiKTtcblxuICAgIHZhciB0b3BpY0N0cmwgPSB0aGlzO1xuXG5cbiAgICAvL1BhcnNlciBoZXJlXG4gICAgdG9waWNDdHJsLnRhZ3MgICAgICA9IFRhZ3M7XG4gICAgdG9waWNDdHJsLnRvcGljcyAgICA9IFRvcGljcztcbiAgICB0b3BpY0N0cmwuYXV0aCAgICAgID0gQXV0aDtcbiAgICB0b3BpY0N0cmwudXNlcnMgICAgID0gVXNlcnM7XG4gICAgdG9waWNDdHJsLmxhbmd1YWdlcyA9IExhbmd1YWdlcztcbiAgICB0b3BpY0N0cmwucGxhY2VzICAgID0gUGxhY2VzO1xuICAgIHRvcGljQ3RybC5hcmNoaXZlICAgPSBBcmNoaXZlO1xuICAgIHRvcGljQ3RybC5ub3RpICAgICAgPSBOb3RpU2VydmljZTtcblxuICAgIGlmKHRvcGljQ3RybC5hdXRoLnJlZi5nZXRBdXRoKCkgIT0gbnVsbCApe1xuICAgICAgdG9waWNDdHJsLnByb2ZpbGUgID0gdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLmF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgICAgdG9waWNDdHJsLnVpZCA9IHRvcGljQ3RybC5wcm9maWxlLiRpZDtcbiAgICAgIHRvcGljQ3RybC51c2VyUmVmID0gdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MgPSB0b3BpY0N0cmwudXNlcnMudXB2b3Rlcyh0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzID0gdG9waWNDdHJsLnVzZXJzLmRvd252b3Rlcyh0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nID0gdG9waWNDdHJsLnVzZXJzLmZvbGxvd2luZyh0b3BpY0N0cmwudWlkKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRvcGljQ3RybC5wcm9maWxlID0nJztcbiAgICAgIHRvcGljQ3RybC51aWQgPSAnJztcbiAgICAgIHRvcGljQ3RybC51c2VyUmVmID0gJyc7XG4gICAgfVxuXG5cblxuICAgIC8vUHJlc2V0IFBhcmFtZXRlcnNcbiAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzICA9IFtdO1xuICAgIHRvcGljQ3RybC5pbWFnZVRleHQgICAgID0gW107XG4gICAgdG9waWNDdHJsLmluUmVwbHlBcnIgICAgPSBbXTtcbiAgICB0b3BpY0N0cmwubG9hZEJ1c3kgICAgICA9IGZhbHNlO1xuICAgIHRvcGljQ3RybC5zbHVnUmV0dXJuICAgID0gbnVsbDtcbiAgICB0b3BpY0N0cmwuY3JpdGVyaWEgICAgICA9IGZhbHNlO1xuICAgIHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5ID0gbnVsbDtcbiAgICB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWE9ZmFsc2U7XG4gICAgdG9waWNDdHJsLmNyaXRSZXBseURhdGEgPSBudWxsO1xuXG4gICAgLy9pZiBhbGxvdyBudWxsIGluIHRoZSBmb3JtXG4gICAgdG9waWNDdHJsLm5ld1RvcGljICAgICAgPSB7XG4gICAgICAnbG9jYXRpb24nOiAnJyxcbiAgICAgICd1cmwnIDogJycsXG4gICAgICAnaXBJbmZvJzogJycsXG4gICAgICAndGFncyc6ICcnLFxuICAgICAgJ2JvZHknOiAnJ1xuICAgIH1cblxuXG4gICAgLy9DYWxjIGF2ZXJhZ2UgcmV2aWV3IGlucHV0IGluIHJlcGx5XG4gICAgdG9waWNDdHJsLmF2Z1Jldmlld1JlcGx5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgdmFyIG9iakNvdW50ID0gT2JqZWN0LmtleXModG9waWNDdHJsLmNyaXRlcmlhUmVwbHkpLmxlbmd0aDtcbiAgICAgIHZhciBhdmcgPSAwXG4gICAgICBmb3IodmFyIGk9MDtpPG9iakNvdW50O2krKyl7XG4gICAgICAgIGF2ZyA9IGF2ZyArIHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5W2ldO1xuICAgICAgfVxuXG4gICAgICB0b3BpY0N0cmwucmVwbHlSZXZpZXdBdmVyYWdlID0gYXZnL29iakNvdW50O1xuXG4gICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSk7XG5cbiAgICAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhID0geyBhdmc6IHRvcGljQ3RybC5yZXBseVJldmlld0F2ZXJhZ2UsIGRhdGE6IHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5fVxuICAgIH1cblxuXG4gICAgLy9HZXQgdGhlIGF2ZXJhZ2Ugc2NvcmUgZnJvbSBjcml0ZXJpYSB2YWx1ZXNcbiAgICB0b3BpY0N0cmwuYXZnUmV2aWV3U2NvcmUgPSBmdW5jdGlvbihkYXRhKXtcbiAgICAgIGlmKGRhdGEpXG4gICAgICB7XG4gICAgICB2YXIgYXZnID0wO1xuICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xuICAgICAgICBhdmcgPSBhdmcgKyBkYXRhW2ldLnJhdGluZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBhdmcvZGF0YS5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvL0xhYmVsIGZvciByZW1vdmUgdG9waWNzXG4gICAgJHRyYW5zbGF0ZShbJ0tFWV9SRU1PVkUnLCAnS0VZX0NBTkNFTCcsJ0tFWV9DT05GX1JFTU9WRScsJ0tFWV9DT05GX1JFTV9DJ10pLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0aW9ucykge1xuICAgICAgdG9waWNDdHJsLnJlbW92ZVRyYW5zID0gdHJhbnNsYXRpb25zLktFWV9SRU1PVkU7XG4gICAgICB0b3BpY0N0cmwuY2FuY2VsVHJhbnMgPSB0cmFuc2xhdGlvbnMuS0VZX0NBTkNFTDtcbiAgICAgIHRvcGljQ3RybC5jb25maXJtUmVtICA9IHRyYW5zbGF0aW9ucy5LRVlfQ09ORl9SRU1PVkU7XG4gICAgICB0b3BpY0N0cmwuY29uZmlybVJlbUNvbnRlbnQgPSAgdHJhbnNsYXRpb25zLktFWV9DT05GX1JFTV9DO1xuICAgIH0pO1xuXG5cbiAgICB0b3BpY0N0cmwudXNlck5hbWUgPSBmdW5jdGlvbih1c2VySWQpe1xuICAgICAgaWYodXNlcklkIT0gbnVsbCl7XG4gICAgICAgIC8vcmV0dXJuIHRvcGljQ3RybC51c2Vycy5nZXREaXNwbGF5TmFtZSh1c2VySWQpO1xuICAgICAgfVxuICAgIH1cblxuXG5cblxuICAgIC8vTG9naW4gZm9yIG1hdGVyaWFsXG4gICAgdG9waWNDdHJsLnNob3dNZExvZ2luID0gZnVuY3Rpb24oZXYpIHtcbiAgICAgIHZhciB1c2VGdWxsU2NyZWVuID0gKCRtZE1lZGlhKCdzbScpIHx8ICRtZE1lZGlhKCd4cycpKSAmJiAkc2NvcGUuY3VzdG9tRnVsbHNjcmVlbjtcbiAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9tZC1sb2dpbi1mb3JtLmh0bWwnLFxuICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgIGZ1bGxzY3JlZW46IHVzZUZ1bGxTY3JlZW5cbiAgICAgICAgfSlcbiAgICB9XG5cblxuXG4gICAgdG9waWNDdHJsLmRlY29kZVRleHQgPSBmdW5jdGlvbih0ZXh0KXtcbiAgICAgIC8vcmV0dXJuICRmaWx0ZXIoJ3NsdWdpZnknKShpdGVtLm5hbWUpO1xuICAgICAgY29uc29sZS5sb2coZGVjb2RlVVJJKHRleHQpKTtcbiAgICAgIHJldHVybiBkZWNvZGVVUkkodGV4dCk7XG4gICAgfVxuXG5cbiAgICB0b3BpY0N0cmwubG9hZE1vcmUgPSBmdW5jdGlvbihpdGVtcykge1xuICAgICAgdG9waWNDdHJsLmxvYWRCdXN5ID0gdHJ1ZTtcbiAgICAgIHZhciBkYXRhID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGRhdGEucHVzaChpdGVtc1tpXSk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5sb2FkVGFncyA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwudGFncy50YWdzVXJsKCkpO1xuICAgIH07XG5cblxuICAgIC8qdG9waWNDdHJsLnVzZXJzLmdldExvY2F0aW9uSVAoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm8gPSBkYXRhO1xuICAgIH0pOyovXG5cblxuICAgIC8vVXBsb2FkIFByb2ZpbGUgaW1hZ2VcbiAgICB0b3BpY0N0cmwudXBsb2FkRmlsZSA9IGZ1bmN0aW9uKGZpbGVzLGluZGV4KSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2goZmlsZXMsIGZ1bmN0aW9uIChmbG93RmlsZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciB1cmkgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3NbaW5kZXhdID0gdXJpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmxvd0ZpbGUuZmlsZSk7XG4gICAgICB9KVxuICAgIH07XG5cblxuICAgIC8vU2hvdyBjb25maXJtIHJlbW92ZSB0b3BpY1xuICAgIHRvcGljQ3RybC5zaG93Q29uZmlybVJlbW92ZSA9IGZ1bmN0aW9uKGV2LHRvcGljX293bmVyLG9iail7XG4gICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgIC50aXRsZSh0b3BpY0N0cmwuY29uZmlybVJlbSlcbiAgICAgICAgLnRleHRDb250ZW50KHRvcGljQ3RybC5jb25maXJtUmVtQ29udGVudClcbiAgICAgICAgLnRhcmdldEV2ZW50KGV2KVxuICAgICAgICAub2sodG9waWNDdHJsLnJlbW92ZVRyYW5zKVxuICAgICAgICAuY2FuY2VsKHRvcGljQ3RybC5jYW5jZWxUcmFucyk7XG4gICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZih0b3BpY0N0cmwucmVtb3ZlVG9waWModG9waWNfb3duZXIsb2JqKSl7XG4gICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy9SZW1vdmUgdG9waWNcbiAgICB0b3BpY0N0cmwucmVtb3ZlVG9waWMgPSBmdW5jdGlvbih0b3BpY19vd25lcixvYmope1xuICAgICAgLy92ZXJpZnkgaWYgdGhlIHRvcGljIG93bmVyIGFuZCB0aGUgbG9naW4gb3duZXIgaXMgdGhlIHNhbWUgcHBsXG4gICAgICBpZih0b3BpY19vd25lciA9PSB0b3BpY0N0cmwudWlkKXtcbiAgICAgICAgbW92ZUZiUmVjb3JkKHRvcGljQ3RybC50b3BpY3MucmVmQ2hpbGQob2JqLiRpZCksIHRvcGljQ3RybC5hcmNoaXZlLmFkZENoaWxkKG9iai4kaWQpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgfWVsc2V7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLiR3YXRjaCgnJyxmdW5jdGlvbigpe1xuICAgICAgY29uc29sZS5sb2coXCI+Pj4gd2F0Y2hpbmcgYXQgdG9waWMgY29udHJvbGxlclwiKTtcbiAgICB9KVxuXG5cbiAgICAvL1JlcGx5IHRvIHRvcGljXG4gICAgdG9waWNDdHJsLnJlcGx5ID0gZnVuY3Rpb24odG9waWNPYmope1xuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5QXJyKHRvcGljT2JqLiRpZCkuJGFkZCh7XG4gICAgICAgIHRvcGljSWQ6ICB0b3BpY09iai4kaWQsXG4gICAgICAgIGJvZHk6ICAgICB0b3BpY0N0cmwubmV3UmVwbHkuYm9keSxcbiAgICAgICAgdWlkOiAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIHJldmlldzogICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSxcbiAgICAgICAgY3JlYXRlZDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgLy9Ob3RpZnkgdG9waWMgb3duZXJcbiAgICAgICAgLy90b3BpY09iaiByZWZlcnMgdG8gdGhlIHByb3BlcnR5IG9mIHRoaXMgb2JqZWN0XG4gICAgICAgIHRvcGljQ3RybC5ub3RpLnVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50KHRvcGljT2JqLiRpZCx0b3BpY09iai51aWQsdG9waWNDdHJsLnVpZCk7XG4gICAgICB9KVxuXG5cblxuXG5cblxuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50KHRvcGljT2JqLiRpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIGlmKCFkYXRhLmNvdW50KXtcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnRSZWYodG9waWNPYmouJGlkKS5zZXQoMSk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudFJlZih0b3BpY09iai4kaWQpXG4gICAgICAgICAgICAuc2V0KGRhdGEuY291bnQgKzEpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuXG4gICAgICAvL1N0YXQgdXBkYXRlIGZvciB1c2VyXG4gICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L2NvdW50JylcbiAgICAgICAgLnNldCh0b3BpY0N0cmwucHJvZmlsZS5zdGF0LmNvbW1lbnQuY291bnQgKyAxKTtcblxuICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvY29tbWVudC90b3BpY3MvJyt0b3BpY09iai4kaWQpXG4gICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgIH1cblxuXG5cbiAgICAvL1JlcGx5IGluIHJlcGx5XG4gICAgdG9waWNDdHJsLnJlcGx5SW5SZXBseSA9IGZ1bmN0aW9uKHRvcGljSWQscmVwbHlJZCl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5SW5SZXBseUFycih0b3BpY0lkLHJlcGx5SWQpLiRhZGQoe1xuICAgICAgICBib2R5OiAgICAgdG9waWNDdHJsLnJlcGx5SW5SZXBseS5ib2R5LFxuICAgICAgICB1aWQ6ICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgY3JlYXRlZDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pXG4gICAgfVxuXG5cblxuICAgIHRvcGljQ3RybC5hZGROZXdDaG9pY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBuZXdJdGVtTm8gPSB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWEubGVuZ3RoKzE7XG4gICAgICB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWEucHVzaCh7J2lkJzonY3JpdGVyaWEnK25ld0l0ZW1Ob30pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwucmVtb3ZlQ2hvaWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGFzdEl0ZW0gPSB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWEubGVuZ3RoLTE7XG4gICAgICB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWEuc3BsaWNlKGxhc3RJdGVtKTtcbiAgICB9O1xuXG5cbiAgICAvL0NyZWF0ZSBuZXcgdG9waWNcbiAgICB0b3BpY0N0cmwuY3JlYXRlVG9waWMgPSBmdW5jdGlvbihjYXRlZ29yeSxpc0RyYWZ0KXtcblxuICAgICAgLy9DaGVjayBpZiB3ZSBoYXZlIGxvY2F0aW9uIGRldGFpbHNcbiAgICAgIHZhciBsb2NhdGlvbkRldGFpbCA9ICcnO1xuXG4gICAgICBpZih0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24gIT09ICcnICl7XG4gICAgICAgIGNvbnNvbGUubG9nKHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbik7XG4gICAgICAgIGxvY2F0aW9uRGV0YWlsID0ge1xuICAgICAgICAgIHBsYWNlX2lkOiB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5wbGFjZV9pZCxcbiAgICAgICAgICBzbHVnOiAgICAgU2x1Zy5zbHVnaWZ5KHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLm5hbWUpLFxuICAgICAgICAgIG5hbWU6ICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5uYW1lLFxuICAgICAgICAgIGFkZHJlc3M6ICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5mb3JtYXR0ZWRfYWRkcmVzcyxcbiAgICAgICAgICBsYXQ6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAvKiBERUJVRyBGT1JNIFZBTFVFXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICB0eXBlOiAgICAgICAgICAgdG9waWNDdHJsLnR5cGUsXG4gICAgICAgIGxhbmc6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMubGFuZyxcbiAgICAgICAgdG9waWM6ICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyxcbiAgICAgICAgYm9keTogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5ib2R5LFxuICAgICAgICBjYXRlZ29yeTogICAgICAgY2F0ZWdvcnksXG4gICAgICAgIHVpZDogICAgICAgICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICBzbHVnOiAgICAgICAgICAgU2x1Zy5zbHVnaWZ5KHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyksXG4gICAgICAgIHBob3RvczogICAgICAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzLFxuICAgICAgICBwaG90b3NfdGV4dDogICAgdG9waWNDdHJsLmltYWdlVGV4dCxcbiAgICAgICAgbG9jYXRpb246ICAgICAgIGxvY2F0aW9uRGV0YWlsLFxuICAgICAgICB1cmw6ICAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnVybCxcbiAgICAgICAgZHJhZnQ6ICAgICAgICAgIGlzRHJhZnQsXG4gICAgICAgIGNyZWF0ZWQ6ICAgICAgICBtb21lbnQoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB0YWdzOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRhZ3MsXG4gICAgICAgIHVzZXJJUDogICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mb1xuICAgICAgfTtcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgKi9cblxuICAgICAgdG9waWNDdHJsLnRvcGljcy5hcnIuJGFkZCh7XG4gICAgICAgICAgdHlwZTogICAgICAgICAgIHRvcGljQ3RybC50eXBlLFxuICAgICAgICAgIGxhbmc6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMubGFuZyxcbiAgICAgICAgICB0b3BpYzogICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRvcGljLFxuICAgICAgICAgIGJvZHk6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuYm9keSxcbiAgICAgICAgICBjYXRlZ29yeTogICAgICAgY2F0ZWdvcnksXG4gICAgICAgICAgdWlkOiAgICAgICAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgICAgLy9zbHVnOiAgICAgICAgICAgU2x1Zy5zbHVnaWZ5KHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyksXG4gICAgICAgICAgc2x1ZzogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyxcbiAgICAgICAgICBwaG90b3M6ICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyxcbiAgICAgICAgICBwaG90b3NfdGV4dDogICAgdG9waWNDdHJsLmltYWdlVGV4dCxcbiAgICAgICAgICBsb2NhdGlvbjogICAgICAgbG9jYXRpb25EZXRhaWwsXG4gICAgICAgICAgdXJsOiAgICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy51cmwsXG4gICAgICAgICAgZHJhZnQ6ICAgICAgICAgIGlzRHJhZnQsXG4gICAgICAgICAgY3JlYXRlZDogICAgICAgIG1vbWVudCgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdGFnczogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLFxuICAgICAgICAgIHVzZXJJUDogICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuaXBJbmZvLFxuICAgICAgICAgIHJldmlldzogICAgICAgICB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWEsXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24odG9waWMpe1xuXG4gICAgICAgICAgdmFyIHNsdWdUZXh0ID0nJztcbiAgICAgICAgICAvL2lmIHdlIGFyZSB1bmFibGUgdG8gY29udmVydCB0byBzbHVnIHRoZW4gd2UgdXNlIHRoZSB0b3BpYyB0ZXh0LCBlbHNlIHVzZSBzbHVnXG4gICAgICAgICAgaWYoU2x1Zy5zbHVnaWZ5KHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYykgPT0nJyl7XG4gICAgICAgICAgICBzbHVnVGV4dCA9IHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYztcbiAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHNsdWdUZXh0ID0gU2x1Zy5zbHVnaWZ5KHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9VcGRhdGUgc2x1ZyB3aXRoIHRvcGljIEtleVxuICAgICAgICAgIHRvcGljQ3RybC50b3BpY3MuZ2V0VG9waWNCeUtleSh0b3BpYy5rZXkoKSkudXBkYXRlKHtcInNsdWdcIjpzbHVnVGV4dCt0b3BpYy5rZXkoKX0pO1xuXG4gICAgICAgICAgLy9TdGF0IHVwZGF0ZVxuICAgICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L3Bvc3RlZC9jb3VudCcpXG4gICAgICAgICAgICAuc2V0KHRvcGljQ3RybC5wcm9maWxlLnN0YXQucG9zdGVkLmNvdW50ICsgMSk7XG5cbiAgICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvdG9waWNzLycrdG9waWMua2V5KCkpXG4gICAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcblxuICAgICAgICAgIC8vSWYgdGhlcmUgaXMgbG9jYXRpb25cbiAgICAgICAgICBpZihsb2NhdGlvbkRldGFpbCAhPT0gJycpe1xuXG4gICAgICAgICAgICB0b3BpY0N0cmwucGxhY2VzLmFkZENoaWxkKGxvY2F0aW9uRGV0YWlsLnBsYWNlX2lkKVxuICAgICAgICAgICAgICAgICAgICAgIC5jaGlsZCh0b3BpYy5rZXkoKSlcbiAgICAgICAgICAgICAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcblxuICAgICAgICAgICAgdG9waWNDdHJsLnBsYWNlcy5hZGRDaGlsZChsb2NhdGlvbkRldGFpbC5wbGFjZV9pZClcbiAgICAgICAgICAgICAgLmNoaWxkKCdpbmZvJykuc2V0KGxvY2F0aW9uRGV0YWlsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL2lmIHRoZXJlIGFyZSB0YWdzXG4gICAgICAgICAgaWYodG9waWNDdHJsLm5ld1RvcGljLnRhZ3MgIT09IG51bGwpe1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLmxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICAgICAgICB0b3BpY0N0cmwudGFncy5hZGRDaGlsZCh0b3BpY0N0cmwubmV3VG9waWMudGFnc1tpbmRleF0udGV4dClcbiAgICAgICAgICAgICAgICAuY2hpbGQodG9waWMua2V5KCkpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9Ob3RpZnkgZm9sbG93ZXJcbiAgICAgICAgICB0b3BpY0N0cmwubm90aS5ub3RpZnlGb2xsb3dlcih0b3BpYy5rZXkoKSx0b3BpY0N0cmwudWlkKTtcblxuXG4gICAgICAgICAgLy9SZXNldCBmb3JtIGhlcmVcbiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMgPSB7XG4gICAgICAgICAgICBib2R5OiAnJ1xuICAgICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL0NoZWNrIGlmIHVzZXIgaXMgYWxyZWFkeSBmb2xsb3dpbmcgdXNlclxuICAgIHRvcGljQ3RybC5jaGVja0ZvbGxvdyA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuICAgICAgaWYodG9waWNDdHJsLnVzZXJzLmNoZWNrRm9sbG93KHRvcGljQ3RybC51aWQsZm9sbG93X3VpZCkpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvL0ZvbGxvdyBVc2VyXG4gICAgdG9waWNDdHJsLmZvbGxvd1VzZXIgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGJlaW5nIGZvbGxvdywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUoZm9sbG93X3VpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgKyAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci91aWQvJysgdG9waWNDdHJsLnVpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgIH0pO1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgaXMgZm9sbG93aW5nLCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2luZ1xuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50ICsgMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL3VpZC8nKyBmb2xsb3dfdWlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VuZm9sbG93IFVzZXJcbiAgICB0b3BpY0N0cmwudW5mb2xsb3dVc2VyID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBiZWluZyBmb2xsb3csIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93ZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKGZvbGxvd191aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvdWlkLycrIHRvcGljQ3RybC51aWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBpcyBmb2xsb3dpbmcsIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93aW5nXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93aW5nLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL3VpZC8nKyBmb2xsb3dfdWlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG4gICAgfVxuXG5cblxuICAgICAvL3Vwdm90ZVxuICAgIHRvcGljQ3RybC51cHZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG5cbiAgICAgIGlmKHRvcGljLmRvd252b3RlcyAhPSB1bmRlZmluZWQgJiYgdG9waWMuZG93bnZvdGVzW3RvcGljQ3RybC51aWRdICE9IHVuZGVmaW5lZCl7XG4gICAgICAgIHRvcGljQ3RybC5jYW5jZWxEb3dudm90ZSh0b3BpYyk7XG4gICAgICB9XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVwdm90ZVRvcGljKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuJHZhbHVlKTtcblxuICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LnVwdm90ZWQuY291bnQgKyAxKTtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL3RvcGljcy8nK3RvcGljLiRpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwuY2FuY2VsVXB2b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmRvVXB2b3RlKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG5cbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQudXB2b3RlZC5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC90b3BpY3MvJyt0b3BpYy4kaWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cblxuICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICAgIC8vZG93bnZvdGVcbiAgICB0b3BpY0N0cmwuZG93bnZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICBpZih0b3BpYy51cHZvdGVzICE9IHVuZGVmaW5lZCAmJiB0b3BpYy51cHZvdGVzW3RvcGljQ3RybC51aWRdICE9IHVuZGVmaW5lZCl7XG4gICAgICAgIHRvcGljQ3RybC5jYW5jZWxVcHZvdGUodG9waWMpO1xuICAgICAgfVxuICAgICAgdG9waWNDdHJsLnRvcGljcy5kb3dudm90ZVRvcGljKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS4kdmFsdWUpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5jYW5jZWxEb3dudm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5kb0Rvd252b3RlKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgICAvL2ZvbGxvdyB0b3BpY1xuICAgIHRvcGljQ3RybC5mb2xsb3dUb3BpYyA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MuZm9sbG93KHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS5oaXN0b3J5W3RvcGljQ3RybC51aWRdKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwudW5mb2xsb3dUb3BpYyA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5mb2xsb3codG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICB9XSk7XG5cblxuLy9odHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82MDk5MDQyXG5mdW5jdGlvbiBtb3ZlRmJSZWNvcmQob2xkUmVmLCBuZXdSZWYpIHtcbiAgb2xkUmVmLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICBuZXdSZWYuc2V0KHNuYXAudmFsKCksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICBvbGRSZWYucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0eXBlb2YoY29uc29sZSkgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLy8gVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnVG9waWNzJywgW1wiJGZpcmViYXNlT2JqZWN0XCIsIFwiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbiAoJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpIHtcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcycpXG4gICAgdmFyIHRvcGljcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpXG4gICAgdmFyIHRvcGljc0FyciA9ICRmaXJlYmFzZUFycmF5KHJlZilcbiAgICB2YXIgdG9waWNLZXkgPSAnJ1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpYyBzZXJ2aWNlXCIpO1xuXG4gICAgdmFyIFRvcGljcyA9IHtcbiAgICAgIC8vIEdldCB0b3BpYyB0YWdcbiAgICAgIGdldFRhZzogZnVuY3Rpb24gKHRhZykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgndGFncycpLmVxdWFsVG8odGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldCB0b3BpYyBzbHVnXG4gICAgICBnZXRTbHVnOiBmdW5jdGlvbiAoc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHNsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpY3MgY3JlYXRlZCBieSB1c2VyX2lkXG4gICAgICBjcmVhdGVkQnk6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3VpZCcpLmVxdWFsVG8odWlkKSlcblxuICAgICAgfSxcbiAgICAgIHJlZkNoaWxkOiBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZClcbiAgICAgIH0sXG4gICAgICBjb3VudFVzZXJUb3BpY3M6IGZ1bmN0aW9uICgpIHt9LFxuXG4gICAgICAvLyBHZXR0aW5nIHRoZSBsaXN0IG9mIHRvcGljIGJhc2Ugb24gY2F0ZWdvcnlcbiAgICAgIGxpc3Q6IGZ1bmN0aW9uIChjYXRlZ29yeSkge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ2NhdGVnb3J5JykuZXF1YWxUbyhjYXRlZ29yeSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICBuYW1lOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHRvcGljX3NsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIFJlZlxuICAgICAgZm9ydG9waWNSZWY6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeUtleTogZnVuY3Rpb24gKHRvcGljX2tleSkge1xuICAgICAgICByZXR1cm4gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcy8nICsgdG9waWNfa2V5KVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeVNsdWc6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKS5saW1pdFRvRmlyc3QoMSkpXG4gICAgICB9LFxuXG4gICAgICBpbmNyZW1lbnRWaWV3OiBmdW5jdGlvbiAodG9waWNfc2x1Zykge30sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIGFycmF5XG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KFRvcGljcy5mb3J0b3BpY1JlZih0b3BpY19zbHVnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGxpc3RpbmdcbiAgICAgIHJlcGx5TGlzdDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcycpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5QXJyOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGNvdW50XG4gICAgICByZXBseUNvdW50OiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycpKVxuICAgICAgfSxcbiAgICAgIHJlcGx5Q291bnRSZWY6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy9jb3VudCcpXG4gICAgICB9LFxuXG4gICAgICByZXBseUluUmVwbHk6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgaW4gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5SW5SZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQsIHJlcGx5SWQpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJytyZXBseUlkKycvaW5SZXBseScpKSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycgKyByZXBseUlkICsgJy9pblJlcGx5JykpXG4gICAgICB9LFxuXG4gICAgICAvLyB1cHZvdGVzXG4gICAgICBnZXRVcHZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSxcbiAgICAgICAgICBhcnJheTogJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZG93bnZvdGVzXG4gICAgICBnZXREb3dudm90ZXM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZm9sbG93ZXJzXG4gICAgICBnZXRGb2xsb3dlcnM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICB1cHZvdGVUb3BpYzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb1Vwdm90ZTogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGRvd252b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkpXG4gICAgICB9LFxuXG4gICAgICB1bmRvRG93bnZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKVxuICAgICAgfSxcblxuICAgICAgZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEudmFsdWUgPT09IG51bGwgfHwgZGF0YS52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KDEpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgKyAxKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgLSAxKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKVxuICAgICAgfSxcblxuICAgICAgZ2V0Vmlld3M6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCkuY2hpbGQoJ3ZpZXdzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBsYXRlc3RGZWVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdjcmVhdGVkJykubGltaXRUb0xhc3QoMTApKVxuICAgICAgfSxcblxuICAgICAgdG9waWNzQnlUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gYXJyYXlcbiAgICAgIGFycjogJGZpcmViYXNlQXJyYXkocmVmKSxcblxuICAgICAgYWxsOiB0b3BpY3MsXG4gICAgICByZWY6IHJlZlxuICAgIH07XG5cbiAgICByZXR1cm4gVG9waWNzXG5cbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgW1wiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRzdGF0ZVwiLCBcIiRmaWx0ZXJcIiwgXCJtZDVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCJUb3BpY3NcIiwgXCJGYWNlYm9va1wiLCBcIm5vdGlmeVwiLCBcIkNhdGVTZXJ2aWNlXCIsIFwicHJvZmlsZVwiLCBcImlzT3duZXJcIiwgXCJ1c2VyUG9zdHNcIiwgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRmaWx0ZXIsIG1kNSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRoLFVzZXJzLFRvcGljcywgRmFjZWJvb2ssbm90aWZ5LENhdGVTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZSxpc093bmVyLHVzZXJQb3N0cyl7XG5cbiAgICBjb25zb2xlLmxvZyhcIlByb2ZpbGVDdHJsXCIpO1xuXG4gICAgdmFyIHByb2ZpbGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2VyXG4gICAgcHJvZmlsZUN0cmwucHJvZmlsZSAgID0gcHJvZmlsZTtcbiAgICBwcm9maWxlQ3RybC5hdXRoICAgICAgPSBBdXRoO1xuICAgIHByb2ZpbGVDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHByb2ZpbGVDdHJsLnRvcGljcyAgICA9IFRvcGljcztcbiAgICBwcm9maWxlQ3RybC5mYWNlYm9vayAgPSBGYWNlYm9vaztcbiAgICBwcm9maWxlQ3RybC5pc093bmVyICAgPSBpc093bmVyO1xuICAgIHByb2ZpbGVDdHJsLmNhdGUgICAgICA9IENhdGVTZXJ2aWNlO1xuICAgIHByb2ZpbGVDdHJsLiRzdGF0ZSAgICA9ICRzdGF0ZTtcbiAgICBwcm9maWxlQ3RybC51c2VyUG9zdHMgPSB1c2VyUG9zdHM7XG5cbiAgICBwcm9maWxlQ3RybC51c2VyRmVlZCAgPSAnJztcbiAgICBwcm9maWxlQ3RybC5mZWVkID0gJyc7XG5cbiAgICBwcm9maWxlQ3RybC5lZGl0SW5pdCA9ICd1c2VyRWRpdCc7XG5cbiAgICBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9IGZhbHNlO1xuXG5cbiAgICBwcm9maWxlQ3RybC5nZXRVc2VyUG9zdCA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICBwcm9maWxlQ3RybC5mZWVkID0gcHJvZmlsZUN0cmwudG9waWNzLmNyZWF0ZWRCeSh1aWQpO1xuICAgIH1cblxuXG5cbiAgICAvKkxpbmsgYWNjb3VudCB3aXRoIGZhY2Vib29rKi9cbiAgICBwcm9maWxlQ3RybC5saW5rRmFjZWJvb2sgPSBmdW5jdGlvbigpe1xuICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2subG9naW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2suZ2V0TG9naW5TdGF0dXMoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gJ2Nvbm5lY3RlZCcpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2dnZWRJbiA9IHRydWU7XG4gICAgICAgICAgICBwcm9maWxlQ3RybC5mYWNlYm9vay5hcGkoJy9tZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IGxvZ2dlZCBpblwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1RoZSBvcmlnaW5hbCB2YWx1ZSBmcm9tIHByb2ZpbGVcbiAgICBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUgPSBwcm9maWxlQ3RybC5wcm9maWxlO1xuXG5cbiAgICBwcm9maWxlQ3RybC51c2VyQ3JlYXRlZCA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICByZXR1cm4gcHJvZmlsZUN0cmwudG9waWNzLmNyZWF0ZWRCeSh1aWQpO1xuICAgIH1cblxuXG4gICAgLy9QcmVzZXQgUGFyYW1ldGVyc1xuICAgIHByb2ZpbGVDdHJsLmltYWdlU3RyaW5ncyAgICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLnVzZXJDYXRlRm9sbG93ICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLmNhdGVJc0ZvbGxvdyAgICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLmZvbGxvd0xpc3QgICAgICA9ICcnO1xuXG5cblxuXG5cbiAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlTGlzdEFyciA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICBwcm9maWxlQ3RybC5mb2xsb3dMaXN0ID0gcHJvZmlsZUN0cmwuY2F0ZS5mb2xsb3dMaXN0KHVpZCk7XG4gICAgfVxuXG4gICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZvbGxvd0NhdGVMaXN0QXJyKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgIH1cblxuICAgIHByb2ZpbGVDdHJsLmZvbGxvd0NhdGUgPSBmdW5jdGlvbihpbmRleCxjYXRlX3NsdWcpe1xuICAgICAgcHJvZmlsZUN0cmwuY2F0ZUlzRm9sbG93W2luZGV4XSAgPSB0cnVlO1xuICAgICAgcHJvZmlsZUN0cmwuY2F0ZS5hZGRDaGlsZChjYXRlX3NsdWcrJy9mb2xsb3dlcicpXG4gICAgICAgIC5jaGlsZChBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgIH1cblxuXG5cblxuXG4gICAgLy9VcGxvYWQgUHJvZmlsZSBpbWFnZVxuICAgIHByb2ZpbGVDdHJsLnVwbG9hZEZpbGUgPSBmdW5jdGlvbihmaWxlcykge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGZpbGVzLCBmdW5jdGlvbiAoZmxvd0ZpbGUsIGkpIHtcbiAgICAgICAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciB1cmkgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgIHByb2ZpbGVDdHJsLmltYWdlU3RyaW5nc1tpXSA9IHVyaTtcbiAgICAgICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZSh7XCJwaG90b1wiOiB1cml9KVxuICAgICAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmxvd0ZpbGUuZmlsZSk7XG4gICAgICB9KVxuICAgIH07XG5cblxuICAgIC8vU2F2ZSBwcm9maWxlIHdpdGggcHJvZmlsZUN0cmwucHJvZmlsZVxuICAgIC8vcGFyYW1zOiByZWRpcmVjdCwgaWYgZXhpc3QgdGhlbiByZWRpcmVjdCBhZnRlciBzYXZlXG4gICAgcHJvZmlsZUN0cmwuc2F2ZVByb2ZpbGUgPSBmdW5jdGlvbihyZWRpcmVjdCl7XG4gICAgICBwcm9maWxlQ3RybC5wcm9maWxlLnVwZGF0ZWQgPSBtb21lbnQoKS50b0lTT1N0cmluZygpO1xuXG5cbiAgICAgIGlmKHByb2ZpbGVDdHJsLmxvY2F0aW9uICE9PSBudWxsICkge1xuICAgICAgICBsb2NhdGlvbkRldGFpbCA9IHtcbiAgICAgICAgICBwbGFjZV9pZDogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5wbGFjZV9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLm5hbWUsXG4gICAgICAgICAgYWRkcmVzczogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5mb3JtYXR0ZWRfYWRkcmVzcyxcbiAgICAgICAgICBsYXQ6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgbG5nOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICB9XG5cbiAgICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS51c2VyTG9jYXRpb24gPSBsb2NhdGlvbkRldGFpbDtcbiAgICAgIH1cblxuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgICAgICBpZihyZWRpcmVjdCAhPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAkc3RhdGUuZ28ocmVkaXJlY3QpO1xuICAgICAgICB9XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICBub3RpZnkoe21lc3NhZ2U6J0Vycm9yIHNhdmluZyBkYXRhJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9VcGRhdGUgbmFtZVxuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZU5hbWUgPSBmdW5jdGlvbigpe1xuXG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZShcbiAgICAgICAge1xuICAgICAgICAgIFwiZmlyc3RuYW1lXCI6ICBwcm9maWxlQ3RybC5wcm9maWxlLmZpcnN0bmFtZSxcbiAgICAgICAgICBcImxhc3RuYW1lXCI6ICAgcHJvZmlsZUN0cmwucHJvZmlsZS5sYXN0bmFtZSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQrJy9sb2cnKS5wdXNoKCkuc2V0KHtcbiAgICAgICAgYWN0aW9uOiAgIFwibmFtZV9jaGFuZ2VcIixcbiAgICAgICAgb2xkbmFtZTogIHByb2ZpbGVDdHJsLm9sZFByb2ZpbGVWYWx1ZS5maXJzdG5hbWUgKyBcIi1cIiArIHByb2ZpbGVDdHJsLm9sZFByb2ZpbGVWYWx1ZS5sYXN0bmFtZSxcbiAgICAgICAgY3JlYXRlZDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pO1xuXG4gICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICB9XG5cblxuICAgIC8vVXBkYXRlIEJpb1xuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZUJpbyA9IGZ1bmN0aW9uKCl7XG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZSh7XCJiaW9ncmFwaHlcIjogcHJvZmlsZUN0cmwucHJvZmlsZS5iaW9ncmFwaHl9KVxuXG4gICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICB9XG5cblxuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZVByb2ZpbGUgPSBmdW5jdGlvbigpe1xuICAgICAgLy9wcm9maWxlQ3RybC5wcm9maWxlLmVtYWlsSGFzaCA9IG1kNS5jcmVhdGVIYXNoKGF1dGgucGFzc3dvcmQuZW1haWwpO1xuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vQ2hlY2sgaWYgdXNlciBleGlzdCwgcmV0dXJuIGZhbHNlIGlmIHRoZXkgZG9cbiAgICBwcm9maWxlQ3RybC5jaGVja1VzZXJuYW1lID0gZnVuY3Rpb24oKXtcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMuY2hlY2tVc2VybmFtZUV4aXN0KHByb2ZpbGVDdHJsLnByb2ZpbGUuZGlzcGxheU5hbWUpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgaWYoc25hcHNob3QudmFsKCkgIT09IG51bGwpe1xuICAgICAgICAgIHJldHVybiBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9dHJ1ZTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgIHJldHVybiBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9ZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICB9XSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuZmFjdG9yeSgnVXNlcnMnLCBbXCIkZmlyZWJhc2VBcnJheVwiLCBcIiRmaXJlYmFzZU9iamVjdFwiLCBcIkZpcmViYXNlVXJsXCIsIFwiJGh0dHBcIiwgZnVuY3Rpb24gKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkaHR0cCkge1xuICAgIHZhciB1c2Vyc1JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd1c2VycycpXG4gICAgdmFyIHVzZXJzID0gJGZpcmViYXNlQXJyYXkodXNlcnNSZWYpXG5cbiAgICBjb25zb2xlLmxvZyhcIlVzZXIgU2VydmljZVwiKTtcblxuICAgIHZhciBVc2VycyA9IHtcbiAgICAgIGdldExvY2F0aW9uSVA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxuICAgICAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIGdldExvY2F0aW9uSVBEYXRhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgdXJsOiAnaHR0cDovL2lwaW5mby5pby9qc29uJyxcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YS5kYXRhXG4gICAgICAgIH0pXG4gICAgICB9LFxuXG4gICAgICBwcm9maWxlOiBmdW5jdGlvbih1aWQpe1xuICAgICAgICByZXR1cm4gdXNlcnMuJGdldFJlY29yZCh1aWQpO1xuICAgICAgfSxcblxuXG4gICAgICAvL1NlYXJjaCBhbmQgcmV0dXJuIHVzZXJuYW1lXG4gICAgICBnZXRQcm9maWxlQnlVc2VybmFtZTpmdW5jdGlvbih1c2VybmFtZSl7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZi5vcmRlckJ5Q2hpbGQoJ2Rpc3BsYXlOYW1lJykuZXF1YWxUbyh1c2VybmFtZSkpO1xuICAgICAgfSxcblxuICAgICAgLy9DaGVjayBpZiB1c2VybmFtZSBleGlzdCwgaWYgbm90IHJldHVybiBudWxsXG4gICAgICBjaGVja1VzZXJuYW1lRXhpc3Q6ZnVuY3Rpb24odXNlcm5hbWUpe1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYub3JkZXJCeUNoaWxkKCdkaXNwbGF5TmFtZScpLmVxdWFsVG8odXNlcm5hbWUpO1xuICAgICAgfSxcblxuXG4gICAgICBnZXRQcm9maWxlOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QodXNlcnNSZWYuY2hpbGQodWlkKSlcbiAgICAgIH0sXG5cbiAgICAgIGdldERpc3BsYXlOYW1lOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHVpZCk7XG4gICAgICAgIGlmICh1aWQgIT09IG51bGwgfHwgdWlkICE9PSAnJykge1xuICAgICAgICAgIHJldHVybiB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZGlzcGxheU5hbWU7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vR2V0IHVzZXIgRm9sbG93ZXJzXG4gICAgICBnZXRGb2xsb3dlcjpmdW5jdGlvbih1aWQpe1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKycvc3RhdC9mb2xsb3dlci91aWQnKTtcbiAgICAgIH0sXG5cbiAgICAgIC8vQ2hlY2sgaWYgdXNlciBpcyBhbHJlYWR5IGZvbGxvd2luZ1xuICAgICAgY2hlY2tGb2xsb3c6ZnVuY3Rpb24odWlkLGZvbGxvd19pZCl7XG5cbiAgICAgICAgdmFyIGZvbGxvdz1mYWxzZTtcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMvJyt1aWQrJy9zdGF0L2ZvbGxvd2luZy91aWQvJytmb2xsb3dfaWQpO1xuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgZm9sbG93ID0gc25hcHNob3QuZXhpc3RzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmb2xsb3c7XG4gICAgICB9LFxuXG4gICAgICAvL0NoYW5nZSBwYXNzd29yZFxuICAgICAgdXNlckNoYW5nZVBhc3N3b3JkOmZ1bmN0aW9uKGVtYWlsLG9sZHBhc3MsbmV3cGFzcyl7XG5cbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG4gICAgICAgIHJlZi5jaGFuZ2VQYXNzd29yZCh7XG4gICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgIG9sZFBhc3N3b3JkOiBvbGRwYXNzLFxuICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdwYXNzXG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGVycm9yLmNvZGUpIHtcbiAgICAgICAgICAgICAgY2FzZSBcIklOVkFMSURfUEFTU1dPUkRcIjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSBzcGVjaWZpZWQgdXNlciBhY2NvdW50IHBhc3N3b3JkIGlzIGluY29ycmVjdC5cIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgXCJJTlZBTElEX1VTRVJcIjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSBzcGVjaWZpZWQgdXNlciBhY2NvdW50IGRvZXMgbm90IGV4aXN0LlwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGNoYW5naW5nIHBhc3N3b3JkOlwiLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXNlciBwYXNzd29yZCBjaGFuZ2VkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG5cbiAgICAgIHVzZXJSZWY6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZClcbiAgICAgIH0sXG5cbiAgICAgIHVwdm90ZXM6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ3Vwdm90ZXMnKVxuICAgICAgfSxcblxuICAgICAgZG93bnZvdGVzOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCdkb3dudm90ZXMnKVxuICAgICAgfSxcblxuICAgICAgLy9Vc2VyIGZvbGxvd2luZyB0b3BpY1xuICAgICAgZm9sbG93aW5nOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCdmb2xsb3dpbmcnKVxuICAgICAgfSxcblxuICAgICAgdXNlckFyclJlZjogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKVxuICAgICAgfSxcblxuICAgICAgYWxsOiB1c2Vyc1xuICAgIH1cblxuICAgIHJldHVybiBVc2Vyc1xuICB9XSlcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ1VuaXF1ZUlER2VuZXJhdG9yJywgZnVuY3Rpb24oKXsgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBGYW5jeSBJRCBnZW5lcmF0b3IgdGhhdCBjcmVhdGVzIDIwLWNoYXJhY3RlciBzdHJpbmcgaWRlbnRpZmllcnMgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XHJcbiAgICAgKlxyXG4gICAgICogMS4gVGhleSdyZSBiYXNlZCBvbiB0aW1lc3RhbXAgc28gdGhhdCB0aGV5IHNvcnQgKmFmdGVyKiBhbnkgZXhpc3RpbmcgaWRzLlxyXG4gICAgICogMi4gVGhleSBjb250YWluIDcyLWJpdHMgb2YgcmFuZG9tIGRhdGEgYWZ0ZXIgdGhlIHRpbWVzdGFtcCBzbyB0aGF0IElEcyB3b24ndCBjb2xsaWRlIHdpdGggb3RoZXIgY2xpZW50cycgSURzLlxyXG4gICAgICogMy4gVGhleSBzb3J0ICpsZXhpY29ncmFwaGljYWxseSogKHNvIHRoZSB0aW1lc3RhbXAgaXMgY29udmVydGVkIHRvIGNoYXJhY3RlcnMgdGhhdCB3aWxsIHNvcnQgcHJvcGVybHkpLlxyXG4gICAgICogNC4gVGhleSdyZSBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcuICBFdmVuIGlmIHlvdSBnZW5lcmF0ZSBtb3JlIHRoYW4gb25lIGluIHRoZSBzYW1lIHRpbWVzdGFtcCwgdGhlXHJcbiAgICAgKiAgICBsYXR0ZXIgb25lcyB3aWxsIHNvcnQgYWZ0ZXIgdGhlIGZvcm1lciBvbmVzLiAgV2UgZG8gdGhpcyBieSB1c2luZyB0aGUgcHJldmlvdXMgcmFuZG9tIGJpdHNcclxuICAgICAqICAgIGJ1dCBcImluY3JlbWVudGluZ1wiIHRoZW0gYnkgMSAob25seSBpbiB0aGUgY2FzZSBvZiBhIHRpbWVzdGFtcCBjb2xsaXNpb24pLlxyXG4gICAgICovXHJcbiAgICAgcmV0dXJuIHtcclxuXHJcbiAgICAgICAgZ2VuZXJhdGVQdXNoSUQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAvLyBNb2RlbGVkIGFmdGVyIGJhc2U2NCB3ZWItc2FmZSBjaGFycywgYnV0IG9yZGVyZWQgYnkgQVNDSUkuXHJcbiAgICAgICAgICAgIHZhciBQVVNIX0NIQVJTID0gJy0wMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpfYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonO1xyXG5cclxuICAgICAgICAgICAgLy8gVGltZXN0YW1wIG9mIGxhc3QgcHVzaCwgdXNlZCB0byBwcmV2ZW50IGxvY2FsIGNvbGxpc2lvbnMgaWYgeW91IHB1c2ggdHdpY2UgaW4gb25lIG1zLlxyXG4gICAgICAgICAgICB2YXIgbGFzdFB1c2hUaW1lID0gMDtcclxuXHJcbiAgICAgICAgICAgIC8vIFdlIGdlbmVyYXRlIDcyLWJpdHMgb2YgcmFuZG9tbmVzcyB3aGljaCBnZXQgdHVybmVkIGludG8gMTIgY2hhcmFjdGVycyBhbmQgYXBwZW5kZWQgdG8gdGhlXHJcbiAgICAgICAgICAgIC8vIHRpbWVzdGFtcCB0byBwcmV2ZW50IGNvbGxpc2lvbnMgd2l0aCBvdGhlciBjbGllbnRzLiAgV2Ugc3RvcmUgdGhlIGxhc3QgY2hhcmFjdGVycyB3ZVxyXG4gICAgICAgICAgICAvLyBnZW5lcmF0ZWQgYmVjYXVzZSBpbiB0aGUgZXZlbnQgb2YgYSBjb2xsaXNpb24sIHdlJ2xsIHVzZSB0aG9zZSBzYW1lIGNoYXJhY3RlcnMgZXhjZXB0XHJcbiAgICAgICAgICAgIC8vIFwiaW5jcmVtZW50ZWRcIiBieSBvbmUuXHJcbiAgICAgICAgICAgIHZhciBsYXN0UmFuZENoYXJzID0gW107XHJcblxyXG4gICAgICAgICAgICAvLyByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICAgIHZhciBkdXBsaWNhdGVUaW1lID0gKG5vdyA9PT0gbGFzdFB1c2hUaW1lKTtcclxuICAgICAgICAgICAgICBsYXN0UHVzaFRpbWUgPSBub3c7XHJcblxyXG4gICAgICAgICAgICAgIHZhciB0aW1lU3RhbXBDaGFycyA9IG5ldyBBcnJheSg4KTtcclxuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gNzsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgIHRpbWVTdGFtcENoYXJzW2ldID0gUFVTSF9DSEFSUy5jaGFyQXQobm93ICUgNjQpO1xyXG4gICAgICAgICAgICAgICAgLy8gTk9URTogQ2FuJ3QgdXNlIDw8IGhlcmUgYmVjYXVzZSBqYXZhc2NyaXB0IHdpbGwgY29udmVydCB0byBpbnQgYW5kIGxvc2UgdGhlIHVwcGVyIGJpdHMuXHJcbiAgICAgICAgICAgICAgICBub3cgPSBNYXRoLmZsb29yKG5vdyAvIDY0KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKG5vdyAhPT0gMCkgdGhyb3cgbmV3IEVycm9yKCdXZSBzaG91bGQgaGF2ZSBjb252ZXJ0ZWQgdGhlIGVudGlyZSB0aW1lc3RhbXAuJyk7XHJcblxyXG4gICAgICAgICAgICAgIHZhciBpZCA9IHRpbWVTdGFtcENoYXJzLmpvaW4oJycpO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoIWR1cGxpY2F0ZVRpbWUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIGxhc3RSYW5kQ2hhcnNbaV0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA2NCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSB0aW1lc3RhbXAgaGFzbid0IGNoYW5nZWQgc2luY2UgbGFzdCBwdXNoLCB1c2UgdGhlIHNhbWUgcmFuZG9tIG51bWJlciwgZXhjZXB0IGluY3JlbWVudGVkIGJ5IDEuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAxMTsgaSA+PSAwICYmIGxhc3RSYW5kQ2hhcnNbaV0gPT09IDYzOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsYXN0UmFuZENoYXJzW2ldKys7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZCArPSBQVVNIX0NIQVJTLmNoYXJBdChsYXN0UmFuZENoYXJzW2ldKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYoaWQubGVuZ3RoICE9IDIwKSB0aHJvdyBuZXcgRXJyb3IoJ0xlbmd0aCBzaG91bGQgYmUgMjAuJyk7XHJcblxyXG4gICAgICAgICAgICAgIHJldHVybiBpZDtcclxuICAgICAgICAgICAgLy8gfTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICB9KSIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignQXV0aEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLCRtZFNpZGVuYXYsJHRyYW5zbGF0ZSwgJGNvb2tpZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlTZXJ2aWNlLCRub3RpZmljYXRpb24pe1xuXG4gICAgY29uc29sZS5sb2coXCJhdXRoQ3RybFwiKTtcblxuICAgIHZhciBhdXRoQ3RybCA9IHRoaXM7XG5cbiAgICAvL0FzayBmb3Igbm90aWZpY2F0aW9uIHBlcm1pc3Npb25cbiAgICAkbm90aWZpY2F0aW9uLnJlcXVlc3RQZXJtaXNzaW9uKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHBlcm1pc3Npb24pOyAvLyBkZWZhdWx0LCBncmFudGVkLCBkZW5pZWRcbiAgICAgIH0pO1xuXG4gICAgLy9QYXJzZXJcbiAgICBhdXRoQ3RybC5hdXRoICAgICA9IEF1dGg7XG4gICAgYXV0aEN0cmwudXNlcnMgICAgPSBVc2VycztcbiAgICBhdXRoQ3RybC5ub3RpZmljYXRpb24gPSBOb3RpU2VydmljZTtcblxuICAgIGF1dGhDdHJsLmJhZGdlVmFsdWUgPSAwO1xuXG4gICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgICAgPSBhdXRoQ3RybC51c2Vycy5nZXRQcm9maWxlKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgICAgLy9hdXRoQ3RybC5iYWRnZVZhbHVlID0gYXV0aEN0cmwubm90aWZpY2F0aW9uLnVucmVhZE5vdGlmaWNhdGlvbihhdXRoQ3RybC5wcm9maWxlLiRpZCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBhdXRoQ3RybC5wcm9maWxlID0nJ1xuICAgIH1cblxuICAgIGF1dGhDdHJsLnVzZXIgPSB7XG4gICAgICBlbWFpbDogJycsXG4gICAgICBwYXNzd29yZDogJydcbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuJHdhdGNoKCdiYWRnZVZhbHVlJyxmdW5jdGlvbigpe1xuICAgICAgY29uc29sZS5sb2coXCI+Pj5cIiArIGF1dGhDdHJsLmJhZGdlVmFsdWUudmFsdWUpO1xuICAgICAgcmV0dXJuIE5vdGlTZXJ2aWNlLnVucmVhZE5vdGlmaWNhdGlvbihhdXRoQ3RybC5wcm9maWxlLiRpZCkudGhlbihmdW5jdGlvbih2YWwpe1xuICAgICAgICBhdXRoQ3RybC5iYWRnZVZhbHVlID0gdmFsO1xuICAgICAgfSk7XG5cblxuICAgICAgLy9yZXR1cm4gYXV0aEN0cmwuYmFkZ2VWYWx1ZSA9IGF1dGhDdHJsLm5vdGlmaWNhdGlvbi51bnJlYWROb3RpZmljYXRpb24oYXV0aEN0cmwucHJvZmlsZS4kaWQpO1xuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZyhhdXRoQ3RybC5iYWRnZVZhbHVlKTtcblxuXG4gICAgLy9SZXNldCBjb3VudGVyXG4gICAgYXV0aEN0cmwucmVzZXRDb3VudGVyID0gZnVuY3Rpb24oKXtcbiAgICAgIGF1dGhDdHJsLm5vdGlmaWNhdGlvbi5yZXNldFVucmVhZChhdXRoQ3RybC5wcm9maWxlLiRpZCk7XG4gICAgfVxuXG5cbiAgICAvL0NoYW5nZSBsYW5ndWFnZVxuICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xuICAgICAgJHRyYW5zbGF0ZS51c2UobGFuZ0tleSk7XG4gICAgICAvLyBTZXR0aW5nIGEgY29va2llXG4gICAgICAkY29va2llcy5wdXQoJ3VzZXJMYW5nJywgbGFuZ0tleSk7XG4gICAgICAvL0lmIHVzZXIgcmVnaXN0ZXJlZCAtIHVwZGF0ZSB0aGlzIGluIHRoZWlyIHByZWZlcmVuY2VcbiAgICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XG4gICAgICAgIGF1dGhDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKHtcImxhbmdcIjpsYW5nS2V5fSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvL0NoZWNrayB1c2VyIHNlbGVjdGVkIGxhbmd1YWdlXG4gICAgaWYoIWF1dGhDdHJsLnByb2ZpbGUubGFuZyl7XG4gICAgICBpZigkY29va2llcy5nZXQoJ3VzZXJMYW5nJykpe1xuICAgICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKCRjb29raWVzLmdldCgndXNlckxhbmcnKSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgYXV0aEN0cmwudG9nZ2xlTGFuZygnRW5nJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKGF1dGhDdHJsLnByb2ZpbGUubGFuZyk7XG4gICAgfVxuXG5cbiAgICAvL0xvZ2luXG4gICAgYXV0aEN0cmwubG9naW4gPSBmdW5jdGlvbiAoKXtcbiAgICAgIGF1dGhDdHJsLmF1dGguYXV0aC4kYXV0aFdpdGhQYXNzd29yZChhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uIChhdXRoKXtcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcil7XG4gICAgICAgIGF1dGhDdHJsLmVycm9yID0gZXJyb3I7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy9Mb2dvdXRcbiAgICBhdXRoQ3RybC5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgQXV0aC5hdXRoLiR1bmF1dGgoKTtcbiAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICB9XG5cbiAgICAvL1JlZ2lzdGVyIHVzZXJcbiAgICBhdXRoQ3RybC5yZWdpc3RlciA9IGZ1bmN0aW9uICgpe1xuICAgICAgQXV0aC5hdXRoLiRjcmVhdGVVc2VyKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKHVzZXIpe1xuICAgICAgICBhdXRoQ3RybC5sb2dpbigpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcbiAgICAgICAgYXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5mYWN0b3J5KCdBdXRoJywgZnVuY3Rpb24oJGZpcmViYXNlQXV0aCwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xuICAgIHZhciBhdXRoID0gJGZpcmViYXNlQXV0aChyZWYpO1xuXG4gICAgY29uc29sZS5sb2coXCJhdXRoIHNlcnZpY2VcIik7XG5cbiAgICB2YXIgQXV0aCA9IHtcblxuICAgICAgcmVmOnJlZixcbiAgICAgIGF1dGg6IGF1dGgsXG5cbiAgICAgIGdldFVpZDpmdW5jdGlvbigpe1xuICAgICAgICB2YXIgdWlkID0gcmVmLmdldEF1dGgoKTtcbiAgICAgICAgaWYodWlkICE9IG51bGwgKXtcbiAgICAgICAgICByZXR1cm4gcmVmLmdldEF1dGgoKS51aWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfVxuXG4gICAgcmV0dXJuIEF1dGg7XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdDYXRlQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgQ2F0ZWdvcnksY2F0ZU5hbWUsY2F0ZVRvcGljcyl7XG4gICAgdmFyIGNhdGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2Vyc1xuICAgIGNhdGVDdHJsLmNhdGVOYW1lICAgPSBjYXRlTmFtZTtcbiAgICBjYXRlQ3RybC5jYXRlZ29yeSAgID0gQ2F0ZWdvcnk7XG4gICAgY2F0ZUN0cmwuY2F0ZVRvcGljcyA9IGNhdGVUb3BpY3M7XG5cblxuICAgIGNvbnNvbGUubG9nKFwiQ2F0ZUN0cmxcIik7XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC8vVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnQ2F0ZVNlcnZpY2UnLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5ICwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMnKTtcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xuXG4gICAgY29uc29sZS5sb2coXCJjYXRlZ29yeSBzZXJ2aWNlXCIpO1xuICAgIFxuICAgIHZhciBDYXRlID0ge1xuXG4gICAgICBuYW1lOiBmdW5jdGlvbih0b3BpY19zbHVnKXtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKFwic2x1Z1wiKS5lcXVhbFRvKHRvcGljX3NsdWcpO1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xuICAgICAgfSxcblxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpO1xuICAgICAgfSxcblxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxuICAgICAgfSxcblxuICAgICAgZm9sbG93TGlzdDpmdW5jdGlvbih1aWQpe1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoXCJuZXdzL2ZvbGxvd2VyXCIpLmVxdWFsVG8odWlkKTtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KGRhdGEpO1xuICAgICAgfSxcblxuICAgICAgdW5Gb2xsb3c6ZnVuY3Rpb24oc2x1Zyx1aWQpe1xuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzLycrc2x1ZysnL2ZvbGxvd2VyLycrdWlkKTtcbiAgICAgICAgcmVmLnJlbW92ZSgpO1xuICAgICAgfSxcblxuICAgICAgdXNlckZvbGxvdzpmdW5jdGlvbihzbHVnLHVpZCl7XG4gICAgICAgIHZhciBmb2xsb3c9ZmFsc2U7XG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMvJytzbHVnKycvZm9sbG93ZXIvJyt1aWQpO1xuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgZm9sbG93ID0gc25hcHNob3QuZXhpc3RzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmb2xsb3c7XG4gICAgICB9LFxuICAgICAgYXJyOiAkZmlyZWJhc2VBcnJheShyZWYpLFxuICAgICAgYWxsOmNhdGVnb3JpZXNcbiAgICB9XG4gICAgcmV0dXJuIENhdGU7XG4gIH0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIGZ1bmN0aW9uKEF1dGgsICRzdGF0ZSxDYXRlZ29yeSxDYXRlU2VydmljZSxUYWdzLFRvcGljc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgIHZhciBkYXNoYm9hcmRDdHJsID0gdGhpcztcblxuICAgIGRhc2hib2FyZEN0cmwuYXV0aCA9IEF1dGg7XG5cbiAgICBkYXNoYm9hcmRDdHJsLmNhdGUgICAgICAgID0gQ2F0ZVNlcnZpY2U7XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlZ29yaWVzICA9IENhdGVnb3J5O1xuICAgIGRhc2hib2FyZEN0cmwudG9waWNzICAgICAgPSBUb3BpY3M7XG4gICAgZGFzaGJvYXJkQ3RybC50b3BpY19ncmlkICA9IGZhbHNlO1xuICAgIGRhc2hib2FyZEN0cmwudGFncyAgICAgICAgPSBUYWdzLmFycjtcblxuICAgIGRhc2hib2FyZEN0cmwudXNlckNhdGVGb2xsb3cgID0gW107XG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBkYXNoYm9hcmRDdHJsLmZvbGxvd0xpc3QgICAgICA9ICcnO1xuICAgIGRhc2hib2FyZEN0cmwudXNlckZlZWQgPSdudWxsJztcblxuICAgIGRhc2hib2FyZEN0cmwubGF0ZXN0RmVlZCA9IGRhc2hib2FyZEN0cmwudG9waWNzLmxhdGVzdEZlZWQoKTtcblxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGNhdGVfc2x1Zyl7XG4gICAgICBkYXNoYm9hcmRDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIkRhc2hib2FyZEN0cmxcIik7XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG5cbiAgLmRpcmVjdGl2ZSgnbWFpbkhlYWRlcicsZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXG4gICAgICB0cmFuc2NsdWRlOiAgIHRydWUsXG4gICAgICAvL2NvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgIH1cblxuICB9KVxuXG4gIC8vQmFkZ2Ugbm90aWZpY2F0aW9uXG4gIC5kaXJlY3RpdmUoJ2JhZGdlTm90aWZpY2F0aW9uJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvYmFkZ2Utbm90aWZpY2F0aW9uLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgbm90aWZpY2F0aW9uOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0xpc3Qgb2YgY2F0ZWdvcmllcyBvbiB0aGUgc2lkZXJiYXJcbiAgLmRpcmVjdGl2ZSgncmV2aWV3U2NvcmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9yZXZpZXctc3VtbWFyeS1saXN0Lmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgcmV2aWV3OiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL0ZvbGxvdyBCdXR0b25cbiAgLmRpcmVjdGl2ZSgndXNlckZvbGxvd2VyQnRuJyxmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogICAgICdFJyxcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcbiAgICAgIC8vY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogICd0ZW1wbGF0ZXMvaHRtbC9mb2xsb3ctdXNlci5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGZvbGxvdzogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLy9DYXRlZ29yeSBmb2xsb3cgYnV0dG9uXG4gIC5kaXJlY3RpdmUoJ2NhdGVGb2xsb3dCdG4nLGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWZvbGxvdy1idG4uaHRtbCcsXG4gICAgICBzY29wZToge1xuICAgICAgICBjYXRlOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXG4gIC5kaXJlY3RpdmUoJ3RvcGljR3JpZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvY2F0ZWdvcnktZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuICAvL0dyaWQgVGFncyBmb3Igc2lkZWJhclxuICAuZGlyZWN0aXZlKCd0YWdHcmlkJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90YWctZ3JpZC5odG1sJ1xuICAgIH1cbiAgfSlcblxuXG4gIC5kaXJlY3RpdmUoJ3RvcGljQ3JlYXRlJywgZnVuY3Rpb24oKXtcblxuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtY3JlYXRlLmh0bWwnLFxuICAgICAgc2NvcGU6IHtcbiAgICAgICAgdG9waWM6ICc9J1xuICAgICAgfVxuICAgIH1cblxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNMaXN0JywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAvL2NvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvdG9waWMtbGlzdC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljczogJz0nXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbiAgLmRpcmVjdGl2ZSgndG9waWNBY3Rpb25zQ2FyZCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLy9jb250cm9sbGVyOiAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWFjdGlvbnMtY2FyZC5odG1sJyxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHRvcGljOiAnPSdcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuICAvL2ZvciB0YWdzIC0gbWF4IHRhZ3NcbiAgLmRpcmVjdGl2ZSgnZW5mb3JjZU1heFRhZ3MnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ0N0cmwpIHtcbiAgICAgIHZhciBtYXhUYWdzID0gYXR0cnMubWF4VGFncyA/IHBhcnNlSW50KGF0dHJzLm1heFRhZ3MsICc0JykgOiBudWxsO1xuXG4gICAgICBuZ0N0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgJiYgbWF4VGFncyAmJiB2YWx1ZS5sZW5ndGggPiBtYXhUYWdzKSB7XG4gICAgICAgICAgdmFsdWUuc3BsaWNlKHZhbHVlLmxlbmd0aCAtIDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbmZpZyhbJyR0cmFuc2xhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ0VuZycsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ0Rhc2hib2FyZCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICdMYW5ndWFnZXMnLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAnSG9tZScsXHJcbiAgICAgICdLRVlfUkVHSVNURVInOiAgICdSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICdMb2cgaW4nLFxyXG4gICAgICAnS0VZX0xPR09VVCc6ICAgICAnTG9nIG91dCcsXHJcbiAgICAgICdLRVlfRk9MTE9XJzogICAgICdGb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0VSJzogICAnRm9sbG93ZXInLFxyXG4gICAgICAnS0VZX1VORk9MTE9XJzogICAnVW5mb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0lORyc6ICAnRm9sbG93aW5nJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ1Bvc3QnLFxyXG4gICAgICAnS0VZX1BPU1RFRCc6ICAgICAnUG9zdGVkJyxcclxuICAgICAgJ0tFWV9VUFZPVEUnOiAgICAgJ1Vwdm90ZScsXHJcbiAgICAgICdLRVlfVVBWT1RFRCc6ICAgICdVcHZvdGVkJyxcclxuICAgICAgJ0tFWV9EV05fVk9URSc6ICAgJ0Rvd252b3RlJyxcclxuICAgICAgJ0tFWV9EV05fVk9URUQnOiAgJ0Rvd252b3RlZCcsXHJcbiAgICAgICdLRVlfVklFVyc6ICAgICAgICdWaWV3JyxcclxuICAgICAgJ0tFWV9SRU1PVkUnOiAgICAgJ1JlbW92ZScsXHJcbiAgICAgICdLRVlfQ0FOQ0VMJzogICAgICdDYW5jZWwnLFxyXG4gICAgICAnS0VZX1FVRVNUSU9OJzogICAnUXVlc3Rpb24nLFxyXG4gICAgICAnS0VZX1RPUElDJzogICAgICAnVG9waWMnLFxyXG4gICAgICAnS0VZX0NIR19QV0QnOiAgICAnQ2hhbmdlIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9QQVNTV09SRCc6ICAgJ1Bhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9PTERfUFdEJzogICAgJ09sZCBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfTkVXX1BXRCc6ICAgICdOZXcgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX05FV19QV0RfQyc6ICAnTmV3IHBhc3N3b3JkIGNvbmZpcm1hdGlvbicsXHJcbiAgICAgICdLRVlfU0FWRSc6ICAgICAgICdTYXZlJyxcclxuICAgICAgJ0tFWV9TQVZFX0RSQUZUJzogJ1NhdmUgYXMgZHJhZnQnLFxyXG4gICAgICAnS0VZX1RBR1MnOiAgICAgICAnVGFncycsXHJcbiAgICAgICdLRVlfRVhQTE9SRSc6ICAgICdFeHBsb3JlJyxcclxuICAgICAgJ0tFWV9GRUFUX0NBVCc6ICAgICdGZWF0dXJlcyBjYXRlZ29yaWVzJyxcclxuICAgICAgJ0tFWV9DT01NRU5UUyc6ICAgJ0NvbW1lbnRzJyxcclxuICAgICAgJ0tFWV9SRVBMWSc6ICAgICAgJ1JlcGx5JyxcclxuICAgICAgJ0tFWV9SRVZJRVcnOiAgICAgJ1JldmlldycsXHJcbiAgICAgICdLRVlfRURJVCc6ICAgICAgICdFZGl0JyxcclxuICAgICAgJ0tFWV9UUkVORCc6ICAgICAgJ1RyZW5kJyxcclxuICAgICAgJ0tFWV9UUkVORElORyc6ICAgJ1RyZW5kaW5nJyxcclxuICAgICAgJ0tFWV9XUklURV9SRVBMWSc6J1dyaXRlIGEgcmVwbHknLFxyXG4gICAgICAnS0VZX0xBVEVTVF9GRUVEJzonTGF0ZXN0IEZlZWQnLFxyXG5cclxuICAgICAgLy9SZW1vdmUgdG9waWNcclxuICAgICAgJ0tFWV9DT05GX1JFTU9WRSc6J0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmU/JyxcclxuICAgICAgJ0tFWV9DT05GX1JFTV9DJzogJ09uY2UgcmVtb3ZlLCB5b3Ugd2lsbCBub3QgYmUgYWJsZXRvIHRvIGdldCB0aGlzIHRvcGljIGJhY2snLFxyXG5cclxuXHJcbiAgICAgIC8vU0VOVEVOQ0VcclxuICAgICAgJ0tFWV9XSEFUX09OX1VSX01JTkQnOiAgJ1doYXRcXCdzIG9uIHlvdXIgbWluZD8nLFxyXG4gICAgICAnS0VZX1lPVV9XQU5UX0ZPTExPVyc6ICAnWW91IG1heSB3YW50IHRvIGZvbGxvdycsXHJcbiAgICAgICdLRVlfTk9fQUNDVF9SRUdJU1RFUic6ICdEb25cXCd0IGhhdmUgYWNjb3VudD8gUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX0NBTlRfQ0hOR19VU0VSJzogICAnRG9uXFwndCBoYXZlIGFjY291bnQ/IFJlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9ZT1VSX0FDQ09VTlQnOiAgICAgJ1lvdXIgYWNjb3VudCcsXHJcbiAgICAgICdLRVlfTk9USElOR19IRVJFJzogICAgICdOb3RoaW5nIGhlcmUsIHlldCcsXHJcbiAgICAgICdLRVlfV0hPX1RPX0ZPTExPVyc6ICAgICdXaG8gdG8gZm9sbG93JyxcclxuICAgICAgJ0tFWV9DQVRfV0lMTF9BUFBFQVInOiAgJ0ZvbGxvdyBzb21lIGNhdGVnb3JpZXMgYW5kIGl0IHdpbGwgYXBwZWFyIGhlcmUnLFxyXG4gICAgICAnS0VZX1dIVF9VUl9TVE9SWSc6ICAgICAnV2hhdFxcJ3MgeW91ciBzdG9yeScsXHJcbiAgICAgICdLRVlfV1JUX0NPTU1FTlQnOiAgICAgICdXcml0ZSBhIGNvbW1lbnQnLFxyXG5cclxuXHJcblxyXG4gICAgICAvL1VTRVIgSU5QVVRcclxuICAgICAgJ0tFWV9GSVJTVE5BTUUnOiAgJ0ZpcnN0IG5hbWUnLFxyXG4gICAgICAnS0VZX0xBU1ROQU1FJzogICAnTGFzdCBuYW1lJyxcclxuICAgICAgJ0tFWV9CSVJUSERBWSc6ICAgJ0JpcnRoZGF5JyxcclxuICAgICAgJ0tFWV9NT05USCc6ICAgICAgJ01vbnRoJyxcclxuICAgICAgJ0tFWV9EQVknOiAgICAgICAgJ0RheScsXHJcbiAgICAgICdLRVlfRU1BSUwnOiAgICAgICdFbWFpbCcsXHJcbiAgICAgICdLRVlfQ09ORl9FTUFJTCc6ICdDb25maXJtIEVtYWlsJyxcclxuICAgICAgJ0tFWV9HRU5ERVInOiAgICAgJ0dlbmRlcicsXHJcbiAgICAgICdLRVlfTUFMRSc6ICAgICAgICdNYWxlJyxcclxuICAgICAgJ0tFWV9GRU1BTEUnOiAgICAgJ0ZlbWFsZScsXHJcbiAgICAgICdLRVlfVVNFUk5BTUUnOiAgICdVc2VybmFtZScsXHJcbiAgICAgICdLRVlfTE9DQVRJT04nOiAgICdMb2NhdGlvbicsXHJcblxyXG4gICAgICAvL1VzZXIgRWRpdFxyXG4gICAgICAnS0VZX0VEX1BST0ZJTEUnOiAnRWRpdCBQcm9maWxlJyxcclxuICAgICAgJ0tFWV9FRF9DSEdfUFdEJzogJ0NoYW5nZSBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfRURfUFJPRklMRSc6ICdFZGl0IFByb2ZpbGUnLFxyXG4gICAgICAnS0VZX0VEX1NJVEUnOiAgICAnV2Vic2l0ZScsXHJcbiAgICAgICdLRVlfRURfUEhPTkUnOiAgICdQaG9uZScsXHJcbiAgICAgICdLRVlfRURfQklPJzogICAgICdCaW9ncmFwaHknLFxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ+C5hOC4l+C4oicsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ+C4q+C5ieC4reC4h+C4l+C4seC5ieC4h+C4q+C4oeC4lCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICfguKDguLLguKnguLInLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAn4Lir4LiZ4LmJ4Liy4LmB4Lij4LiBJyxcclxuICAgICAgJ0tFWV9SRUdJU1RFUic6ICAgJ+C4quC4oeC4seC4hOC4o+C5g+C4iuC5iScsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICfguYDguILguYnguLLguKrguLnguYjguKPguLDguJrguJonLFxyXG4gICAgICAnS0VZX0ZPTExPVyc6ICAgICAn4LiV4Li04LiU4LiV4Liy4LihJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ+C5guC4nuC4quC4leC5jCdcclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnZW4nKTtcclxuICB9XSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ05vdGlDdHJsJywgZnVuY3Rpb24oJHN0YXRlLENhdGVnb3J5LFRvcGljcyxOb3RpU2VydmljZSl7XHJcbiAgICB2YXIgbm90aUN0cmwgPSB0aGlzO1xyXG5cclxuXHJcbiAgICBub3RpQ3RybC50b3BpY3MgPSBUb3BpY3M7XHJcbiAgICBub3RpQ3RybC5mZWVkICAgPSBmZWVkO1xyXG4gICAgbm90aUN0cmwubm90aVNlcnZpY2UgPSBOb3RpU2VydmljZTtcclxuXHJcbiAgICBub3RpQ3RybC5ub3RpZnlUbyA9ZnVuY3Rpb24odWlkKXtcclxuICAgICAgcmV0dXJuIG5vdGlDdHJsLmFyci5wdXNoKHVpZCkuJGFkZCh1aWQpXHJcbiAgICB9XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuXG4gIC5mYWN0b3J5KCdOb3RpU2VydmljZScsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXkgLCBGaXJlYmFzZVVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlcnMsJG5vdGlmaWNhdGlvbiwkcSl7XG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uJyk7XG4gICAgdmFyIG5vdGkgPSAkZmlyZWJhc2VPYmplY3QocmVmKTtcbiAgICB2YXIgdXNlcnMgPSBVc2VycztcblxuICAgIGNvbnNvbGUubG9nKCdub3RpIHNlcnZpY2UnKTtcblxuICAgIHZhciBOb3RpZmljYXRpb24gPSB7XG5cbiAgICAgIC8vRGlzcGxheSB1bnJlYWRcbiAgICAgIHVucmVhZE5vdGlmaWNhdGlvbjpmdW5jdGlvbih1aWQpe1xuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQrJy91bnJlYWQnKTtcbiAgICAgICAgdmFyIGNvdW50ZXI7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLGZ1bmN0aW9uKHNuYXBzaG90KXtcbiAgICAgICAgICBjb3VudGVyID0gc25hcHNob3QudmFsKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coc25hcHNob3QudmFsKCkpO1xuXG4gICAgICAgICAgaWYoY291bnRlciA+IDApe1xuICAgICAgICAgICAgJG5vdGlmaWNhdGlvbignTmV3IG1lc3NhZ2UgZnJvbSBRYW55YScsIHtcbiAgICAgICAgICAgICAgYm9keTogJ1lvdSBoYXZlICcrY291bnRlciArJyB1bnJlYWQgbWVzc2FnZXMnLFxuICAgICAgICAgICAgICBkaXI6ICdhdXRvJyxcbiAgICAgICAgICAgICAgbGFuZzogJ2VuJyxcbiAgICAgICAgICAgICAgdGFnOiAnbXktdGFnJyxcbiAgICAgICAgICAgICAgaWNvbjogJ2h0dHA6Ly93d3cuY2wuY2FtLmFjLnVrL3Jlc2VhcmNoL3NyZy9uZXRvcy9pbWFnZXMvcXNlbnNlLWxvZ28ucG5nJyxcbiAgICAgICAgICAgICAgLy9kZWxheTogMTAwMCwgLy8gaW4gbXNcbiAgICAgICAgICAgICAgZm9jdXNXaW5kb3dPbkNsaWNrOiB0cnVlIC8vIGZvY3VzIHRoZSB3aW5kb3cgb24gY2xpY2tcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb3VudGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgfSxcblxuXG4gICAgICAvL05vdGlmeSBmb2xsb3dlcnNcbiAgICAgIG5vdGlmeUZvbGxvd2VyOmZ1bmN0aW9uKHRvcGljSWQsdWlkKXtcbiAgICAgICAgdmFyIHJlZiA9IHVzZXJzLmdldEZvbGxvd2VyKHVpZCk7XG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkU25hcHNob3QpIHtcbiAgICAgICAgICAgIC8vdXBkYXRlIG5vdGlmaWNhdGlvbiBhbmQgZGV0YWlsc1xuICAgICAgICAgICAgTm90aWZpY2F0aW9uLnVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50KHRvcGljSWQsY2hpbGRTbmFwc2hvdC5rZXkoKSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIC8vQWRkIGRldGFpbCBmb3IgdGhpcyBub3RpZmljdGlhb25cbiAgICAgIG5vdGlmeUxvZzpmdW5jdGlvbih0b3BpY0lkLHVpZCxmcm9tX3VpZCl7XG4gICAgICAgIGNvbnNvbGUubG9nKFwidWlkIFwiK3VpZCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZnJvbSB1aWQgXCIrIGZyb21fdWlkKTtcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycpO1xuICAgICAgICByZWYub24uYWRkQ2hpbGQodWlkKS5wdXNoKCkuc2V0KHtcbiAgICAgICAgICB0b3BpY0lkOiAgICB0b3BpY0lkLFxuICAgICAgICAgIGZyb206ICAgICAgIGZyb21fdWlkLFxuICAgICAgICAgIGlzX3JlYWQ6ICAgIGZhbHNlLFxuICAgICAgICAgIHRpbWVzdGFtcDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICRub3RpZmljYXRpb24oJ05ldyBtZXNzYWdlIGZyb20gUWFueWEnLCB7XG4gICAgICAgICAgICBib2R5OiAnWW91IGhhdmUgbmV3IG1lc3NhZ2UnLFxuICAgICAgICAgICAgZGlyOiAnYXV0bycsXG4gICAgICAgICAgICBsYW5nOiAnZW4nLFxuICAgICAgICAgICAgdGFnOiAnbXktdGFnJyxcbiAgICAgICAgICAgIGljb246ICdodHRwOi8vd3d3LmNsLmNhbS5hYy51ay9yZXNlYXJjaC9zcmcvbmV0b3MvaW1hZ2VzL3FzZW5zZS1sb2dvLnBuZycsXG4gICAgICAgICAgICAvL2RlbGF5OiAxMDAwLCAvLyBpbiBtc1xuICAgICAgICAgICAgZm9jdXNXaW5kb3dPbkNsaWNrOiB0cnVlIC8vIGZvY3VzIHRoZSB3aW5kb3cgb24gY2xpY2tcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgIH0sXG5cblxuICAgICAgLy9SZXNldCB1bnJlYWQgY291bnRlclxuICAgICAgcmVzZXRVbnJlYWQ6ZnVuY3Rpb24odWlkKXtcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XG4gICAgICAgIHJlZi5zZXQoMCk7XG4gICAgICB9LFxuXG5cbiAgICAgIC8vVXBkYXRlIG5vdGlmaWNhdGlvblxuICAgICAgLy9AcGFyYW1zIHVpZCAtIHdobyB0aGlzIG5vdGlmaWNhdGlvbiBpcyBnb2luZyB0b1xuICAgICAgdXBkYXRlTm90aWZpY2F0aW9uQ291bnQ6ZnVuY3Rpb24odG9waWNJZCx1aWQsZnJvbV91aWQpe1xuXG4gICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ25vdGlmaWNhdGlvbi8nK3VpZCsnL3VucmVhZCcpO1xuICAgICAgICByZWYub25jZShcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgLy9kZWZhdWx0IHVucmVhZCBpcyAxXG4gICAgICAgICBpZihzbmFwc2hvdC52YWwoKSA9PSAnbnVsbCcpe1xuICAgICAgICAgICAgcmVmLnNldCgxKVxuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgcmVmLnNldChzbmFwc2hvdC52YWwoKSArIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgcmVhZCBmYWlsZWQ6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vQWRkIHRvIGxvZ1xuICAgICAgICBOb3RpZmljYXRpb24ubm90aWZ5TG9nKHRvcGljSWQsdWlkLGZyb21fdWlkKTtcblxuXG5cbiAgICAgIH0sXG5cblxuICAgICAgYWRkQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKGNoaWxkKTtcbiAgICAgIH0sXG5cbiAgICAgIGFkZEFyckNoaWxkOmZ1bmN0aW9uKGNoaWxkKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQoY2hpbGQpKTtcbiAgICAgIH0sXG5cbiAgICAgIGFycjogJGZpcmViYXNlQXJyYXkocmVmKSxcbiAgICAgIGFsbDogbm90aVxuICAgIH1cbiAgICByZXR1cm4gTm90aWZpY2F0aW9uO1xuXG5cbiAgICBmdW5jdGlvbiBub3RpZmljYXRpb25BbGVydCh1aWQsaGVhZCxib2R5KXtcbiAgICAgIHZhciBub3RpZmljYXRpb25fcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQpO1xuICAgICAgbm90aWZpY2F0aW9uX3JlZi5vbmNlKFwiY2hpbGRfYWRkZWRcIixmdW5jdGlvbigpe1xuICAgICAgICAkbm90aWZpY2F0aW9uKGhlYWQsIHtcbiAgICAgICAgICBib2R5OiBib2R5LFxuICAgICAgICAgIGRpcjogJ2F1dG8nLFxuICAgICAgICAgIGxhbmc6ICdlbicsXG4gICAgICAgICAgdGFnOiAnbXktdGFnJyxcbiAgICAgICAgICBpY29uOiAnaHR0cDovL3d3dy5jbC5jYW0uYWMudWsvcmVzZWFyY2gvc3JnL25ldG9zL2ltYWdlcy9xc2Vuc2UtbG9nby5wbmcnLFxuICAgICAgICAgIC8vZGVsYXk6IDEwMDAsIC8vIGluIG1zXG4gICAgICAgICAgZm9jdXNXaW5kb3dPbkNsaWNrOiB0cnVlIC8vIGZvY3VzIHRoZSB3aW5kb3cgb24gY2xpY2tcbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgIH1cbiAgfSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ1BsYWNlc0N0cmwnLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLCBTbHVnLExhbmd1YWdlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlTGFuZGluZykge1xyXG5cclxuICAgIHZhciBwbGFjZXNDdHJsID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKHBsYWNlTGFuZGluZyk7XHJcbiAgICBwbGFjZXNDdHJsLnBsYWNlTGFuZGluZyA9IHBsYWNlTGFuZGluZztcclxuXHJcbiAgfSk7XHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnUGxhY2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuXHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydwbGFjZXMnKTtcclxuICAgIHZhciBwbGFjZURldGFpbF9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlc19kZXRhaWxzJyk7XHJcblxyXG4gICAgdmFyIHBsYWNlcyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIFBsYWNlcyA9IHtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRQbGFjZURldGFpbENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiBwbGFjZURldGFpbF9yZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0UGxhY2VSZWY6ZnVuY3Rpb24ocGxhY2VfaWQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQocGxhY2VfaWQrJy9pbmZvJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogcGxhY2VzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGxhY2VzO1xyXG4gIH0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAvL0NhdGVnb3J5IGxpc3RcbiAgLmZhY3RvcnkoJ0NhdGVnb3J5JywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMnKTtcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xuICAgIHZhciB0b3BpY0FyciA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICBjb25zb2xlLmxvZyhcIlV0aWwgY2F0ZWdvcnkgU2VydmljZVwiKTtcblxuICAgIHZhciBDYXRlZ29yeSA9IHtcbiAgICAgIGdldE5hbWU6IGZ1bmN0aW9uKHNsdWcpe1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5jaGlsZChzbHVnKTtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChkYXRhKTtcbiAgICAgIH0sXG5cbiAgICAgIGFsbDogY2F0ZWdvcmllc1xuICAgIH1cbiAgICByZXR1cm4gQ2F0ZWdvcnk7XG4gIH0pXG5cblxuICAvL0xhbmd1YWdlc1xuICAuZmFjdG9yeSgnTGFuZ3VhZ2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydsYW5ndWFnZXMnKTtcbiAgICB2YXIgbGFuZyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICBjb25zb2xlLmxvZyhcIlV0aWwgbGFuZ3VhZ2VcIik7XG5cbiAgICByZXR1cm4gbGFuZztcbiAgfSlcblxuXG4gIC8vTGFuZ3VhZ2VzXG4gIC5mYWN0b3J5KCdBcmNoaXZlJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydhcmNoaXZlJyk7XG4gICAgdmFyIGFyY2hpdmUgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xuXG4gICAgY29uc29sZS5sb2coXCJVdGlsIGxhbmd1YWdlXCIpO1xuXG4gICAgdmFyIEFyY2hpdmUgPXtcbiAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihzbHVnKXtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChzbHVnKTtcbiAgICAgIH0sXG4gICAgICByZWY6IHJlZixcbiAgICAgIGFycjogYXJjaGl2ZVxuICAgIH1cbiAgICByZXR1cm4gQXJjaGl2ZTtcbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29udHJvbGxlcignVGFnQ3RybCcsIGZ1bmN0aW9uKEF1dGgsIFVzZXJzLCAkc3RhdGUsJHJvb3RTY29wZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzb2x2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTGFuZGluZyx0YWdOYW1lKSB7XHJcblxyXG4gICAgdmFyIHRhZ0N0cmwgPSB0aGlzO1xyXG4gICAgdGFnQ3RybC50YWdMYW5kaW5nICA9IHRhZ0xhbmRpbmc7XHJcbiAgICB0YWdDdHJsLnRhZ05hbWUgICAgID0gdGFnTmFtZTtcclxuXHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuZmFjdG9yeSgnVGFncycsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkcSl7XG5cbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd0YWdzJyk7XG4gICAgdmFyIHRhZ3MgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xuXG4gICAgY29uc29sZS5sb2coXCJ0YWcgc2VydmljZVwiKTtcblxuICAgIHZhciBUYWdzID0ge1xuXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oY2hpbGRuYW1lKXtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXG4gICAgICB9LFxuXG4gICAgICB0YWdzVXJsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYpO1xuICAgICAgfSxcblxuICAgICAgZ2V0VGFnUmVmOmZ1bmN0aW9uKHRhZyl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodGFnKTtcbiAgICAgIH0sXG5cbiAgICAgIGdldFRhZ09iamVjdDpmdW5jdGlvbih0YWcpe1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0YWcpKVxuICAgICAgfSxcblxuICAgICAgdG9waWNUYWdzOmZ1bmN0aW9uKHRhZyl7XG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgdmFyIGZiID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcbiAgICAgICAgdmFyIGRhdGFSZXQgPSAnJztcblxuICAgICAgICByZXR1cm4gZmIuY2hpbGQoJ3RhZ3MvJyt0YWcpXG4gICAgICAgICAgLm9uKCdjaGlsZF9hZGRlZCcsIGZ1bmN0aW9uKHRhZ1NuYXApe1xuICAgICAgICAgICAgZmIuY2hpbGQoJ3RvcGljcycpXG4gICAgICAgICAgICAgIC5vcmRlckJ5Q2hpbGQoXCJ0YWdzXCIpXG4gICAgICAgICAgICAgIC5lcXVhbFRvKHRhZylcbiAgICAgICAgICAgICAgLm9uKCdjaGlsZF9hZGRlZCcsIGZ1bmN0aW9uKHRvcGljU25hcCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAvL3Nob3coIGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKSApO1xuICAgICAgICAgICAgICAgIHJldHVybiBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhUmV0KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgfSxcblxuICAgICAgYXJyOiB0YWdzXG5cbiAgICB9XG4gICAgcmV0dXJuIFRhZ3M7XG4gIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1RvcGljTGFuZGluZ0N0cmwnLCBmdW5jdGlvbiAoJHN0YXRlLCAkc2NvcGUsIFNsdWcsIFRvcGljcywgQXV0aCwgVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc093bmVyLHRvcGljTGFuZGluZywgcmVwbHlMaXN0LCB2aWV3RGF0YSwgZm9sbG93ZXJzKSB7XG5cbiAgICBjb25zb2xlLmxvZyhcInRvcGljTGFuZGluZ0N0cmxcIik7XG5cbiAgICB2YXIgdG9waWNMYW5kaW5nQ3RybCA9IHRoaXNcblxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5hdXRoICAgICAgICAgPSBBdXRoO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudXNlcnMgICAgICAgID0gVXNlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY0xhbmRpbmcgPSB0b3BpY0xhbmRpbmc7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY3MgICAgICAgPSBUb3BpY3M7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QgICAgPSByZXBseUxpc3Q7XG4gICAgdG9waWNMYW5kaW5nQ3RybC52aWV3cyAgICAgICAgPSB2aWV3RGF0YTtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmZvbGxvd2VycyAgICA9IGZvbGxvd2VycztcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmlzT3duZXIgICAgICA9IGlzT3duZXI7XG5cblxuXG5cbiAgICAvL0dldHRpbmcgUmVwbGllcyBpbiByZXBsaWVzXG4gICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyID0gW107XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbigpe1xuXG4gICAgICBmb3IodmFyIGk9MDsgaTx0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdC5sZW5ndGg7aSsrKXtcbiAgICAgICAgdmFyIHRvcGljSWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS50b3BpY0lkO1xuICAgICAgICB2YXIgcmVwbHlJZCA9IHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0W2ldLiRpZDtcbiAgICAgICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyW2ldID0gdG9waWNMYW5kaW5nQ3RybC50b3BpY3MucmVwbHlJblJlcGx5KHRvcGljSWQscmVwbHlJZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkoKTtcbiAgfSlcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAvLyBUb3BpYyBsaXN0XG4gIC5mYWN0b3J5KCdUb3BpY3MnLCBmdW5jdGlvbiAoJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpIHtcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcycpXG4gICAgdmFyIHRvcGljcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpXG4gICAgdmFyIHRvcGljc0FyciA9ICRmaXJlYmFzZUFycmF5KHJlZilcbiAgICB2YXIgdG9waWNLZXkgPSAnJ1xuXG4gICAgY29uc29sZS5sb2coXCJ0b3BpYyBzZXJ2aWNlXCIpO1xuXG4gICAgdmFyIFRvcGljcyA9IHtcbiAgICAgIC8vIEdldCB0b3BpYyB0YWdcbiAgICAgIGdldFRhZzogZnVuY3Rpb24gKHRhZykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgndGFncycpLmVxdWFsVG8odGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldCB0b3BpYyBzbHVnXG4gICAgICBnZXRTbHVnOiBmdW5jdGlvbiAoc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHNsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpY3MgY3JlYXRlZCBieSB1c2VyX2lkXG4gICAgICBjcmVhdGVkQnk6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3VpZCcpLmVxdWFsVG8odWlkKSlcblxuICAgICAgfSxcbiAgICAgIHJlZkNoaWxkOiBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZClcbiAgICAgIH0sXG4gICAgICBjb3VudFVzZXJUb3BpY3M6IGZ1bmN0aW9uICgpIHt9LFxuXG4gICAgICAvLyBHZXR0aW5nIHRoZSBsaXN0IG9mIHRvcGljIGJhc2Ugb24gY2F0ZWdvcnlcbiAgICAgIGxpc3Q6IGZ1bmN0aW9uIChjYXRlZ29yeSkge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ2NhdGVnb3J5JykuZXF1YWxUbyhjYXRlZ29yeSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICBuYW1lOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHRvcGljX3NsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIFJlZlxuICAgICAgZm9ydG9waWNSZWY6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeUtleTogZnVuY3Rpb24gKHRvcGljX2tleSkge1xuICAgICAgICByZXR1cm4gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcy8nICsgdG9waWNfa2V5KVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeVNsdWc6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKS5saW1pdFRvRmlyc3QoMSkpXG4gICAgICB9LFxuXG4gICAgICBpbmNyZW1lbnRWaWV3OiBmdW5jdGlvbiAodG9waWNfc2x1Zykge30sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIGFycmF5XG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KFRvcGljcy5mb3J0b3BpY1JlZih0b3BpY19zbHVnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGxpc3RpbmdcbiAgICAgIHJlcGx5TGlzdDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcycpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5QXJyOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGNvdW50XG4gICAgICByZXBseUNvdW50OiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycpKVxuICAgICAgfSxcbiAgICAgIHJlcGx5Q291bnRSZWY6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy9jb3VudCcpXG4gICAgICB9LFxuXG4gICAgICByZXBseUluUmVwbHk6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgaW4gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5SW5SZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQsIHJlcGx5SWQpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJytyZXBseUlkKycvaW5SZXBseScpKSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycgKyByZXBseUlkICsgJy9pblJlcGx5JykpXG4gICAgICB9LFxuXG4gICAgICAvLyB1cHZvdGVzXG4gICAgICBnZXRVcHZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSxcbiAgICAgICAgICBhcnJheTogJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZG93bnZvdGVzXG4gICAgICBnZXREb3dudm90ZXM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZm9sbG93ZXJzXG4gICAgICBnZXRGb2xsb3dlcnM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICB1cHZvdGVUb3BpYzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb1Vwdm90ZTogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGRvd252b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkpXG4gICAgICB9LFxuXG4gICAgICB1bmRvRG93bnZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKVxuICAgICAgfSxcblxuICAgICAgZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEudmFsdWUgPT09IG51bGwgfHwgZGF0YS52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KDEpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgKyAxKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgLSAxKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKVxuICAgICAgfSxcblxuICAgICAgZ2V0Vmlld3M6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCkuY2hpbGQoJ3ZpZXdzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBsYXRlc3RGZWVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdjcmVhdGVkJykubGltaXRUb0xhc3QoMTApKVxuICAgICAgfSxcblxuICAgICAgdG9waWNzQnlUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gYXJyYXlcbiAgICAgIGFycjogJGZpcmViYXNlQXJyYXkocmVmKSxcblxuICAgICAgYWxsOiB0b3BpY3MsXG4gICAgICByZWY6IHJlZlxuICAgIH07XG5cbiAgICByZXR1cm4gVG9waWNzXG5cbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRmaWx0ZXIsIG1kNSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRoLFVzZXJzLFRvcGljcywgRmFjZWJvb2ssbm90aWZ5LENhdGVTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZSxpc093bmVyLHVzZXJQb3N0cyl7XG5cbiAgICBjb25zb2xlLmxvZyhcIlByb2ZpbGVDdHJsXCIpO1xuXG4gICAgdmFyIHByb2ZpbGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2VyXG4gICAgcHJvZmlsZUN0cmwucHJvZmlsZSAgID0gcHJvZmlsZTtcbiAgICBwcm9maWxlQ3RybC5hdXRoICAgICAgPSBBdXRoO1xuICAgIHByb2ZpbGVDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHByb2ZpbGVDdHJsLnRvcGljcyAgICA9IFRvcGljcztcbiAgICBwcm9maWxlQ3RybC5mYWNlYm9vayAgPSBGYWNlYm9vaztcbiAgICBwcm9maWxlQ3RybC5pc093bmVyICAgPSBpc093bmVyO1xuICAgIHByb2ZpbGVDdHJsLmNhdGUgICAgICA9IENhdGVTZXJ2aWNlO1xuICAgIHByb2ZpbGVDdHJsLiRzdGF0ZSAgICA9ICRzdGF0ZTtcbiAgICBwcm9maWxlQ3RybC51c2VyUG9zdHMgPSB1c2VyUG9zdHM7XG5cbiAgICBwcm9maWxlQ3RybC51c2VyRmVlZCAgPSAnJztcbiAgICBwcm9maWxlQ3RybC5mZWVkID0gJyc7XG5cbiAgICBwcm9maWxlQ3RybC5lZGl0SW5pdCA9ICd1c2VyRWRpdCc7XG5cbiAgICBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9IGZhbHNlO1xuXG5cbiAgICBwcm9maWxlQ3RybC5nZXRVc2VyUG9zdCA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICBwcm9maWxlQ3RybC5mZWVkID0gcHJvZmlsZUN0cmwudG9waWNzLmNyZWF0ZWRCeSh1aWQpO1xuICAgIH1cblxuXG5cbiAgICAvKkxpbmsgYWNjb3VudCB3aXRoIGZhY2Vib29rKi9cbiAgICBwcm9maWxlQ3RybC5saW5rRmFjZWJvb2sgPSBmdW5jdGlvbigpe1xuICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2subG9naW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2suZ2V0TG9naW5TdGF0dXMoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gJ2Nvbm5lY3RlZCcpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2dnZWRJbiA9IHRydWU7XG4gICAgICAgICAgICBwcm9maWxlQ3RybC5mYWNlYm9vay5hcGkoJy9tZScsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IGxvZ2dlZCBpblwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1RoZSBvcmlnaW5hbCB2YWx1ZSBmcm9tIHByb2ZpbGVcbiAgICBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUgPSBwcm9maWxlQ3RybC5wcm9maWxlO1xuXG5cbiAgICBwcm9maWxlQ3RybC51c2VyQ3JlYXRlZCA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICByZXR1cm4gcHJvZmlsZUN0cmwudG9waWNzLmNyZWF0ZWRCeSh1aWQpO1xuICAgIH1cblxuXG4gICAgLy9QcmVzZXQgUGFyYW1ldGVyc1xuICAgIHByb2ZpbGVDdHJsLmltYWdlU3RyaW5ncyAgICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLnVzZXJDYXRlRm9sbG93ICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLmNhdGVJc0ZvbGxvdyAgICA9IFtdO1xuICAgIHByb2ZpbGVDdHJsLmZvbGxvd0xpc3QgICAgICA9ICcnO1xuXG5cblxuXG5cbiAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlTGlzdEFyciA9IGZ1bmN0aW9uKHVpZCl7XG4gICAgICBwcm9maWxlQ3RybC5mb2xsb3dMaXN0ID0gcHJvZmlsZUN0cmwuY2F0ZS5mb2xsb3dMaXN0KHVpZCk7XG4gICAgfVxuXG4gICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZvbGxvd0NhdGVMaXN0QXJyKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgIH1cblxuICAgIHByb2ZpbGVDdHJsLmZvbGxvd0NhdGUgPSBmdW5jdGlvbihpbmRleCxjYXRlX3NsdWcpe1xuICAgICAgcHJvZmlsZUN0cmwuY2F0ZUlzRm9sbG93W2luZGV4XSAgPSB0cnVlO1xuICAgICAgcHJvZmlsZUN0cmwuY2F0ZS5hZGRDaGlsZChjYXRlX3NsdWcrJy9mb2xsb3dlcicpXG4gICAgICAgIC5jaGlsZChBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgIH1cblxuXG5cblxuXG4gICAgLy9VcGxvYWQgUHJvZmlsZSBpbWFnZVxuICAgIHByb2ZpbGVDdHJsLnVwbG9hZEZpbGUgPSBmdW5jdGlvbihmaWxlcykge1xuICAgICAgYW5ndWxhci5mb3JFYWNoKGZpbGVzLCBmdW5jdGlvbiAoZmxvd0ZpbGUsIGkpIHtcbiAgICAgICAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciB1cmkgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgIHByb2ZpbGVDdHJsLmltYWdlU3RyaW5nc1tpXSA9IHVyaTtcbiAgICAgICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZSh7XCJwaG90b1wiOiB1cml9KVxuICAgICAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmxvd0ZpbGUuZmlsZSk7XG4gICAgICB9KVxuICAgIH07XG5cblxuICAgIC8vU2F2ZSBwcm9maWxlIHdpdGggcHJvZmlsZUN0cmwucHJvZmlsZVxuICAgIC8vcGFyYW1zOiByZWRpcmVjdCwgaWYgZXhpc3QgdGhlbiByZWRpcmVjdCBhZnRlciBzYXZlXG4gICAgcHJvZmlsZUN0cmwuc2F2ZVByb2ZpbGUgPSBmdW5jdGlvbihyZWRpcmVjdCl7XG4gICAgICBwcm9maWxlQ3RybC5wcm9maWxlLnVwZGF0ZWQgPSBtb21lbnQoKS50b0lTT1N0cmluZygpO1xuXG5cbiAgICAgIGlmKHByb2ZpbGVDdHJsLmxvY2F0aW9uICE9PSBudWxsICkge1xuICAgICAgICBsb2NhdGlvbkRldGFpbCA9IHtcbiAgICAgICAgICBwbGFjZV9pZDogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5wbGFjZV9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLm5hbWUsXG4gICAgICAgICAgYWRkcmVzczogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5mb3JtYXR0ZWRfYWRkcmVzcyxcbiAgICAgICAgICBsYXQ6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgbG5nOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICB9XG5cbiAgICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS51c2VyTG9jYXRpb24gPSBsb2NhdGlvbkRldGFpbDtcbiAgICAgIH1cblxuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgICAgICBpZihyZWRpcmVjdCAhPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAkc3RhdGUuZ28ocmVkaXJlY3QpO1xuICAgICAgICB9XG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICBub3RpZnkoe21lc3NhZ2U6J0Vycm9yIHNhdmluZyBkYXRhJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9VcGRhdGUgbmFtZVxuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZU5hbWUgPSBmdW5jdGlvbigpe1xuXG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZShcbiAgICAgICAge1xuICAgICAgICAgIFwiZmlyc3RuYW1lXCI6ICBwcm9maWxlQ3RybC5wcm9maWxlLmZpcnN0bmFtZSxcbiAgICAgICAgICBcImxhc3RuYW1lXCI6ICAgcHJvZmlsZUN0cmwucHJvZmlsZS5sYXN0bmFtZSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQrJy9sb2cnKS5wdXNoKCkuc2V0KHtcbiAgICAgICAgYWN0aW9uOiAgIFwibmFtZV9jaGFuZ2VcIixcbiAgICAgICAgb2xkbmFtZTogIHByb2ZpbGVDdHJsLm9sZFByb2ZpbGVWYWx1ZS5maXJzdG5hbWUgKyBcIi1cIiArIHByb2ZpbGVDdHJsLm9sZFByb2ZpbGVWYWx1ZS5sYXN0bmFtZSxcbiAgICAgICAgY3JlYXRlZDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pO1xuXG4gICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICB9XG5cblxuICAgIC8vVXBkYXRlIEJpb1xuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZUJpbyA9IGZ1bmN0aW9uKCl7XG4gICAgICBwcm9maWxlQ3RybC51c2Vycy51c2VyQXJyUmVmKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnVwZGF0ZSh7XCJiaW9ncmFwaHlcIjogcHJvZmlsZUN0cmwucHJvZmlsZS5iaW9ncmFwaHl9KVxuXG4gICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICB9XG5cblxuICAgIHByb2ZpbGVDdHJsLnVwZGF0ZVByb2ZpbGUgPSBmdW5jdGlvbigpe1xuICAgICAgLy9wcm9maWxlQ3RybC5wcm9maWxlLmVtYWlsSGFzaCA9IG1kNS5jcmVhdGVIYXNoKGF1dGgucGFzc3dvcmQuZW1haWwpO1xuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS4kc2F2ZSgpLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vQ2hlY2sgaWYgdXNlciBleGlzdCwgcmV0dXJuIGZhbHNlIGlmIHRoZXkgZG9cbiAgICBwcm9maWxlQ3RybC5jaGVja1VzZXJuYW1lID0gZnVuY3Rpb24oKXtcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMuY2hlY2tVc2VybmFtZUV4aXN0KHByb2ZpbGVDdHJsLnByb2ZpbGUuZGlzcGxheU5hbWUpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgaWYoc25hcHNob3QudmFsKCkgIT09IG51bGwpe1xuICAgICAgICAgIHJldHVybiBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9dHJ1ZTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgIHJldHVybiBwcm9maWxlQ3RybC5uYW1lRXhpc3Q9ZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuZmFjdG9yeSgnVXNlcnMnLCBmdW5jdGlvbiAoJGZpcmViYXNlQXJyYXksICRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwsICRodHRwKSB7XG4gICAgdmFyIHVzZXJzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3VzZXJzJylcbiAgICB2YXIgdXNlcnMgPSAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZilcblxuICAgIGNvbnNvbGUubG9nKFwiVXNlciBTZXJ2aWNlXCIpO1xuXG4gICAgdmFyIFVzZXJzID0ge1xuICAgICAgZ2V0TG9jYXRpb25JUDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgIHVybDogJ2h0dHA6Ly9pcGluZm8uaW8vanNvbicsXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9KVxuICAgICAgfSxcblxuICAgICAgZ2V0TG9jYXRpb25JUERhdGE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxuICAgICAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHJldHVybiBkYXRhLmRhdGFcbiAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIHByb2ZpbGU6IGZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHJldHVybiB1c2Vycy4kZ2V0UmVjb3JkKHVpZCk7XG4gICAgICB9LFxuXG5cbiAgICAgIC8vU2VhcmNoIGFuZCByZXR1cm4gdXNlcm5hbWVcbiAgICAgIGdldFByb2ZpbGVCeVVzZXJuYW1lOmZ1bmN0aW9uKHVzZXJuYW1lKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmLm9yZGVyQnlDaGlsZCgnZGlzcGxheU5hbWUnKS5lcXVhbFRvKHVzZXJuYW1lKSk7XG4gICAgICB9LFxuXG4gICAgICAvL0NoZWNrIGlmIHVzZXJuYW1lIGV4aXN0LCBpZiBub3QgcmV0dXJuIG51bGxcbiAgICAgIGNoZWNrVXNlcm5hbWVFeGlzdDpmdW5jdGlvbih1c2VybmFtZSl7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5vcmRlckJ5Q2hpbGQoJ2Rpc3BsYXlOYW1lJykuZXF1YWxUbyh1c2VybmFtZSk7XG4gICAgICB9LFxuXG5cbiAgICAgIGdldFByb2ZpbGU6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgZ2V0RGlzcGxheU5hbWU6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgY29uc29sZS5sb2codWlkKTtcbiAgICAgICAgaWYgKHVpZCAhPT0gbnVsbCB8fCB1aWQgIT09ICcnKSB7XG4gICAgICAgICAgcmV0dXJuIHVzZXJzLiRnZXRSZWNvcmQodWlkKS5kaXNwbGF5TmFtZTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy9HZXQgdXNlciBGb2xsb3dlcnNcbiAgICAgIGdldEZvbGxvd2VyOmZ1bmN0aW9uKHVpZCl7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQrJy9zdGF0L2ZvbGxvd2VyL3VpZCcpO1xuICAgICAgfSxcblxuICAgICAgLy9DaGVjayBpZiB1c2VyIGlzIGFscmVhZHkgZm9sbG93aW5nXG4gICAgICBjaGVja0ZvbGxvdzpmdW5jdGlvbih1aWQsZm9sbG93X2lkKXtcblxuICAgICAgICB2YXIgZm9sbG93PWZhbHNlO1xuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd1c2Vycy8nK3VpZCsnL3N0YXQvZm9sbG93aW5nL3VpZC8nK2ZvbGxvd19pZCk7XG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICBmb2xsb3cgPSBzbmFwc2hvdC5leGlzdHMoKTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcbiAgICAgIH0sXG5cbiAgICAgIC8vQ2hhbmdlIHBhc3N3b3JkXG4gICAgICB1c2VyQ2hhbmdlUGFzc3dvcmQ6ZnVuY3Rpb24oZW1haWwsb2xkcGFzcyxuZXdwYXNzKXtcblxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcbiAgICAgICAgcmVmLmNoYW5nZVBhc3N3b3JkKHtcbiAgICAgICAgICBlbWFpbDogZW1haWwsXG4gICAgICAgICAgb2xkUGFzc3dvcmQ6IG9sZHBhc3MsXG4gICAgICAgICAgbmV3UGFzc3dvcmQ6IG5ld3Bhc3NcbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZXJyb3IuY29kZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiSU5WQUxJRF9QQVNTV09SRFwiOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgcGFzc3dvcmQgaXMgaW5jb3JyZWN0LlwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgY2FzZSBcIklOVkFMSURfVVNFUlwiOlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgZG9lcyBub3QgZXhpc3QuXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgY2hhbmdpbmcgcGFzc3dvcmQ6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIHBhc3N3b3JkIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSxcblxuICAgICAgdXNlclJlZjogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKVxuICAgICAgfSxcblxuICAgICAgdXB2b3RlczogZnVuY3Rpb24gKHVpZCkge1xuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKS5jaGlsZCgndXB2b3RlcycpXG4gICAgICB9LFxuXG4gICAgICBkb3dudm90ZXM6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2Rvd252b3RlcycpXG4gICAgICB9LFxuXG4gICAgICAvL1VzZXIgZm9sbG93aW5nIHRvcGljXG4gICAgICBmb2xsb3dpbmc6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2ZvbGxvd2luZycpXG4gICAgICB9LFxuXG4gICAgICB1c2VyQXJyUmVmOiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpXG4gICAgICB9LFxuXG4gICAgICBhbGw6IHVzZXJzXG4gICAgfVxuXG4gICAgcmV0dXJuIFVzZXJzXG4gIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnVW5pcXVlSURHZW5lcmF0b3InLCBmdW5jdGlvbigpeyAgXHJcbiAgICAvKipcclxuICAgICAqIEZhbmN5IElEIGdlbmVyYXRvciB0aGF0IGNyZWF0ZXMgMjAtY2hhcmFjdGVyIHN0cmluZyBpZGVudGlmaWVycyB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICAgICAqXHJcbiAgICAgKiAxLiBUaGV5J3JlIGJhc2VkIG9uIHRpbWVzdGFtcCBzbyB0aGF0IHRoZXkgc29ydCAqYWZ0ZXIqIGFueSBleGlzdGluZyBpZHMuXHJcbiAgICAgKiAyLiBUaGV5IGNvbnRhaW4gNzItYml0cyBvZiByYW5kb20gZGF0YSBhZnRlciB0aGUgdGltZXN0YW1wIHNvIHRoYXQgSURzIHdvbid0IGNvbGxpZGUgd2l0aCBvdGhlciBjbGllbnRzJyBJRHMuXHJcbiAgICAgKiAzLiBUaGV5IHNvcnQgKmxleGljb2dyYXBoaWNhbGx5KiAoc28gdGhlIHRpbWVzdGFtcCBpcyBjb252ZXJ0ZWQgdG8gY2hhcmFjdGVycyB0aGF0IHdpbGwgc29ydCBwcm9wZXJseSkuXHJcbiAgICAgKiA0LiBUaGV5J3JlIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZy4gIEV2ZW4gaWYgeW91IGdlbmVyYXRlIG1vcmUgdGhhbiBvbmUgaW4gdGhlIHNhbWUgdGltZXN0YW1wLCB0aGVcclxuICAgICAqICAgIGxhdHRlciBvbmVzIHdpbGwgc29ydCBhZnRlciB0aGUgZm9ybWVyIG9uZXMuICBXZSBkbyB0aGlzIGJ5IHVzaW5nIHRoZSBwcmV2aW91cyByYW5kb20gYml0c1xyXG4gICAgICogICAgYnV0IFwiaW5jcmVtZW50aW5nXCIgdGhlbSBieSAxIChvbmx5IGluIHRoZSBjYXNlIG9mIGEgdGltZXN0YW1wIGNvbGxpc2lvbikuXHJcbiAgICAgKi9cclxuICAgICByZXR1cm4ge1xyXG5cclxuICAgICAgICBnZW5lcmF0ZVB1c2hJRDpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgIC8vIE1vZGVsZWQgYWZ0ZXIgYmFzZTY0IHdlYi1zYWZlIGNoYXJzLCBidXQgb3JkZXJlZCBieSBBU0NJSS5cclxuICAgICAgICAgICAgdmFyIFBVU0hfQ0hBUlMgPSAnLTAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWl9hYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eic7XHJcblxyXG4gICAgICAgICAgICAvLyBUaW1lc3RhbXAgb2YgbGFzdCBwdXNoLCB1c2VkIHRvIHByZXZlbnQgbG9jYWwgY29sbGlzaW9ucyBpZiB5b3UgcHVzaCB0d2ljZSBpbiBvbmUgbXMuXHJcbiAgICAgICAgICAgIHZhciBsYXN0UHVzaFRpbWUgPSAwO1xyXG5cclxuICAgICAgICAgICAgLy8gV2UgZ2VuZXJhdGUgNzItYml0cyBvZiByYW5kb21uZXNzIHdoaWNoIGdldCB0dXJuZWQgaW50byAxMiBjaGFyYWN0ZXJzIGFuZCBhcHBlbmRlZCB0byB0aGVcclxuICAgICAgICAgICAgLy8gdGltZXN0YW1wIHRvIHByZXZlbnQgY29sbGlzaW9ucyB3aXRoIG90aGVyIGNsaWVudHMuICBXZSBzdG9yZSB0aGUgbGFzdCBjaGFyYWN0ZXJzIHdlXHJcbiAgICAgICAgICAgIC8vIGdlbmVyYXRlZCBiZWNhdXNlIGluIHRoZSBldmVudCBvZiBhIGNvbGxpc2lvbiwgd2UnbGwgdXNlIHRob3NlIHNhbWUgY2hhcmFjdGVycyBleGNlcHRcclxuICAgICAgICAgICAgLy8gXCJpbmNyZW1lbnRlZFwiIGJ5IG9uZS5cclxuICAgICAgICAgICAgdmFyIGxhc3RSYW5kQ2hhcnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgdmFyIGR1cGxpY2F0ZVRpbWUgPSAobm93ID09PSBsYXN0UHVzaFRpbWUpO1xyXG4gICAgICAgICAgICAgIGxhc3RQdXNoVGltZSA9IG5vdztcclxuXHJcbiAgICAgICAgICAgICAgdmFyIHRpbWVTdGFtcENoYXJzID0gbmV3IEFycmF5KDgpO1xyXG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSA3OyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgdGltZVN0YW1wQ2hhcnNbaV0gPSBQVVNIX0NIQVJTLmNoYXJBdChub3cgJSA2NCk7XHJcbiAgICAgICAgICAgICAgICAvLyBOT1RFOiBDYW4ndCB1c2UgPDwgaGVyZSBiZWNhdXNlIGphdmFzY3JpcHQgd2lsbCBjb252ZXJ0IHRvIGludCBhbmQgbG9zZSB0aGUgdXBwZXIgYml0cy5cclxuICAgICAgICAgICAgICAgIG5vdyA9IE1hdGguZmxvb3Iobm93IC8gNjQpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAobm93ICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ1dlIHNob3VsZCBoYXZlIGNvbnZlcnRlZCB0aGUgZW50aXJlIHRpbWVzdGFtcC4nKTtcclxuXHJcbiAgICAgICAgICAgICAgdmFyIGlkID0gdGltZVN0YW1wQ2hhcnMuam9pbignJyk7XHJcblxyXG4gICAgICAgICAgICAgIGlmICghZHVwbGljYXRlVGltZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgbGFzdFJhbmRDaGFyc1tpXSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDY0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHRpbWVzdGFtcCBoYXNuJ3QgY2hhbmdlZCBzaW5jZSBsYXN0IHB1c2gsIHVzZSB0aGUgc2FtZSByYW5kb20gbnVtYmVyLCBleGNlcHQgaW5jcmVtZW50ZWQgYnkgMS5cclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDExOyBpID49IDAgJiYgbGFzdFJhbmRDaGFyc1tpXSA9PT0gNjM7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICBsYXN0UmFuZENoYXJzW2ldID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxhc3RSYW5kQ2hhcnNbaV0rKztcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlkICs9IFBVU0hfQ0hBUlMuY2hhckF0KGxhc3RSYW5kQ2hhcnNbaV0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZihpZC5sZW5ndGggIT0gMjApIHRocm93IG5ldyBFcnJvcignTGVuZ3RoIHNob3VsZCBiZSAyMC4nKTtcclxuXHJcbiAgICAgICAgICAgICAgcmV0dXJuIGlkO1xyXG4gICAgICAgICAgICAvLyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIH0pIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
