"use strict";function show(e){return console.log(e),JSON.stringify(e,null,2)}function extend(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t&&"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}),e}function moveFbRecord(e,t){e.once("value",function(o){t.set(o.val(),function(t){t?"undefined"!=typeof console&&console.error&&console.error(t):e.remove()})})}var app=angular.module("App",["firebase","angular-md5","ui.router","ngMaterial","angularMoment","flow","slugifier","ngAutocomplete","ngTagsInput","cgNotify","pascalprecht.translate","facebook","angular-web-notification","angular-flexslider","ngSanitize","ui.bootstrap","angular-smilies","ngCookies"]).config(["$mdThemingProvider",function(e){e.definePalette("slack",{50:"ffebee",100:"ffcdd2",200:"ef9a9a",300:"e57373",400:"ef5350",500:"4D394B",600:"e53935",700:"d32f2f",800:"c62828",900:"b71c1c",A100:"ff8a80",A200:"ff5252",A400:"ff1744",A700:"d50000",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),e.theme("default").primaryPalette("slack")}]).config(["FacebookProvider",function(e){var t="931376120263856";e.setAppId(t),e.init(t)}]).config(["$translateProvider",function(e){e.preferredLanguage("Eng"),e.useSanitizeValueStrategy("escape")}]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",views:{"":{controller:"HomeCtrl as  homeCtrl",templateUrl:"home/home.html",resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("dashboard")},function(e){return e})}],feed:["Topics",function(e){return e.latestFeed()}]}},"login-form@home":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/html/login-form.html"},"header@home":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("trending",{url:"/explore/trending",views:{"":{controller:"HomeCtrl as  homeCtrl",templateUrl:"home/trend.html",resolve:{feed:["Topics",function(e){return e.latestFeed()}]}},"header@trending":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("category",{url:"/category/{Slug}",views:{"":{controller:"CateCtrl as cateCtrl",templateUrl:"category/index.html",resolve:{cateName:["$stateParams","Category",function(e,t){return t.getName(e.Slug).$loaded()}],cateTopics:["$stateParams","Topics",function(e,t){return t.list(e.Slug)}]}},"header@category":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("places",{url:"/places/{place_slug}/{place_id}",views:{"header@places":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"PlacesCtrl as placesCtrl",templateUrl:"place/index.html",resolve:{placeLanding:["Places","Topics","$stateParams","$firebaseArray",function(e,t,o,r){var n;return e.getPlaceRef(o.place_id).on("value",function(e){n=e.val(),console.log(e.val())}),n}]}}}}).state("tag",{url:"/tag/{Tag}",views:{"header@tag":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"},"":{controller:"TagCtrl as tagCtrl",templateUrl:"tag/index.html",resolve:{tagName:["$stateParams",function(e){return e.Tag}],tagLanding:["Topics","$stateParams","Tags",function(e,t,o){var r=t.Tag;return e.topicsByTag(r)}]}}}}).state("topic",{url:"/{Slug}",resolve:{Slug:["$stateParams","$state","NotiService","Auth",function(e,t,o,r){o.unreadNotification(r.ref.getAuth().uid),e.Slug=decodeURIComponent(e.Slug),""==e.Slug&&t.go("dashboard")}]},views:{"":{controller:"TopicLandingCtrl as topicLandingCtrl",templateUrl:"topics/index.html",resolve:{isOwner:["Auth","Users","$stateParams","Topics",function(e,t,o,r){var n="";return e.ref.getAuth()?r.fortopic(o.Slug).$loaded().then(function(t){return null!=t[0]?(n=t[0].uid,e.ref.getAuth().uid==n?!0:!1):void 0}):!1}],topicLanding:["$stateParams","Topics",function(e,t){return t.fortopic(e.Slug).$loaded()}],replyList:["$stateParams","Topics","$state",function(e,t,o){var r="";return t.fortopic(e.Slug).$loaded().then(function(e){return null!=e[0]?r=e[0].$id:o.go("topic-notfound"),t.replyList(r)})}],viewData:["$stateParams","Topics","Users","Auth",function(e,t,o,r){var n,i,l=moment().toISOString(),a={userIP:"",created:l};return o.getLocationIP().success(function(e){a.userIP=e.data}).then(function(e){a.userIP=e.data}),t.getTopicBySlug(e.Slug).$loaded().then(function(e){return"undefined"!==e[0].$id&&(n=e[0].$id,i=t.getViews(n),i.obj.$loaded().then(function(e){null==e.count?i.ref.child("count").set(1):i.ref.child("count").set(e.count+1)}),r.auth.$requireAuth().then(function(e){var t=e.uid;i.ref.child("history").child(t).push().set(a),o.userRef(e.uid).child("views").child(n).push().set(a)})),i.obj})}],followers:["$stateParams","Topics",function(e,t){return t.getTopicBySlug(e.Slug).$loaded().then(function(e){var o=e[0].$id;return t.getFollowers(o).obj.$loaded().then(function(e){return e})})}]}},"header@topic":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("topic-notfound",{url:"/err/notfound"}).state("profile",{url:"/profile/{Name}",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/index.html",resolve:{isOwner:["Auth","Users","$stateParams",function(e,t,o){return e.ref.getAuth()?t.getProfileByUsername(o.Name).$loaded().then(function(t){return t[0].$id==e.ref.getAuth().uid?!0:!1}):!1}],userPosts:["Users","Topics","$stateParams",function(e,t,o){return e.getProfileByUsername(o.Name).$loaded().then(function(e){return e[0].$id?t.createdBy(e[0].$id):void 0})}],profile:["$state","$stateParams","$rootScope","Auth","Users",function(e,t,o,r,n){return n.getProfileByUsername(t.Name).$loaded().then(function(e){return e})}]}},"header@profile":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("acccountEdit",{url:"/account/edit",views:{"passwordEdit@acccountEdit":{url:"/account/changePassword",templateUrl:"profile/passwd.html"},"userEdit@acccountEdit":{url:"/account/edit-form",templateUrl:"profile/edit-form.html"},"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"profile/edit.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(t){return t.displayName?t:void e.go("get_started")})},function(t){e.go("home")})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@acccountEdit":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("accountPassword",{url:"/account/changePassword",templateUrl:"profile/passwd.html"}).state("accountUserEdit",{url:"/account/edit-form",templateUrl:"profile/edit-form.html"}).state("dashboard",{url:"/user/dashboard",controller:"DashboardCtrl as dashboardCtrl",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"dashboard/index.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["$state","$rootScope","Auth","Users",function(e,t,o,r){return o.auth.$requireAuth().then(function(t){return r.getProfile(t.uid).$loaded().then(function(o){return o.stat||(r.userRef(t.uid).child("stat/upvoted/count").set(0),r.userRef(t.uid).child("stat/posted/count").set(0),r.userRef(t.uid).child("stat/comment/count").set(0),r.userRef(t.uid).child("stat/follower/count").set(0),r.userRef(t.uid).child("stat/following/count").set(0)),o.displayName?o:void e.go("get_started")})},function(t){return e.go("home"),t})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@dashboard":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("follow_cates",{url:"/user/follow-categories",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/follow-categories.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@follow_cates":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("get_started",{url:"/user/get_started",views:{"":{controller:"ProfileCtrl as profileCtrl",templateUrl:"auth/get_started.html",resolve:{userPosts:function(){return!1},isOwner:function(){return!0},profile:["Users","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){return e.getProfile(t.uid).$loaded()})}],auth:["$state","Users","Auth",function(e,t,o){return o.auth.$requireAuth()["catch"](function(){e.go("home")})}]}},"header@get_started":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("login",{url:"/user/login",views:{"":{templateUrl:"auth/login.html"},"login-form@login":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/html/login-form.html"},"header@login":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}}}).state("register",{url:"/user/register",views:{"":{controller:"AuthCtrl as authCtrl",templateUrl:"auth/register.html"},"header@register":{controller:"AuthCtrl as authCtrl",templateUrl:"templates/toolbar/main_toolbar.html"}},resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.auth.$requireAuth().then(function(t){e.go("home")},function(e){return e})}]}}),t.otherwise("/")}]).filter("orderObjectBy",function(){return function(e,t,o){var r=[];return angular.forEach(e,function(e){r.push(e.$id).set(e)}),r.sort(function(e,o){return e[t]>o[t]?1:-1}),o&&r.reverse(),r}}).filter("decodeURI",function(){return function(e){return e?decodeURI(e):""}}).filter("nl2br",["$sce",function(e){return function(t){return t?e.trustAsHtml(t.replace(/\n/g,"<br/>")):""}}]).constant("FirebaseUrl","https://bmxyz.firebaseio.com/");angular.module("App").controller("AuthCtrl",["Auth","Users","$state","$rootScope","$mdSidenav","$translate","$cookies","NotiService",function(e,t,o,r,n,i,l,a){function u(e){return function(){n(e).toggle()}}var s=this;s.auth=e,s.users=t,s.notification=a,null!=e.ref.getAuth()?s.profile=s.users.getProfile(e.ref.getAuth().uid):s.profile="",s.user={email:"",password:""},s.badgeNotification=s.notification.addArrChild(s.profile.$id+"/unread"),s.resetCounter=function(){s.notification.resetUnread(s.profile.$id)},s.toggleLang=function(t){i.use(t),l.put("userLang",t),e.ref.getAuth()&&s.users.userArrRef(e.ref.getAuth().uid).update({lang:t})},s.profile.lang?s.toggleLang(s.profile.lang):l.get("userLang")?s.toggleLang(l.get("userLang")):s.toggleLang("Eng"),s.login=function(){s.auth.auth.$authWithPassword(s.user).then(function(e){o.go("dashboard")},function(e){s.error=e})},s.logout=function(){e.auth.$unauth(),o.go("login")},s.register=function(){e.auth.$createUser(s.user).then(function(e){s.login()},function(e){s.error=e})},s.toggleRight=u("right")}]),angular.module("App").factory("Auth",["$firebaseAuth","FirebaseUrl",function(e,t){var o=new Firebase(t),r=e(o),n={ref:o,auth:r,getUid:function(){var e=o.getAuth();return null!=e?o.getAuth().uid:!1}};return n}]),angular.module("App").controller("CateCtrl",["$state","Category","cateName","cateTopics",function(e,t,o,r){var n=this;n.cateName=o,n.category=t,n.cateTopics=r}]),angular.module("App").factory("CateService",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r),i={name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopic:function(t){return e(usersRef.child(uid))},addChild:function(e){return r.child(e)},followList:function(e){var o=r.orderByChild("news/follower").equalTo(e);return t(o)},unFollow:function(e,t){var r=new Firebase(o+"categories/"+e+"/follower/"+t);r.remove()},userFollow:function(e,t){var r=!1,n=new Firebase(o+"categories/"+e+"/follower/"+t);return n.once("value",function(e){r=e.exists()}),r},arr:t(r),all:n};return i}]),angular.module("App").factory("Post",["$firebaseObject","FirebaseUrl",function(e,t){var o=new Firebase(t+"topics"),r=e(o),n={topicName:function(t){var r=o.orderByChild("slug").equalTo(t);return e(r)},fortopic:function(t){return e(usersRef.child(uid))},all:r};return n}]),angular.module("App").controller("DashboardCtrl",["Auth","$state","Category","CateService","Tags","$timeout","$mdSidenav","$log",function(e,t,o,r,n,i,l,a){var u=this;u.auth=e,u.cate=r,u.categories=o.all,u.topic_grid=!1,u.tags=n.arr,u.userCateFollow=[],u.cateIsFollow=[],u.followList="",u.close=function(){l("right").close()},u.followCate=function(t){u.cate.addChild(t+"/follower").child(e.ref.getAuth().uid).push().set(moment().toISOString())}}]),angular.module("App").directive("reviewScore",function(){return{restrict:"E",transclude:!0,controller:"TopicCtrl as topicCtrl",templateUrl:"templates/html/review-summary-list.html",scope:{review:"="}}}).directive("userFollowerBtn",function(){return{restrict:"E",transclude:!0,controller:"TopicCtrl as topicCtrl",templateUrl:"templates/html/follow-user.html",scope:{follow:"="}}}).directive("cateFollowBtn",function(){return{controller:"DashboardCtrl as dashboardCtrl",templateUrl:"templates/html/category-follow-btn.html",scope:{cate:"="}}}).directive("topicGrid",function(){return{controller:"DashboardCtrl as dashboardCtrl",templateUrl:"templates/html/category-grid.html"}}).directive("tagGrid",function(){return{controller:"DashboardCtrl as dashboardCtrl",templateUrl:"templates/html/tag-grid.html"}}).directive("topicCreate",function(){return{controller:"TopicCtrl as topicCtrl",templateUrl:"templates/html/topic-create.html",scope:{topic:"="}}}).directive("topicList",function(){return{controller:"TopicCtrl as topicCtrl",templateUrl:"templates/html/topic-list.html",scope:{topics:"="}}}).directive("topicActionsCard",function(){return{controller:"TopicCtrl as topicCtrl",templateUrl:"templates/html/topic-actions-card.html",scope:{topic:"="}}}).directive("enforceMaxTags",function(){return{require:"ngModel",link:function(e,t,o,r){var n=o.maxTags?parseInt(o.maxTags,"4"):null;r.$parsers.push(function(e){return e&&n&&e.length>n&&e.splice(e.length-1,1),e})}}}),angular.module("App").controller("HomeCtrl",["$state","Category","Topics","feed",function(e,t,o,r){var n=this;n.topics=t,n.topics=o,n.feed=r}]),angular.module("App").config(["$translateProvider",function(e){e.translations("Eng",{KEY_DASHBOARD:"Dashboard",KEY_LANGUAGES:"Languages",KEY_HOME:"Home",KEY_REGISTER:"Register",KEY_LOGIN:"Log in",KEY_LOGOUT:"Log out",KEY_FOLLOW:"Follow",KEY_FOLLOWER:"Follower",KEY_UNFOLLOW:"Unfollow",KEY_FOLLOWING:"Following",KEY_POST:"Post",KEY_POSTED:"Posted",KEY_UPVOTE:"Upvote",KEY_UPVOTED:"Upvoted",KEY_DWN_VOTE:"Downvote",KEY_DWN_VOTED:"Downvoted",KEY_VIEW:"View",KEY_REMOVE:"Remove",KEY_CANCEL:"Cancel",KEY_QUESTION:"Question",KEY_TOPIC:"Topic",KEY_CHG_PWD:"Change Password",KEY_PASSWORD:"Password",KEY_OLD_PWD:"Old Password",KEY_NEW_PWD:"New Password",KEY_NEW_PWD_C:"New password confirmation",KEY_SAVE:"Save",KEY_SAVE_DRAFT:"Save as draft",KEY_TAGS:"Tags",KEY_EXPLORE:"Explore",KEY_COMMENTS:"Comments",KEY_REPLY:"Reply",KEY_REVIEW:"Review",KEY_EDIT:"Edit",KEY_TREND:"Trend",KEY_TRENDING:"Trending",KEY_WRITE_REPLY:"Write a reply",KEY_LATEST_FEED:"Latest Feed",KEY_CONF_REMOVE:"Are you sure you want to remove?",KEY_CONF_REM_C:"Once remove, you will not be ableto to get this topic back",KEY_WHAT_ON_UR_MIND:"What's on your mind?",KEY_YOU_WANT_FOLLOW:"You may want to follow",KEY_NO_ACCT_REGISTER:"Don't have account? Register",KEY_CANT_CHNG_USER:"Don't have account? Register",KEY_YOUR_ACCOUNT:"Your account",KEY_NOTHING_HERE:"Nothing here, yet",KEY_WHO_TO_FOLLOW:"Who to follow",KEY_CAT_WILL_APPEAR:"Follow some categories and it will appear here",KEY_WHT_UR_STORY:"What's your story",KEY_WRT_COMMENT:"Write a comment",KEY_FIRSTNAME:"First name",KEY_LASTNAME:"Last name",KEY_BIRTHDAY:"Birthday",KEY_MONTH:"Month",KEY_DAY:"Day",KEY_EMAIL:"Email",KEY_CONF_EMAIL:"Confirm Email",KEY_GENDER:"Gender",KEY_MALE:"Male",KEY_FEMALE:"Female",KEY_USERNAME:"Username",KEY_LOCATION:"Location",KEY_ED_PROFILE:"Edit Profile",KEY_ED_CHG_PWD:"Change Password",KEY_ED_PROFILE:"Edit Profile",KEY_ED_SITE:"Website",KEY_ED_PHONE:"Phone",KEY_ED_BIO:"Biography"}),e.translations("ไทย",{KEY_DASHBOARD:"ห้องทั้งหมด",KEY_LANGUAGES:"ภาษา",KEY_HOME:"หน้าแรก",KEY_REGISTER:"สมัครใช้",KEY_LOGIN:"เข้าสู่ระบบ",KEY_FOLLOW:"ติดตาม",KEY_POST:"โพสต์"}),e.preferredLanguage("en")}]),angular.module("App").controller("NotiCtrl",["$state","Category","Topics","NotiService",function(e,t,o,r){var n=this;n.topics=o,n.feed=feed,n.notiService=r,n.notifyTo=function(e){return n.arr.push(e).$add(e)}}]),angular.module("App").factory("NotiService",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"notification"),n=e(r),i={unreadNotification:function(t){var r=new Firebase(o+"notification/"+t);console.log(e(r.orderByChild("is_read").equalTo("false")))},resetUnread:function(e){var t=new Firebase(o+"notification/"+e+"/unread");t.set(0)},updateNotificationCount:function(e){var t=new Firebase(o+"notification/"+e+"/unread");t.once("value",function(e){console.log(e.val()),"null"==e.val()?(console.log("null"),t.set(1)):(console.log("increment here"),t.set(e.val()+1))},function(e){console.log("The read failed: "+e.code)}),s},addChild:function(e){return r.child(e)},addArrChild:function(t){return e(r.child(t))},arr:t(r),all:n};return i}]),angular.module("App").controller("PlacesCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","Tags","Topics","Auth","Users","Slug","Languages","placeLanding",function(e,t,o,r,n,i,l,a,u,s,c,d){var f=this;console.log(d),f.placeLanding=d}]),angular.module("App").factory("Places",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"places"),r=new Firebase(t+"places_details"),n=e(o),i={addChild:function(e){return o.child(e)},addPlaceDetailChild:function(e){return r.child(e)},getPlaceRef:function(e){return o.child(e+"/info")},arr:n};return i}]),angular.module("App").factory("Category",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"categories"),n=e(r),i=(t(r),{getName:function(t){var o=r.child(t);return e(o)},all:n});return i}]).factory("Languages",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"languages"),r=e(o);return r}]).factory("Archive",["$firebaseArray","FirebaseUrl",function(e,t){var o=new Firebase(t+"archive"),r=e(o),n={addChild:function(e){return o.child(e)},ref:o,arr:r};return n}]),angular.module("App").controller("TagCtrl",["Auth","Users","$state","$rootScope","tagLanding","tagName",function(e,t,o,r,n,i){var l=this;l.tagLanding=n,l.tagName=i}]),angular.module("App").factory("Tags",["$firebaseArray","$firebaseObject","FirebaseUrl","$q",function(e,t,o,r){var n=new Firebase(o+"tags"),i=e(n),l={addChild:function(e){return n.child(e)},tagsUrl:function(){return e(n)},getTagRef:function(e){return n.child(e)},getTagObject:function(e){return t(n.child(e))},topicTags:function(e){var t=r.defer(),n=new Firebase(o);return n.child("tags/"+e).on("child_added",function(o){n.child("topics").orderByChild("tags").equalTo(e).on("child_added",function(e){return t.resolve(),extend({},o.val(),e.val())})})},arr:i};return l}]),angular.module("App").controller("TopicLandingCtrl",["$state","$scope","Slug","Topics","Auth","Users","isOwner","topicLanding","replyList","viewData","followers",function(e,t,o,r,n,i,l,a,u,s,c){var d=this;d.auth=n,d.users=i,d.topicLanding=a,d.topics=r,d.replyList=u,d.views=s,d.followers=c,d.isOwner=l,d.inReplyArr=[],d.replyInReply=function(){for(var e=0;e<d.replyList.length;e++){var t=d.replyList[e].topicId,o=d.replyList[e].$id;d.inReplyArr[e]=d.topics.replyInReply(t,o)}},d.replyInReply()}]),angular.module("App").controller("TopicCtrl",["$state","$scope","$rootScope","$mdDialog","$mdMedia","$http","FirebaseUrl","$translate","NotiService","Tags","Topics","Auth","Users","Slug","Places","Languages","Archive",function(e,t,o,r,n,i,l,a,u,s,c,d,f,p,h,g,m){var v=this;v.tags=s,v.topics=c,v.auth=d,v.users=f,v.languages=g,v.places=h,v.archive=m,v.noti=u,null!=v.auth.ref.getAuth()?(v.profile=v.users.getProfile(v.auth.ref.getAuth().uid),v.uid=v.profile.$id,v.userRef=v.users.userRef(v.uid),v.userUpvotedTopics=v.users.upvotes(v.uid),v.userDownvotedTopics=v.users.downvotes(v.uid),v.userFollowing=v.users.following(v.uid)):(v.profile="",v.uid="",v.userRef=""),v.imageStrings=[],v.imageText=[],v.inReplyArr=[],v.loadBusy=!1,v.slugReturn=null,v.criteria=!1,v.criteriaReply=null,v.reviewCriteria=!1,v.critReplyData=null,v.newTopic={location:"",url:"",ipInfo:"",tags:"",body:""},v.avgReviewReply=function(){for(var e=Object.keys(v.criteriaReply).length,t=0,o=0;e>o;o++)t+=v.criteriaReply[o];v.replyReviewAverage=t/e,console.log(v.criteriaReply),v.critReplyData={avg:v.replyReviewAverage,data:v.criteriaReply}},v.avgReviewScore=function(e){if(e){for(var t=0,o=0;o<e.length;o++)t+=e[o].rating;return t/e.length}},a(["KEY_REMOVE","KEY_CANCEL","KEY_CONF_REMOVE","KEY_CONF_REM_C"]).then(function(e){v.removeTrans=e.KEY_REMOVE,v.cancelTrans=e.KEY_CANCEL,v.confirmRem=e.KEY_CONF_REMOVE,v.confirmRemContent=e.KEY_CONF_REM_C}),v.userName=function(e){return null!=e?v.users.getDisplayName(e):void 0},v.showMdLogin=function(e){var o=(n("sm")||n("xs"))&&t.customFullscreen;r.show({controller:"AuthCtrl as authCtrl",templateUrl:"templates/html/md-login-form.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:o})},v.decodeText=function(e){return console.log(decodeURI(e)),decodeURI(e)},v.loadMore=function(e){v.loadBusy=!0;for(var t=[],o=0;o<e.length;o++)t.push(e[o]);return console.log(t),t},v.loadTags=function(e){console.log(v.tags.tagsUrl())},v.uploadFile=function(e,t){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;v.imageStrings[t]=o},o.readAsDataURL(e.file)})},v.showConfirmRemove=function(t,o,n){var i=r.confirm().title(v.confirmRem).textContent(v.confirmRemContent).targetEvent(t).ok(v.removeTrans).cancel(v.cancelTrans);r.show(i).then(function(){v.removeTopic(o,n)&&e.go("dashboard")})},v.removeTopic=function(e,t){return e==v.uid?(moveFbRecord(v.topics.refChild(t.$id),v.archive.addChild(t.$id)),!0):!1},v.reply=function(e){v.topics.replyArr(e.$id).$add({topicId:e.$id,body:v.newReply.body,uid:v.uid,review:v.critReplyData,created:moment().toISOString()}),v.noti.updateNotificationCount(e.uid),v.noti.addChild(e.uid).push().set({topicId:e.$id,from:v.uid,is_read:!1,timestamp:moment().toISOString()}),v.topics.replyCount(e.$id).$loaded().then(function(t){t.count?v.topics.replyCountRef(e.$id).set(t.count+1):v.topics.replyCountRef(e.$id).set(1)}),v.users.userRef(v.uid).child("stat/comment/count").set(v.profile.stat.comment.count+1),v.users.userRef(v.uid).child("stat/comment/topics/"+e.$id).push().set(moment().toISOString())},v.replyInReply=function(e,t){v.topics.replyInReplyArr(e,t).$add({body:v.replyInReply.body,uid:v.uid,created:moment().toISOString()})},v.addNewChoice=function(){var e=v.reviewCriteria.length+1;v.reviewCriteria.push({id:"criteria"+e})},v.removeChoice=function(){var e=v.reviewCriteria.length-1;v.reviewCriteria.splice(e)},v.createTopic=function(e,t){var o="";""!==v.newTopic.location&&(console.log(v.newTopic.location),o={place_id:v.newTopic.location.details.place_id,slug:p.slugify(v.newTopic.location.details.name),name:v.newTopic.location.details.name,address:v.newTopic.location.details.formatted_address,lat:v.newTopic.location.details.geometry.location.lat(),lng:v.newTopic.location.details.geometry.location.lng(),lng:v.newTopic.location.details.geometry.location.lng(),lng:v.newTopic.location.details.geometry.location.lng()}),v.topics.arr.$add({type:v.type,lang:v.newTopic.lang,topic:v.newTopic.topic,body:v.newTopic.body,category:e,uid:v.uid,slug:v.newTopic.topic,photos:v.imageStrings,photos_text:v.imageText,location:o,url:v.newTopic.url,draft:t,created:moment().toISOString(),tags:v.newTopic.tags,userIP:v.newTopic.ipInfo,review:v.reviewCriteria}).then(function(e){var t="";if(t=""==p.slugify(v.newTopic.topic)?v.newTopic.topic:p.slugify(v.newTopic.topic),v.topics.getTopicByKey(e.key()).update({slug:t+e.key()}),v.users.userRef(v.uid).child("stat/posted/count").set(v.profile.stat.posted.count+1),v.users.userRef(v.uid).child("stat/posted/topics/"+e.key()).push().set(moment().toISOString()),""!==o&&(v.places.addChild(o.place_id).child(e.key()).push().set(moment().toISOString()),v.places.addChild(o.place_id).child("info").set(o)),null!==v.newTopic.tags)for(index=0;index<v.newTopic.tags.length;++index)v.tags.addChild(v.newTopic.tags[index].text).child(e.key()).push().set(moment().toISOString());v.newTopic={body:""}})},v.checkFollow=function(e){return v.users.checkFollow(v.uid,e)?!0:!1},v.followUser=function(e){v.users.getProfile(e).$loaded().then(function(t){v.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count+1),v.users.userRef(e).child("stat/follower/uid/"+v.uid).push().set(moment().toISOString())}),v.users.getProfile(v.uid).$loaded().then(function(t){v.users.userRef(v.uid).child("stat/following/count").set(t.stat.follower.count+1),v.users.userRef(v.uid).child("stat/following/uid/"+e).push().set(moment().toISOString())})},v.unfollowUser=function(e){v.users.getProfile(e).$loaded().then(function(t){v.users.userRef(e).child("stat/follower/count").set(t.stat.follower.count-1),v.users.userRef(e).child("stat/follower/uid/"+v.uid).remove()}),v.users.getProfile(v.uid).$loaded().then(function(t){v.users.userRef(v.uid).child("stat/following/count").set(t.stat.following.count-1),v.users.userRef(v.uid).child("stat/following/uid/"+e).remove()})},v.upvote=function(e){void 0!=e.downvotes&&void 0!=e.downvotes[v.uid]&&v.cancelDownvote(e),v.topics.upvoteTopic(e.$id,v.uid).$loaded().then(function(t){v.userUpvotedTopics.child(e.$id).set(t.$value),v.users.getProfile(e.uid).$loaded().then(function(t){v.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count+1),v.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).push().set(moment().toISOString())})})},v.cancelUpvote=function(e){v.topics.undoUpvote(e.$id,v.uid),v.users.getProfile(e.uid).$loaded().then(function(t){v.users.userRef(e.uid).child("stat/upvoted/count").set(t.stat.upvoted.count-1),v.users.userRef(e.uid).child("stat/upvoted/topics/"+e.$id).remove()}),v.userUpvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},v.downvote=function(e){void 0!=e.upvotes&&void 0!=e.upvotes[v.uid]&&v.cancelUpvote(e),v.topics.downvoteTopic(e.$id,v.uid).$loaded().then(function(t){v.userDownvotedTopics.child(e.$id).set(t.$value)})},v.cancelDownvote=function(e){v.topics.undoDownvote(e.$id,v.uid),v.userDownvotedTopics.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})},v.followTopic=function(e){v.topics.follow(e.$id,v.uid).$loaded().then(function(t){v.userFollowing.child(e.$id).set(t.history[v.uid])})},v.unfollowTopic=function(e){v.topics.unfollow(e.$id,v.uid),v.userFollowing.child(e.$id).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")})}}]),angular.module("App").factory("Topics",["$firebaseObject","$firebaseArray","FirebaseUrl",function(e,t,o){var r=new Firebase(o+"topics"),n=e(r),i=(t(r),{getTag:function(e){return t(r.orderByChild("tags").equalTo(e))},getSlug:function(e){var o=r.orderByChild("slug").equalTo(e);return t(o)},createdBy:function(e){return t(r.orderByChild("uid").equalTo(e))},refChild:function(e){return r.child(e)},countUserTopics:function(){},list:function(e){var o=r.orderByChild("category").equalTo(e);return t(o)},name:function(t){var o=r.orderByChild("slug").equalTo(t);return e(o)},fortopicRef:function(e){return r.orderByChild("slug").equalTo(e)},getTopicByKey:function(e){return new Firebase(o+"topics/"+e)},getTopicBySlug:function(e){return t(r.orderByChild("slug").equalTo(e).limitToFirst(1))},incrementView:function(e){},fortopic:function(e){return t(i.fortopicRef(e))},replyList:function(e){var o=r.child(e+"/replies");return t(o)},replyArr:function(e){return t(r.child(e+"/replies"))},replyCount:function(t){return e(r.child(t+"/replies/"))},replyCountRef:function(e){return r.child(e+"/replies/count")},replyInReply:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},replyInReplyArr:function(e,o){return t(r.child(e+"/replies/"+o+"/inReply"))},getUpvotes:function(e){return{ref:r.child(e+"/upvotes"),array:t(r.child(e+"/upvotes"))}},getDownvotes:function(e){return{ref:r.child(e+"/downvotes"),array:t(r.child(e+"/downvotes"))}},getFollowers:function(t){return{ref:r.child(t+"/followers"),obj:e(r.child(t+"/followers"))}},upvoteTopic:function(t,o){return r.child(t+"/upvotes").child(o).set(moment().toISOString()),e(r.child(t+"/upvotes").child(o))},undoUpvote:function(e,t){return r.child(e+"/upvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/upvotes")},downvoteTopic:function(t,o){return r.child(t+"/downvotes").child(o).set(moment().toISOString()),e(r.child(t+"/downvotes").child(o))},undoDownvote:function(e,t){return r.child(e+"/downvotes").child(t).remove(function(e){e?console.log("Error:",e):console.log("Removed successfully!")}),r.child(e+"/downvotes")},follow:function(t,o){return r.child(t+"/followers").child("history").child(o).set(moment().toISOString()),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){null===e.value||void 0===e.value?r.child(t+"/followers").child("count").set(1):r.child(t+"/followers").child("count").set(e.$value+1)}),e(r.child(t+"/followers"))},unfollow:function(t,o){return r.child(t+"/followers").child("history").child(o).remove(function(o){o?console.log("Error:",o):(console.log("Removed successfully!"),e(r.child(t+"/followers").child("count")).$loaded().then(function(e){r.child(t+"/followers").child("count").set(e.$value-1)}))}),r.child(t+"/followers")},getViews:function(t){return{ref:r.child(t).child("views"),obj:e(r.child(t).child("views"))}},latestFeed:function(){return t(r.orderByChild("created").limitToLast(10))},topicsByTag:function(e){return t(r.orderByChild("tags").equalTo(e))},arr:t(r),all:n,ref:r});return i}]),angular.module("App").controller("ProfileCtrl",["$scope","$rootScope","$state","$filter","md5","Auth","Users","Topics","Facebook","notify","CateService","profile","isOwner","userPosts",function(e,t,o,r,n,i,l,a,u,s,c,d,f,p){var h=this;h.profile=d,h.auth=i,h.users=l,h.topics=a,h.facebook=u,h.isOwner=f,h.cate=c,h.$state=o,h.userPosts=p,h.feed="",h.editInit="userEdit",h.nameExist=!1,h.getUserPost=function(e){h.feed=h.topics.createdBy(e)},h.linkFacebook=function(){h.facebook.login(function(t){h.facebook.getLoginStatus(function(t){"connected"===t.status?(e.loggedIn=!0,h.facebook.api("/me",function(e){console.log(e)})):console.log("not logged in")})})},h.oldProfileValue=h.profile,h.userCreated=function(e){return h.topics.createdBy(e)},h.imageStrings=[],h.userCateFollow=[],h.cateIsFollow=[],h.followList="",h.followCateListArr=function(e){h.followList=h.cate.followList(e)},i.ref.getAuth()&&h.followCateListArr(i.ref.getAuth().uid),h.followCate=function(e,t){h.cateIsFollow[e]=!0,h.cate.addChild(t+"/follower").child(i.ref.getAuth().uid).push().set(moment().toISOString())},h.uploadFile=function(e){angular.forEach(e,function(e,t){var o=new FileReader;o.onload=function(e){var o=e.target.result;h.imageStrings[t]=o,h.users.userArrRef(i.ref.getAuth().uid).update({photo:o}),s({message:"Saved",position:"center",duration:3e3})},o.readAsDataURL(e.file)})},h.saveProfile=function(e){h.profile.updated=moment().toISOString(),null!==h.location&&(locationDetail={place_id:h.location.details.place_id,name:h.location.details.name,address:h.location.details.formatted_address,
lat:h.location.details.geometry.location.lat(),lng:h.location.details.geometry.location.lng()},h.profile.userLocation=locationDetail),h.profile.$save().then(function(){s({message:"Saved",position:"center",duration:3e3}),void 0!==e&&o.go(e)})["catch"](function(e){s({message:"Error saving data",position:"center",duration:3e3})})},h.updateName=function(){h.users.userArrRef(i.ref.getAuth().uid).update({firstname:h.profile.firstname,lastname:h.profile.lastname}),h.users.userArrRef(i.ref.getAuth().uid+"/log").push().set({action:"name_change",oldname:h.oldProfileValue.firstname+"-"+h.oldProfileValue.lastname,created:moment().toISOString()}),s({message:"Saved",position:"center",duration:3e3})},h.updateBio=function(){h.users.userArrRef(i.ref.getAuth().uid).update({biography:h.profile.biography}),s({message:"Saved",position:"center",duration:3e3})},h.updateProfile=function(){h.profile.$save().then(function(){o.go("dashboard")})},h.checkUsername=function(){h.users.checkUsernameExist(h.profile.displayName).once("value",function(e){return null!==e.val()?h.nameExist=!0:h.nameExist=!1})}}]),angular.module("App").factory("Users",["$firebaseArray","$firebaseObject","FirebaseUrl","$http",function(e,t,o,r){var n=new Firebase(o+"users"),i=e(n),l={getLocationIP:function(){return r({url:"http://ipinfo.io/json",method:"GET"})},getLocationIPData:function(){return r({url:"http://ipinfo.io/json",method:"GET"}).then(function(e){return e.data})},profile:function(e){return i.$getRecord(e)},getProfileByUsername:function(t){return e(n.orderByChild("displayName").equalTo(t))},checkUsernameExist:function(e){return n.orderByChild("displayName").equalTo(e)},getProfile:function(e){return t(n.child(e))},getDisplayName:function(e){return null==e||""===e?"":i.$getRecord(e).displayName},checkFollow:function(e,t){var r=!1,n=new Firebase(o+"users/"+e+"/stat/following/uid/"+t);return n.once("value",function(e){r=e.exists()}),r},userChangePassword:function(e,t,r){var n=new Firebase(o);n.changePassword({email:e,oldPassword:t,newPassword:r},function(e){if(e)switch(e.code){case"INVALID_PASSWORD":console.log("The specified user account password is incorrect.");break;case"INVALID_USER":console.log("The specified user account does not exist.");break;default:console.log("Error changing password:",e)}else console.log("User password changed successfully!")})},userRef:function(e){return n.child(e)},upvotes:function(e){return n.child(e).child("upvotes")},downvotes:function(e){return n.child(e).child("downvotes")},following:function(e){return n.child(e).child("following")},userArrRef:function(e){return n.child(e)},all:i};return l}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInRvcGljcy5jb250cm9sbGVyLmpzIiwiYnVpbGQuanMiLCJhdXRoLmNvbnRyb2xsZXIuanMiLCJhdXRoLnNlcnZpY2UuanMiLCJjYXRlZ29yeS5jb250cm9sbGVyLmpzIiwiY2F0ZWdvcnkuc2VydmljZS5qcyIsInBvc3Quc2VydmljZS5qcyIsImRhc2hib2FyZC5jb250cm9sbGVyLmpzIiwiZGlyZWN0aXZlcy5qcyIsImhvbWUuY29udHJvbGxlci5qcyIsImxhbmcuanMiLCJub3RpZmljYXRpb24uY29udHJvbGxlci5qcyIsIm5vdGlmaWNhdGlvbi5zZXJ2aWNlLmpzIiwicGxhY2UuY29udHJvbGxlci5qcyIsInBsYWNlLnNlcnZpY2UuanMiLCJ1dGlsaXRpZXMuc2VydmljZS5qcyIsInRhZy5jb250cm9sbGVyLmpzIiwidGFnLnNlcnZpY2UuanMiLCJ0b3BpYy1sYW5kaW5nLmNvbnRyb2xsZXIuanMiLCJ0b3BpY3Muc2VydmljZS5qcyIsInByb2ZpbGUuY29udHJvbGxlci5qcyIsInVzZXJzLnNlcnZpY2UuanMiXSwibmFtZXMiOlsic2hvdyIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImV4dGVuZCIsImJhc2UiLCJwYXJ0cyIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiYXJndW1lbnRzIiwiZm9yRWFjaCIsInAiLCJrIiwiaGFzT3duUHJvcGVydHkiLCJtb3ZlRmJSZWNvcmQiLCJvbGRSZWYiLCJuZXdSZWYiLCJvbmNlIiwic25hcCIsInNldCIsInZhbCIsImVycm9yIiwicmVtb3ZlIiwiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRtZFRoZW1pbmdQcm92aWRlciIsImRlZmluZVBhbGV0dGUiLCI1MCIsIjEwMCIsIjIwMCIsIjMwMCIsIjQwMCIsIjUwMCIsIjYwMCIsIjcwMCIsIjgwMCIsIjkwMCIsIkExMDAiLCJBMjAwIiwiQTQwMCIsIkE3MDAiLCJjb250cmFzdERlZmF1bHRDb2xvciIsImNvbnRyYXN0RGFya0NvbG9ycyIsImNvbnRyYXN0TGlnaHRDb2xvcnMiLCJ1bmRlZmluZWQiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiRmFjZWJvb2tQcm92aWRlciIsIm15QXBwSWQiLCJzZXRBcHBJZCIsImluaXQiLCIkdHJhbnNsYXRlUHJvdmlkZXIiLCJwcmVmZXJyZWRMYW5ndWFnZSIsInVzZVNhbml0aXplVmFsdWVTdHJhdGVneSIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsIiIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJyZXF1aXJlTm9BdXRoIiwiJHN0YXRlIiwiQXV0aCIsImF1dGgiLCIkcmVxdWlyZUF1dGgiLCJ0aGVuIiwiZ28iLCJmZWVkIiwiVG9waWNzIiwibGF0ZXN0RmVlZCIsImxvZ2luLWZvcm1AaG9tZSIsImhlYWRlckBob21lIiwiaGVhZGVyQHRyZW5kaW5nIiwiY2F0ZU5hbWUiLCIkc3RhdGVQYXJhbXMiLCJDYXRlZ29yeSIsImdldE5hbWUiLCJTbHVnIiwiJGxvYWRlZCIsImNhdGVUb3BpY3MiLCJsaXN0IiwiaGVhZGVyQGNhdGVnb3J5IiwiaGVhZGVyQHBsYWNlcyIsInBsYWNlTGFuZGluZyIsIlBsYWNlcyIsIiRmaXJlYmFzZUFycmF5IiwiZ2V0UGxhY2VSZWYiLCJwbGFjZV9pZCIsIm9uIiwic25hcHNob3QiLCJoZWFkZXJAdGFnIiwidGFnTmFtZSIsIlRhZyIsInRhZ0xhbmRpbmciLCJUYWdzIiwidGFnIiwidG9waWNzQnlUYWciLCJOb3RpU2VydmljZSIsInVucmVhZE5vdGlmaWNhdGlvbiIsInJlZiIsImdldEF1dGgiLCJ1aWQiLCJkZWNvZGVVUklDb21wb25lbnQiLCJpc093bmVyIiwiVXNlcnMiLCJ0b3BpY1VpZCIsImZvcnRvcGljIiwidG9waWNMYW5kaW5nIiwicmVwbHlMaXN0IiwidG9waWNLZXkiLCIkaWQiLCJ2aWV3RGF0YSIsInRpbWUiLCJtb21lbnQiLCJ0b0lTT1N0cmluZyIsImhpc3RvcnlPYmoiLCJ1c2VySVAiLCJjcmVhdGVkIiwiZ2V0TG9jYXRpb25JUCIsInN1Y2Nlc3MiLCJnZXRUb3BpY0J5U2x1ZyIsImdldFZpZXdzIiwib2JqIiwiY291bnQiLCJjaGlsZCIsInB1c2giLCJ1c2VyUmVmIiwiZm9sbG93ZXJzIiwiZ2V0Rm9sbG93ZXJzIiwidmFsdWUiLCJoZWFkZXJAdG9waWMiLCJnZXRQcm9maWxlQnlVc2VybmFtZSIsIk5hbWUiLCJwcm9maWxlIiwidXNlclBvc3RzIiwiY3JlYXRlZEJ5IiwiJHJvb3RTY29wZSIsImhlYWRlckBwcm9maWxlIiwicGFzc3dvcmRFZGl0QGFjY2NvdW50RWRpdCIsInVzZXJFZGl0QGFjY2NvdW50RWRpdCIsImdldFByb2ZpbGUiLCJkaXNwbGF5TmFtZSIsImhlYWRlckBhY2Njb3VudEVkaXQiLCJzdGF0IiwiaGVhZGVyQGRhc2hib2FyZCIsImhlYWRlckBmb2xsb3dfY2F0ZXMiLCJoZWFkZXJAZ2V0X3N0YXJ0ZWQiLCJsb2dpbi1mb3JtQGxvZ2luIiwiaGVhZGVyQGxvZ2luIiwiaGVhZGVyQHJlZ2lzdGVyIiwib3RoZXJ3aXNlIiwiZmlsdGVyIiwiaXRlbXMiLCJmaWVsZCIsInJldmVyc2UiLCJmaWx0ZXJlZCIsIml0ZW0iLCJzb3J0IiwiYSIsImIiLCJ0ZXh0IiwiZGVjb2RlVVJJIiwiJHNjZSIsInRydXN0QXNIdG1sIiwicmVwbGFjZSIsImNvbnN0YW50IiwiJG1kU2lkZW5hdiIsIiR0cmFuc2xhdGUiLCIkY29va2llcyIsImJ1aWxkVG9nZ2xlciIsIm5hdklEIiwidG9nZ2xlIiwiYXV0aEN0cmwiLCJ0aGlzIiwidXNlcnMiLCJub3RpZmljYXRpb24iLCJ1c2VyIiwiZW1haWwiLCJwYXNzd29yZCIsImJhZGdlTm90aWZpY2F0aW9uIiwiYWRkQXJyQ2hpbGQiLCJyZXNldENvdW50ZXIiLCJyZXNldFVucmVhZCIsInRvZ2dsZUxhbmciLCJsYW5nS2V5IiwidXNlIiwicHV0IiwidXNlckFyclJlZiIsInVwZGF0ZSIsImxhbmciLCJnZXQiLCJsb2dpbiIsIiRhdXRoV2l0aFBhc3N3b3JkIiwibG9nb3V0IiwiJHVuYXV0aCIsInJlZ2lzdGVyIiwiJGNyZWF0ZVVzZXIiLCJ0b2dnbGVSaWdodCIsImZhY3RvcnkiLCIkZmlyZWJhc2VBdXRoIiwiRmlyZWJhc2VVcmwiLCJGaXJlYmFzZSIsImdldFVpZCIsImNhdGVDdHJsIiwiY2F0ZWdvcnkiLCIkZmlyZWJhc2VPYmplY3QiLCJjYXRlZ29yaWVzIiwiQ2F0ZSIsIm5hbWUiLCJ0b3BpY19zbHVnIiwib3JkZXJCeUNoaWxkIiwiZXF1YWxUbyIsInVzZXJzUmVmIiwiYWRkQ2hpbGQiLCJjaGlsZG5hbWUiLCJmb2xsb3dMaXN0IiwidW5Gb2xsb3ciLCJzbHVnIiwidXNlckZvbGxvdyIsImZvbGxvdyIsImV4aXN0cyIsImFyciIsImFsbCIsInRvcGljcyIsIlRTIiwidG9waWNOYW1lIiwiQ2F0ZVNlcnZpY2UiLCIkdGltZW91dCIsIiRsb2ciLCJkYXNoYm9hcmRDdHJsIiwiY2F0ZSIsInRvcGljX2dyaWQiLCJ0YWdzIiwidXNlckNhdGVGb2xsb3ciLCJjYXRlSXNGb2xsb3ciLCJjbG9zZSIsImZvbGxvd0NhdGUiLCJjYXRlX3NsdWciLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJzY29wZSIsInJldmlldyIsInRvcGljIiwicmVxdWlyZSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJuZ0N0cmwiLCJtYXhUYWdzIiwicGFyc2VJbnQiLCIkcGFyc2VycyIsImxlbmd0aCIsInNwbGljZSIsImhvbWVDdHJsIiwidHJhbnNsYXRpb25zIiwiS0VZX0RBU0hCT0FSRCIsIktFWV9MQU5HVUFHRVMiLCJLRVlfSE9NRSIsIktFWV9SRUdJU1RFUiIsIktFWV9MT0dJTiIsIktFWV9MT0dPVVQiLCJLRVlfRk9MTE9XIiwiS0VZX0ZPTExPV0VSIiwiS0VZX1VORk9MTE9XIiwiS0VZX0ZPTExPV0lORyIsIktFWV9QT1NUIiwiS0VZX1BPU1RFRCIsIktFWV9VUFZPVEUiLCJLRVlfVVBWT1RFRCIsIktFWV9EV05fVk9URSIsIktFWV9EV05fVk9URUQiLCJLRVlfVklFVyIsIktFWV9SRU1PVkUiLCJLRVlfQ0FOQ0VMIiwiS0VZX1FVRVNUSU9OIiwiS0VZX1RPUElDIiwiS0VZX0NIR19QV0QiLCJLRVlfUEFTU1dPUkQiLCJLRVlfT0xEX1BXRCIsIktFWV9ORVdfUFdEIiwiS0VZX05FV19QV0RfQyIsIktFWV9TQVZFIiwiS0VZX1NBVkVfRFJBRlQiLCJLRVlfVEFHUyIsIktFWV9FWFBMT1JFIiwiS0VZX0NPTU1FTlRTIiwiS0VZX1JFUExZIiwiS0VZX1JFVklFVyIsIktFWV9FRElUIiwiS0VZX1RSRU5EIiwiS0VZX1RSRU5ESU5HIiwiS0VZX1dSSVRFX1JFUExZIiwiS0VZX0xBVEVTVF9GRUVEIiwiS0VZX0NPTkZfUkVNT1ZFIiwiS0VZX0NPTkZfUkVNX0MiLCJLRVlfV0hBVF9PTl9VUl9NSU5EIiwiS0VZX1lPVV9XQU5UX0ZPTExPVyIsIktFWV9OT19BQ0NUX1JFR0lTVEVSIiwiS0VZX0NBTlRfQ0hOR19VU0VSIiwiS0VZX1lPVVJfQUNDT1VOVCIsIktFWV9OT1RISU5HX0hFUkUiLCJLRVlfV0hPX1RPX0ZPTExPVyIsIktFWV9DQVRfV0lMTF9BUFBFQVIiLCJLRVlfV0hUX1VSX1NUT1JZIiwiS0VZX1dSVF9DT01NRU5UIiwiS0VZX0ZJUlNUTkFNRSIsIktFWV9MQVNUTkFNRSIsIktFWV9CSVJUSERBWSIsIktFWV9NT05USCIsIktFWV9EQVkiLCJLRVlfRU1BSUwiLCJLRVlfQ09ORl9FTUFJTCIsIktFWV9HRU5ERVIiLCJLRVlfTUFMRSIsIktFWV9GRU1BTEUiLCJLRVlfVVNFUk5BTUUiLCJLRVlfTE9DQVRJT04iLCJLRVlfRURfUFJPRklMRSIsIktFWV9FRF9DSEdfUFdEIiwiS0VZX0VEX1NJVEUiLCJLRVlfRURfUEhPTkUiLCJLRVlfRURfQklPIiwibm90aUN0cmwiLCJub3RpU2VydmljZSIsIm5vdGlmeVRvIiwiJGFkZCIsIm5vdGkiLCJOb3RpZmljYXRpb24iLCJ1cGRhdGVOb3RpZmljYXRpb25Db3VudCIsImVycm9yT2JqZWN0IiwiY29kZSIsInMiLCIkc2NvcGUiLCIkbWREaWFsb2ciLCIkbWRNZWRpYSIsIkxhbmd1YWdlcyIsInBsYWNlc0N0cmwiLCJwbGFjZURldGFpbF9yZWYiLCJwbGFjZXMiLCJhZGRQbGFjZURldGFpbENoaWxkIiwiYXJjaGl2ZSIsIkFyY2hpdmUiLCJ0YWdDdHJsIiwiJHEiLCJ0YWdzVXJsIiwiZ2V0VGFnUmVmIiwiZ2V0VGFnT2JqZWN0IiwidG9waWNUYWdzIiwiZGVmZXJyZWQiLCJkZWZlciIsImZiIiwidGFnU25hcCIsInRvcGljU25hcCIsInRvcGljTGFuZGluZ0N0cmwiLCJpblJlcGx5QXJyIiwicmVwbHlJblJlcGx5IiwiaSIsInRvcGljSWQiLCJyZXBseUlkIiwiJGh0dHAiLCJ0b3BpY0N0cmwiLCJsYW5ndWFnZXMiLCJ1c2VyVXB2b3RlZFRvcGljcyIsInVwdm90ZXMiLCJ1c2VyRG93bnZvdGVkVG9waWNzIiwiZG93bnZvdGVzIiwidXNlckZvbGxvd2luZyIsImZvbGxvd2luZyIsImltYWdlU3RyaW5ncyIsImltYWdlVGV4dCIsImxvYWRCdXN5Iiwic2x1Z1JldHVybiIsImNyaXRlcmlhIiwiY3JpdGVyaWFSZXBseSIsInJldmlld0NyaXRlcmlhIiwiY3JpdFJlcGx5RGF0YSIsIm5ld1RvcGljIiwibG9jYXRpb24iLCJpcEluZm8iLCJib2R5IiwiYXZnUmV2aWV3UmVwbHkiLCJvYmpDb3VudCIsIk9iamVjdCIsImtleXMiLCJhdmciLCJyZXBseVJldmlld0F2ZXJhZ2UiLCJhdmdSZXZpZXdTY29yZSIsInJhdGluZyIsInJlbW92ZVRyYW5zIiwiY2FuY2VsVHJhbnMiLCJjb25maXJtUmVtIiwiY29uZmlybVJlbUNvbnRlbnQiLCJ1c2VyTmFtZSIsInVzZXJJZCIsImdldERpc3BsYXlOYW1lIiwic2hvd01kTG9naW4iLCJldiIsInVzZUZ1bGxTY3JlZW4iLCJjdXN0b21GdWxsc2NyZWVuIiwicGFyZW50IiwiZG9jdW1lbnQiLCJ0YXJnZXRFdmVudCIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJmdWxsc2NyZWVuIiwiZGVjb2RlVGV4dCIsImxvYWRNb3JlIiwibG9hZFRhZ3MiLCJxdWVyeSIsInVwbG9hZEZpbGUiLCJmaWxlcyIsImluZGV4IiwiZmxvd0ZpbGUiLCJmaWxlUmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsImV2ZW50IiwidXJpIiwidGFyZ2V0IiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsImZpbGUiLCJzaG93Q29uZmlybVJlbW92ZSIsInRvcGljX293bmVyIiwiY29uZmlybSIsInRpdGxlIiwidGV4dENvbnRlbnQiLCJvayIsImNhbmNlbCIsInJlbW92ZVRvcGljIiwicmVmQ2hpbGQiLCJyZXBseSIsInRvcGljT2JqIiwicmVwbHlBcnIiLCJuZXdSZXBseSIsImZyb20iLCJpc19yZWFkIiwidGltZXN0YW1wIiwicmVwbHlDb3VudCIsInJlcGx5Q291bnRSZWYiLCJjb21tZW50IiwicmVwbHlJblJlcGx5QXJyIiwiYWRkTmV3Q2hvaWNlIiwibmV3SXRlbU5vIiwiaWQiLCJyZW1vdmVDaG9pY2UiLCJsYXN0SXRlbSIsImNyZWF0ZVRvcGljIiwiaXNEcmFmdCIsImxvY2F0aW9uRGV0YWlsIiwiZGV0YWlscyIsInNsdWdpZnkiLCJhZGRyZXNzIiwiZm9ybWF0dGVkX2FkZHJlc3MiLCJsYXQiLCJnZW9tZXRyeSIsImxuZyIsInR5cGUiLCJwaG90b3MiLCJwaG90b3NfdGV4dCIsImRyYWZ0Iiwic2x1Z1RleHQiLCJnZXRUb3BpY0J5S2V5Iiwia2V5IiwicG9zdGVkIiwiY2hlY2tGb2xsb3ciLCJmb2xsb3dfdWlkIiwiZm9sbG93VXNlciIsImZvbGxvd2VyIiwidW5mb2xsb3dVc2VyIiwidXB2b3RlIiwiY2FuY2VsRG93bnZvdGUiLCJ1cHZvdGVUb3BpYyIsIiR2YWx1ZSIsInVwdm90ZWQiLCJjYW5jZWxVcHZvdGUiLCJ1bmRvVXB2b3RlIiwiZG93bnZvdGUiLCJkb3dudm90ZVRvcGljIiwidW5kb0Rvd252b3RlIiwiZm9sbG93VG9waWMiLCJoaXN0b3J5IiwidW5mb2xsb3dUb3BpYyIsInVuZm9sbG93IiwiZ2V0VGFnIiwiZ2V0U2x1ZyIsImNvdW50VXNlclRvcGljcyIsImZvcnRvcGljUmVmIiwidG9waWNfa2V5IiwibGltaXRUb0ZpcnN0IiwiaW5jcmVtZW50VmlldyIsImdldFVwdm90ZXMiLCJhcnJheSIsImdldERvd252b3RlcyIsImxpbWl0VG9MYXN0IiwiJGZpbHRlciIsIm1kNSIsIkZhY2Vib29rIiwibm90aWZ5IiwicHJvZmlsZUN0cmwiLCJmYWNlYm9vayIsImVkaXRJbml0IiwibmFtZUV4aXN0IiwiZ2V0VXNlclBvc3QiLCJsaW5rRmFjZWJvb2siLCJyZXNwb25zZSIsImdldExvZ2luU3RhdHVzIiwic3RhdHVzIiwibG9nZ2VkSW4iLCJhcGkiLCJvbGRQcm9maWxlVmFsdWUiLCJ1c2VyQ3JlYXRlZCIsImZvbGxvd0NhdGVMaXN0QXJyIiwicGhvdG8iLCJtZXNzYWdlIiwicG9zaXRpb24iLCJkdXJhdGlvbiIsInNhdmVQcm9maWxlIiwicmVkaXJlY3QiLCJ1cGRhdGVkIiwidXNlckxvY2F0aW9uIiwiJHNhdmUiLCJ1cGRhdGVOYW1lIiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJhY3Rpb24iLCJvbGRuYW1lIiwidXBkYXRlQmlvIiwiYmlvZ3JhcGh5IiwidXBkYXRlUHJvZmlsZSIsImNoZWNrVXNlcm5hbWUiLCJjaGVja1VzZXJuYW1lRXhpc3QiLCJtZXRob2QiLCJnZXRMb2NhdGlvbklQRGF0YSIsIiRnZXRSZWNvcmQiLCJ1c2VybmFtZSIsImZvbGxvd19pZCIsInVzZXJDaGFuZ2VQYXNzd29yZCIsIm9sZHBhc3MiLCJuZXdwYXNzIiwiY2hhbmdlUGFzc3dvcmQiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIl0sIm1hcHBpbmdzIjoiQUFBQSxZQXdvQkEsU0FBQUEsTUFBQUMsR0FFQSxNQURBQyxTQUFBQyxJQUFBRixHQUNBRyxLQUFBQyxVQUFBSixFQUFBLEtBQUEsR0FJQSxRQUFB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QUFsSSxFQUFBbUksV0FFQUQsR0FHQThULG1CQUFBLFNBQUF4VyxFQUFBeVcsRUFBQUMsR0FFQSxHQUFBeGIsR0FBQSxHQUFBc0csVUFBQUQsRUFDQXJHLEdBQUF5YixnQkFDQTNXLE1BQUFBLEVBQ0E0VyxZQUFBSCxFQUNBSSxZQUFBSCxHQUNBLFNBQUEzZ0IsR0FDQSxHQUFBQSxFQUNBLE9BQUFBLEVBQUEyVCxNQUNBLElBQUEsbUJBQ0FsVixRQUFBQyxJQUFBLG9EQUNBLE1BQ0EsS0FBQSxlQUNBRCxRQUFBQyxJQUFBLDZDQUNBLE1BQ0EsU0FDQUQsUUFBQUMsSUFBQSwyQkFBQXNCLE9BR0F2QixTQUFBQyxJQUFBLDBDQUtBb0ksUUFBQSxTQUFBekIsR0FDQSxNQUFBK0csR0FBQXhGLE1BQUF2QixJQUdBdVEsUUFBQSxTQUFBdlEsR0FDQSxNQUFBK0csR0FBQXhGLE1BQUF2QixHQUFBdUIsTUFBQSxZQUdBa1AsVUFBQSxTQUFBelEsR0FDQSxNQUFBK0csR0FBQXhGLE1BQUF2QixHQUFBdUIsTUFBQSxjQUdBb1AsVUFBQSxTQUFBM1EsR0FDQSxNQUFBK0csR0FBQXhGLE1BQUF2QixHQUFBdUIsTUFBQSxjQUdBK0QsV0FBQSxTQUFBdEYsR0FDQSxNQUFBK0csR0FBQXhGLE1BQUF2QixJQUdBeUgsSUFBQWhELEVBR0EsT0FBQXRFIiwiZmlsZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIE1haW4gbW9kdWxlIG9mIHRoZSBhcHBsaWNhdGlvbi5cbiAqL1xudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHAnLCBbXG4gICAgJ2ZpcmViYXNlJyxcbiAgICAnYW5ndWxhci1tZDUnLCAvLyBFbmNyeXB0IGVtYWlsXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ25nTWF0ZXJpYWwnLCAvLyBJbnRlcmZhY2VcbiAgICAnYW5ndWxhck1vbWVudCcsIC8vIFRpbWUgbWFuYWdlbWVudFxuICAgICdmbG93JywgLy8gSW1hZ2UgdXBsb2FkXG4gICAgJ3NsdWdpZmllcicsIC8vIENyZWF0ZSBTbHVnc1xuICAgICduZ0F1dG9jb21wbGV0ZScsIC8vIEdvb2dsZSBwbGFjZXNcbiAgICAnbmdUYWdzSW5wdXQnLCAvLyBUYWdzXG4gICAgJ2NnTm90aWZ5JywgLy8gTm90aWZpY2F0aW9uIC0gaHR0cHM6Ly9naXRodWIuY29tL2Nncm9zcy9hbmd1bGFyLW5vdGlmeVxuICAgICdwYXNjYWxwcmVjaHQudHJhbnNsYXRlJywgLy8gVHJhbnNsYXRpb24gLSBodHRwczovL2FuZ3VsYXItdHJhbnNsYXRlLmdpdGh1Yi5pby9cbiAgICAnZmFjZWJvb2snLCAvLyBGYWNlYm9vayAtIGh0dHBzOi8vZ2l0aHViLmNvbS9DaXVsL2FuZ3VsYXItZmFjZWJvb2tcbiAgICAnYW5ndWxhci13ZWItbm90aWZpY2F0aW9uJywgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhZ2llZ3VyYXJpL2FuZ3VsYXItd2ViLW5vdGlmaWNhdGlvblxuICAgICdhbmd1bGFyLWZsZXhzbGlkZXInLCAvLyBJbWFnZSBzbGlkZXIgLSBodHRwczovL2dpdGh1Yi5jb20vdGhlbmlrc28vYW5ndWxhci1mbGV4c2xpZGVyXG5cbiAgICAvLyBFbW90aWNvbiAtLSBodHRwOi8vbWlzdGljMTAwLmdpdGh1Yi5pby9hbmd1bGFyLXNtaWxpZXMvXG4gICAgJ25nU2FuaXRpemUnLFxuICAgICd1aS5ib290c3RyYXAnLCAvLyBPUiBtZ2NyZWEubmdTdHJhcFxuICAgICdhbmd1bGFyLXNtaWxpZXMnLFxuXG4gICAgJ25nQ29va2llcycsIC8vIGNvb2tpZXMgc3R1ZmZcblxuICBdKVxuXG4gIC5jb25maWcoZnVuY3Rpb24gKCRtZFRoZW1pbmdQcm92aWRlcikge1xuICAgICRtZFRoZW1pbmdQcm92aWRlci5kZWZpbmVQYWxldHRlKCdzbGFjaycsIHtcbiAgICAgICc1MCc6ICdmZmViZWUnLFxuICAgICAgJzEwMCc6ICdmZmNkZDInLFxuICAgICAgJzIwMCc6ICdlZjlhOWEnLFxuICAgICAgJzMwMCc6ICdlNTczNzMnLFxuICAgICAgJzQwMCc6ICdlZjUzNTAnLFxuICAgICAgJzUwMCc6ICc0RDM5NEInLCAvLyBwcmltYXJ5IGNvbG91clxuICAgICAgJzYwMCc6ICdlNTM5MzUnLFxuICAgICAgJzcwMCc6ICdkMzJmMmYnLFxuICAgICAgJzgwMCc6ICdjNjI4MjgnLFxuICAgICAgJzkwMCc6ICdiNzFjMWMnLFxuICAgICAgJ0ExMDAnOiAnZmY4YTgwJyxcbiAgICAgICdBMjAwJzogJ2ZmNTI1MicsXG4gICAgICAnQTQwMCc6ICdmZjE3NDQnLFxuICAgICAgJ0E3MDAnOiAnZDUwMDAwJyxcbiAgICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsIC8vIHdoZXRoZXIsIGJ5IGRlZmF1bHQsIHRleHQgKGNvbnRyYXN0KVxuICAgICAgLy8gb24gdGhpcyBwYWxldHRlIHNob3VsZCBiZSBkYXJrIG9yIGxpZ2h0XG4gICAgICAnY29udHJhc3REYXJrQ29sb3JzJzogWyc1MCcsICcxMDAnLCAvLyBodWVzIHdoaWNoIGNvbnRyYXN0IHNob3VsZCBiZSAnZGFyaycgYnkgZGVmYXVsdFxuICAgICAgICAnMjAwJywgJzMwMCcsICc0MDAnLCAnQTEwMCddLFxuICAgICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiB1bmRlZmluZWQgLy8gY291bGQgYWxzbyBzcGVjaWZ5IHRoaXMgaWYgZGVmYXVsdCB3YXMgJ2RhcmsnXG4gICAgfSlcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgLnByaW1hcnlQYWxldHRlKCdzbGFjaycpXG4gIH0pXG5cbiAgLy8gRmFjZWJvb2sgQ29uZmlnXG4gIC5jb25maWcoXG4gICAgZnVuY3Rpb24gKEZhY2Vib29rUHJvdmlkZXIpIHtcbiAgICAgIHZhciBteUFwcElkID0gJzkzMTM3NjEyMDI2Mzg1NidcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuc2V0QXBwSWQobXlBcHBJZClcbiAgICAgIEZhY2Vib29rUHJvdmlkZXIuaW5pdChteUFwcElkKVxuICAgIH1cbiAgKVxuXG4gIC8vU2VjdXJpdHkgZm9yIFRyYW5zbGF0ZVxuICAuY29uZmlnKGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcbiAgICAkdHJhbnNsYXRlUHJvdmlkZXIucHJlZmVycmVkTGFuZ3VhZ2UoJ0VuZycpO1xuICAgIC8vIEVuYWJsZSBlc2NhcGluZyBvZiBIVE1MXG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnVzZVNhbml0aXplVmFsdWVTdHJhdGVneSgnZXNjYXBlJyk7XG4gIH0pXG5cblxuXG4gIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlclxuICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsIGFzICBob21lQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2hvbWUvaG9tZS5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcmVxdWlyZU5vQXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZmVlZDogZnVuY3Rpb24gKFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGF0ZXN0RmVlZCgpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdsb2dpbi1mb3JtQGhvbWUnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9sb2dpbi1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGhvbWUnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy9UcmVuZGluZ1xuICAgICAgLnN0YXRlKCd0cmVuZGluZycsIHtcbiAgICAgICAgdXJsOiAnL2V4cGxvcmUvdHJlbmRpbmcnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwgYXMgIGhvbWVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaG9tZS90cmVuZC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgZmVlZDogZnVuY3Rpb24gKFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGF0ZXN0RmVlZCgpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAdHJlbmRpbmcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gQ2F0ZWdvcnkgTGFuZGluZ1xuICAgICAgLnN0YXRlKCdjYXRlZ29yeScsIHtcbiAgICAgICAgdXJsOiAnL2NhdGVnb3J5L3tTbHVnfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYXRlQ3RybCBhcyBjYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NhdGVnb3J5L2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAvLyBHZXR0aW5nIENhdGVnb3J5IGRldGFpbHNcbiAgICAgICAgICAgICAgY2F0ZU5hbWU6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIENhdGVnb3J5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENhdGVnb3J5LmdldE5hbWUoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAvLyBHZXR0aW5nIGxpc3Qgb2YgY2F0ZWdvcnkgdG9waWNzIGhlcmVcbiAgICAgICAgICAgICAgY2F0ZVRvcGljczogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5saXN0KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGNhdGVnb3J5Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFBsYWNlcyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncGxhY2VzJywge1xuICAgICAgICB1cmw6ICcvcGxhY2VzL3twbGFjZV9zbHVnfS97cGxhY2VfaWR9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHBsYWNlcyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFjZXNDdHJsIGFzIHBsYWNlc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwbGFjZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcGxhY2VMYW5kaW5nOiBmdW5jdGlvbiAoUGxhY2VzLCBUb3BpY3MsICRzdGF0ZVBhcmFtcywgJGZpcmViYXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVxuICAgICAgICAgICAgICAgIFBsYWNlcy5nZXRQbGFjZVJlZigkc3RhdGVQYXJhbXMucGxhY2VfaWQpLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgZGF0YSA9IHNuYXBzaG90LnZhbCgpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzbmFwc2hvdC52YWwoKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgIC8vIHJldHVybiAgJGZpcmViYXNlQXJyYXkoUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gVGFnIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0YWcnLCB7XG4gICAgICAgIHVybDogJy90YWcve1RhZ30nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdoZWFkZXJAdGFnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RhZ0N0cmwgYXMgdGFnQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RhZy9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdGFnTmFtZTogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc3RhdGVQYXJhbXMuVGFnXG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgdGFnTGFuZGluZzogZnVuY3Rpb24gKFRvcGljcywgJHN0YXRlUGFyYW1zLCBUYWdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhZyA9ICRzdGF0ZVBhcmFtcy5UYWdcbiAgICAgICAgICAgICAgICAvLyB2YXIgZmIgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpXG4gICAgICAgICAgICAgICAgLy8gdmFyIGRhdGFSZXQgPSAnJ1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiBzaG93KFRhZ3MudG9waWNUYWdzKHRhZykpXG4gICAgICAgICAgICAgICAgLypyZXR1cm4gZmIuY2hpbGQoJ3RhZ3MvJyArIHRhZylcbiAgICAgICAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIGZ1bmN0aW9uICh0YWdTbmFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9yZGVyQnlDaGlsZChcInRhZ3NcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5lcXVhbFRvKHRhZylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbigndmFsdWUnLCBmdW5jdGlvbiAodG9waWNTbmFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvISpkYXRhUmV0ID0gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRmaXJlYmFzZUFycmF5KGRhdGFSZXQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YVJldFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgKiEvXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KSovXG4gICAgICAgICAgICAgICAgLy8gdmFyIHRhZ09iaiA9IFRhZ3MuZ2V0VGFnT2JqZWN0KHRhZylcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gdGFnT2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgIHJldHVybiBUb3BpY3MudG9waWNzQnlUYWcodGFnKS5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGV4dGVuZCh7fSwgdGFnT2JqLiR2YWx1ZSwgc25hcC52YWwoKSkpXG4gICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiBleHRlbmQoe30sIHRhZ09iai4kdmFsdWUsIHNuYXAudmFsKCkpXG4gICAgICAgICAgICAgICAgLy8gICB9KVxuICAgICAgICAgICAgICAgIC8vIH0pXG5cbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZiLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZhciBkYXRhID0gc25hcHNob3QudmFsKClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbihkYXRhU25hcCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHZhciBpbmRleCA9IHdvcmQuaW5kZXhPZignICcpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGZpcnN0ID0gZGF0YVNuYXAuTmFtZS5zdWJzdHJpbmcoMCwgaW5kZXgpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGxhc3QgPSB3b3JkLnN1YnN0cmluZyhpbmRleCArIDEpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGNhbmRpZGF0ZSA9IGRhdGFTbmFwLk5hbWVcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAoY2FuZGlkYXRlLmluZGV4T2YoZmlyc3QpID49IDAgJiYgY2FuZGlkYXRlLmluZGV4T2YobGFzdCkgPj0gMClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YVNuYXAuQ0lEKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHJlamVjdCgnU29tZSBzb3J0IG9mIGZhaWx1cmUnKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAvLyAgICAgfSlcbiAgICAgICAgICAgICAgICAvLyB9KVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy50b3BpY3NCeVRhZyh0YWcpXG4gICAgICAgICAgICAgIC8vIC5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXApe1xuICAgICAgICAgICAgICAvLyB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRvcGljIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0b3BpYycsIHtcbiAgICAgICAgdXJsOiAnL3tTbHVnfScsXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBTbHVnOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCRzdGF0ZSwgTm90aVNlcnZpY2UsQXV0aCkge1xuICAgICAgICAgICAgTm90aVNlcnZpY2UudW5yZWFkTm90aWZpY2F0aW9uKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgICAgICAgICAgJHN0YXRlUGFyYW1zLlNsdWcgPSBkZWNvZGVVUklDb21wb25lbnQoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICBpZigkc3RhdGVQYXJhbXMuU2x1ZyA9PSAnJyl7XG4gICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVG9waWNMYW5kaW5nQ3RybCBhcyB0b3BpY0xhbmRpbmdDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndG9waWNzL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoQXV0aCwgVXNlcnMsICRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljVWlkID0gJydcbiAgICAgICAgICAgICAgICAvLyBJZiB1c2VyIGxvZ2luLCBjaGVjayBpZiB0aGV5IGFyZSB0aGUgdG9waWMgb3duZXJcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdG9waWNVaWQgPSBkYXRhWzBdLnVpZFxuICAgICAgICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkudWlkID09IHRvcGljVWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdG9waWNMYW5kaW5nOiBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJlcGx5TGlzdDogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzLCAkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXkgPSAnJ1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygndG9waWMtbm90Zm91bmQnKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5yZXBseUxpc3QodG9waWNLZXkpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdmlld0RhdGE6IGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXksIHZpZXdzXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmogPSB7J3VzZXJJUCc6ICcnLCAnY3JlYXRlZCc6IHRpbWV9XG4gICAgICAgICAgICAgICAgVXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmoudXNlcklQID0gZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iai51c2VySVAgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0VG9waWNCeVNsdWcoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgICAgdmlld3MgPSBUb3BpY3MuZ2V0Vmlld3ModG9waWNLZXkpXG5cbiAgICAgICAgICAgICAgICAgICAgdmlld3Mub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY291bnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuY291bnQgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gYXV0aC51aWRcbiAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnB1c2goKS5zZXQoaGlzdG9yeU9iailcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgndmlld3MnKS5jaGlsZCh0b3BpY0tleSkucHVzaCgpLnNldChoaXN0b3J5T2JqKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdzLm9ialxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZvbGxvd2VyczogZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5nZXRUb3BpY0J5U2x1Zygkc3RhdGVQYXJhbXMuU2x1ZykuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIHZhciB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldEZvbGxvd2Vycyh0b3BpY0tleSkub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckB0b3BpYyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gVG9waWMgbm90IGZvdW5kXG4gICAgICAuc3RhdGUoJ3RvcGljLW5vdGZvdW5kJywge1xuICAgICAgICB1cmw6ICcvZXJyL25vdGZvdW5kJ1xuICAgICAgfSlcblxuICAgICAgLy8gUHJvZmlsZSBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncHJvZmlsZScsIHtcbiAgICAgICAgdXJsOiAnL3Byb2ZpbGUve05hbWV9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKEF1dGgsIFVzZXJzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlWzBdLiRpZCA9PSBBdXRoLnJlZi5nZXRBdXRoKCkudWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uIChVc2VycywgVG9waWNzLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZUJ5VXNlcm5hbWUoJHN0YXRlUGFyYW1zLk5hbWUpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVswXS4kaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5jcmVhdGVkQnkocHJvZmlsZVswXS4kaWQpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogZnVuY3Rpb24gKCRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkcm9vdFNjb3BlLCBBdXRoLCBVc2Vycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlQnlVc2VybmFtZSgkc3RhdGVQYXJhbXMuTmFtZSkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9maWxlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBwcm9maWxlJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFByb2ZpbGUgbGFuZGluZyBwYWdlXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnYWNjY291bnRFZGl0Jywge1xuICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAncGFzc3dvcmRFZGl0QGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9wYXNzd2QuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICd1c2VyRWRpdEBhY2Njb3VudEVkaXQnOiB7XG4gICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0LWZvcm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvZWRpdC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoLCBVc2Vycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2dldF9zdGFydGVkJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgYXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBhY2Njb3VudEVkaXQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50UGFzc3dvcmQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3Bhc3N3ZC5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhY2NvdW50VXNlckVkaXQnLCB7XG4gICAgICAgIHVybDogJy9hY2NvdW50L2VkaXQtZm9ybScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9lZGl0LWZvcm0uaHRtbCdcbiAgICAgIH0pXG5cbiAgICAgIC8vIERhc2hib2FyZFxuICAgICAgLy8gQHByb2ZpbGVDdHJsXG4gICAgICAuc3RhdGUoJ2Rhc2hib2FyZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZGFzaGJvYXJkJyxcbiAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2Rhc2hib2FyZC9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoLCBVc2Vycykge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIHN0YXQgb2JqZWN0XG4gICAgICAgICAgICAgICAgICAgIGlmICghcHJvZmlsZS5zdGF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L3Bvc3RlZC9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpLnNldCgwKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgbm8gZGlzcGxheW5hbWUgLSBnbyB0byBnZXRfc3RhcnRlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZS5kaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdnZXRfc3RhcnRlZCcpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgYXV0aDogZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBkYXNoYm9hcmQnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIEZvbGxsb3cgQ2F0ZWdvcnlcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdmb2xsb3dfY2F0ZXMnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2ZvbGxvdy1jYXRlZ29yaWVzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9mb2xsb3ctY2F0ZWdvcmllcy5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGZvbGxvd19jYXRlcyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gR2V0dGluZyBzdGFydGVkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZ2V0X3N0YXJ0ZWQnLCB7XG4gICAgICAgIHVybDogJy91c2VyL2dldF9zdGFydGVkJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9nZXRfc3RhcnRlZC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGdldF9zdGFydGVkJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvdXNlci9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9sb2dpbi5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2xvZ2luLWZvcm1AbG9naW4nOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9sb2dpbi1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGxvZ2luJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvdXNlci9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAcmVnaXN0ZXInOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICByZXF1aXJlTm9BdXRoOiBmdW5jdGlvbiAoJHN0YXRlLCBBdXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICByZXR1cm4gZXJyb3JcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpXG4gIH0pXG5cbiAgLmZpbHRlcignb3JkZXJPYmplY3RCeScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGl0ZW1zLCBmaWVsZCwgcmV2ZXJzZSkge1xuICAgICAgdmFyIGZpbHRlcmVkID0gW11cbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtLiRpZCkuc2V0KGl0ZW0pXG4gICAgICB9KVxuICAgICAgZmlsdGVyZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gKGFbZmllbGRdID4gYltmaWVsZF0gPyAxIDogLTEpXG4gICAgICB9KVxuICAgICAgaWYgKHJldmVyc2UpIGZpbHRlcmVkLnJldmVyc2UoKVxuICAgICAgcmV0dXJuIGZpbHRlcmVkXG4gICAgfVxuICB9KVxuXG4gIC5maWx0ZXIoJ2RlY29kZVVSSScsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gZGVjb2RlVVJJKHRleHQpIDogJydcbiAgICB9XG4gIH0pXG5cbiAgLy8gRm9ybWF0dGluZyB0ZXh0cyB0byBpbmNsdWRlIG5ldyBsaW5lXG4gIC5maWx0ZXIoJ25sMmJyJywgZnVuY3Rpb24gKCRzY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gJHNjZS50cnVzdEFzSHRtbCh0ZXh0LnJlcGxhY2UoL1xcbi9nLCAnPGJyLz4nKSkgOiAnJ1xuICAgIH1cbiAgfSlcblxuICAuY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vYm14eXouZmlyZWJhc2Vpby5jb20vJylcblxuZnVuY3Rpb24gc2hvdyAoZGF0YSkge1xuICBjb25zb2xlLmxvZyhkYXRhKVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMilcbn1cblxuLy8gZm9yIGpvaW5pbmcgLSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82NTk4MjM4XG5mdW5jdGlvbiBleHRlbmQgKGJhc2UpIHtcbiAgdmFyIHBhcnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKVxuICBwYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7XG4gICAgaWYgKHAgJiYgdHlwZW9mIChwKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAodmFyIGsgaW4gcCkge1xuICAgICAgICBpZiAocC5oYXNPd25Qcm9wZXJ0eShrKSkge1xuICAgICAgICAgIGJhc2Vba10gPSBwW2tdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIHJldHVybiBiYXNlXG59XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1RvcGljQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwkc2NvcGUsJHJvb3RTY29wZSwgJG1kRGlhbG9nLCAkbWRNZWRpYSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLEZpcmViYXNlVXJsLCR0cmFuc2xhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOb3RpU2VydmljZSxUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2x1ZyxQbGFjZXMsIExhbmd1YWdlcyxBcmNoaXZlKXtcblxuICAgIHZhciB0b3BpY0N0cmwgPSB0aGlzO1xuXG5cbiAgICAvL1BhcnNlciBoZXJlXG4gICAgdG9waWNDdHJsLnRhZ3MgICAgICA9IFRhZ3M7XG4gICAgdG9waWNDdHJsLnRvcGljcyAgICA9IFRvcGljcztcbiAgICB0b3BpY0N0cmwuYXV0aCAgICAgID0gQXV0aDtcbiAgICB0b3BpY0N0cmwudXNlcnMgICAgID0gVXNlcnM7XG4gICAgdG9waWNDdHJsLmxhbmd1YWdlcyA9IExhbmd1YWdlcztcbiAgICB0b3BpY0N0cmwucGxhY2VzICAgID0gUGxhY2VzO1xuICAgIHRvcGljQ3RybC5hcmNoaXZlICAgPSBBcmNoaXZlO1xuICAgIHRvcGljQ3RybC5ub3RpICAgICAgPSBOb3RpU2VydmljZTtcblxuICAgIGlmKHRvcGljQ3RybC5hdXRoLnJlZi5nZXRBdXRoKCkgIT0gbnVsbCApe1xuICAgICAgdG9waWNDdHJsLnByb2ZpbGUgID0gdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLmF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xuICAgICAgdG9waWNDdHJsLnVpZCA9IHRvcGljQ3RybC5wcm9maWxlLiRpZDtcbiAgICAgIHRvcGljQ3RybC51c2VyUmVmID0gdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MgPSB0b3BpY0N0cmwudXNlcnMudXB2b3Rlcyh0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzID0gdG9waWNDdHJsLnVzZXJzLmRvd252b3Rlcyh0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nID0gdG9waWNDdHJsLnVzZXJzLmZvbGxvd2luZyh0b3BpY0N0cmwudWlkKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRvcGljQ3RybC5wcm9maWxlID0nJztcbiAgICAgIHRvcGljQ3RybC51aWQgPSAnJztcbiAgICAgIHRvcGljQ3RybC51c2VyUmVmID0gJyc7XG4gICAgfVxuXG5cblxuICAgIC8vUHJlc2V0IFBhcmFtZXRlcnNcbiAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzICA9IFtdO1xuICAgIHRvcGljQ3RybC5pbWFnZVRleHQgICAgID0gW107XG4gICAgdG9waWNDdHJsLmluUmVwbHlBcnIgICAgPSBbXTtcbiAgICB0b3BpY0N0cmwubG9hZEJ1c3kgICAgICA9IGZhbHNlO1xuICAgIHRvcGljQ3RybC5zbHVnUmV0dXJuICAgID0gbnVsbDtcbiAgICB0b3BpY0N0cmwuY3JpdGVyaWEgICAgICA9IGZhbHNlO1xuICAgIHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5ID0gbnVsbDtcbiAgICB0b3BpY0N0cmwucmV2aWV3Q3JpdGVyaWE9ZmFsc2U7XG4gICAgdG9waWNDdHJsLmNyaXRSZXBseURhdGEgPSBudWxsO1xuXG4gICAgLy9pZiBhbGxvdyBudWxsIGluIHRoZSBmb3JtXG4gICAgdG9waWNDdHJsLm5ld1RvcGljICAgICAgPSB7XG4gICAgICAnbG9jYXRpb24nOiAnJyxcbiAgICAgICd1cmwnIDogJycsXG4gICAgICAnaXBJbmZvJzogJycsXG4gICAgICAndGFncyc6ICcnLFxuICAgICAgJ2JvZHknOiAnJ1xuICAgIH1cblxuXG4gICAgLy9DYWxjIGF2ZXJhZ2UgcmV2aWV3IGlucHV0IGluIHJlcGx5XG4gICAgdG9waWNDdHJsLmF2Z1Jldmlld1JlcGx5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgdmFyIG9iakNvdW50ID0gT2JqZWN0LmtleXModG9waWNDdHJsLmNyaXRlcmlhUmVwbHkpLmxlbmd0aDtcbiAgICAgIHZhciBhdmcgPSAwXG4gICAgICBmb3IodmFyIGk9MDtpPG9iakNvdW50O2krKyl7XG4gICAgICAgIGF2ZyA9IGF2ZyArIHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5W2ldO1xuICAgICAgfVxuXG4gICAgICB0b3BpY0N0cmwucmVwbHlSZXZpZXdBdmVyYWdlID0gYXZnL29iakNvdW50O1xuXG4gICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSk7XG5cbiAgICAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhID0geyBhdmc6IHRvcGljQ3RybC5yZXBseVJldmlld0F2ZXJhZ2UsIGRhdGE6IHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5fVxuICAgIH1cblxuXG4gICAgLy9HZXQgdGhlIGF2ZXJhZ2Ugc2NvcmUgZnJvbSBjcml0ZXJpYSB2YWx1ZXNcbiAgICB0b3BpY0N0cmwuYXZnUmV2aWV3U2NvcmUgPSBmdW5jdGlvbihkYXRhKXtcbiAgICAgIGlmKGRhdGEpXG4gICAgICB7XG4gICAgICB2YXIgYXZnID0wO1xuICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xuICAgICAgICBhdmcgPSBhdmcgKyBkYXRhW2ldLnJhdGluZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBhdmcvZGF0YS5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvL0xhYmVsIGZvciByZW1vdmUgdG9waWNzXG4gICAgJHRyYW5zbGF0ZShbJ0tFWV9SRU1PVkUnLCAnS0VZX0NBTkNFTCcsJ0tFWV9DT05GX1JFTU9WRScsJ0tFWV9DT05GX1JFTV9DJ10pLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0aW9ucykge1xuICAgICAgdG9waWNDdHJsLnJlbW92ZVRyYW5zID0gdHJhbnNsYXRpb25zLktFWV9SRU1PVkU7XG4gICAgICB0b3BpY0N0cmwuY2FuY2VsVHJhbnMgPSB0cmFuc2xhdGlvbnMuS0VZX0NBTkNFTDtcbiAgICAgIHRvcGljQ3RybC5jb25maXJtUmVtICA9IHRyYW5zbGF0aW9ucy5LRVlfQ09ORl9SRU1PVkU7XG4gICAgICB0b3BpY0N0cmwuY29uZmlybVJlbUNvbnRlbnQgPSAgdHJhbnNsYXRpb25zLktFWV9DT05GX1JFTV9DO1xuICAgIH0pO1xuXG5cbiAgICB0b3BpY0N0cmwudXNlck5hbWUgPSBmdW5jdGlvbih1c2VySWQpe1xuICAgICAgaWYodXNlcklkIT0gbnVsbCl7XG4gICAgICAgIHJldHVybiB0b3BpY0N0cmwudXNlcnMuZ2V0RGlzcGxheU5hbWUodXNlcklkKTtcbiAgICAgIH1cbiAgICB9XG5cblxuXG5cbiAgICAvL0xvZ2luIGZvciBtYXRlcmlhbFxuICAgIHRvcGljQ3RybC5zaG93TWRMb2dpbiA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICB2YXIgdXNlRnVsbFNjcmVlbiA9ICgkbWRNZWRpYSgnc20nKSB8fCAkbWRNZWRpYSgneHMnKSkgJiYgJHNjb3BlLmN1c3RvbUZ1bGxzY3JlZW47XG4gICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL21kLWxvZ2luLWZvcm0uaHRtbCcsXG4gICAgICAgICAgcGFyZW50OiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgZnVsbHNjcmVlbjogdXNlRnVsbFNjcmVlblxuICAgICAgICB9KVxuICAgIH1cblxuXG5cbiAgICB0b3BpY0N0cmwuZGVjb2RlVGV4dCA9IGZ1bmN0aW9uKHRleHQpe1xuICAgICAgLy9yZXR1cm4gJGZpbHRlcignc2x1Z2lmeScpKGl0ZW0ubmFtZSk7XG4gICAgICBjb25zb2xlLmxvZyhkZWNvZGVVUkkodGV4dCkpO1xuICAgICAgcmV0dXJuIGRlY29kZVVSSSh0ZXh0KTtcbiAgICB9XG5cblxuICAgIHRvcGljQ3RybC5sb2FkTW9yZSA9IGZ1bmN0aW9uKGl0ZW1zKSB7XG4gICAgICB0b3BpY0N0cmwubG9hZEJ1c3kgPSB0cnVlO1xuICAgICAgdmFyIGRhdGEgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZGF0YS5wdXNoKGl0ZW1zW2ldKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmxvYWRUYWdzID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRvcGljQ3RybC50YWdzLnRhZ3NVcmwoKSk7XG4gICAgfTtcblxuXG4gICAgLyp0b3BpY0N0cmwudXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mbyA9IGRhdGE7XG4gICAgfSk7Ki9cblxuXG4gICAgLy9VcGxvYWQgUHJvZmlsZSBpbWFnZVxuICAgIHRvcGljQ3RybC51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMsaW5kZXgpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpbmRleCkge1xuICAgICAgICB2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIHVyaSA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5nc1tpbmRleF0gPSB1cmk7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmbG93RmlsZS5maWxlKTtcbiAgICAgIH0pXG4gICAgfTtcblxuXG4gICAgLy9TaG93IGNvbmZpcm0gcmVtb3ZlIHRvcGljXG4gICAgdG9waWNDdHJsLnNob3dDb25maXJtUmVtb3ZlID0gZnVuY3Rpb24oZXYsdG9waWNfb3duZXIsb2JqKXtcbiAgICAgIC8vIEFwcGVuZGluZyBkaWFsb2cgdG8gZG9jdW1lbnQuYm9keSB0byBjb3ZlciBzaWRlbmF2IGluIGRvY3MgYXBwXG4gICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgLnRpdGxlKHRvcGljQ3RybC5jb25maXJtUmVtKVxuICAgICAgICAudGV4dENvbnRlbnQodG9waWNDdHJsLmNvbmZpcm1SZW1Db250ZW50KVxuICAgICAgICAudGFyZ2V0RXZlbnQoZXYpXG4gICAgICAgIC5vayh0b3BpY0N0cmwucmVtb3ZlVHJhbnMpXG4gICAgICAgIC5jYW5jZWwodG9waWNDdHJsLmNhbmNlbFRyYW5zKTtcbiAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHRvcGljQ3RybC5yZW1vdmVUb3BpYyh0b3BpY19vd25lcixvYmopKXtcbiAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL1JlbW92ZSB0b3BpY1xuICAgIHRvcGljQ3RybC5yZW1vdmVUb3BpYyA9IGZ1bmN0aW9uKHRvcGljX293bmVyLG9iail7XG4gICAgICAvL3ZlcmlmeSBpZiB0aGUgdG9waWMgb3duZXIgYW5kIHRoZSBsb2dpbiBvd25lciBpcyB0aGUgc2FtZSBwcGxcbiAgICAgIGlmKHRvcGljX293bmVyID09IHRvcGljQ3RybC51aWQpe1xuICAgICAgICBtb3ZlRmJSZWNvcmQodG9waWNDdHJsLnRvcGljcy5yZWZDaGlsZChvYmouJGlkKSwgdG9waWNDdHJsLmFyY2hpdmUuYWRkQ2hpbGQob2JqLiRpZCkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vUmVwbHkgdG8gdG9waWNcbiAgICB0b3BpY0N0cmwucmVwbHkgPSBmdW5jdGlvbih0b3BpY09iail7XG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlBcnIodG9waWNPYmouJGlkKS4kYWRkKHtcbiAgICAgICAgdG9waWNJZDogIHRvcGljT2JqLiRpZCxcbiAgICAgICAgYm9keTogICAgIHRvcGljQ3RybC5uZXdSZXBseS5ib2R5LFxuICAgICAgICB1aWQ6ICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgcmV2aWV3OiAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhLFxuICAgICAgICBjcmVhdGVkOiAgbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgIH0pXG5cbiAgICAgIHRvcGljQ3RybC5ub3RpLnVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50KHRvcGljT2JqLnVpZCk7XG5cbiAgICAgIHRvcGljQ3RybC5ub3RpLmFkZENoaWxkKHRvcGljT2JqLnVpZCkucHVzaCgpLnNldCh7XG4gICAgICAgIHRvcGljSWQ6ICAgIHRvcGljT2JqLiRpZCxcbiAgICAgICAgZnJvbTogICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgaXNfcmVhZDogICAgZmFsc2UsXG4gICAgICAgIHRpbWVzdGFtcDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pO1xuXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudCh0b3BpY09iai4kaWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICBpZighZGF0YS5jb3VudCl7XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50UmVmKHRvcGljT2JqLiRpZCkuc2V0KDEpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnRSZWYodG9waWNPYmouJGlkKVxuICAgICAgICAgICAgLnNldChkYXRhLmNvdW50ICsxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgLy9TdGF0IHVwZGF0ZSBmb3IgdXNlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvY29tbWVudC9jb3VudCcpXG4gICAgICAgIC5zZXQodG9waWNDdHJsLnByb2ZpbGUuc3RhdC5jb21tZW50LmNvdW50ICsgMSk7XG5cbiAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvdG9waWNzLycrdG9waWNPYmouJGlkKVxuICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG4gICAgLy9SZXBseSBpbiByZXBseVxuICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbih0b3BpY0lkLHJlcGx5SWQpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUluUmVwbHlBcnIodG9waWNJZCxyZXBseUlkKS4kYWRkKHtcbiAgICAgICAgYm9keTogICAgIHRvcGljQ3RybC5yZXBseUluUmVwbHkuYm9keSxcbiAgICAgICAgdWlkOiAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KVxuICAgIH1cblxuXG5cbiAgICB0b3BpY0N0cmwuYWRkTmV3Q2hvaWNlID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbmV3SXRlbU5vID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aCsxO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnB1c2goeydpZCc6J2NyaXRlcmlhJytuZXdJdGVtTm99KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLnJlbW92ZUNob2ljZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxhc3RJdGVtID0gdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLmxlbmd0aC0xO1xuICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLnNwbGljZShsYXN0SXRlbSk7XG4gICAgfTtcblxuXG4gICAgLy9DcmVhdGUgbmV3IHRvcGljXG4gICAgdG9waWNDdHJsLmNyZWF0ZVRvcGljID0gZnVuY3Rpb24oY2F0ZWdvcnksaXNEcmFmdCl7XG5cbiAgICAgIC8vQ2hlY2sgaWYgd2UgaGF2ZSBsb2NhdGlvbiBkZXRhaWxzXG4gICAgICB2YXIgbG9jYXRpb25EZXRhaWwgPSAnJztcblxuICAgICAgaWYodG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uICE9PSAnJyApe1xuICAgICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24pO1xuICAgICAgICBsb2NhdGlvbkRldGFpbCA9IHtcbiAgICAgICAgICBwbGFjZV9pZDogdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgc2x1ZzogICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5uYW1lKSxcbiAgICAgICAgICBuYW1lOiAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMubmFtZSxcbiAgICAgICAgICBhZGRyZXNzOiAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgLyogREVCVUcgRk9STSBWQUxVRVxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgdHlwZTogICAgICAgICAgIHRvcGljQ3RybC50eXBlLFxuICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgIHRvcGljOiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgIGJvZHk6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuYm9keSxcbiAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICB1aWQ6ICAgICAgICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICBwaG90b3M6ICAgICAgICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyxcbiAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgIGxvY2F0aW9uOiAgICAgICBsb2NhdGlvbkRldGFpbCxcbiAgICAgICAgdXJsOiAgICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy51cmwsXG4gICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICBjcmVhdGVkOiAgICAgICAgbW9tZW50KCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdGFnczogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLFxuICAgICAgICB1c2VySVA6ICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm9cbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICovXG5cbiAgICAgIHRvcGljQ3RybC50b3BpY3MuYXJyLiRhZGQoe1xuICAgICAgICAgIHR5cGU6ICAgICAgICAgICB0b3BpY0N0cmwudHlwZSxcbiAgICAgICAgICBsYW5nOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxhbmcsXG4gICAgICAgICAgdG9waWM6ICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy50b3BpYyxcbiAgICAgICAgICBib2R5OiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmJvZHksXG4gICAgICAgICAgY2F0ZWdvcnk6ICAgICAgIGNhdGVnb3J5LFxuICAgICAgICAgIHVpZDogICAgICAgICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICAgIC8vc2x1ZzogICAgICAgICAgIFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpLFxuICAgICAgICAgIHNsdWc6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgICAgcGhvdG9zOiAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MsXG4gICAgICAgICAgcGhvdG9zX3RleHQ6ICAgIHRvcGljQ3RybC5pbWFnZVRleHQsXG4gICAgICAgICAgbG9jYXRpb246ICAgICAgIGxvY2F0aW9uRGV0YWlsLFxuICAgICAgICAgIHVybDogICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudXJsLFxuICAgICAgICAgIGRyYWZ0OiAgICAgICAgICBpc0RyYWZ0LFxuICAgICAgICAgIGNyZWF0ZWQ6ICAgICAgICBtb21lbnQoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHRhZ3M6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudGFncyxcbiAgICAgICAgICB1c2VySVA6ICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmlwSW5mbyxcbiAgICAgICAgICByZXZpZXc6ICAgICAgICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhLFxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHRvcGljKXtcblxuICAgICAgICAgIHZhciBzbHVnVGV4dCA9Jyc7XG4gICAgICAgICAgLy9pZiB3ZSBhcmUgdW5hYmxlIHRvIGNvbnZlcnQgdG8gc2x1ZyB0aGVuIHdlIHVzZSB0aGUgdG9waWMgdGV4dCwgZWxzZSB1c2Ugc2x1Z1xuICAgICAgICAgIGlmKFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpID09Jycpe1xuICAgICAgICAgICAgc2x1Z1RleHQgPSB0b3BpY0N0cmwubmV3VG9waWMudG9waWM7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBzbHVnVGV4dCA9IFNsdWcuc2x1Z2lmeSh0b3BpY0N0cmwubmV3VG9waWMudG9waWMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vVXBkYXRlIHNsdWcgd2l0aCB0b3BpYyBLZXlcbiAgICAgICAgICB0b3BpY0N0cmwudG9waWNzLmdldFRvcGljQnlLZXkodG9waWMua2V5KCkpLnVwZGF0ZSh7XCJzbHVnXCI6c2x1Z1RleHQrdG9waWMua2V5KCl9KTtcblxuICAgICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKVxuICAgICAgICAgICAgLnNldCh0b3BpY0N0cmwucHJvZmlsZS5zdGF0LnBvc3RlZC5jb3VudCArIDEpO1xuXG4gICAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL3RvcGljcy8nK3RvcGljLmtleSgpKVxuICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAvL0lmIHRoZXJlIGlzIGxvY2F0aW9uXG4gICAgICAgICAgaWYobG9jYXRpb25EZXRhaWwgIT09ICcnKXtcblxuICAgICAgICAgICAgdG9waWNDdHJsLnBsYWNlcy5hZGRDaGlsZChsb2NhdGlvbkRldGFpbC5wbGFjZV9pZClcbiAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQodG9waWMua2V5KCkpXG4gICAgICAgICAgICAgICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG5cbiAgICAgICAgICAgIHRvcGljQ3RybC5wbGFjZXMuYWRkQ2hpbGQobG9jYXRpb25EZXRhaWwucGxhY2VfaWQpXG4gICAgICAgICAgICAgIC5jaGlsZCgnaW5mbycpLnNldChsb2NhdGlvbkRldGFpbCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy9pZiB0aGVyZSBhcmUgdGFnc1xuICAgICAgICAgIGlmKHRvcGljQ3RybC5uZXdUb3BpYy50YWdzICE9PSBudWxsKXtcbiAgICAgICAgICAgIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IHRvcGljQ3RybC5uZXdUb3BpYy50YWdzLmxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICAgICAgICB0b3BpY0N0cmwudGFncy5hZGRDaGlsZCh0b3BpY0N0cmwubmV3VG9waWMudGFnc1tpbmRleF0udGV4dClcbiAgICAgICAgICAgICAgICAuY2hpbGQodG9waWMua2V5KCkpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMgPSB7XG4gICAgICAgICAgYm9keTogJydcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH07XG5cblxuICAgIC8vQ2hlY2sgaWYgdXNlciBpcyBhbHJlYWR5IGZvbGxvd2luZyB1c2VyXG4gICAgdG9waWNDdHJsLmNoZWNrRm9sbG93ID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG4gICAgICBpZih0b3BpY0N0cmwudXNlcnMuY2hlY2tGb2xsb3codG9waWNDdHJsLnVpZCxmb2xsb3dfdWlkKSl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vRm9sbG93IFVzZXJcbiAgICB0b3BpY0N0cmwuZm9sbG93VXNlciA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgYmVpbmcgZm9sbG93LCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2VyXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZShmb2xsb3dfdWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dlci5jb3VudCArIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKGZvbGxvd191aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2VyL3VpZC8nKyB0b3BpY0N0cmwudWlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBpcyBmb2xsb3dpbmcsIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93aW5nXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgKyAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvdWlkLycrIGZvbGxvd191aWQpXG4gICAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVW5mb2xsb3cgVXNlclxuICAgIHRvcGljQ3RybC51bmZvbGxvd1VzZXIgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGJlaW5nIGZvbGxvdywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUoZm9sbG93X3VpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci91aWQvJysgdG9waWNDdHJsLnVpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGlzIGZvbGxvd2luZywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dpbmdcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC51aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC5mb2xsb3dpbmcuY291bnQgLSAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvdWlkLycrIGZvbGxvd191aWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cbiAgICB9XG5cblxuXG4gICAgIC8vdXB2b3RlXG4gICAgdG9waWNDdHJsLnVwdm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcblxuICAgICAgaWYodG9waWMuZG93bnZvdGVzICE9IHVuZGVmaW5lZCAmJiB0b3BpYy5kb3dudm90ZXNbdG9waWNDdHJsLnVpZF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgdG9waWNDdHJsLmNhbmNlbERvd252b3RlKHRvcGljKTtcbiAgICAgIH1cbiAgICAgIHRvcGljQ3RybC50b3BpY3MudXB2b3RlVG9waWModG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyVXB2b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS4kdmFsdWUpO1xuXG4gICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWMudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQudXB2b3RlZC5jb3VudCArIDEpO1xuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvdG9waWNzLycrdG9waWMuJGlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICB9KTtcblxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5jYW5jZWxVcHZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVuZG9VcHZvdGUodG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcblxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWMudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIC8vU3RhdCB1cGRhdGVcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL2NvdW50JylcbiAgICAgICAgICAuc2V0KGRhdGEuc3RhdC51cHZvdGVkLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL3RvcGljcy8nK3RvcGljLiRpZCkucmVtb3ZlKCk7XG4gICAgICB9KTtcblxuXG4gICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gICAgLy9kb3dudm90ZVxuICAgIHRvcGljQ3RybC5kb3dudm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIGlmKHRvcGljLnVwdm90ZXMgIT0gdW5kZWZpbmVkICYmIHRvcGljLnVwdm90ZXNbdG9waWNDdHJsLnVpZF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgdG9waWNDdHJsLmNhbmNlbFVwdm90ZSh0b3BpYyk7XG4gICAgICB9XG4gICAgICB0b3BpY0N0cmwudG9waWNzLmRvd252b3RlVG9waWModG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLiR2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdG9waWNDdHJsLmNhbmNlbERvd252b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmRvRG93bnZvdGUodG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRG93bnZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICAgIC8vZm9sbG93IHRvcGljXG4gICAgdG9waWNDdHJsLmZvbGxvd1RvcGljID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy5mb2xsb3codG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nLmNoaWxkKHRvcGljLiRpZCkuc2V0KHZhbHVlLmhpc3RvcnlbdG9waWNDdHJsLnVpZF0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC51bmZvbGxvd1RvcGljID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmZvbGxvdyh0b3BpYy4kaWQsIHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJGb2xsb3dpbmcuY2hpbGQodG9waWMuJGlkKS5yZW1vdmUoZnVuY3Rpb24oZXJyb3Ipe1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICAgIH19KTtcbiAgICB9O1xuXG4gIH0pO1xuXG5cbi8vaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va2F0b3d1bGYvNjA5OTA0MlxuZnVuY3Rpb24gbW92ZUZiUmVjb3JkKG9sZFJlZiwgbmV3UmVmKSB7XG4gIG9sZFJlZi5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7XG4gICAgbmV3UmVmLnNldChzbmFwLnZhbCgpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgb2xkUmVmLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAodHlwZW9mKGNvbnNvbGUpICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNYWluIG1vZHVsZSBvZiB0aGUgYXBwbGljYXRpb24uXG4gKi9cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnQXBwJywgW1xuICAgICdmaXJlYmFzZScsXG4gICAgJ2FuZ3VsYXItbWQ1JywgLy8gRW5jcnlwdCBlbWFpbFxuICAgICd1aS5yb3V0ZXInLFxuICAgICduZ01hdGVyaWFsJywgLy8gSW50ZXJmYWNlXG4gICAgJ2FuZ3VsYXJNb21lbnQnLCAvLyBUaW1lIG1hbmFnZW1lbnRcbiAgICAnZmxvdycsIC8vIEltYWdlIHVwbG9hZFxuICAgICdzbHVnaWZpZXInLCAvLyBDcmVhdGUgU2x1Z3NcbiAgICAnbmdBdXRvY29tcGxldGUnLCAvLyBHb29nbGUgcGxhY2VzXG4gICAgJ25nVGFnc0lucHV0JywgLy8gVGFnc1xuICAgICdjZ05vdGlmeScsIC8vIE5vdGlmaWNhdGlvbiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9jZ3Jvc3MvYW5ndWxhci1ub3RpZnlcbiAgICAncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScsIC8vIFRyYW5zbGF0aW9uIC0gaHR0cHM6Ly9hbmd1bGFyLXRyYW5zbGF0ZS5naXRodWIuaW8vXG4gICAgJ2ZhY2Vib29rJywgLy8gRmFjZWJvb2sgLSBodHRwczovL2dpdGh1Yi5jb20vQ2l1bC9hbmd1bGFyLWZhY2Vib29rXG4gICAgJ2FuZ3VsYXItd2ViLW5vdGlmaWNhdGlvbicsIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYWdpZWd1cmFyaS9hbmd1bGFyLXdlYi1ub3RpZmljYXRpb25cbiAgICAnYW5ndWxhci1mbGV4c2xpZGVyJywgLy8gSW1hZ2Ugc2xpZGVyIC0gaHR0cHM6Ly9naXRodWIuY29tL3RoZW5pa3NvL2FuZ3VsYXItZmxleHNsaWRlclxuXG4gICAgLy8gRW1vdGljb24gLS0gaHR0cDovL21pc3RpYzEwMC5naXRodWIuaW8vYW5ndWxhci1zbWlsaWVzL1xuICAgICduZ1Nhbml0aXplJyxcbiAgICAndWkuYm9vdHN0cmFwJywgLy8gT1IgbWdjcmVhLm5nU3RyYXBcbiAgICAnYW5ndWxhci1zbWlsaWVzJyxcblxuICAgICduZ0Nvb2tpZXMnLCAvLyBjb29raWVzIHN0dWZmXG5cbiAgXSlcblxuICAuY29uZmlnKFtcIiRtZFRoZW1pbmdQcm92aWRlclwiLCBmdW5jdGlvbiAoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ3NsYWNrJywge1xuICAgICAgJzUwJzogJ2ZmZWJlZScsXG4gICAgICAnMTAwJzogJ2ZmY2RkMicsXG4gICAgICAnMjAwJzogJ2VmOWE5YScsXG4gICAgICAnMzAwJzogJ2U1NzM3MycsXG4gICAgICAnNDAwJzogJ2VmNTM1MCcsXG4gICAgICAnNTAwJzogJzREMzk0QicsIC8vIHByaW1hcnkgY29sb3VyXG4gICAgICAnNjAwJzogJ2U1MzkzNScsXG4gICAgICAnNzAwJzogJ2QzMmYyZicsXG4gICAgICAnODAwJzogJ2M2MjgyOCcsXG4gICAgICAnOTAwJzogJ2I3MWMxYycsXG4gICAgICAnQTEwMCc6ICdmZjhhODAnLFxuICAgICAgJ0EyMDAnOiAnZmY1MjUyJyxcbiAgICAgICdBNDAwJzogJ2ZmMTc0NCcsXG4gICAgICAnQTcwMCc6ICdkNTAwMDAnLFxuICAgICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JywgLy8gd2hldGhlciwgYnkgZGVmYXVsdCwgdGV4dCAoY29udHJhc3QpXG4gICAgICAvLyBvbiB0aGlzIHBhbGV0dGUgc2hvdWxkIGJlIGRhcmsgb3IgbGlnaHRcbiAgICAgICdjb250cmFzdERhcmtDb2xvcnMnOiBbJzUwJywgJzEwMCcsIC8vIGh1ZXMgd2hpY2ggY29udHJhc3Qgc2hvdWxkIGJlICdkYXJrJyBieSBkZWZhdWx0XG4gICAgICAgICcyMDAnLCAnMzAwJywgJzQwMCcsICdBMTAwJ10sXG4gICAgICAnY29udHJhc3RMaWdodENvbG9ycyc6IHVuZGVmaW5lZCAvLyBjb3VsZCBhbHNvIHNwZWNpZnkgdGhpcyBpZiBkZWZhdWx0IHdhcyAnZGFyaydcbiAgICB9KVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAucHJpbWFyeVBhbGV0dGUoJ3NsYWNrJylcbiAgfV0pXG5cbiAgLy8gRmFjZWJvb2sgQ29uZmlnXG4gIC5jb25maWcoXG4gICAgW1wiRmFjZWJvb2tQcm92aWRlclwiLCBmdW5jdGlvbiAoRmFjZWJvb2tQcm92aWRlcikge1xuICAgICAgdmFyIG15QXBwSWQgPSAnOTMxMzc2MTIwMjYzODU2J1xuICAgICAgRmFjZWJvb2tQcm92aWRlci5zZXRBcHBJZChteUFwcElkKVxuICAgICAgRmFjZWJvb2tQcm92aWRlci5pbml0KG15QXBwSWQpXG4gICAgfV1cbiAgKVxuXG4gIC8vU2VjdXJpdHkgZm9yIFRyYW5zbGF0ZVxuICAuY29uZmlnKFtcIiR0cmFuc2xhdGVQcm92aWRlclwiLCBmdW5jdGlvbiAoJHRyYW5zbGF0ZVByb3ZpZGVyKSB7XG4gICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnByZWZlcnJlZExhbmd1YWdlKCdFbmcnKTtcbiAgICAvLyBFbmFibGUgZXNjYXBpbmcgb2YgSFRNTFxuICAgICR0cmFuc2xhdGVQcm92aWRlci51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3koJ2VzY2FwZScpO1xuICB9XSlcblxuXG5cbiAgLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwgYXMgIGhvbWVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaG9tZS9ob21lLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICByZXF1aXJlTm9BdXRoOiBbXCIkc3RhdGVcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJylcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBmZWVkOiBbXCJUb3BpY3NcIiwgZnVuY3Rpb24gKFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MubGF0ZXN0RmVlZCgpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnbG9naW4tZm9ybUBob21lJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvbG9naW4tZm9ybS5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBob21lJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vVHJlbmRpbmdcbiAgICAgIC5zdGF0ZSgndHJlbmRpbmcnLCB7XG4gICAgICAgIHVybDogJy9leHBsb3JlL3RyZW5kaW5nJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsIGFzICBob21lQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2hvbWUvdHJlbmQuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGZlZWQ6IFtcIlRvcGljc1wiLCBmdW5jdGlvbiAoVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRvcGljcy5sYXRlc3RGZWVkKClcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAdHJlbmRpbmcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cblxuICAgICAgLy8gQ2F0ZWdvcnkgTGFuZGluZ1xuICAgICAgLnN0YXRlKCdjYXRlZ29yeScsIHtcbiAgICAgICAgdXJsOiAnL2NhdGVnb3J5L3tTbHVnfScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDYXRlQ3RybCBhcyBjYXRlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NhdGVnb3J5L2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAvLyBHZXR0aW5nIENhdGVnb3J5IGRldGFpbHNcbiAgICAgICAgICAgICAgY2F0ZU5hbWU6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIkNhdGVnb3J5XCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIENhdGVnb3J5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIENhdGVnb3J5LmdldE5hbWUoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgLy8gR2V0dGluZyBsaXN0IG9mIGNhdGVnb3J5IHRvcGljcyBoZXJlXG4gICAgICAgICAgICAgIGNhdGVUb3BpY3M6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmxpc3QoJHN0YXRlUGFyYW1zLlNsdWcpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGNhdGVnb3J5Jzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFBsYWNlcyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncGxhY2VzJywge1xuICAgICAgICB1cmw6ICcvcGxhY2VzL3twbGFjZV9zbHVnfS97cGxhY2VfaWR9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHBsYWNlcyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGFjZXNDdHJsIGFzIHBsYWNlc0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwbGFjZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgcGxhY2VMYW5kaW5nOiBbXCJQbGFjZXNcIiwgXCJUb3BpY3NcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBmdW5jdGlvbiAoUGxhY2VzLCBUb3BpY3MsICRzdGF0ZVBhcmFtcywgJGZpcmViYXNlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVxuICAgICAgICAgICAgICAgIFBsYWNlcy5nZXRQbGFjZVJlZigkc3RhdGVQYXJhbXMucGxhY2VfaWQpLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgZGF0YSA9IHNuYXBzaG90LnZhbCgpXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzbmFwc2hvdC52YWwoKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgIC8vIHJldHVybiAgJGZpcmViYXNlQXJyYXkoUGxhY2VzLmdldFBsYWNlUmVmKCRzdGF0ZVBhcmFtcy5wbGFjZV9pZCkpXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRhZyBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgndGFnJywge1xuICAgICAgICB1cmw6ICcvdGFnL3tUYWd9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnaGVhZGVyQHRhZyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUYWdDdHJsIGFzIHRhZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0YWcvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHRhZ05hbWU6IFtcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRzdGF0ZVBhcmFtcy5UYWdcbiAgICAgICAgICAgICAgfV0sXG5cbiAgICAgICAgICAgICAgdGFnTGFuZGluZzogW1wiVG9waWNzXCIsIFwiJHN0YXRlUGFyYW1zXCIsIFwiVGFnc1wiLCBmdW5jdGlvbiAoVG9waWNzLCAkc3RhdGVQYXJhbXMsIFRhZ3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFnID0gJHN0YXRlUGFyYW1zLlRhZ1xuICAgICAgICAgICAgICAgIC8vIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybClcbiAgICAgICAgICAgICAgICAvLyB2YXIgZGF0YVJldCA9ICcnXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHNob3coVGFncy50b3BpY1RhZ3ModGFnKSlcbiAgICAgICAgICAgICAgICAvKnJldHVybiBmYi5jaGlsZCgndGFncy8nICsgdGFnKVxuICAgICAgICAgICAgICAgICAgICAub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHRhZ1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmIuY2hpbGQoJ3RvcGljcycpXG4gICAgICAgICAgICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmVxdWFsVG8odGFnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIGZ1bmN0aW9uICh0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNob3coIGV4dGVuZCh7fSwgdGFnU25hcC52YWwoKSwgdG9waWNTbmFwLnZhbCgpKSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8hKmRhdGFSZXQgPSBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkoZGF0YVJldCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhUmV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAqIS9cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pKi9cbiAgICAgICAgICAgICAgICAvLyB2YXIgdGFnT2JqID0gVGFncy5nZXRUYWdPYmplY3QodGFnKVxuICAgICAgICAgICAgICAgIC8vIHJldHVybiB0YWdPYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vICAgcmV0dXJuIFRvcGljcy50b3BpY3NCeVRhZyh0YWcpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZXh0ZW5kKHt9LCB0YWdPYmouJHZhbHVlLCBzbmFwLnZhbCgpKSlcbiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIGV4dGVuZCh7fSwgdGFnT2JqLiR2YWx1ZSwgc25hcC52YWwoKSlcbiAgICAgICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICAgICAgLy8gfSlcblxuICAgICAgICAgICAgICAgIC8vIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgZmIub25jZSgndmFsdWUnLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdmFyIGRhdGEgPSBzbmFwc2hvdC52YWwoKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGFTbmFwKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIGluZGV4ID0gd29yZC5pbmRleE9mKCcgJylcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgZmlyc3QgPSBkYXRhU25hcC5OYW1lLnN1YnN0cmluZygwLCBpbmRleClcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgbGFzdCA9IHdvcmQuc3Vic3RyaW5nKGluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB2YXIgY2FuZGlkYXRlID0gZGF0YVNuYXAuTmFtZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChjYW5kaWRhdGUuaW5kZXhPZihmaXJzdCkgPj0gMCAmJiBjYW5kaWRhdGUuaW5kZXhPZihsYXN0KSA+PSAwKVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhU25hcC5DSUQpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgcmVqZWN0KCdTb21lIHNvcnQgb2YgZmFpbHVyZScpXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC8vICAgICB9KVxuICAgICAgICAgICAgICAgIC8vIH0pXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLnRvcGljc0J5VGFnKHRhZylcbiAgICAgICAgICAgICAgLy8gLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24oc25hcCl7XG4gICAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG5cbiAgICAgIC8vIFRvcGljIGxhbmRpbmcgcGFnZVxuICAgICAgLnN0YXRlKCd0b3BpYycsIHtcbiAgICAgICAgdXJsOiAnL3tTbHVnfScsXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBTbHVnOiBbXCIkc3RhdGVQYXJhbXNcIiwgXCIkc3RhdGVcIiwgXCJOb3RpU2VydmljZVwiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZVBhcmFtcywkc3RhdGUsIE5vdGlTZXJ2aWNlLEF1dGgpIHtcbiAgICAgICAgICAgIE5vdGlTZXJ2aWNlLnVucmVhZE5vdGlmaWNhdGlvbihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICAgICAgICAgICRzdGF0ZVBhcmFtcy5TbHVnID0gZGVjb2RlVVJJQ29tcG9uZW50KCRzdGF0ZVBhcmFtcy5TbHVnKVxuICAgICAgICAgICAgaWYoJHN0YXRlUGFyYW1zLlNsdWcgPT0gJycpe1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1dXG4gICAgICAgIH0sXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0xhbmRpbmdDdHJsIGFzIHRvcGljTGFuZGluZ0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0b3BpY3MvaW5kZXguaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIGlzT3duZXI6IFtcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoQXV0aCwgVXNlcnMsICRzdGF0ZVBhcmFtcywgVG9waWNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljVWlkID0gJydcbiAgICAgICAgICAgICAgICAvLyBJZiB1c2VyIGxvZ2luLCBjaGVjayBpZiB0aGV5IGFyZSB0aGUgdG9waWMgb3duZXJcbiAgICAgICAgICAgICAgICBpZiAoQXV0aC5yZWYuZ2V0QXV0aCgpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdG9waWNVaWQgPSBkYXRhWzBdLnVpZFxuICAgICAgICAgICAgICAgICAgICAgIGlmIChBdXRoLnJlZi5nZXRBdXRoKCkudWlkID09IHRvcGljVWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIHRvcGljTGFuZGluZzogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZm9ydG9waWMoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKTtcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIHJlcGx5TGlzdDogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIFwiJHN0YXRlXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgJHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5ID0gJydcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmZvcnRvcGljKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbMF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0b3BpY0tleSA9IGRhdGFbMF0uJGlkXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3RvcGljLW5vdGZvdW5kJylcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MucmVwbHlMaXN0KHRvcGljS2V5KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICB2aWV3RGF0YTogW1wiJHN0YXRlUGFyYW1zXCIsIFwiVG9waWNzXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGVQYXJhbXMsIFRvcGljcywgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9waWNLZXksIHZpZXdzXG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmogPSB7J3VzZXJJUCc6ICcnLCAnY3JlYXRlZCc6IHRpbWV9XG4gICAgICAgICAgICAgICAgVXNlcnMuZ2V0TG9jYXRpb25JUCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmoudXNlcklQID0gZGF0YS5kYXRhXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iai51c2VySVAgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0VG9waWNCeVNsdWcoJHN0YXRlUGFyYW1zLlNsdWcpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS4kaWQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgICAgdmlld3MgPSBUb3BpY3MuZ2V0Vmlld3ModG9waWNLZXkpXG5cbiAgICAgICAgICAgICAgICAgICAgdmlld3Mub2JqLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY291bnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld3MucmVmLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuY291bnQgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gYXV0aC51aWRcbiAgICAgICAgICAgICAgICAgICAgICB2aWV3cy5yZWYuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnB1c2goKS5zZXQoaGlzdG9yeU9iailcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgndmlld3MnKS5jaGlsZCh0b3BpY0tleSkucHVzaCgpLnNldChoaXN0b3J5T2JqKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdzLm9ialxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBmb2xsb3dlcnM6IFtcIiRzdGF0ZVBhcmFtc1wiLCBcIlRvcGljc1wiLCBmdW5jdGlvbiAoJHN0YXRlUGFyYW1zLCBUb3BpY3MpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmdldFRvcGljQnlTbHVnKCRzdGF0ZVBhcmFtcy5TbHVnKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHRvcGljS2V5ID0gZGF0YVswXS4kaWRcbiAgICAgICAgICAgICAgICAgIHJldHVybiBUb3BpY3MuZ2V0Rm9sbG93ZXJzKHRvcGljS2V5KS5vYmouJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckB0b3BpYyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLy8gVG9waWMgbm90IGZvdW5kXG4gICAgICAuc3RhdGUoJ3RvcGljLW5vdGZvdW5kJywge1xuICAgICAgICB1cmw6ICcvZXJyL25vdGZvdW5kJ1xuICAgICAgfSlcblxuICAgICAgLy8gUHJvZmlsZSBsYW5kaW5nIHBhZ2VcbiAgICAgIC5zdGF0ZSgncHJvZmlsZScsIHtcbiAgICAgICAgdXJsOiAnL3Byb2ZpbGUve05hbWV9JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9pbmRleC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgaXNPd25lcjogW1wiQXV0aFwiLCBcIlVzZXJzXCIsIFwiJHN0YXRlUGFyYW1zXCIsIGZ1bmN0aW9uIChBdXRoLCBVc2VycywgJHN0YXRlUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKEF1dGgucmVmLmdldEF1dGgoKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVswXS4kaWQgPT0gQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIHVzZXJQb3N0czogW1wiVXNlcnNcIiwgXCJUb3BpY3NcIiwgXCIkc3RhdGVQYXJhbXNcIiwgZnVuY3Rpb24gKFVzZXJzLCBUb3BpY3MsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlQnlVc2VybmFtZSgkc3RhdGVQYXJhbXMuTmFtZSkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlWzBdLiRpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gVG9waWNzLmNyZWF0ZWRCeShwcm9maWxlWzBdLiRpZClcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogW1wiJHN0YXRlXCIsIFwiJHN0YXRlUGFyYW1zXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBmdW5jdGlvbiAoJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGVCeVVzZXJuYW1lKCRzdGF0ZVBhcmFtcy5OYW1lKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2hlYWRlckBwcm9maWxlJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFByb2ZpbGUgbGFuZGluZyBwYWdlXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnYWNjY291bnRFZGl0Jywge1xuICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0JyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAncGFzc3dvcmRFZGl0QGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIHVybDogJy9hY2NvdW50L2NoYW5nZVBhc3N3b3JkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncHJvZmlsZS9wYXNzd2QuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICd1c2VyRWRpdEBhY2Njb3VudEVkaXQnOiB7XG4gICAgICAgICAgICB1cmw6ICcvYWNjb3VudC9lZGl0LWZvcm0nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvZWRpdC5odG1sJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgdXNlclBvc3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGlzT3duZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBwcm9maWxlOiBbXCIkc3RhdGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIGZ1bmN0aW9uICgkc3RhdGUsICRyb290U2NvcGUsIEF1dGgsIFVzZXJzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS50aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0UHJvZmlsZShhdXRoLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKHByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgYXV0aDogW1wiJHN0YXRlXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGFjY2NvdW50RWRpdCc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90b29sYmFyL21haW5fdG9vbGJhci5odG1sJ1xuICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRQYXNzd29yZCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvY2hhbmdlUGFzc3dvcmQnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvcGFzc3dkLmh0bWwnXG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2FjY291bnRVc2VyRWRpdCcsIHtcbiAgICAgICAgdXJsOiAnL2FjY291bnQvZWRpdC1mb3JtJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwcm9maWxlL2VkaXQtZm9ybS5odG1sJ1xuICAgICAgfSlcblxuICAgICAgLy8gRGFzaGJvYXJkXG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgICB1cmw6ICcvdXNlci9kYXNoYm9hcmQnLFxuICAgICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsIGFzIHByb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZGFzaGJvYXJkL2luZGV4Lmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIiRzdGF0ZVwiLCBcIiRyb290U2NvcGVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aCwgVXNlcnMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAocHJvZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBubyBzdGF0IG9iamVjdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2ZpbGUuc3RhdCkge1xuICAgICAgICAgICAgICAgICAgICAgIFVzZXJzLnVzZXJSZWYoYXV0aC51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9wb3N0ZWQvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L2NvdW50Jykuc2V0KDApXG4gICAgICAgICAgICAgICAgICAgICAgVXNlcnMudXNlclJlZihhdXRoLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgICBVc2Vycy51c2VyUmVmKGF1dGgudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKS5zZXQoMClcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIGRpc3BsYXluYW1lIC0gZ28gdG8gZ2V0X3N0YXJ0ZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGUuZGlzcGxheU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnZ2V0X3N0YXJ0ZWQnKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJylcbiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBhdXRoOiBbXCIkc3RhdGVcIiwgXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAZGFzaGJvYXJkJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBGb2xsbG93IENhdGVnb3J5XG4gICAgICAvLyBAcHJvZmlsZUN0cmxcbiAgICAgIC5zdGF0ZSgnZm9sbG93X2NhdGVzJywge1xuICAgICAgICB1cmw6ICcvdXNlci9mb2xsb3ctY2F0ZWdvcmllcycsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCBhcyBwcm9maWxlQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvZm9sbG93LWNhdGVnb3JpZXMuaHRtbCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgIHVzZXJQb3N0czogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpc093bmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgcHJvZmlsZTogW1wiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uIChVc2VycywgQXV0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJzLmdldFByb2ZpbGUoYXV0aC51aWQpLiRsb2FkZWQoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBhdXRoOiBbXCIkc3RhdGVcIiwgXCJVc2Vyc1wiLCBcIkF1dGhcIiwgZnVuY3Rpb24gKCRzdGF0ZSwgVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAZm9sbG93X2NhdGVzJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBHZXR0aW5nIHN0YXJ0ZWRcbiAgICAgIC8vIEBwcm9maWxlQ3RybFxuICAgICAgLnN0YXRlKCdnZXRfc3RhcnRlZCcsIHtcbiAgICAgICAgdXJsOiAnL3VzZXIvZ2V0X3N0YXJ0ZWQnLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwgYXMgcHJvZmlsZUN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhdXRoL2dldF9zdGFydGVkLmh0bWwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICB1c2VyUG9zdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaXNPd25lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHByb2ZpbGU6IFtcIlVzZXJzXCIsIFwiQXV0aFwiLCBmdW5jdGlvbiAoVXNlcnMsIEF1dGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXV0aC5hdXRoLiRyZXF1aXJlQXV0aCgpLnRoZW4oZnVuY3Rpb24gKGF1dGgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBVc2Vycy5nZXRQcm9maWxlKGF1dGgudWlkKS4kbG9hZGVkKClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgYXV0aDogW1wiJHN0YXRlXCIsIFwiVXNlcnNcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIFVzZXJzLCBBdXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF1dGguYXV0aC4kcmVxdWlyZUF1dGgoKS5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGdldF9zdGFydGVkJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvdXNlci9sb2dpbicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXV0aC9sb2dpbi5odG1sJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2xvZ2luLWZvcm1AbG9naW4nOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9sb2dpbi1mb3JtLmh0bWwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnaGVhZGVyQGxvZ2luJzoge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ0F1dGhDdHJsIGFzIGF1dGhDdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Rvb2xiYXIvbWFpbl90b29sYmFyLmh0bWwnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgICB1cmw6ICcvdXNlci9yZWdpc3RlcicsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2F1dGgvcmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgICB9LFxuICAgICAgICAgICdoZWFkZXJAcmVnaXN0ZXInOiB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQXV0aEN0cmwgYXMgYXV0aEN0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdG9vbGJhci9tYWluX3Rvb2xiYXIuaHRtbCdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICByZXF1aXJlTm9BdXRoOiBbXCIkc3RhdGVcIiwgXCJBdXRoXCIsIGZ1bmN0aW9uICgkc3RhdGUsIEF1dGgpIHtcbiAgICAgICAgICAgIHJldHVybiBBdXRoLmF1dGguJHJlcXVpcmVBdXRoKCkudGhlbihmdW5jdGlvbiAoYXV0aCkge1xuICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgIHJldHVybiBlcnJvclxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpXG4gIH1dKVxuXG4gIC5maWx0ZXIoJ29yZGVyT2JqZWN0QnknLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpdGVtcywgZmllbGQsIHJldmVyc2UpIHtcbiAgICAgIHZhciBmaWx0ZXJlZCA9IFtdXG4gICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGZpbHRlcmVkLnB1c2goaXRlbS4kaWQpLnNldChpdGVtKVxuICAgICAgfSlcbiAgICAgIGZpbHRlcmVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIChhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xKVxuICAgICAgfSlcbiAgICAgIGlmIChyZXZlcnNlKSBmaWx0ZXJlZC5yZXZlcnNlKClcbiAgICAgIHJldHVybiBmaWx0ZXJlZFxuICAgIH1cbiAgfSlcblxuICAuZmlsdGVyKCdkZWNvZGVVUkknLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dCA/IGRlY29kZVVSSSh0ZXh0KSA6ICcnXG4gICAgfVxuICB9KVxuXG4gIC8vIEZvcm1hdHRpbmcgdGV4dHMgdG8gaW5jbHVkZSBuZXcgbGluZVxuICAuZmlsdGVyKCdubDJicicsIFtcIiRzY2VcIiwgZnVuY3Rpb24gKCRzY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHJldHVybiB0ZXh0ID8gJHNjZS50cnVzdEFzSHRtbCh0ZXh0LnJlcGxhY2UoL1xcbi9nLCAnPGJyLz4nKSkgOiAnJ1xuICAgIH1cbiAgfV0pXG5cbiAgLmNvbnN0YW50KCdGaXJlYmFzZVVybCcsICdodHRwczovL2JteHl6LmZpcmViYXNlaW8uY29tLycpXG5cbmZ1bmN0aW9uIHNob3cgKGRhdGEpIHtcbiAgY29uc29sZS5sb2coZGF0YSlcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpXG59XG5cbi8vIGZvciBqb2luaW5nIC0gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20va2F0b3d1bGYvNjU5ODIzOFxuZnVuY3Rpb24gZXh0ZW5kIChiYXNlKSB7XG4gIHZhciBwYXJ0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcbiAgcGFydHMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuICAgIGlmIChwICYmIHR5cGVvZiAocCkgPT09ICdvYmplY3QnKSB7XG4gICAgICBmb3IgKHZhciBrIGluIHApIHtcbiAgICAgICAgaWYgKHAuaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICBiYXNlW2tdID0gcFtrXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuICByZXR1cm4gYmFzZVxufVxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29udHJvbGxlcignQXV0aEN0cmwnLCBbXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCIkc3RhdGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJG1kU2lkZW5hdlwiLCBcIiR0cmFuc2xhdGVcIiwgXCIkY29va2llc1wiLCBcIk5vdGlTZXJ2aWNlXCIsIGZ1bmN0aW9uKEF1dGgsIFVzZXJzLCAkc3RhdGUsJHJvb3RTY29wZSwkbWRTaWRlbmF2LCR0cmFuc2xhdGUsICRjb29raWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5vdGlTZXJ2aWNlKXtcclxuICAgIHZhciBhdXRoQ3RybCA9IHRoaXM7XHJcblxyXG5cclxuICAgIC8vUGFyc2VyXHJcbiAgICBhdXRoQ3RybC5hdXRoICAgICA9IEF1dGg7XHJcbiAgICBhdXRoQ3RybC51c2VycyAgICA9IFVzZXJzO1xyXG4gICAgYXV0aEN0cmwubm90aWZpY2F0aW9uID0gTm90aVNlcnZpY2U7XHJcblxyXG5cclxuICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSAhPSBudWxsICl7XHJcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgID0gYXV0aEN0cmwudXNlcnMuZ2V0UHJvZmlsZShBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIGF1dGhDdHJsLnByb2ZpbGUgPScnXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGF1dGhDdHJsLnVzZXIgPSB7XHJcbiAgICAgIGVtYWlsOiAnJyxcclxuICAgICAgcGFzc3dvcmQ6ICcnXHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAvL0dldCB0aGUgYmFkZ2Ugbm90aWZpY2F0aW9uXHJcbiAgICBhdXRoQ3RybC5iYWRnZU5vdGlmaWNhdGlvbiA9ICBhdXRoQ3RybC5ub3RpZmljYXRpb24uYWRkQXJyQ2hpbGQoYXV0aEN0cmwucHJvZmlsZS4kaWQrJy91bnJlYWQnKTtcclxuICAgIC8vUmVzZXQgY291bnRlclxyXG4gICAgYXV0aEN0cmwucmVzZXRDb3VudGVyID0gZnVuY3Rpb24oKXtcclxuICAgICAgYXV0aEN0cmwubm90aWZpY2F0aW9uLnJlc2V0VW5yZWFkKGF1dGhDdHJsLnByb2ZpbGUuJGlkKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy9DaGFuZ2UgbGFuZ3VhZ2VcclxuICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcgPSBmdW5jdGlvbiAobGFuZ0tleSkge1xyXG4gICAgICAkdHJhbnNsYXRlLnVzZShsYW5nS2V5KTtcclxuICAgICAgLy8gU2V0dGluZyBhIGNvb2tpZVxyXG4gICAgICAkY29va2llcy5wdXQoJ3VzZXJMYW5nJywgbGFuZ0tleSk7XHJcbiAgICAgIC8vSWYgdXNlciByZWdpc3RlcmVkIC0gdXBkYXRlIHRoaXMgaW4gdGhlaXIgcHJlZmVyZW5jZVxyXG4gICAgICBpZihBdXRoLnJlZi5nZXRBdXRoKCkpe1xyXG4gICAgICAgIGF1dGhDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKHtcImxhbmdcIjpsYW5nS2V5fSlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vQ2hlY2trIHVzZXIgc2VsZWN0ZWQgbGFuZ3VhZ2VcclxuICAgIGlmKCFhdXRoQ3RybC5wcm9maWxlLmxhbmcpe1xyXG4gICAgICBpZigkY29va2llcy5nZXQoJ3VzZXJMYW5nJykpe1xyXG4gICAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoJGNvb2tpZXMuZ2V0KCd1c2VyTGFuZycpKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgYXV0aEN0cmwudG9nZ2xlTGFuZygnRW5nJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIGF1dGhDdHJsLnRvZ2dsZUxhbmcoYXV0aEN0cmwucHJvZmlsZS5sYW5nKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy9Mb2dpblxyXG4gICAgYXV0aEN0cmwubG9naW4gPSBmdW5jdGlvbiAoKXtcclxuICAgICAgYXV0aEN0cmwuYXV0aC5hdXRoLiRhdXRoV2l0aFBhc3N3b3JkKGF1dGhDdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKGF1dGgpe1xyXG4gICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcil7XHJcbiAgICAgICAgYXV0aEN0cmwuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vTG9nb3V0XHJcbiAgICBhdXRoQ3RybC5sb2dvdXQgPSBmdW5jdGlvbigpe1xyXG4gICAgICBBdXRoLmF1dGguJHVuYXV0aCgpO1xyXG4gICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9SZWdpc3RlciB1c2VyXHJcbiAgICBhdXRoQ3RybC5yZWdpc3RlciA9IGZ1bmN0aW9uICgpe1xyXG4gICAgICBBdXRoLmF1dGguJGNyZWF0ZVVzZXIoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbiAodXNlcil7XHJcbiAgICAgICAgYXV0aEN0cmwubG9naW4oKTtcclxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcclxuICAgICAgICBhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIGF1dGhDdHJsLnRvZ2dsZVJpZ2h0ID0gYnVpbGRUb2dnbGVyKCdyaWdodCcpO1xyXG4gICAgZnVuY3Rpb24gYnVpbGRUb2dnbGVyKG5hdklEKSB7XHJcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAkbWRTaWRlbmF2KG5hdklEKVxyXG4gICAgICAgICAgLnRvZ2dsZSgpXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5mYWN0b3J5KCdBdXRoJywgW1wiJGZpcmViYXNlQXV0aFwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZUF1dGgsIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwpO1xyXG4gICAgdmFyIGF1dGggPSAkZmlyZWJhc2VBdXRoKHJlZik7XHJcblxyXG4gICAgdmFyIEF1dGggPSB7XHJcbiAgICAgIHJlZjpyZWYsXHJcbiAgICAgIGF1dGg6IGF1dGgsXHJcblxyXG4gICAgICBnZXRVaWQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgdWlkID0gcmVmLmdldEF1dGgoKTtcclxuICAgICAgICBpZih1aWQgIT0gbnVsbCApe1xyXG4gICAgICAgICAgcmV0dXJuIHJlZi5nZXRBdXRoKCkudWlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gQXV0aDtcclxuICB9XSk7XHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ0NhdGVDdHJsJywgW1wiJHN0YXRlXCIsIFwiQ2F0ZWdvcnlcIiwgXCJjYXRlTmFtZVwiLCBcImNhdGVUb3BpY3NcIiwgZnVuY3Rpb24oJHN0YXRlLCBDYXRlZ29yeSxjYXRlTmFtZSxjYXRlVG9waWNzKXtcclxuICAgIHZhciBjYXRlQ3RybCA9IHRoaXM7XHJcblxyXG4gICAgLy9QYXJzZXJzXHJcbiAgICBjYXRlQ3RybC5jYXRlTmFtZSAgID0gY2F0ZU5hbWU7XHJcbiAgICBjYXRlQ3RybC5jYXRlZ29yeSAgID0gQ2F0ZWdvcnk7XHJcbiAgICBjYXRlQ3RybC5jYXRlVG9waWNzID0gY2F0ZVRvcGljcztcclxuXHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL1RvcGljIGxpc3RcclxuICAuZmFjdG9yeSgnQ2F0ZVNlcnZpY2UnLCBbXCIkZmlyZWJhc2VPYmplY3RcIiwgXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXkgLCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzJyk7XHJcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG5cclxuICAgIHZhciBDYXRlID0ge1xyXG5cclxuICAgICAgbmFtZTogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKFwic2x1Z1wiKS5lcXVhbFRvKHRvcGljX3NsdWcpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFkZENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZm9sbG93TGlzdDpmdW5jdGlvbih1aWQpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcIm5ld3MvZm9sbG93ZXJcIikuZXF1YWxUbyh1aWQpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVuRm9sbG93OmZ1bmN0aW9uKHNsdWcsdWlkKXtcclxuICAgICAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzLycrc2x1ZysnL2ZvbGxvd2VyLycrdWlkKTtcclxuICAgICAgICByZWYucmVtb3ZlKCk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1c2VyRm9sbG93OmZ1bmN0aW9uKHNsdWcsdWlkKXtcclxuICAgICAgICB2YXIgZm9sbG93PWZhbHNlO1xyXG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMvJytzbHVnKycvZm9sbG93ZXIvJyt1aWQpO1xyXG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcclxuICAgICAgICAgIGZvbGxvdyA9IHNuYXBzaG90LmV4aXN0cygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcclxuICAgICAgfSxcclxuICAgICAgYXJyOiAkZmlyZWJhc2VBcnJheShyZWYpLFxyXG4gICAgICBhbGw6Y2F0ZWdvcmllc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIENhdGU7XHJcbiAgfV0pXHJcblxyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL1RvcGljIGxpc3RcclxuICAuZmFjdG9yeSgnUG9zdCcsIFtcIiRmaXJlYmFzZU9iamVjdFwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndG9waWNzJyk7XHJcbiAgICB2YXIgdG9waWNzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XHJcblxyXG4gICAgdmFyIFRTID0ge1xyXG4gICAgICB0b3BpY05hbWU6IGZ1bmN0aW9uKHRvcGljX3NsdWcpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLm9yZGVyQnlDaGlsZChcInNsdWdcIikuZXF1YWxUbyh0b3BpY19zbHVnKTtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xyXG4gICAgICB9LFxyXG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKTtcclxuICAgICAgfSxcclxuICAgICAgYWxsOnRvcGljc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFRTO1xyXG4gIH1dKVxyXG5cclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29udHJvbGxlcignRGFzaGJvYXJkQ3RybCcsIFtcIkF1dGhcIiwgXCIkc3RhdGVcIiwgXCJDYXRlZ29yeVwiLCBcIkNhdGVTZXJ2aWNlXCIsIFwiVGFnc1wiLCBcIiR0aW1lb3V0XCIsIFwiJG1kU2lkZW5hdlwiLCBcIiRsb2dcIiwgZnVuY3Rpb24oQXV0aCwgJHN0YXRlLENhdGVnb3J5LENhdGVTZXJ2aWNlLFRhZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dCwgJG1kU2lkZW5hdiwgJGxvZykge1xyXG4gICAgdmFyIGRhc2hib2FyZEN0cmwgPSB0aGlzO1xyXG5cclxuICAgIGRhc2hib2FyZEN0cmwuYXV0aCA9IEF1dGg7XHJcblxyXG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlID0gQ2F0ZVNlcnZpY2U7XHJcbiAgICBkYXNoYm9hcmRDdHJsLmNhdGVnb3JpZXMgICAgICA9IENhdGVnb3J5LmFsbDtcclxuICAgIGRhc2hib2FyZEN0cmwudG9waWNfZ3JpZCAgPSBmYWxzZTtcclxuICAgIGRhc2hib2FyZEN0cmwudGFncyAgICAgICAgPSBUYWdzLmFycjtcclxuXHJcbiAgICBkYXNoYm9hcmRDdHJsLnVzZXJDYXRlRm9sbG93ICA9IFtdO1xyXG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcclxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93TGlzdCAgICAgID0gJyc7XHJcblxyXG5cclxuICAgIC8vQ2xvc2UgU2lkZSBiYXJcclxuICAgIGRhc2hib2FyZEN0cmwuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICRtZFNpZGVuYXYoJ3JpZ2h0JykuY2xvc2UoKTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGNhdGVfc2x1Zyl7XHJcbiAgICAgIGRhc2hib2FyZEN0cmwuY2F0ZS5hZGRDaGlsZChjYXRlX3NsdWcrJy9mb2xsb3dlcicpXHJcbiAgICAgICAgLmNoaWxkKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XHJcbiAgICB9XHJcbiAgfV0pO1xyXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuXHJcbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXHJcbiAgLmRpcmVjdGl2ZSgncmV2aWV3U2NvcmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogICAgICdFJyxcclxuICAgICAgdHJhbnNjbHVkZTogICB0cnVlLFxyXG4gICAgICBjb250cm9sbGVyOiAgICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvcmV2aWV3LXN1bW1hcnktbGlzdC5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICByZXZpZXc6ICc9J1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgLy9Gb2xsb3cgQnV0dG9uXHJcbiAgLmRpcmVjdGl2ZSgndXNlckZvbGxvd2VyQnRuJyxmdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXHJcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcclxuICAgICAgY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAgJ3RlbXBsYXRlcy9odG1sL2ZvbGxvdy11c2VyLmh0bWwnLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIGZvbGxvdzogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KVxyXG5cclxuICAvL0NhdGVnb3J5IGZvbGxvdyBidXR0b25cclxuICAuZGlyZWN0aXZlKCdjYXRlRm9sbG93QnRuJyxmdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvY2F0ZWdvcnktZm9sbG93LWJ0bi5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBjYXRlOiAnPSdcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIC8vTGlzdCBvZiBjYXRlZ29yaWVzIG9uIHRoZSBzaWRlcmJhclxyXG4gIC5kaXJlY3RpdmUoJ3RvcGljR3JpZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWdyaWQuaHRtbCdcclxuICAgIH1cclxuICB9KVxyXG5cclxuICAvL0dyaWQgVGFncyBmb3Igc2lkZWJhclxyXG4gIC5kaXJlY3RpdmUoJ3RhZ0dyaWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90YWctZ3JpZC5odG1sJ1xyXG4gICAgfVxyXG4gIH0pXHJcblxyXG5cclxuICAuZGlyZWN0aXZlKCd0b3BpY0NyZWF0ZScsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udHJvbGxlcjogJ1RvcGljQ3RybCBhcyB0b3BpY0N0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWNyZWF0ZS5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICB0b3BpYzogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfSlcclxuXHJcblxyXG4gIC5kaXJlY3RpdmUoJ3RvcGljTGlzdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90b3BpYy1saXN0Lmh0bWwnLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIHRvcGljczogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KVxyXG5cclxuXHJcbiAgLmRpcmVjdGl2ZSgndG9waWNBY3Rpb25zQ2FyZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90b3BpYy1hY3Rpb25zLWNhcmQuaHRtbCcsXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgdG9waWM6ICc9J1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcblxyXG4gIC8vZm9yIHRhZ3MgLSBtYXggdGFnc1xyXG4gIC5kaXJlY3RpdmUoJ2VuZm9yY2VNYXhUYWdzJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdDdHJsKSB7XHJcbiAgICAgIHZhciBtYXhUYWdzID0gYXR0cnMubWF4VGFncyA/IHBhcnNlSW50KGF0dHJzLm1heFRhZ3MsICc0JykgOiBudWxsO1xyXG5cclxuICAgICAgbmdDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgJiYgbWF4VGFncyAmJiB2YWx1ZS5sZW5ndGggPiBtYXhUYWdzKSB7XHJcbiAgICAgICAgICB2YWx1ZS5zcGxpY2UodmFsdWUubGVuZ3RoIC0gMSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7XHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgW1wiJHN0YXRlXCIsIFwiQ2F0ZWdvcnlcIiwgXCJUb3BpY3NcIiwgXCJmZWVkXCIsIGZ1bmN0aW9uKCRzdGF0ZSxDYXRlZ29yeSxUb3BpY3MsZmVlZCl7XHJcbiAgICB2YXIgaG9tZUN0cmwgPSB0aGlzO1xyXG5cclxuICAgIGhvbWVDdHJsLnRvcGljcyA9IENhdGVnb3J5O1xyXG4gICAgaG9tZUN0cmwudG9waWNzID0gVG9waWNzO1xyXG4gICAgaG9tZUN0cmwuZmVlZCAgID0gZmVlZDtcclxuICB9XSk7XHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbmZpZyhbJyR0cmFuc2xhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ0VuZycsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ0Rhc2hib2FyZCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICdMYW5ndWFnZXMnLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAnSG9tZScsXHJcbiAgICAgICdLRVlfUkVHSVNURVInOiAgICdSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICdMb2cgaW4nLFxyXG4gICAgICAnS0VZX0xPR09VVCc6ICAgICAnTG9nIG91dCcsXHJcbiAgICAgICdLRVlfRk9MTE9XJzogICAgICdGb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0VSJzogICAnRm9sbG93ZXInLFxyXG4gICAgICAnS0VZX1VORk9MTE9XJzogICAnVW5mb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0lORyc6ICAnRm9sbG93aW5nJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ1Bvc3QnLFxyXG4gICAgICAnS0VZX1BPU1RFRCc6ICAgICAnUG9zdGVkJyxcclxuICAgICAgJ0tFWV9VUFZPVEUnOiAgICAgJ1Vwdm90ZScsXHJcbiAgICAgICdLRVlfVVBWT1RFRCc6ICAgICdVcHZvdGVkJyxcclxuICAgICAgJ0tFWV9EV05fVk9URSc6ICAgJ0Rvd252b3RlJyxcclxuICAgICAgJ0tFWV9EV05fVk9URUQnOiAgJ0Rvd252b3RlZCcsXHJcbiAgICAgICdLRVlfVklFVyc6ICAgICAgICdWaWV3JyxcclxuICAgICAgJ0tFWV9SRU1PVkUnOiAgICAgJ1JlbW92ZScsXHJcbiAgICAgICdLRVlfQ0FOQ0VMJzogICAgICdDYW5jZWwnLFxyXG4gICAgICAnS0VZX1FVRVNUSU9OJzogICAnUXVlc3Rpb24nLFxyXG4gICAgICAnS0VZX1RPUElDJzogICAgICAnVG9waWMnLFxyXG4gICAgICAnS0VZX0NIR19QV0QnOiAgICAnQ2hhbmdlIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9QQVNTV09SRCc6ICAgJ1Bhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9PTERfUFdEJzogICAgJ09sZCBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfTkVXX1BXRCc6ICAgICdOZXcgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX05FV19QV0RfQyc6ICAnTmV3IHBhc3N3b3JkIGNvbmZpcm1hdGlvbicsXHJcbiAgICAgICdLRVlfU0FWRSc6ICAgICAgICdTYXZlJyxcclxuICAgICAgJ0tFWV9TQVZFX0RSQUZUJzogJ1NhdmUgYXMgZHJhZnQnLFxyXG4gICAgICAnS0VZX1RBR1MnOiAgICAgICAnVGFncycsXHJcbiAgICAgICdLRVlfRVhQTE9SRSc6ICAgICdFeHBsb3JlJyxcclxuICAgICAgJ0tFWV9DT01NRU5UUyc6ICAgJ0NvbW1lbnRzJyxcclxuICAgICAgJ0tFWV9SRVBMWSc6ICAgICAgJ1JlcGx5JyxcclxuICAgICAgJ0tFWV9SRVZJRVcnOiAgICAgJ1JldmlldycsXHJcbiAgICAgICdLRVlfRURJVCc6ICAgICAgICdFZGl0JyxcclxuICAgICAgJ0tFWV9UUkVORCc6ICAgICAgJ1RyZW5kJyxcclxuICAgICAgJ0tFWV9UUkVORElORyc6ICAgJ1RyZW5kaW5nJyxcclxuICAgICAgJ0tFWV9XUklURV9SRVBMWSc6J1dyaXRlIGEgcmVwbHknLFxyXG4gICAgICAnS0VZX0xBVEVTVF9GRUVEJzonTGF0ZXN0IEZlZWQnLFxyXG5cclxuICAgICAgLy9SZW1vdmUgdG9waWNcclxuICAgICAgJ0tFWV9DT05GX1JFTU9WRSc6J0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmU/JyxcclxuICAgICAgJ0tFWV9DT05GX1JFTV9DJzogJ09uY2UgcmVtb3ZlLCB5b3Ugd2lsbCBub3QgYmUgYWJsZXRvIHRvIGdldCB0aGlzIHRvcGljIGJhY2snLFxyXG5cclxuXHJcbiAgICAgIC8vU0VOVEVOQ0VcclxuICAgICAgJ0tFWV9XSEFUX09OX1VSX01JTkQnOiAgJ1doYXRcXCdzIG9uIHlvdXIgbWluZD8nLFxyXG4gICAgICAnS0VZX1lPVV9XQU5UX0ZPTExPVyc6ICAnWW91IG1heSB3YW50IHRvIGZvbGxvdycsXHJcbiAgICAgICdLRVlfTk9fQUNDVF9SRUdJU1RFUic6ICdEb25cXCd0IGhhdmUgYWNjb3VudD8gUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX0NBTlRfQ0hOR19VU0VSJzogICAnRG9uXFwndCBoYXZlIGFjY291bnQ/IFJlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9ZT1VSX0FDQ09VTlQnOiAgICAgJ1lvdXIgYWNjb3VudCcsXHJcbiAgICAgICdLRVlfTk9USElOR19IRVJFJzogICAgICdOb3RoaW5nIGhlcmUsIHlldCcsXHJcbiAgICAgICdLRVlfV0hPX1RPX0ZPTExPVyc6ICAgICdXaG8gdG8gZm9sbG93JyxcclxuICAgICAgJ0tFWV9DQVRfV0lMTF9BUFBFQVInOiAgJ0ZvbGxvdyBzb21lIGNhdGVnb3JpZXMgYW5kIGl0IHdpbGwgYXBwZWFyIGhlcmUnLFxyXG4gICAgICAnS0VZX1dIVF9VUl9TVE9SWSc6ICAgICAnV2hhdFxcJ3MgeW91ciBzdG9yeScsXHJcbiAgICAgICdLRVlfV1JUX0NPTU1FTlQnOiAgICAgICdXcml0ZSBhIGNvbW1lbnQnLFxyXG5cclxuXHJcblxyXG4gICAgICAvL1VTRVIgSU5QVVRcclxuICAgICAgJ0tFWV9GSVJTVE5BTUUnOiAgJ0ZpcnN0IG5hbWUnLFxyXG4gICAgICAnS0VZX0xBU1ROQU1FJzogICAnTGFzdCBuYW1lJyxcclxuICAgICAgJ0tFWV9CSVJUSERBWSc6ICAgJ0JpcnRoZGF5JyxcclxuICAgICAgJ0tFWV9NT05USCc6ICAgICAgJ01vbnRoJyxcclxuICAgICAgJ0tFWV9EQVknOiAgICAgICAgJ0RheScsXHJcbiAgICAgICdLRVlfRU1BSUwnOiAgICAgICdFbWFpbCcsXHJcbiAgICAgICdLRVlfQ09ORl9FTUFJTCc6ICdDb25maXJtIEVtYWlsJyxcclxuICAgICAgJ0tFWV9HRU5ERVInOiAgICAgJ0dlbmRlcicsXHJcbiAgICAgICdLRVlfTUFMRSc6ICAgICAgICdNYWxlJyxcclxuICAgICAgJ0tFWV9GRU1BTEUnOiAgICAgJ0ZlbWFsZScsXHJcbiAgICAgICdLRVlfVVNFUk5BTUUnOiAgICdVc2VybmFtZScsXHJcbiAgICAgICdLRVlfTE9DQVRJT04nOiAgICdMb2NhdGlvbicsXHJcblxyXG4gICAgICAvL1VzZXIgRWRpdFxyXG4gICAgICAnS0VZX0VEX1BST0ZJTEUnOiAnRWRpdCBQcm9maWxlJyxcclxuICAgICAgJ0tFWV9FRF9DSEdfUFdEJzogJ0NoYW5nZSBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfRURfUFJPRklMRSc6ICdFZGl0IFByb2ZpbGUnLFxyXG4gICAgICAnS0VZX0VEX1NJVEUnOiAgICAnV2Vic2l0ZScsXHJcbiAgICAgICdLRVlfRURfUEhPTkUnOiAgICdQaG9uZScsXHJcbiAgICAgICdLRVlfRURfQklPJzogICAgICdCaW9ncmFwaHknLFxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ+C5hOC4l+C4oicsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ+C4q+C5ieC4reC4h+C4l+C4seC5ieC4h+C4q+C4oeC4lCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICfguKDguLLguKnguLInLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAn4Lir4LiZ4LmJ4Liy4LmB4Lij4LiBJyxcclxuICAgICAgJ0tFWV9SRUdJU1RFUic6ICAgJ+C4quC4oeC4seC4hOC4o+C5g+C4iuC5iScsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICfguYDguILguYnguLLguKrguLnguYjguKPguLDguJrguJonLFxyXG4gICAgICAnS0VZX0ZPTExPVyc6ICAgICAn4LiV4Li04LiU4LiV4Liy4LihJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ+C5guC4nuC4quC4leC5jCdcclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnZW4nKTtcclxuICB9XSlcclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29udHJvbGxlcignTm90aUN0cmwnLCBbXCIkc3RhdGVcIiwgXCJDYXRlZ29yeVwiLCBcIlRvcGljc1wiLCBcIk5vdGlTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSxDYXRlZ29yeSxUb3BpY3MsTm90aVNlcnZpY2Upe1xyXG4gICAgdmFyIG5vdGlDdHJsID0gdGhpcztcclxuXHJcblxyXG4gICAgbm90aUN0cmwudG9waWNzID0gVG9waWNzO1xyXG4gICAgbm90aUN0cmwuZmVlZCAgID0gZmVlZDtcclxuICAgIG5vdGlDdHJsLm5vdGlTZXJ2aWNlID0gTm90aVNlcnZpY2U7XHJcblxyXG4gICAgbm90aUN0cmwubm90aWZ5VG8gPWZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgIHJldHVybiBub3RpQ3RybC5hcnIucHVzaCh1aWQpLiRhZGQodWlkKVxyXG4gICAgfVxyXG4gIH1dKTtcclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuXHJcbiAgLmZhY3RvcnkoJ05vdGlTZXJ2aWNlJywgW1wiJGZpcmViYXNlT2JqZWN0XCIsIFwiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5ICwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uJyk7XHJcbiAgICB2YXIgbm90aSA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG5cclxuICAgIHZhciBOb3RpZmljYXRpb24gPSB7XHJcblxyXG4gICAgICB1bnJlYWROb3RpZmljYXRpb246ZnVuY3Rpb24odWlkKXtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCRmaXJlYmFzZU9iamVjdChyZWYub3JkZXJCeUNoaWxkKFwiaXNfcmVhZFwiKS5lcXVhbFRvKFwiZmFsc2VcIikpKTtcclxuICAgICAgfSxcclxuXHJcblxyXG4gICAgICAvL1Jlc2V0IHVucmVhZCBjb3VudGVyXHJcbiAgICAgIHJlc2V0VW5yZWFkOmZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XHJcbiAgICAgICAgcmVmLnNldCgwKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50OmZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XHJcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coc25hcHNob3QudmFsKCkpO1xyXG4gICAgICAgICBpZihzbmFwc2hvdC52YWwoKSA9PSAnbnVsbCcpe1xyXG4gICAgICAgICAgIGNvbnNvbGUubG9nKCdudWxsJylcclxuICAgICAgICAgICAgcmVmLnNldCgxKVxyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgY29uc29sZS5sb2coJ2luY3JlbWVudCBoZXJlJylcclxuICAgICAgICAgICAgcmVmLnNldChzbmFwc2hvdC52YWwoKSArIDEpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvck9iamVjdCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgcmVhZCBmYWlsZWQ6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XHJcbiAgICAgICAgfSk7ICAgICAgICAgc1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQXJyQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKGNoaWxkKSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXHJcbiAgICAgIGFsbDogbm90aVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcclxuICB9XSlcclxuXHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ1BsYWNlc0N0cmwnLCBbXCIkc3RhdGVcIiwgXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJG1kRGlhbG9nXCIsIFwiJG1kTWVkaWFcIiwgXCJUYWdzXCIsIFwiVG9waWNzXCIsIFwiQXV0aFwiLCBcIlVzZXJzXCIsIFwiU2x1Z1wiLCBcIkxhbmd1YWdlc1wiLCBcInBsYWNlTGFuZGluZ1wiLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLCBTbHVnLExhbmd1YWdlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlTGFuZGluZykge1xyXG5cclxuICAgIHZhciBwbGFjZXNDdHJsID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKHBsYWNlTGFuZGluZyk7XHJcbiAgICBwbGFjZXNDdHJsLnBsYWNlTGFuZGluZyA9IHBsYWNlTGFuZGluZztcclxuXHJcbiAgfV0pO1xyXG5cclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnUGxhY2VzJywgW1wiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbigkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xyXG5cclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlcycpO1xyXG4gICAgdmFyIHBsYWNlRGV0YWlsX3JlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsncGxhY2VzX2RldGFpbHMnKTtcclxuXHJcbiAgICB2YXIgcGxhY2VzID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICB2YXIgUGxhY2VzID0ge1xyXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oY2hpbGRuYW1lKXtcclxuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKGNoaWxkbmFtZSlcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFkZFBsYWNlRGV0YWlsQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHBsYWNlRGV0YWlsX3JlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBnZXRQbGFjZVJlZjpmdW5jdGlvbihwbGFjZV9pZCl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChwbGFjZV9pZCsnL2luZm8nKTtcclxuICAgICAgfSxcclxuICAgICAgYXJyOiBwbGFjZXNcclxuICAgIH1cclxuICAgIHJldHVybiBQbGFjZXM7XHJcbiAgfV0pXHJcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcblxyXG4gIC8vQ2F0ZWdvcnkgbGlzdFxyXG4gIC5mYWN0b3J5KCdDYXRlZ29yeScsIFtcIiRmaXJlYmFzZU9iamVjdFwiLCBcIiRmaXJlYmFzZUFycmF5XCIsIFwiRmlyZWJhc2VVcmxcIiwgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcycpO1xyXG4gICAgdmFyIGNhdGVnb3JpZXMgPSAkZmlyZWJhc2VPYmplY3QocmVmKTtcclxuICAgIHZhciB0b3BpY0FyciA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIENhdGVnb3J5ID0ge1xyXG4gICAgICBnZXROYW1lOiBmdW5jdGlvbihzbHVnKXtcclxuICAgICAgICB2YXIgZGF0YSA9IHJlZi5jaGlsZChzbHVnKTtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWxsOiBjYXRlZ29yaWVzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gQ2F0ZWdvcnk7XHJcbiAgfV0pXHJcblxyXG5cclxuICAvL0xhbmd1YWdlc1xyXG4gIC5mYWN0b3J5KCdMYW5ndWFnZXMnLCBbXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydsYW5ndWFnZXMnKTtcclxuICAgIHZhciBsYW5nID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICByZXR1cm4gbGFuZztcclxuICB9XSlcclxuXHJcblxyXG4gIC8vTGFuZ3VhZ2VzXHJcbiAgLmZhY3RvcnkoJ0FyY2hpdmUnLCBbXCIkZmlyZWJhc2VBcnJheVwiLCBcIkZpcmViYXNlVXJsXCIsIGZ1bmN0aW9uKCRmaXJlYmFzZUFycmF5LCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydhcmNoaXZlJyk7XHJcbiAgICB2YXIgYXJjaGl2ZSA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIEFyY2hpdmUgPXtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKHNsdWcpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoc2x1Zyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlZjogcmVmLFxyXG4gICAgICBhcnI6IGFyY2hpdmVcclxuICAgIH1cclxuICAgIHJldHVybiBBcmNoaXZlO1xyXG4gIH1dKTtcclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuY29udHJvbGxlcignVGFnQ3RybCcsIFtcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcIiRzdGF0ZVwiLCBcIiRyb290U2NvcGVcIiwgXCJ0YWdMYW5kaW5nXCIsIFwidGFnTmFtZVwiLCBmdW5jdGlvbihBdXRoLCBVc2VycywgJHN0YXRlLCRyb290U2NvcGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ0xhbmRpbmcsdGFnTmFtZSkge1xyXG5cclxuICAgIHZhciB0YWdDdHJsID0gdGhpcztcclxuICAgIHRhZ0N0cmwudGFnTGFuZGluZyAgPSB0YWdMYW5kaW5nO1xyXG4gICAgdGFnQ3RybC50YWdOYW1lICAgICA9IHRhZ05hbWU7XHJcblxyXG4gIH1dKTtcclxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmZhY3RvcnkoJ1RhZ3MnLCBbXCIkZmlyZWJhc2VBcnJheVwiLCBcIiRmaXJlYmFzZU9iamVjdFwiLCBcIkZpcmViYXNlVXJsXCIsIFwiJHFcIiwgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksICRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwsICRxKXtcblxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3RhZ3MnKTtcbiAgICB2YXIgdGFncyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICB2YXIgVGFncyA9IHtcblxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxuICAgICAgfSxcblxuICAgICAgdGFnc1VybDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmKTtcbiAgICAgIH0sXG5cbiAgICAgIGdldFRhZ1JlZjpmdW5jdGlvbih0YWcpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRhZyk7XG4gICAgICB9LFxuXG4gICAgICBnZXRUYWdPYmplY3Q6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljVGFnczpmdW5jdGlvbih0YWcpe1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG4gICAgICAgIHZhciBkYXRhUmV0ID0gJyc7XG5cbiAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0YWdzLycrdGFnKVxuICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0YWdTbmFwKXtcbiAgICAgICAgICAgIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAuZXF1YWxUbyh0YWcpXG4gICAgICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgLy9zaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YVJldCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIGFycjogdGFnc1xuXG4gICAgfVxuICAgIHJldHVybiBUYWdzO1xuICB9XSlcblxuYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdUb3BpY0xhbmRpbmdDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiU2x1Z1wiLCBcIlRvcGljc1wiLCBcIkF1dGhcIiwgXCJVc2Vyc1wiLCBcImlzT3duZXJcIiwgXCJ0b3BpY0xhbmRpbmdcIiwgXCJyZXBseUxpc3RcIiwgXCJ2aWV3RGF0YVwiLCBcImZvbGxvd2Vyc1wiLCBmdW5jdGlvbiAoJHN0YXRlLCAkc2NvcGUsIFNsdWcsIFRvcGljcywgQXV0aCwgVXNlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc093bmVyLHRvcGljTGFuZGluZywgcmVwbHlMaXN0LCB2aWV3RGF0YSwgZm9sbG93ZXJzKSB7XG5cbiAgICB2YXIgdG9waWNMYW5kaW5nQ3RybCA9IHRoaXNcblxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5hdXRoICAgICAgICAgPSBBdXRoO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudXNlcnMgICAgICAgID0gVXNlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY0xhbmRpbmcgPSB0b3BpY0xhbmRpbmc7XG4gICAgdG9waWNMYW5kaW5nQ3RybC50b3BpY3MgICAgICAgPSBUb3BpY3M7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QgICAgPSByZXBseUxpc3Q7XG4gICAgdG9waWNMYW5kaW5nQ3RybC52aWV3cyAgICAgICAgPSB2aWV3RGF0YTtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmZvbGxvd2VycyAgICA9IGZvbGxvd2VycztcbiAgICB0b3BpY0xhbmRpbmdDdHJsLmlzT3duZXIgICAgICA9IGlzT3duZXI7XG5cblxuXG5cbiAgICAvL0dldHRpbmcgUmVwbGllcyBpbiByZXBsaWVzXG4gICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyID0gW107XG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkgPSBmdW5jdGlvbigpe1xuXG4gICAgICBmb3IodmFyIGk9MDsgaTx0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdC5sZW5ndGg7aSsrKXtcbiAgICAgICAgdmFyIHRvcGljSWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS50b3BpY0lkO1xuICAgICAgICB2YXIgcmVwbHlJZCA9IHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0W2ldLiRpZDtcbiAgICAgICAgdG9waWNMYW5kaW5nQ3RybC5pblJlcGx5QXJyW2ldID0gdG9waWNMYW5kaW5nQ3RybC50b3BpY3MucmVwbHlJblJlcGx5KHRvcGljSWQscmVwbHlJZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdG9waWNMYW5kaW5nQ3RybC5yZXBseUluUmVwbHkoKTtcbiAgfV0pXG5cbmFuZ3VsYXIubW9kdWxlKCdBcHAnKVxuICAuY29udHJvbGxlcignVG9waWNDdHJsJywgW1wiJHN0YXRlXCIsIFwiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRtZERpYWxvZ1wiLCBcIiRtZE1lZGlhXCIsIFwiJGh0dHBcIiwgXCJGaXJlYmFzZVVybFwiLCBcIiR0cmFuc2xhdGVcIiwgXCJOb3RpU2VydmljZVwiLCBcIlRhZ3NcIiwgXCJUb3BpY3NcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCJTbHVnXCIsIFwiUGxhY2VzXCIsIFwiTGFuZ3VhZ2VzXCIsIFwiQXJjaGl2ZVwiLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaHR0cCxGaXJlYmFzZVVybCwkdHJhbnNsYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aVNlcnZpY2UsVGFncywgVG9waWNzLCBBdXRoLCBVc2VycyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNsdWcsUGxhY2VzLCBMYW5ndWFnZXMsQXJjaGl2ZSl7XG5cbiAgICB2YXIgdG9waWNDdHJsID0gdGhpcztcblxuXG4gICAgLy9QYXJzZXIgaGVyZVxuICAgIHRvcGljQ3RybC50YWdzICAgICAgPSBUYWdzO1xuICAgIHRvcGljQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgdG9waWNDdHJsLmF1dGggICAgICA9IEF1dGg7XG4gICAgdG9waWNDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHRvcGljQ3RybC5sYW5ndWFnZXMgPSBMYW5ndWFnZXM7XG4gICAgdG9waWNDdHJsLnBsYWNlcyAgICA9IFBsYWNlcztcbiAgICB0b3BpY0N0cmwuYXJjaGl2ZSAgID0gQXJjaGl2ZTtcbiAgICB0b3BpY0N0cmwubm90aSAgICAgID0gTm90aVNlcnZpY2U7XG5cbiAgICBpZih0b3BpY0N0cmwuYXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcbiAgICAgIHRvcGljQ3RybC5wcm9maWxlICA9IHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljQ3RybC5hdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICAgIHRvcGljQ3RybC51aWQgPSB0b3BpY0N0cmwucHJvZmlsZS4kaWQ7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9IHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpO1xuICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzID0gdG9waWNDdHJsLnVzZXJzLnVwdm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcyA9IHRvcGljQ3RybC51c2Vycy5kb3dudm90ZXModG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZyA9IHRvcGljQ3RybC51c2Vycy5mb2xsb3dpbmcodG9waWNDdHJsLnVpZCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0b3BpY0N0cmwucHJvZmlsZSA9Jyc7XG4gICAgICB0b3BpY0N0cmwudWlkID0gJyc7XG4gICAgICB0b3BpY0N0cmwudXNlclJlZiA9ICcnO1xuICAgIH1cblxuXG5cbiAgICAvL1ByZXNldCBQYXJhbWV0ZXJzXG4gICAgdG9waWNDdHJsLmltYWdlU3RyaW5ncyAgPSBbXTtcbiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0ICAgICA9IFtdO1xuICAgIHRvcGljQ3RybC5pblJlcGx5QXJyICAgID0gW107XG4gICAgdG9waWNDdHJsLmxvYWRCdXN5ICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuc2x1Z1JldHVybiAgICA9IG51bGw7XG4gICAgdG9waWNDdHJsLmNyaXRlcmlhICAgICAgPSBmYWxzZTtcbiAgICB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseSA9IG51bGw7XG4gICAgdG9waWNDdHJsLnJldmlld0NyaXRlcmlhPWZhbHNlO1xuICAgIHRvcGljQ3RybC5jcml0UmVwbHlEYXRhID0gbnVsbDtcblxuICAgIC8vaWYgYWxsb3cgbnVsbCBpbiB0aGUgZm9ybVxuICAgIHRvcGljQ3RybC5uZXdUb3BpYyAgICAgID0ge1xuICAgICAgJ2xvY2F0aW9uJzogJycsXG4gICAgICAndXJsJyA6ICcnLFxuICAgICAgJ2lwSW5mbyc6ICcnLFxuICAgICAgJ3RhZ3MnOiAnJyxcbiAgICAgICdib2R5JzogJydcbiAgICB9XG5cblxuICAgIC8vQ2FsYyBhdmVyYWdlIHJldmlldyBpbnB1dCBpbiByZXBseVxuICAgIHRvcGljQ3RybC5hdmdSZXZpZXdSZXBseSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHZhciBvYmpDb3VudCA9IE9iamVjdC5rZXlzKHRvcGljQ3RybC5jcml0ZXJpYVJlcGx5KS5sZW5ndGg7XG4gICAgICB2YXIgYXZnID0gMFxuICAgICAgZm9yKHZhciBpPTA7aTxvYmpDb3VudDtpKyspe1xuICAgICAgICBhdmcgPSBhdmcgKyB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseVtpXTtcbiAgICAgIH1cblxuICAgICAgdG9waWNDdHJsLnJlcGx5UmV2aWV3QXZlcmFnZSA9IGF2Zy9vYmpDb3VudDtcblxuICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLmNyaXRlcmlhUmVwbHkpO1xuXG4gICAgICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSA9IHsgYXZnOiB0b3BpY0N0cmwucmVwbHlSZXZpZXdBdmVyYWdlLCBkYXRhOiB0b3BpY0N0cmwuY3JpdGVyaWFSZXBseX1cbiAgICB9XG5cblxuICAgIC8vR2V0IHRoZSBhdmVyYWdlIHNjb3JlIGZyb20gY3JpdGVyaWEgdmFsdWVzXG4gICAgdG9waWNDdHJsLmF2Z1Jldmlld1Njb3JlID0gZnVuY3Rpb24oZGF0YSl7XG4gICAgICBpZihkYXRhKVxuICAgICAge1xuICAgICAgdmFyIGF2ZyA9MDtcbiAgICAgIGZvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtcbiAgICAgICAgYXZnID0gYXZnICsgZGF0YVtpXS5yYXRpbmc7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXZnL2RhdGEubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuXG4gICAgLy9MYWJlbCBmb3IgcmVtb3ZlIHRvcGljc1xuICAgICR0cmFuc2xhdGUoWydLRVlfUkVNT1ZFJywgJ0tFWV9DQU5DRUwnLCdLRVlfQ09ORl9SRU1PVkUnLCdLRVlfQ09ORl9SRU1fQyddKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGlvbnMpIHtcbiAgICAgIHRvcGljQ3RybC5yZW1vdmVUcmFucyA9IHRyYW5zbGF0aW9ucy5LRVlfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNhbmNlbFRyYW5zID0gdHJhbnNsYXRpb25zLktFWV9DQU5DRUw7XG4gICAgICB0b3BpY0N0cmwuY29uZmlybVJlbSAgPSB0cmFuc2xhdGlvbnMuS0VZX0NPTkZfUkVNT1ZFO1xuICAgICAgdG9waWNDdHJsLmNvbmZpcm1SZW1Db250ZW50ID0gIHRyYW5zbGF0aW9ucy5LRVlfQ09ORl9SRU1fQztcbiAgICB9KTtcblxuXG4gICAgdG9waWNDdHJsLnVzZXJOYW1lID0gZnVuY3Rpb24odXNlcklkKXtcbiAgICAgIGlmKHVzZXJJZCE9IG51bGwpe1xuICAgICAgICByZXR1cm4gdG9waWNDdHJsLnVzZXJzLmdldERpc3BsYXlOYW1lKHVzZXJJZCk7XG4gICAgICB9XG4gICAgfVxuXG5cblxuXG4gICAgLy9Mb2dpbiBmb3IgbWF0ZXJpYWxcbiAgICB0b3BpY0N0cmwuc2hvd01kTG9naW4gPSBmdW5jdGlvbihldikge1xuICAgICAgdmFyIHVzZUZ1bGxTY3JlZW4gPSAoJG1kTWVkaWEoJ3NtJykgfHwgJG1kTWVkaWEoJ3hzJykpICYmICRzY29wZS5jdXN0b21GdWxsc2NyZWVuO1xuICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdXRoQ3RybCBhcyBhdXRoQ3RybCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC9tZC1sb2dpbi1mb3JtLmh0bWwnLFxuICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgIGZ1bGxzY3JlZW46IHVzZUZ1bGxTY3JlZW5cbiAgICAgICAgfSlcbiAgICB9XG5cblxuXG4gICAgdG9waWNDdHJsLmRlY29kZVRleHQgPSBmdW5jdGlvbih0ZXh0KXtcbiAgICAgIC8vcmV0dXJuICRmaWx0ZXIoJ3NsdWdpZnknKShpdGVtLm5hbWUpO1xuICAgICAgY29uc29sZS5sb2coZGVjb2RlVVJJKHRleHQpKTtcbiAgICAgIHJldHVybiBkZWNvZGVVUkkodGV4dCk7XG4gICAgfVxuXG5cbiAgICB0b3BpY0N0cmwubG9hZE1vcmUgPSBmdW5jdGlvbihpdGVtcykge1xuICAgICAgdG9waWNDdHJsLmxvYWRCdXN5ID0gdHJ1ZTtcbiAgICAgIHZhciBkYXRhID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGRhdGEucHVzaChpdGVtc1tpXSk7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgIHJldHVybiBkYXRhXG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5sb2FkVGFncyA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICBjb25zb2xlLmxvZyh0b3BpY0N0cmwudGFncy50YWdzVXJsKCkpO1xuICAgIH07XG5cblxuICAgIC8qdG9waWNDdHJsLnVzZXJzLmdldExvY2F0aW9uSVAoKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm8gPSBkYXRhO1xuICAgIH0pOyovXG5cblxuICAgIC8vVXBsb2FkIFByb2ZpbGUgaW1hZ2VcbiAgICB0b3BpY0N0cmwudXBsb2FkRmlsZSA9IGZ1bmN0aW9uKGZpbGVzLGluZGV4KSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2goZmlsZXMsIGZ1bmN0aW9uIChmbG93RmlsZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciB1cmkgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3NbaW5kZXhdID0gdXJpO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmxvd0ZpbGUuZmlsZSk7XG4gICAgICB9KVxuICAgIH07XG5cblxuICAgIC8vU2hvdyBjb25maXJtIHJlbW92ZSB0b3BpY1xuICAgIHRvcGljQ3RybC5zaG93Q29uZmlybVJlbW92ZSA9IGZ1bmN0aW9uKGV2LHRvcGljX293bmVyLG9iail7XG4gICAgICAvLyBBcHBlbmRpbmcgZGlhbG9nIHRvIGRvY3VtZW50LmJvZHkgdG8gY292ZXIgc2lkZW5hdiBpbiBkb2NzIGFwcFxuICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgIC50aXRsZSh0b3BpY0N0cmwuY29uZmlybVJlbSlcbiAgICAgICAgLnRleHRDb250ZW50KHRvcGljQ3RybC5jb25maXJtUmVtQ29udGVudClcbiAgICAgICAgLnRhcmdldEV2ZW50KGV2KVxuICAgICAgICAub2sodG9waWNDdHJsLnJlbW92ZVRyYW5zKVxuICAgICAgICAuY2FuY2VsKHRvcGljQ3RybC5jYW5jZWxUcmFucyk7XG4gICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZih0b3BpY0N0cmwucmVtb3ZlVG9waWModG9waWNfb3duZXIsb2JqKSl7XG4gICAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy9SZW1vdmUgdG9waWNcbiAgICB0b3BpY0N0cmwucmVtb3ZlVG9waWMgPSBmdW5jdGlvbih0b3BpY19vd25lcixvYmope1xuICAgICAgLy92ZXJpZnkgaWYgdGhlIHRvcGljIG93bmVyIGFuZCB0aGUgbG9naW4gb3duZXIgaXMgdGhlIHNhbWUgcHBsXG4gICAgICBpZih0b3BpY19vd25lciA9PSB0b3BpY0N0cmwudWlkKXtcbiAgICAgICAgbW92ZUZiUmVjb3JkKHRvcGljQ3RybC50b3BpY3MucmVmQ2hpbGQob2JqLiRpZCksIHRvcGljQ3RybC5hcmNoaXZlLmFkZENoaWxkKG9iai4kaWQpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgfWVsc2V7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvL1JlcGx5IHRvIHRvcGljXG4gICAgdG9waWNDdHJsLnJlcGx5ID0gZnVuY3Rpb24odG9waWNPYmope1xuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5QXJyKHRvcGljT2JqLiRpZCkuJGFkZCh7XG4gICAgICAgIHRvcGljSWQ6ICB0b3BpY09iai4kaWQsXG4gICAgICAgIGJvZHk6ICAgICB0b3BpY0N0cmwubmV3UmVwbHkuYm9keSxcbiAgICAgICAgdWlkOiAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIHJldmlldzogICB0b3BpY0N0cmwuY3JpdFJlcGx5RGF0YSxcbiAgICAgICAgY3JlYXRlZDogIG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICB9KVxuXG4gICAgICB0b3BpY0N0cmwubm90aS51cGRhdGVOb3RpZmljYXRpb25Db3VudCh0b3BpY09iai51aWQpO1xuXG4gICAgICB0b3BpY0N0cmwubm90aS5hZGRDaGlsZCh0b3BpY09iai51aWQpLnB1c2goKS5zZXQoe1xuICAgICAgICB0b3BpY0lkOiAgICB0b3BpY09iai4kaWQsXG4gICAgICAgIGZyb206ICAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIGlzX3JlYWQ6ICAgIGZhbHNlLFxuICAgICAgICB0aW1lc3RhbXA6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcblxuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLnJlcGx5Q291bnQodG9waWNPYmouJGlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgaWYoIWRhdGEuY291bnQpe1xuICAgICAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlDb3VudFJlZih0b3BpY09iai4kaWQpLnNldCgxKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5yZXBseUNvdW50UmVmKHRvcGljT2JqLiRpZClcbiAgICAgICAgICAgIC5zZXQoZGF0YS5jb3VudCArMSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG5cbiAgICAgIC8vU3RhdCB1cGRhdGUgZm9yIHVzZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2NvbW1lbnQvY291bnQnKVxuICAgICAgICAuc2V0KHRvcGljQ3RybC5wcm9maWxlLnN0YXQuY29tbWVudC5jb3VudCArIDEpO1xuXG4gICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9jb21tZW50L3RvcGljcy8nK3RvcGljT2JqLiRpZClcbiAgICAgICAgLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgfVxuXG5cblxuICAgIC8vUmVwbHkgaW4gcmVwbHlcbiAgICB0b3BpY0N0cmwucmVwbHlJblJlcGx5ID0gZnVuY3Rpb24odG9waWNJZCxyZXBseUlkKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MucmVwbHlJblJlcGx5QXJyKHRvcGljSWQscmVwbHlJZCkuJGFkZCh7XG4gICAgICAgIGJvZHk6ICAgICB0b3BpY0N0cmwucmVwbHlJblJlcGx5LmJvZHksXG4gICAgICAgIHVpZDogICAgICB0b3BpY0N0cmwudWlkLFxuICAgICAgICBjcmVhdGVkOiAgbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgfSlcbiAgICB9XG5cblxuXG4gICAgdG9waWNDdHJsLmFkZE5ld0Nob2ljZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5ld0l0ZW1ObyA9IHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5sZW5ndGgrMTtcbiAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5wdXNoKHsnaWQnOidjcml0ZXJpYScrbmV3SXRlbU5vfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5yZW1vdmVDaG9pY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBsYXN0SXRlbSA9IHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5sZW5ndGgtMTtcbiAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYS5zcGxpY2UobGFzdEl0ZW0pO1xuICAgIH07XG5cblxuICAgIC8vQ3JlYXRlIG5ldyB0b3BpY1xuICAgIHRvcGljQ3RybC5jcmVhdGVUb3BpYyA9IGZ1bmN0aW9uKGNhdGVnb3J5LGlzRHJhZnQpe1xuXG4gICAgICAvL0NoZWNrIGlmIHdlIGhhdmUgbG9jYXRpb24gZGV0YWlsc1xuICAgICAgdmFyIGxvY2F0aW9uRGV0YWlsID0gJyc7XG5cbiAgICAgIGlmKHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbiAhPT0gJycgKXtcbiAgICAgICAgY29uc29sZS5sb2codG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uKTtcbiAgICAgICAgbG9jYXRpb25EZXRhaWwgPSB7XG4gICAgICAgICAgcGxhY2VfaWQ6IHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLnBsYWNlX2lkLFxuICAgICAgICAgIHNsdWc6ICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMubmFtZSksXG4gICAgICAgICAgbmFtZTogICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLm5hbWUsXG4gICAgICAgICAgYWRkcmVzczogIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmZvcm1hdHRlZF9hZGRyZXNzLFxuICAgICAgICAgIGxhdDogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICBsbmc6ICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgICAgbG5nOiAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgICAgIGxuZzogICAgICB0b3BpY0N0cmwubmV3VG9waWMubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgIC8qIERFQlVHIEZPUk0gVkFMVUVcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgIHR5cGU6ICAgICAgICAgICB0b3BpY0N0cmwudHlwZSxcbiAgICAgICAgbGFuZzogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sYW5nLFxuICAgICAgICB0b3BpYzogICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRvcGljLFxuICAgICAgICBib2R5OiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLmJvZHksXG4gICAgICAgIGNhdGVnb3J5OiAgICAgICBjYXRlZ29yeSxcbiAgICAgICAgdWlkOiAgICAgICAgICAgIHRvcGljQ3RybC51aWQsXG4gICAgICAgIHNsdWc6ICAgICAgICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSxcbiAgICAgICAgcGhvdG9zOiAgICAgICAgIHRvcGljQ3RybC5pbWFnZVN0cmluZ3MsXG4gICAgICAgIHBob3Rvc190ZXh0OiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0LFxuICAgICAgICBsb2NhdGlvbjogICAgICAgbG9jYXRpb25EZXRhaWwsXG4gICAgICAgIHVybDogICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudXJsLFxuICAgICAgICBkcmFmdDogICAgICAgICAgaXNEcmFmdCxcbiAgICAgICAgY3JlYXRlZDogICAgICAgIG1vbWVudCgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHRhZ3M6ICAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudGFncyxcbiAgICAgICAgdXNlcklQOiAgICAgICB0b3BpY0N0cmwubmV3VG9waWMuaXBJbmZvXG4gICAgICB9O1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAqL1xuXG4gICAgICB0b3BpY0N0cmwudG9waWNzLmFyci4kYWRkKHtcbiAgICAgICAgICB0eXBlOiAgICAgICAgICAgdG9waWNDdHJsLnR5cGUsXG4gICAgICAgICAgbGFuZzogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5sYW5nLFxuICAgICAgICAgIHRvcGljOiAgICAgICAgICB0b3BpY0N0cmwubmV3VG9waWMudG9waWMsXG4gICAgICAgICAgYm9keTogICAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5ib2R5LFxuICAgICAgICAgIGNhdGVnb3J5OiAgICAgICBjYXRlZ29yeSxcbiAgICAgICAgICB1aWQ6ICAgICAgICAgICAgdG9waWNDdHJsLnVpZCxcbiAgICAgICAgICAvL3NsdWc6ICAgICAgICAgICBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSxcbiAgICAgICAgICBzbHVnOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRvcGljLFxuICAgICAgICAgIHBob3RvczogICAgICAgICB0b3BpY0N0cmwuaW1hZ2VTdHJpbmdzLFxuICAgICAgICAgIHBob3Rvc190ZXh0OiAgICB0b3BpY0N0cmwuaW1hZ2VUZXh0LFxuICAgICAgICAgIGxvY2F0aW9uOiAgICAgICBsb2NhdGlvbkRldGFpbCxcbiAgICAgICAgICB1cmw6ICAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnVybCxcbiAgICAgICAgICBkcmFmdDogICAgICAgICAgaXNEcmFmdCxcbiAgICAgICAgICBjcmVhdGVkOiAgICAgICAgbW9tZW50KCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB0YWdzOiAgICAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljLnRhZ3MsXG4gICAgICAgICAgdXNlcklQOiAgICAgICAgIHRvcGljQ3RybC5uZXdUb3BpYy5pcEluZm8sXG4gICAgICAgICAgcmV2aWV3OiAgICAgICAgIHRvcGljQ3RybC5yZXZpZXdDcml0ZXJpYSxcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbih0b3BpYyl7XG5cbiAgICAgICAgICB2YXIgc2x1Z1RleHQgPScnO1xuICAgICAgICAgIC8vaWYgd2UgYXJlIHVuYWJsZSB0byBjb252ZXJ0IHRvIHNsdWcgdGhlbiB3ZSB1c2UgdGhlIHRvcGljIHRleHQsIGVsc2UgdXNlIHNsdWdcbiAgICAgICAgICBpZihTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKSA9PScnKXtcbiAgICAgICAgICAgIHNsdWdUZXh0ID0gdG9waWNDdHJsLm5ld1RvcGljLnRvcGljO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgc2x1Z1RleHQgPSBTbHVnLnNsdWdpZnkodG9waWNDdHJsLm5ld1RvcGljLnRvcGljKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvL1VwZGF0ZSBzbHVnIHdpdGggdG9waWMgS2V5XG4gICAgICAgICAgdG9waWNDdHJsLnRvcGljcy5nZXRUb3BpY0J5S2V5KHRvcGljLmtleSgpKS51cGRhdGUoe1wic2x1Z1wiOnNsdWdUZXh0K3RvcGljLmtleSgpfSk7XG5cbiAgICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvcG9zdGVkL2NvdW50JylcbiAgICAgICAgICAgIC5zZXQodG9waWNDdHJsLnByb2ZpbGUuc3RhdC5wb3N0ZWQuY291bnQgKyAxKTtcblxuICAgICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L3Bvc3RlZC90b3BpY3MvJyt0b3BpYy5rZXkoKSlcbiAgICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuXG4gICAgICAgICAgLy9JZiB0aGVyZSBpcyBsb2NhdGlvblxuICAgICAgICAgIGlmKGxvY2F0aW9uRGV0YWlsICE9PSAnJyl7XG5cbiAgICAgICAgICAgIHRvcGljQ3RybC5wbGFjZXMuYWRkQ2hpbGQobG9jYXRpb25EZXRhaWwucGxhY2VfaWQpXG4gICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKHRvcGljLmtleSgpKVxuICAgICAgICAgICAgICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuXG4gICAgICAgICAgICB0b3BpY0N0cmwucGxhY2VzLmFkZENoaWxkKGxvY2F0aW9uRGV0YWlsLnBsYWNlX2lkKVxuICAgICAgICAgICAgICAuY2hpbGQoJ2luZm8nKS5zZXQobG9jYXRpb25EZXRhaWwpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vaWYgdGhlcmUgYXJlIHRhZ3NcbiAgICAgICAgICBpZih0b3BpY0N0cmwubmV3VG9waWMudGFncyAhPT0gbnVsbCl7XG4gICAgICAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCB0b3BpY0N0cmwubmV3VG9waWMudGFncy5sZW5ndGg7ICsraW5kZXgpIHtcbiAgICAgICAgICAgICAgdG9waWNDdHJsLnRhZ3MuYWRkQ2hpbGQodG9waWNDdHJsLm5ld1RvcGljLnRhZ3NbaW5kZXhdLnRleHQpXG4gICAgICAgICAgICAgICAgLmNoaWxkKHRvcGljLmtleSgpKS5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgdG9waWNDdHJsLm5ld1RvcGljID0ge1xuICAgICAgICAgIGJvZHk6ICcnXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL0NoZWNrIGlmIHVzZXIgaXMgYWxyZWFkeSBmb2xsb3dpbmcgdXNlclxuICAgIHRvcGljQ3RybC5jaGVja0ZvbGxvdyA9IGZ1bmN0aW9uKGZvbGxvd191aWQpe1xuICAgICAgaWYodG9waWNDdHJsLnVzZXJzLmNoZWNrRm9sbG93KHRvcGljQ3RybC51aWQsZm9sbG93X3VpZCkpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvL0ZvbGxvdyBVc2VyXG4gICAgdG9waWNDdHJsLmZvbGxvd1VzZXIgPSBmdW5jdGlvbihmb2xsb3dfdWlkKXtcblxuICAgICAgLy9VcGRhdGUgdGhlIHBlcnNvbiB0aGF0IGJlaW5nIGZvbGxvdywgY3JlZGl0IHRoZW0gZm9yIGhhdmluZyBmb2xsb3dlclxuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUoZm9sbG93X3VpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93ZXIuY291bnQgKyAxKTtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZihmb2xsb3dfdWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dlci91aWQvJysgdG9waWNDdHJsLnVpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgIH0pO1xuXG4gICAgICAvL1VwZGF0ZSB0aGUgcGVyc29uIHRoYXQgaXMgZm9sbG93aW5nLCBjcmVkaXQgdGhlbSBmb3IgaGF2aW5nIGZvbGxvd2luZ1xuICAgICAgdG9waWNDdHJsLnVzZXJzLmdldFByb2ZpbGUodG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpY0N0cmwudWlkKS5jaGlsZCgnc3RhdC9mb2xsb3dpbmcvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50ICsgMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL3VpZC8nKyBmb2xsb3dfdWlkKVxuICAgICAgICAgIC5wdXNoKCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VuZm9sbG93IFVzZXJcbiAgICB0b3BpY0N0cmwudW5mb2xsb3dVc2VyID0gZnVuY3Rpb24oZm9sbG93X3VpZCl7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBiZWluZyBmb2xsb3csIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93ZXJcbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKGZvbGxvd191aWQpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LmZvbGxvd2VyLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYoZm9sbG93X3VpZCkuY2hpbGQoJ3N0YXQvZm9sbG93ZXIvdWlkLycrIHRvcGljQ3RybC51aWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vVXBkYXRlIHRoZSBwZXJzb24gdGhhdCBpcyBmb2xsb3dpbmcsIGNyZWRpdCB0aGVtIGZvciBoYXZpbmcgZm9sbG93aW5nXG4gICAgICB0b3BpY0N0cmwudXNlcnMuZ2V0UHJvZmlsZSh0b3BpY0N0cmwudWlkKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljQ3RybC51aWQpLmNoaWxkKCdzdGF0L2ZvbGxvd2luZy9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQuZm9sbG93aW5nLmNvdW50IC0gMSk7XG5cbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWNDdHJsLnVpZCkuY2hpbGQoJ3N0YXQvZm9sbG93aW5nL3VpZC8nKyBmb2xsb3dfdWlkKS5yZW1vdmUoKTtcbiAgICAgIH0pO1xuXG4gICAgfVxuXG5cblxuICAgICAvL3Vwdm90ZVxuICAgIHRvcGljQ3RybC51cHZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG5cbiAgICAgIGlmKHRvcGljLmRvd252b3RlcyAhPSB1bmRlZmluZWQgJiYgdG9waWMuZG93bnZvdGVzW3RvcGljQ3RybC51aWRdICE9IHVuZGVmaW5lZCl7XG4gICAgICAgIHRvcGljQ3RybC5jYW5jZWxEb3dudm90ZSh0b3BpYyk7XG4gICAgICB9XG4gICAgICB0b3BpY0N0cmwudG9waWNzLnVwdm90ZVRvcGljKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlclVwdm90ZWRUb3BpY3MuY2hpbGQodG9waWMuJGlkKS5zZXQodmFsdWUuJHZhbHVlKTtcblxuICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICB0b3BpY0N0cmwudXNlcnMudXNlclJlZih0b3BpYy51aWQpLmNoaWxkKCdzdGF0L3Vwdm90ZWQvY291bnQnKVxuICAgICAgICAgIC5zZXQoZGF0YS5zdGF0LnVwdm90ZWQuY291bnQgKyAxKTtcbiAgICAgICAgdG9waWNDdHJsLnVzZXJzLnVzZXJSZWYodG9waWMudWlkKS5jaGlsZCgnc3RhdC91cHZvdGVkL3RvcGljcy8nK3RvcGljLiRpZClcbiAgICAgICAgICAucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwuY2FuY2VsVXB2b3RlID0gZnVuY3Rpb24odG9waWMpe1xuICAgICAgdG9waWNDdHJsLnRvcGljcy51bmRvVXB2b3RlKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG5cbiAgICAgIHRvcGljQ3RybC51c2Vycy5nZXRQcm9maWxlKHRvcGljLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAvL1N0YXQgdXBkYXRlXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC9jb3VudCcpXG4gICAgICAgICAgLnNldChkYXRhLnN0YXQudXB2b3RlZC5jb3VudCAtIDEpO1xuXG4gICAgICAgIHRvcGljQ3RybC51c2Vycy51c2VyUmVmKHRvcGljLnVpZCkuY2hpbGQoJ3N0YXQvdXB2b3RlZC90b3BpY3MvJyt0b3BpYy4kaWQpLnJlbW92ZSgpO1xuICAgICAgfSk7XG5cblxuICAgICAgdG9waWNDdHJsLnVzZXJVcHZvdGVkVG9waWNzLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICAgIC8vZG93bnZvdGVcbiAgICB0b3BpY0N0cmwuZG93bnZvdGUgPSBmdW5jdGlvbih0b3BpYyl7XG4gICAgICBpZih0b3BpYy51cHZvdGVzICE9IHVuZGVmaW5lZCAmJiB0b3BpYy51cHZvdGVzW3RvcGljQ3RybC51aWRdICE9IHVuZGVmaW5lZCl7XG4gICAgICAgIHRvcGljQ3RybC5jYW5jZWxVcHZvdGUodG9waWMpO1xuICAgICAgfVxuICAgICAgdG9waWNDdHJsLnRvcGljcy5kb3dudm90ZVRvcGljKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS4kdmFsdWUpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvcGljQ3RybC5jYW5jZWxEb3dudm90ZSA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5kb0Rvd252b3RlKHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCk7XG4gICAgICB0b3BpY0N0cmwudXNlckRvd252b3RlZFRvcGljcy5jaGlsZCh0b3BpYy4kaWQpLnJlbW92ZShmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZW1vdmVkIHN1Y2Nlc3NmdWxseSFcIik7XG4gICAgICAgICAgfX0pO1xuICAgIH07XG5cbiAgICAvL2ZvbGxvdyB0b3BpY1xuICAgIHRvcGljQ3RybC5mb2xsb3dUb3BpYyA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MuZm9sbG93KHRvcGljLiRpZCwgdG9waWNDdHJsLnVpZCkuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgICAgICB0b3BpY0N0cmwudXNlckZvbGxvd2luZy5jaGlsZCh0b3BpYy4kaWQpLnNldCh2YWx1ZS5oaXN0b3J5W3RvcGljQ3RybC51aWRdKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB0b3BpY0N0cmwudW5mb2xsb3dUb3BpYyA9IGZ1bmN0aW9uKHRvcGljKXtcbiAgICAgIHRvcGljQ3RybC50b3BpY3MudW5mb2xsb3codG9waWMuJGlkLCB0b3BpY0N0cmwudWlkKTtcbiAgICAgIHRvcGljQ3RybC51c2VyRm9sbG93aW5nLmNoaWxkKHRvcGljLiRpZCkucmVtb3ZlKGZ1bmN0aW9uKGVycm9yKXtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlbW92ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgICB9fSk7XG4gICAgfTtcblxuICB9XSk7XG5cblxuLy9odHRwczovL2dpc3QuZ2l0aHViLmNvbS9rYXRvd3VsZi82MDk5MDQyXG5mdW5jdGlvbiBtb3ZlRmJSZWNvcmQob2xkUmVmLCBuZXdSZWYpIHtcbiAgb2xkUmVmLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXApIHtcbiAgICBuZXdSZWYuc2V0KHNuYXAudmFsKCksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICBvbGRSZWYucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0eXBlb2YoY29uc29sZSkgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLy8gVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnVG9waWNzJywgW1wiJGZpcmViYXNlT2JqZWN0XCIsIFwiJGZpcmViYXNlQXJyYXlcIiwgXCJGaXJlYmFzZVVybFwiLCBmdW5jdGlvbiAoJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSwgRmlyZWJhc2VVcmwpIHtcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcycpXG4gICAgdmFyIHRvcGljcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpXG4gICAgdmFyIHRvcGljc0FyciA9ICRmaXJlYmFzZUFycmF5KHJlZilcbiAgICB2YXIgdG9waWNLZXkgPSAnJ1xuXG4gICAgdmFyIFRvcGljcyA9IHtcbiAgICAgIC8vIEdldCB0b3BpYyB0YWdcbiAgICAgIGdldFRhZzogZnVuY3Rpb24gKHRhZykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgndGFncycpLmVxdWFsVG8odGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldCB0b3BpYyBzbHVnXG4gICAgICBnZXRTbHVnOiBmdW5jdGlvbiAoc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHNsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpY3MgY3JlYXRlZCBieSB1c2VyX2lkXG4gICAgICBjcmVhdGVkQnk6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3VpZCcpLmVxdWFsVG8odWlkKSlcblxuICAgICAgfSxcbiAgICAgIHJlZkNoaWxkOiBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZClcbiAgICAgIH0sXG4gICAgICBjb3VudFVzZXJUb3BpY3M6IGZ1bmN0aW9uICgpIHt9LFxuXG4gICAgICAvLyBHZXR0aW5nIHRoZSBsaXN0IG9mIHRvcGljIGJhc2Ugb24gY2F0ZWdvcnlcbiAgICAgIGxpc3Q6IGZ1bmN0aW9uIChjYXRlZ29yeSkge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ2NhdGVnb3J5JykuZXF1YWxUbyhjYXRlZ29yeSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICBuYW1lOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoJ3NsdWcnKS5lcXVhbFRvKHRvcGljX3NsdWcpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIFJlZlxuICAgICAgZm9ydG9waWNSZWY6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeUtleTogZnVuY3Rpb24gKHRvcGljX2tleSkge1xuICAgICAgICByZXR1cm4gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3RvcGljcy8nICsgdG9waWNfa2V5KVxuICAgICAgfSxcblxuICAgICAgZ2V0VG9waWNCeVNsdWc6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKS5saW1pdFRvRmlyc3QoMSkpXG4gICAgICB9LFxuXG4gICAgICBpbmNyZW1lbnRWaWV3OiBmdW5jdGlvbiAodG9waWNfc2x1Zykge30sXG5cbiAgICAgIC8vIFJldHVybiB0b3BpYyBkZXRhaWxzIGluIGFycmF5XG4gICAgICBmb3J0b3BpYzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KFRvcGljcy5mb3J0b3BpY1JlZih0b3BpY19zbHVnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGxpc3RpbmdcbiAgICAgIHJlcGx5TGlzdDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcycpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5QXJyOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGNvdW50XG4gICAgICByZXBseUNvdW50OiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycpKVxuICAgICAgfSxcbiAgICAgIHJlcGx5Q291bnRSZWY6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy9jb3VudCcpXG4gICAgICB9LFxuXG4gICAgICByZXBseUluUmVwbHk6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmVwbHkgaW4gUmVwbHkgQXJyYXlcbiAgICAgIHJlcGx5SW5SZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQsIHJlcGx5SWQpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJytyZXBseUlkKycvaW5SZXBseScpKSlcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycgKyByZXBseUlkICsgJy9pblJlcGx5JykpXG4gICAgICB9LFxuXG4gICAgICAvLyB1cHZvdGVzXG4gICAgICBnZXRVcHZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSxcbiAgICAgICAgICBhcnJheTogJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZG93bnZvdGVzXG4gICAgICBnZXREb3dudm90ZXM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gZm9sbG93ZXJzXG4gICAgICBnZXRGb2xsb3dlcnM6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICB1cHZvdGVUb3BpYzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb1Vwdm90ZTogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGRvd252b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkpXG4gICAgICB9LFxuXG4gICAgICB1bmRvRG93bnZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKVxuICAgICAgfSxcblxuICAgICAgZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkuc2V0KG1vbWVudCgpLnRvSVNPU3RyaW5nKCkpXG4gICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEudmFsdWUgPT09IG51bGwgfHwgZGF0YS52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KDEpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgKyAxKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZm9sbG93OiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnaGlzdG9yeScpLmNoaWxkKHVpZCkucmVtb3ZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIGVycm9yKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCBzdWNjZXNzZnVsbHkhJylcbiAgICAgICAgICAgICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50JykpLiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKS5jaGlsZCgnY291bnQnKS5zZXQoZGF0YS4kdmFsdWUgLSAxKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9fSlcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKVxuICAgICAgfSxcblxuICAgICAgZ2V0Vmlld3M6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVmOiByZWYuY2hpbGQodG9waWNJZCkuY2hpbGQoJ3ZpZXdzJyksXG4gICAgICAgICAgb2JqOiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpKVxuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBsYXRlc3RGZWVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCdjcmVhdGVkJykubGltaXRUb0xhc3QoMTApKVxuICAgICAgfSxcblxuICAgICAgdG9waWNzQnlUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gYXJyYXlcbiAgICAgIGFycjogJGZpcmViYXNlQXJyYXkocmVmKSxcblxuICAgICAgYWxsOiB0b3BpY3MsXG4gICAgICByZWY6IHJlZlxuICAgIH07XG5cbiAgICByZXR1cm4gVG9waWNzXG5cbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgW1wiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRzdGF0ZVwiLCBcIiRmaWx0ZXJcIiwgXCJtZDVcIiwgXCJBdXRoXCIsIFwiVXNlcnNcIiwgXCJUb3BpY3NcIiwgXCJGYWNlYm9va1wiLCBcIm5vdGlmeVwiLCBcIkNhdGVTZXJ2aWNlXCIsIFwicHJvZmlsZVwiLCBcImlzT3duZXJcIiwgXCJ1c2VyUG9zdHNcIiwgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRmaWx0ZXIsIG1kNSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXJ2aWNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRoLFVzZXJzLFRvcGljcywgRmFjZWJvb2ssbm90aWZ5LENhdGVTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZSxpc093bmVyLHVzZXJQb3N0cyl7XG4gICAgdmFyIHByb2ZpbGVDdHJsID0gdGhpcztcblxuICAgIC8vUGFyc2VyXG4gICAgcHJvZmlsZUN0cmwucHJvZmlsZSAgID0gcHJvZmlsZTtcbiAgICBwcm9maWxlQ3RybC5hdXRoICAgICAgPSBBdXRoO1xuICAgIHByb2ZpbGVDdHJsLnVzZXJzICAgICA9IFVzZXJzO1xuICAgIHByb2ZpbGVDdHJsLnRvcGljcyAgICA9IFRvcGljcztcbiAgICBwcm9maWxlQ3RybC5mYWNlYm9vayAgPSBGYWNlYm9vaztcbiAgICBwcm9maWxlQ3RybC5pc093bmVyICAgPSBpc093bmVyO1xuICAgIHByb2ZpbGVDdHJsLmNhdGUgICAgICA9IENhdGVTZXJ2aWNlO1xuICAgIHByb2ZpbGVDdHJsLiRzdGF0ZSAgICA9ICRzdGF0ZTtcbiAgICBwcm9maWxlQ3RybC51c2VyUG9zdHMgPSB1c2VyUG9zdHM7XG5cbiAgICBwcm9maWxlQ3RybC5mZWVkID0gJyc7XG4gICAgcHJvZmlsZUN0cmwuZWRpdEluaXQgPSAndXNlckVkaXQnO1xuXG4gICAgcHJvZmlsZUN0cmwubmFtZUV4aXN0PSBmYWxzZTtcblxuXG4gICAgcHJvZmlsZUN0cmwuZ2V0VXNlclBvc3QgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZmVlZCA9IHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuXG4gICAgLypMaW5rIGFjY291bnQgd2l0aCBmYWNlYm9vayovXG4gICAgcHJvZmlsZUN0cmwubGlua0ZhY2Vib29rID0gZnVuY3Rpb24oKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmxvZ2luKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmdldExvZ2luU3RhdHVzKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9nZ2VkSW4gPSB0cnVlO1xuICAgICAgICAgICAgcHJvZmlsZUN0cmwuZmFjZWJvb2suYXBpKCcvbWUnLCBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdCBsb2dnZWQgaW5cIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLy9UaGUgb3JpZ2luYWwgdmFsdWUgZnJvbSBwcm9maWxlXG4gICAgcHJvZmlsZUN0cmwub2xkUHJvZmlsZVZhbHVlID0gcHJvZmlsZUN0cmwucHJvZmlsZTtcblxuXG4gICAgcHJvZmlsZUN0cmwudXNlckNyZWF0ZWQgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcmV0dXJuIHByb2ZpbGVDdHJsLnRvcGljcy5jcmVhdGVkQnkodWlkKTtcbiAgICB9XG5cblxuICAgIC8vUHJlc2V0IFBhcmFtZXRlcnNcbiAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3MgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC51c2VyQ2F0ZUZvbGxvdyAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcbiAgICBwcm9maWxlQ3RybC5mb2xsb3dMaXN0ICAgICAgPSAnJztcblxuXG5cblxuXG4gICAgcHJvZmlsZUN0cmwuZm9sbG93Q2F0ZUxpc3RBcnIgPSBmdW5jdGlvbih1aWQpe1xuICAgICAgcHJvZmlsZUN0cmwuZm9sbG93TGlzdCA9IHByb2ZpbGVDdHJsLmNhdGUuZm9sbG93TGlzdCh1aWQpO1xuICAgIH1cblxuICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XG4gICAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlTGlzdEFycihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKTtcbiAgICB9XG5cbiAgICBwcm9maWxlQ3RybC5mb2xsb3dDYXRlID0gZnVuY3Rpb24oaW5kZXgsY2F0ZV9zbHVnKXtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGVJc0ZvbGxvd1tpbmRleF0gID0gdHJ1ZTtcbiAgICAgIHByb2ZpbGVDdHJsLmNhdGUuYWRkQ2hpbGQoY2F0ZV9zbHVnKycvZm9sbG93ZXInKVxuICAgICAgICAuY2hpbGQoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkucHVzaCgpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cblxuXG5cblxuICAgIC8vVXBsb2FkIFByb2ZpbGUgaW1hZ2VcbiAgICBwcm9maWxlQ3RybC51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMpIHtcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpKSB7XG4gICAgICAgIHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICB2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICBwcm9maWxlQ3RybC5pbWFnZVN0cmluZ3NbaV0gPSB1cmk7XG4gICAgICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wicGhvdG9cIjogdXJpfSlcbiAgICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGZsb3dGaWxlLmZpbGUpO1xuICAgICAgfSlcbiAgICB9O1xuXG5cbiAgICAvL1NhdmUgcHJvZmlsZSB3aXRoIHByb2ZpbGVDdHJsLnByb2ZpbGVcbiAgICAvL3BhcmFtczogcmVkaXJlY3QsIGlmIGV4aXN0IHRoZW4gcmVkaXJlY3QgYWZ0ZXIgc2F2ZVxuICAgIHByb2ZpbGVDdHJsLnNhdmVQcm9maWxlID0gZnVuY3Rpb24ocmVkaXJlY3Qpe1xuICAgICAgcHJvZmlsZUN0cmwucHJvZmlsZS51cGRhdGVkID0gbW9tZW50KCkudG9JU09TdHJpbmcoKTtcblxuXG4gICAgICBpZihwcm9maWxlQ3RybC5sb2NhdGlvbiAhPT0gbnVsbCApIHtcbiAgICAgICAgbG9jYXRpb25EZXRhaWwgPSB7XG4gICAgICAgICAgcGxhY2VfaWQ6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMucGxhY2VfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5uYW1lLFxuICAgICAgICAgIGFkZHJlc3M6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZm9ybWF0dGVkX2FkZHJlc3MsXG4gICAgICAgICAgbGF0OiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxuZzogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKSxcbiAgICAgICAgfVxuXG4gICAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUudXNlckxvY2F0aW9uID0gbG9jYXRpb25EZXRhaWw7XG4gICAgICB9XG5cbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBub3RpZnkoe21lc3NhZ2U6J1NhdmVkJyxwb3NpdGlvbjonY2VudGVyJyxkdXJhdGlvbjogMzAwMCB9KTtcbiAgICAgICAgaWYocmVkaXJlY3QgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgJHN0YXRlLmdvKHJlZGlyZWN0KTtcbiAgICAgICAgfVxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgbm90aWZ5KHttZXNzYWdlOidFcnJvciBzYXZpbmcgZGF0YScscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVXBkYXRlIG5hbWVcbiAgICBwcm9maWxlQ3RybC51cGRhdGVOYW1lID0gZnVuY3Rpb24oKXtcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICBcImZpcnN0bmFtZVwiOiAgcHJvZmlsZUN0cmwucHJvZmlsZS5maXJzdG5hbWUsXG4gICAgICAgICAgXCJsYXN0bmFtZVwiOiAgIHByb2ZpbGVDdHJsLnByb2ZpbGUubGFzdG5hbWUsXG4gICAgICAgIH1cbiAgICAgIClcblxuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKycvbG9nJykucHVzaCgpLnNldCh7XG4gICAgICAgIGFjdGlvbjogICBcIm5hbWVfY2hhbmdlXCIsXG4gICAgICAgIG9sZG5hbWU6ICBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUuZmlyc3RuYW1lICsgXCItXCIgKyBwcm9maWxlQ3RybC5vbGRQcm9maWxlVmFsdWUubGFzdG5hbWUsXG4gICAgICAgIGNyZWF0ZWQ6ICBtb21lbnQoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VwZGF0ZSBCaW9cbiAgICBwcm9maWxlQ3RybC51cGRhdGVCaW8gPSBmdW5jdGlvbigpe1xuICAgICAgcHJvZmlsZUN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wiYmlvZ3JhcGh5XCI6IHByb2ZpbGVDdHJsLnByb2ZpbGUuYmlvZ3JhcGh5fSlcblxuICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgfVxuXG5cbiAgICBwcm9maWxlQ3RybC51cGRhdGVQcm9maWxlID0gZnVuY3Rpb24oKXtcbiAgICAgIC8vcHJvZmlsZUN0cmwucHJvZmlsZS5lbWFpbEhhc2ggPSBtZDUuY3JlYXRlSGFzaChhdXRoLnBhc3N3b3JkLmVtYWlsKTtcbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUuJHNhdmUoKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICRzdGF0ZS5nbygnZGFzaGJvYXJkJyk7XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvL0NoZWNrIGlmIHVzZXIgZXhpc3QsIHJldHVybiBmYWxzZSBpZiB0aGV5IGRvXG4gICAgcHJvZmlsZUN0cmwuY2hlY2tVc2VybmFtZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLmNoZWNrVXNlcm5hbWVFeGlzdChwcm9maWxlQ3RybC5wcm9maWxlLmRpc3BsYXlOYW1lKS5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgIGlmKHNuYXBzaG90LnZhbCgpICE9PSBudWxsKXtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PXRydWU7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICByZXR1cm4gcHJvZmlsZUN0cmwubmFtZUV4aXN0PWZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgfV0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnVXNlcnMnLCBbXCIkZmlyZWJhc2VBcnJheVwiLCBcIiRmaXJlYmFzZU9iamVjdFwiLCBcIkZpcmViYXNlVXJsXCIsIFwiJGh0dHBcIiwgZnVuY3Rpb24gKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkaHR0cCkge1xyXG4gICAgdmFyIHVzZXJzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3VzZXJzJylcclxuICAgIHZhciB1c2VycyA9ICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmKVxyXG5cclxuICAgIHZhciBVc2VycyA9IHtcclxuICAgICAgZ2V0TG9jYXRpb25JUDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxyXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBnZXRMb2NhdGlvbklQRGF0YTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxyXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgIHJldHVybiBkYXRhLmRhdGFcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcHJvZmlsZTogZnVuY3Rpb24odWlkKXtcclxuICAgICAgICByZXR1cm4gdXNlcnMuJGdldFJlY29yZCh1aWQpO1xyXG4gICAgICB9LFxyXG5cclxuXHJcbiAgICAgIC8vU2VhcmNoIGFuZCByZXR1cm4gdXNlcm5hbWVcclxuICAgICAgZ2V0UHJvZmlsZUJ5VXNlcm5hbWU6ZnVuY3Rpb24odXNlcm5hbWUpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZi5vcmRlckJ5Q2hpbGQoJ2Rpc3BsYXlOYW1lJykuZXF1YWxUbyh1c2VybmFtZSkpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy9DaGVjayBpZiB1c2VybmFtZSBleGlzdCwgaWYgbm90IHJldHVybiBudWxsXHJcbiAgICAgIGNoZWNrVXNlcm5hbWVFeGlzdDpmdW5jdGlvbih1c2VybmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLm9yZGVyQnlDaGlsZCgnZGlzcGxheU5hbWUnKS5lcXVhbFRvKHVzZXJuYW1lKTtcclxuICAgICAgfSxcclxuXHJcblxyXG4gICAgICBnZXRQcm9maWxlOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0RGlzcGxheU5hbWU6IGZ1bmN0aW9uICh1aWQpIHtcclxuICAgICAgICBpZiAodWlkID09IG51bGwgfHwgdWlkID09PSAnJykge1xyXG4gICAgICAgICAgcmV0dXJuICcnXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZGlzcGxheU5hbWVcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvL0NoZWNrIGlmIHVzZXIgaXMgYWxyZWFkeSBmb2xsb3dpbmdcclxuICAgICAgY2hlY2tGb2xsb3c6ZnVuY3Rpb24odWlkLGZvbGxvd19pZCl7XHJcblxyXG4gICAgICAgIHZhciBmb2xsb3c9ZmFsc2U7XHJcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMvJyt1aWQrJy9zdGF0L2ZvbGxvd2luZy91aWQvJytmb2xsb3dfaWQpO1xyXG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcclxuICAgICAgICAgIGZvbGxvdyA9IHNuYXBzaG90LmV4aXN0cygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVzZXJDaGFuZ2VQYXNzd29yZDpmdW5jdGlvbihlbWFpbCxvbGRwYXNzLG5ld3Bhc3Mpe1xyXG5cclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcclxuICAgICAgICByZWYuY2hhbmdlUGFzc3dvcmQoe1xyXG4gICAgICAgICAgZW1haWw6IGVtYWlsLFxyXG4gICAgICAgICAgb2xkUGFzc3dvcmQ6IG9sZHBhc3MsXHJcbiAgICAgICAgICBuZXdQYXNzd29yZDogbmV3cGFzc1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChlcnJvci5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgY2FzZSBcIklOVkFMSURfUEFTU1dPUkRcIjpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgcGFzc3dvcmQgaXMgaW5jb3JyZWN0LlwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgXCJJTlZBTElEX1VTRVJcIjpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgZG9lcyBub3QgZXhpc3QuXCIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgY2hhbmdpbmcgcGFzc3dvcmQ6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIHBhc3N3b3JkIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVzZXJSZWY6IGZ1bmN0aW9uICh1aWQpIHtcclxuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgdXB2b3RlczogZnVuY3Rpb24gKHVpZCkge1xyXG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCd1cHZvdGVzJylcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGRvd252b3RlczogZnVuY3Rpb24gKHVpZCkge1xyXG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCdkb3dudm90ZXMnKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZm9sbG93aW5nOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2ZvbGxvd2luZycpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1c2VyQXJyUmVmOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZClcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFsbDogdXNlcnNcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gVXNlcnNcclxuICB9XSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ0F1dGhDdHJsJywgZnVuY3Rpb24oQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLCRtZFNpZGVuYXYsJHRyYW5zbGF0ZSwgJGNvb2tpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90aVNlcnZpY2Upe1xyXG4gICAgdmFyIGF1dGhDdHJsID0gdGhpcztcclxuXHJcblxyXG4gICAgLy9QYXJzZXJcclxuICAgIGF1dGhDdHJsLmF1dGggICAgID0gQXV0aDtcclxuICAgIGF1dGhDdHJsLnVzZXJzICAgID0gVXNlcnM7XHJcbiAgICBhdXRoQ3RybC5ub3RpZmljYXRpb24gPSBOb3RpU2VydmljZTtcclxuXHJcblxyXG4gICAgaWYoQXV0aC5yZWYuZ2V0QXV0aCgpICE9IG51bGwgKXtcclxuICAgICAgYXV0aEN0cmwucHJvZmlsZSAgPSBhdXRoQ3RybC51c2Vycy5nZXRQcm9maWxlKEF1dGgucmVmLmdldEF1dGgoKS51aWQpO1xyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgYXV0aEN0cmwucHJvZmlsZSA9JydcclxuICAgIH1cclxuXHJcblxyXG4gICAgYXV0aEN0cmwudXNlciA9IHtcclxuICAgICAgZW1haWw6ICcnLFxyXG4gICAgICBwYXNzd29yZDogJydcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vR2V0IHRoZSBiYWRnZSBub3RpZmljYXRpb25cclxuICAgIGF1dGhDdHJsLmJhZGdlTm90aWZpY2F0aW9uID0gIGF1dGhDdHJsLm5vdGlmaWNhdGlvbi5hZGRBcnJDaGlsZChhdXRoQ3RybC5wcm9maWxlLiRpZCsnL3VucmVhZCcpO1xyXG4gICAgLy9SZXNldCBjb3VudGVyXHJcbiAgICBhdXRoQ3RybC5yZXNldENvdW50ZXIgPSBmdW5jdGlvbigpe1xyXG4gICAgICBhdXRoQ3RybC5ub3RpZmljYXRpb24ucmVzZXRVbnJlYWQoYXV0aEN0cmwucHJvZmlsZS4kaWQpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvL0NoYW5nZSBsYW5ndWFnZVxyXG4gICAgYXV0aEN0cmwudG9nZ2xlTGFuZyA9IGZ1bmN0aW9uIChsYW5nS2V5KSB7XHJcbiAgICAgICR0cmFuc2xhdGUudXNlKGxhbmdLZXkpO1xyXG4gICAgICAvLyBTZXR0aW5nIGEgY29va2llXHJcbiAgICAgICRjb29raWVzLnB1dCgndXNlckxhbmcnLCBsYW5nS2V5KTtcclxuICAgICAgLy9JZiB1c2VyIHJlZ2lzdGVyZWQgLSB1cGRhdGUgdGhpcyBpbiB0aGVpciBwcmVmZXJlbmNlXHJcbiAgICAgIGlmKEF1dGgucmVmLmdldEF1dGgoKSl7XHJcbiAgICAgICAgYXV0aEN0cmwudXNlcnMudXNlckFyclJlZihBdXRoLnJlZi5nZXRBdXRoKCkudWlkKS51cGRhdGUoe1wibGFuZ1wiOmxhbmdLZXl9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy9DaGVja2sgdXNlciBzZWxlY3RlZCBsYW5ndWFnZVxyXG4gICAgaWYoIWF1dGhDdHJsLnByb2ZpbGUubGFuZyl7XHJcbiAgICAgIGlmKCRjb29raWVzLmdldCgndXNlckxhbmcnKSl7XHJcbiAgICAgICAgYXV0aEN0cmwudG9nZ2xlTGFuZygkY29va2llcy5nZXQoJ3VzZXJMYW5nJykpO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICBhdXRoQ3RybC50b2dnbGVMYW5nKCdFbmcnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgYXV0aEN0cmwudG9nZ2xlTGFuZyhhdXRoQ3RybC5wcm9maWxlLmxhbmcpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvL0xvZ2luXHJcbiAgICBhdXRoQ3RybC5sb2dpbiA9IGZ1bmN0aW9uICgpe1xyXG4gICAgICBhdXRoQ3RybC5hdXRoLmF1dGguJGF1dGhXaXRoUGFzc3dvcmQoYXV0aEN0cmwudXNlcikudGhlbihmdW5jdGlvbiAoYXV0aCl7XHJcbiAgICAgICAgJHN0YXRlLmdvKCdkYXNoYm9hcmQnKTtcclxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKXtcclxuICAgICAgICBhdXRoQ3RybC5lcnJvciA9IGVycm9yO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLy9Mb2dvdXRcclxuICAgIGF1dGhDdHJsLmxvZ291dCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgIEF1dGguYXV0aC4kdW5hdXRoKCk7XHJcbiAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvL1JlZ2lzdGVyIHVzZXJcclxuICAgIGF1dGhDdHJsLnJlZ2lzdGVyID0gZnVuY3Rpb24gKCl7XHJcbiAgICAgIEF1dGguYXV0aC4kY3JlYXRlVXNlcihhdXRoQ3RybC51c2VyKS50aGVuKGZ1bmN0aW9uICh1c2VyKXtcclxuICAgICAgICBhdXRoQ3RybC5sb2dpbigpO1xyXG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3Ipe1xyXG4gICAgICAgIGF1dGhDdHJsLmVycm9yID0gZXJyb3I7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgYXV0aEN0cmwudG9nZ2xlUmlnaHQgPSBidWlsZFRvZ2dsZXIoJ3JpZ2h0Jyk7XHJcbiAgICBmdW5jdGlvbiBidWlsZFRvZ2dsZXIobmF2SUQpIHtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRtZFNpZGVuYXYobmF2SUQpXHJcbiAgICAgICAgICAudG9nZ2xlKClcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ0F1dGgnLCBmdW5jdGlvbigkZmlyZWJhc2VBdXRoLCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcclxuICAgIHZhciBhdXRoID0gJGZpcmViYXNlQXV0aChyZWYpO1xyXG5cclxuICAgIHZhciBBdXRoID0ge1xyXG4gICAgICByZWY6cmVmLFxyXG4gICAgICBhdXRoOiBhdXRoLFxyXG5cclxuICAgICAgZ2V0VWlkOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIHVpZCA9IHJlZi5nZXRBdXRoKCk7XHJcbiAgICAgICAgaWYodWlkICE9IG51bGwgKXtcclxuICAgICAgICAgIHJldHVybiByZWYuZ2V0QXV0aCgpLnVpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIEF1dGg7XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdDYXRlQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSwgQ2F0ZWdvcnksY2F0ZU5hbWUsY2F0ZVRvcGljcyl7XHJcbiAgICB2YXIgY2F0ZUN0cmwgPSB0aGlzO1xyXG5cclxuICAgIC8vUGFyc2Vyc1xyXG4gICAgY2F0ZUN0cmwuY2F0ZU5hbWUgICA9IGNhdGVOYW1lO1xyXG4gICAgY2F0ZUN0cmwuY2F0ZWdvcnkgICA9IENhdGVnb3J5O1xyXG4gICAgY2F0ZUN0cmwuY2F0ZVRvcGljcyA9IGNhdGVUb3BpY3M7XHJcblxyXG4gIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuXHJcbiAgLy9Ub3BpYyBsaXN0XHJcbiAgLmZhY3RvcnkoJ0NhdGVTZXJ2aWNlJywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCAkZmlyZWJhc2VBcnJheSAsIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMnKTtcclxuICAgIHZhciBjYXRlZ29yaWVzID0gJGZpcmViYXNlT2JqZWN0KHJlZik7XHJcblxyXG4gICAgdmFyIENhdGUgPSB7XHJcblxyXG4gICAgICBuYW1lOiBmdW5jdGlvbih0b3BpY19zbHVnKXtcclxuICAgICAgICB2YXIgZGF0YSA9IHJlZi5vcmRlckJ5Q2hpbGQoXCJzbHVnXCIpLmVxdWFsVG8odG9waWNfc2x1Zyk7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChkYXRhKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGZvcnRvcGljOiBmdW5jdGlvbih0b3BpY19zbHVnKXtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBmb2xsb3dMaXN0OmZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKFwibmV3cy9mb2xsb3dlclwiKS5lcXVhbFRvKHVpZCk7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KGRhdGEpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgdW5Gb2xsb3c6ZnVuY3Rpb24oc2x1Zyx1aWQpe1xyXG4gICAgICAgIHZhciByZWYgICAgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2NhdGVnb3JpZXMvJytzbHVnKycvZm9sbG93ZXIvJyt1aWQpO1xyXG4gICAgICAgIHJlZi5yZW1vdmUoKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVzZXJGb2xsb3c6ZnVuY3Rpb24oc2x1Zyx1aWQpe1xyXG4gICAgICAgIHZhciBmb2xsb3c9ZmFsc2U7XHJcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnY2F0ZWdvcmllcy8nK3NsdWcrJy9mb2xsb3dlci8nK3VpZCk7XHJcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xyXG4gICAgICAgICAgZm9sbG93ID0gc25hcHNob3QuZXhpc3RzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gZm9sbG93O1xyXG4gICAgICB9LFxyXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXHJcbiAgICAgIGFsbDpjYXRlZ29yaWVzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gQ2F0ZTtcclxuICB9KVxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcblxyXG4gIC8vVG9waWMgbGlzdFxyXG4gIC5mYWN0b3J5KCdQb3N0JywgZnVuY3Rpb24oJGZpcmViYXNlT2JqZWN0LCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKyd0b3BpY3MnKTtcclxuICAgIHZhciB0b3BpY3MgPSAkZmlyZWJhc2VPYmplY3QocmVmKTtcclxuXHJcbiAgICB2YXIgVFMgPSB7XHJcbiAgICAgIHRvcGljTmFtZTogZnVuY3Rpb24odG9waWNfc2x1Zyl7XHJcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKFwic2x1Z1wiKS5lcXVhbFRvKHRvcGljX3NsdWcpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGZvcnRvcGljOiBmdW5jdGlvbih0b3BpY19zbHVnKXtcclxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHVzZXJzUmVmLmNoaWxkKHVpZCkpO1xyXG4gICAgICB9LFxyXG4gICAgICBhbGw6dG9waWNzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gVFM7XHJcbiAgfSlcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdEYXNoYm9hcmRDdHJsJywgZnVuY3Rpb24oQXV0aCwgJHN0YXRlLENhdGVnb3J5LENhdGVTZXJ2aWNlLFRhZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dCwgJG1kU2lkZW5hdiwgJGxvZykge1xyXG4gICAgdmFyIGRhc2hib2FyZEN0cmwgPSB0aGlzO1xyXG5cclxuICAgIGRhc2hib2FyZEN0cmwuYXV0aCA9IEF1dGg7XHJcblxyXG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlID0gQ2F0ZVNlcnZpY2U7XHJcbiAgICBkYXNoYm9hcmRDdHJsLmNhdGVnb3JpZXMgICAgICA9IENhdGVnb3J5LmFsbDtcclxuICAgIGRhc2hib2FyZEN0cmwudG9waWNfZ3JpZCAgPSBmYWxzZTtcclxuICAgIGRhc2hib2FyZEN0cmwudGFncyAgICAgICAgPSBUYWdzLmFycjtcclxuXHJcbiAgICBkYXNoYm9hcmRDdHJsLnVzZXJDYXRlRm9sbG93ICA9IFtdO1xyXG4gICAgZGFzaGJvYXJkQ3RybC5jYXRlSXNGb2xsb3cgICAgPSBbXTtcclxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93TGlzdCAgICAgID0gJyc7XHJcblxyXG5cclxuICAgIC8vQ2xvc2UgU2lkZSBiYXJcclxuICAgIGRhc2hib2FyZEN0cmwuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICRtZFNpZGVuYXYoJ3JpZ2h0JykuY2xvc2UoKTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIGRhc2hib2FyZEN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGNhdGVfc2x1Zyl7XHJcbiAgICAgIGRhc2hib2FyZEN0cmwuY2F0ZS5hZGRDaGlsZChjYXRlX3NsdWcrJy9mb2xsb3dlcicpXHJcbiAgICAgICAgLmNoaWxkKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuXHJcbiAgLy9MaXN0IG9mIGNhdGVnb3JpZXMgb24gdGhlIHNpZGVyYmFyXHJcbiAgLmRpcmVjdGl2ZSgncmV2aWV3U2NvcmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogICAgICdFJyxcclxuICAgICAgdHJhbnNjbHVkZTogICB0cnVlLFxyXG4gICAgICBjb250cm9sbGVyOiAgICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICAndGVtcGxhdGVzL2h0bWwvcmV2aWV3LXN1bW1hcnktbGlzdC5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICByZXZpZXc6ICc9J1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgLy9Gb2xsb3cgQnV0dG9uXHJcbiAgLmRpcmVjdGl2ZSgndXNlckZvbGxvd2VyQnRuJyxmdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVzdHJpY3Q6ICAgICAnRScsXHJcbiAgICAgIHRyYW5zY2x1ZGU6ICAgdHJ1ZSxcclxuICAgICAgY29udHJvbGxlcjogICAnVG9waWNDdHJsIGFzIHRvcGljQ3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAgJ3RlbXBsYXRlcy9odG1sL2ZvbGxvdy11c2VyLmh0bWwnLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIGZvbGxvdzogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KVxyXG5cclxuICAvL0NhdGVnb3J5IGZvbGxvdyBidXR0b25cclxuICAuZGlyZWN0aXZlKCdjYXRlRm9sbG93QnRuJyxmdW5jdGlvbigpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZEN0cmwgYXMgZGFzaGJvYXJkQ3RybCcsXHJcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2h0bWwvY2F0ZWdvcnktZm9sbG93LWJ0bi5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBjYXRlOiAnPSdcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIC8vTGlzdCBvZiBjYXRlZ29yaWVzIG9uIHRoZSBzaWRlcmJhclxyXG4gIC5kaXJlY3RpdmUoJ3RvcGljR3JpZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDdHJsIGFzIGRhc2hib2FyZEN0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL2NhdGVnb3J5LWdyaWQuaHRtbCdcclxuICAgIH1cclxuICB9KVxyXG5cclxuICAvL0dyaWQgVGFncyBmb3Igc2lkZWJhclxyXG4gIC5kaXJlY3RpdmUoJ3RhZ0dyaWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjb250cm9sbGVyOiAnRGFzaGJvYXJkQ3RybCBhcyBkYXNoYm9hcmRDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90YWctZ3JpZC5odG1sJ1xyXG4gICAgfVxyXG4gIH0pXHJcblxyXG5cclxuICAuZGlyZWN0aXZlKCd0b3BpY0NyZWF0ZScsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udHJvbGxlcjogJ1RvcGljQ3RybCBhcyB0b3BpY0N0cmwnLFxyXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9odG1sL3RvcGljLWNyZWF0ZS5odG1sJyxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICB0b3BpYzogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfSlcclxuXHJcblxyXG4gIC5kaXJlY3RpdmUoJ3RvcGljTGlzdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90b3BpYy1saXN0Lmh0bWwnLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIHRvcGljczogJz0nXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KVxyXG5cclxuXHJcbiAgLmRpcmVjdGl2ZSgndG9waWNBY3Rpb25zQ2FyZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbnRyb2xsZXI6ICdUb3BpY0N0cmwgYXMgdG9waWNDdHJsJyxcclxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaHRtbC90b3BpYy1hY3Rpb25zLWNhcmQuaHRtbCcsXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgdG9waWM6ICc9J1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcblxyXG4gIC8vZm9yIHRhZ3MgLSBtYXggdGFnc1xyXG4gIC5kaXJlY3RpdmUoJ2VuZm9yY2VNYXhUYWdzJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdDdHJsKSB7XHJcbiAgICAgIHZhciBtYXhUYWdzID0gYXR0cnMubWF4VGFncyA/IHBhcnNlSW50KGF0dHJzLm1heFRhZ3MsICc0JykgOiBudWxsO1xyXG5cclxuICAgICAgbmdDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgJiYgbWF4VGFncyAmJiB2YWx1ZS5sZW5ndGggPiBtYXhUYWdzKSB7XHJcbiAgICAgICAgICB2YWx1ZS5zcGxpY2UodmFsdWUubGVuZ3RoIC0gMSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdIb21lQ3RybCcsIGZ1bmN0aW9uKCRzdGF0ZSxDYXRlZ29yeSxUb3BpY3MsZmVlZCl7XHJcbiAgICB2YXIgaG9tZUN0cmwgPSB0aGlzO1xyXG5cclxuICAgIGhvbWVDdHJsLnRvcGljcyA9IENhdGVnb3J5O1xyXG4gICAgaG9tZUN0cmwudG9waWNzID0gVG9waWNzO1xyXG4gICAgaG9tZUN0cmwuZmVlZCAgID0gZmVlZDtcclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbmZpZyhbJyR0cmFuc2xhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ0VuZycsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ0Rhc2hib2FyZCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICdMYW5ndWFnZXMnLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAnSG9tZScsXHJcbiAgICAgICdLRVlfUkVHSVNURVInOiAgICdSZWdpc3RlcicsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICdMb2cgaW4nLFxyXG4gICAgICAnS0VZX0xPR09VVCc6ICAgICAnTG9nIG91dCcsXHJcbiAgICAgICdLRVlfRk9MTE9XJzogICAgICdGb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0VSJzogICAnRm9sbG93ZXInLFxyXG4gICAgICAnS0VZX1VORk9MTE9XJzogICAnVW5mb2xsb3cnLFxyXG4gICAgICAnS0VZX0ZPTExPV0lORyc6ICAnRm9sbG93aW5nJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ1Bvc3QnLFxyXG4gICAgICAnS0VZX1BPU1RFRCc6ICAgICAnUG9zdGVkJyxcclxuICAgICAgJ0tFWV9VUFZPVEUnOiAgICAgJ1Vwdm90ZScsXHJcbiAgICAgICdLRVlfVVBWT1RFRCc6ICAgICdVcHZvdGVkJyxcclxuICAgICAgJ0tFWV9EV05fVk9URSc6ICAgJ0Rvd252b3RlJyxcclxuICAgICAgJ0tFWV9EV05fVk9URUQnOiAgJ0Rvd252b3RlZCcsXHJcbiAgICAgICdLRVlfVklFVyc6ICAgICAgICdWaWV3JyxcclxuICAgICAgJ0tFWV9SRU1PVkUnOiAgICAgJ1JlbW92ZScsXHJcbiAgICAgICdLRVlfQ0FOQ0VMJzogICAgICdDYW5jZWwnLFxyXG4gICAgICAnS0VZX1FVRVNUSU9OJzogICAnUXVlc3Rpb24nLFxyXG4gICAgICAnS0VZX1RPUElDJzogICAgICAnVG9waWMnLFxyXG4gICAgICAnS0VZX0NIR19QV0QnOiAgICAnQ2hhbmdlIFBhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9QQVNTV09SRCc6ICAgJ1Bhc3N3b3JkJyxcclxuICAgICAgJ0tFWV9PTERfUFdEJzogICAgJ09sZCBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfTkVXX1BXRCc6ICAgICdOZXcgUGFzc3dvcmQnLFxyXG4gICAgICAnS0VZX05FV19QV0RfQyc6ICAnTmV3IHBhc3N3b3JkIGNvbmZpcm1hdGlvbicsXHJcbiAgICAgICdLRVlfU0FWRSc6ICAgICAgICdTYXZlJyxcclxuICAgICAgJ0tFWV9TQVZFX0RSQUZUJzogJ1NhdmUgYXMgZHJhZnQnLFxyXG4gICAgICAnS0VZX1RBR1MnOiAgICAgICAnVGFncycsXHJcbiAgICAgICdLRVlfRVhQTE9SRSc6ICAgICdFeHBsb3JlJyxcclxuICAgICAgJ0tFWV9DT01NRU5UUyc6ICAgJ0NvbW1lbnRzJyxcclxuICAgICAgJ0tFWV9SRVBMWSc6ICAgICAgJ1JlcGx5JyxcclxuICAgICAgJ0tFWV9SRVZJRVcnOiAgICAgJ1JldmlldycsXHJcbiAgICAgICdLRVlfRURJVCc6ICAgICAgICdFZGl0JyxcclxuICAgICAgJ0tFWV9UUkVORCc6ICAgICAgJ1RyZW5kJyxcclxuICAgICAgJ0tFWV9UUkVORElORyc6ICAgJ1RyZW5kaW5nJyxcclxuICAgICAgJ0tFWV9XUklURV9SRVBMWSc6J1dyaXRlIGEgcmVwbHknLFxyXG4gICAgICAnS0VZX0xBVEVTVF9GRUVEJzonTGF0ZXN0IEZlZWQnLFxyXG5cclxuICAgICAgLy9SZW1vdmUgdG9waWNcclxuICAgICAgJ0tFWV9DT05GX1JFTU9WRSc6J0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmU/JyxcclxuICAgICAgJ0tFWV9DT05GX1JFTV9DJzogJ09uY2UgcmVtb3ZlLCB5b3Ugd2lsbCBub3QgYmUgYWJsZXRvIHRvIGdldCB0aGlzIHRvcGljIGJhY2snLFxyXG5cclxuXHJcbiAgICAgIC8vU0VOVEVOQ0VcclxuICAgICAgJ0tFWV9XSEFUX09OX1VSX01JTkQnOiAgJ1doYXRcXCdzIG9uIHlvdXIgbWluZD8nLFxyXG4gICAgICAnS0VZX1lPVV9XQU5UX0ZPTExPVyc6ICAnWW91IG1heSB3YW50IHRvIGZvbGxvdycsXHJcbiAgICAgICdLRVlfTk9fQUNDVF9SRUdJU1RFUic6ICdEb25cXCd0IGhhdmUgYWNjb3VudD8gUmVnaXN0ZXInLFxyXG4gICAgICAnS0VZX0NBTlRfQ0hOR19VU0VSJzogICAnRG9uXFwndCBoYXZlIGFjY291bnQ/IFJlZ2lzdGVyJyxcclxuICAgICAgJ0tFWV9ZT1VSX0FDQ09VTlQnOiAgICAgJ1lvdXIgYWNjb3VudCcsXHJcbiAgICAgICdLRVlfTk9USElOR19IRVJFJzogICAgICdOb3RoaW5nIGhlcmUsIHlldCcsXHJcbiAgICAgICdLRVlfV0hPX1RPX0ZPTExPVyc6ICAgICdXaG8gdG8gZm9sbG93JyxcclxuICAgICAgJ0tFWV9DQVRfV0lMTF9BUFBFQVInOiAgJ0ZvbGxvdyBzb21lIGNhdGVnb3JpZXMgYW5kIGl0IHdpbGwgYXBwZWFyIGhlcmUnLFxyXG4gICAgICAnS0VZX1dIVF9VUl9TVE9SWSc6ICAgICAnV2hhdFxcJ3MgeW91ciBzdG9yeScsXHJcbiAgICAgICdLRVlfV1JUX0NPTU1FTlQnOiAgICAgICdXcml0ZSBhIGNvbW1lbnQnLFxyXG5cclxuXHJcblxyXG4gICAgICAvL1VTRVIgSU5QVVRcclxuICAgICAgJ0tFWV9GSVJTVE5BTUUnOiAgJ0ZpcnN0IG5hbWUnLFxyXG4gICAgICAnS0VZX0xBU1ROQU1FJzogICAnTGFzdCBuYW1lJyxcclxuICAgICAgJ0tFWV9CSVJUSERBWSc6ICAgJ0JpcnRoZGF5JyxcclxuICAgICAgJ0tFWV9NT05USCc6ICAgICAgJ01vbnRoJyxcclxuICAgICAgJ0tFWV9EQVknOiAgICAgICAgJ0RheScsXHJcbiAgICAgICdLRVlfRU1BSUwnOiAgICAgICdFbWFpbCcsXHJcbiAgICAgICdLRVlfQ09ORl9FTUFJTCc6ICdDb25maXJtIEVtYWlsJyxcclxuICAgICAgJ0tFWV9HRU5ERVInOiAgICAgJ0dlbmRlcicsXHJcbiAgICAgICdLRVlfTUFMRSc6ICAgICAgICdNYWxlJyxcclxuICAgICAgJ0tFWV9GRU1BTEUnOiAgICAgJ0ZlbWFsZScsXHJcbiAgICAgICdLRVlfVVNFUk5BTUUnOiAgICdVc2VybmFtZScsXHJcbiAgICAgICdLRVlfTE9DQVRJT04nOiAgICdMb2NhdGlvbicsXHJcblxyXG4gICAgICAvL1VzZXIgRWRpdFxyXG4gICAgICAnS0VZX0VEX1BST0ZJTEUnOiAnRWRpdCBQcm9maWxlJyxcclxuICAgICAgJ0tFWV9FRF9DSEdfUFdEJzogJ0NoYW5nZSBQYXNzd29yZCcsXHJcbiAgICAgICdLRVlfRURfUFJPRklMRSc6ICdFZGl0IFByb2ZpbGUnLFxyXG4gICAgICAnS0VZX0VEX1NJVEUnOiAgICAnV2Vic2l0ZScsXHJcbiAgICAgICdLRVlfRURfUEhPTkUnOiAgICdQaG9uZScsXHJcbiAgICAgICdLRVlfRURfQklPJzogICAgICdCaW9ncmFwaHknLFxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci50cmFuc2xhdGlvbnMoJ+C5hOC4l+C4oicsIHtcclxuICAgICAgJ0tFWV9EQVNIQk9BUkQnOiAgJ+C4q+C5ieC4reC4h+C4l+C4seC5ieC4h+C4q+C4oeC4lCcsXHJcbiAgICAgICdLRVlfTEFOR1VBR0VTJzogICfguKDguLLguKnguLInLFxyXG4gICAgICAnS0VZX0hPTUUnOiAgICAgICAn4Lir4LiZ4LmJ4Liy4LmB4Lij4LiBJyxcclxuICAgICAgJ0tFWV9SRUdJU1RFUic6ICAgJ+C4quC4oeC4seC4hOC4o+C5g+C4iuC5iScsXHJcbiAgICAgICdLRVlfTE9HSU4nOiAgICAgICfguYDguILguYnguLLguKrguLnguYjguKPguLDguJrguJonLFxyXG4gICAgICAnS0VZX0ZPTExPVyc6ICAgICAn4LiV4Li04LiU4LiV4Liy4LihJyxcclxuICAgICAgJ0tFWV9QT1NUJzogICAgICAgJ+C5guC4nuC4quC4leC5jCdcclxuICAgIH0pO1xyXG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnZW4nKTtcclxuICB9XSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ05vdGlDdHJsJywgZnVuY3Rpb24oJHN0YXRlLENhdGVnb3J5LFRvcGljcyxOb3RpU2VydmljZSl7XHJcbiAgICB2YXIgbm90aUN0cmwgPSB0aGlzO1xyXG5cclxuXHJcbiAgICBub3RpQ3RybC50b3BpY3MgPSBUb3BpY3M7XHJcbiAgICBub3RpQ3RybC5mZWVkICAgPSBmZWVkO1xyXG4gICAgbm90aUN0cmwubm90aVNlcnZpY2UgPSBOb3RpU2VydmljZTtcclxuXHJcbiAgICBub3RpQ3RybC5ub3RpZnlUbyA9ZnVuY3Rpb24odWlkKXtcclxuICAgICAgcmV0dXJuIG5vdGlDdHJsLmFyci5wdXNoKHVpZCkuJGFkZCh1aWQpXHJcbiAgICB9XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAuZmFjdG9yeSgnTm90aVNlcnZpY2UnLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5ICwgRmlyZWJhc2VVcmwpe1xyXG4gICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uJyk7XHJcbiAgICB2YXIgbm90aSA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG5cclxuICAgIHZhciBOb3RpZmljYXRpb24gPSB7XHJcblxyXG4gICAgICB1bnJlYWROb3RpZmljYXRpb246ZnVuY3Rpb24odWlkKXtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydub3RpZmljYXRpb24vJyt1aWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCRmaXJlYmFzZU9iamVjdChyZWYub3JkZXJCeUNoaWxkKFwiaXNfcmVhZFwiKS5lcXVhbFRvKFwiZmFsc2VcIikpKTtcclxuICAgICAgfSxcclxuXHJcblxyXG4gICAgICAvL1Jlc2V0IHVucmVhZCBjb3VudGVyXHJcbiAgICAgIHJlc2V0VW5yZWFkOmZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XHJcbiAgICAgICAgcmVmLnNldCgwKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVwZGF0ZU5vdGlmaWNhdGlvbkNvdW50OmZ1bmN0aW9uKHVpZCl7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsnbm90aWZpY2F0aW9uLycrdWlkKycvdW5yZWFkJyk7XHJcbiAgICAgICAgcmVmLm9uY2UoXCJ2YWx1ZVwiLCBmdW5jdGlvbihzbmFwc2hvdCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coc25hcHNob3QudmFsKCkpO1xyXG4gICAgICAgICBpZihzbmFwc2hvdC52YWwoKSA9PSAnbnVsbCcpe1xyXG4gICAgICAgICAgIGNvbnNvbGUubG9nKCdudWxsJylcclxuICAgICAgICAgICAgcmVmLnNldCgxKVxyXG4gICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgY29uc29sZS5sb2coJ2luY3JlbWVudCBoZXJlJylcclxuICAgICAgICAgICAgcmVmLnNldChzbmFwc2hvdC52YWwoKSArIDEpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvck9iamVjdCkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgcmVhZCBmYWlsZWQ6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XHJcbiAgICAgICAgfSk7ICAgICAgICAgc1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgYWRkQXJyQ2hpbGQ6ZnVuY3Rpb24oY2hpbGQpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKGNoaWxkKSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXHJcbiAgICAgIGFsbDogbm90aVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcclxuICB9KVxyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmNvbnRyb2xsZXIoJ1BsYWNlc0N0cmwnLCBmdW5jdGlvbigkc3RhdGUsJHNjb3BlLCRyb290U2NvcGUsICRtZERpYWxvZywgJG1kTWVkaWEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWdzLCBUb3BpY3MsIEF1dGgsIFVzZXJzLCBTbHVnLExhbmd1YWdlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlTGFuZGluZykge1xyXG5cclxuICAgIHZhciBwbGFjZXNDdHJsID0gdGhpcztcclxuICAgIGNvbnNvbGUubG9nKHBsYWNlTGFuZGluZyk7XHJcbiAgICBwbGFjZXNDdHJsLnBsYWNlTGFuZGluZyA9IHBsYWNlTGFuZGluZztcclxuXHJcbiAgfSk7XHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcclxuICAuZmFjdG9yeSgnUGxhY2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuXHJcbiAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydwbGFjZXMnKTtcclxuICAgIHZhciBwbGFjZURldGFpbF9yZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3BsYWNlc19kZXRhaWxzJyk7XHJcblxyXG4gICAgdmFyIHBsYWNlcyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XHJcblxyXG4gICAgdmFyIFBsYWNlcyA9IHtcclxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChjaGlsZG5hbWUpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhZGRQbGFjZURldGFpbENoaWxkOiBmdW5jdGlvbihjaGlsZG5hbWUpe1xyXG4gICAgICAgIHJldHVybiBwbGFjZURldGFpbF9yZWYuY2hpbGQoY2hpbGRuYW1lKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0UGxhY2VSZWY6ZnVuY3Rpb24ocGxhY2VfaWQpe1xyXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQocGxhY2VfaWQrJy9pbmZvJyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFycjogcGxhY2VzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGxhY2VzO1xyXG4gIH0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG5cclxuICAvL0NhdGVnb3J5IGxpc3RcclxuICAuZmFjdG9yeSgnQ2F0ZWdvcnknLCBmdW5jdGlvbigkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5LCBGaXJlYmFzZVVybCl7XHJcbiAgICB2YXIgcmVmICAgID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKydjYXRlZ29yaWVzJyk7XHJcbiAgICB2YXIgY2F0ZWdvcmllcyA9ICRmaXJlYmFzZU9iamVjdChyZWYpO1xyXG4gICAgdmFyIHRvcGljQXJyID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICB2YXIgQ2F0ZWdvcnkgPSB7XHJcbiAgICAgIGdldE5hbWU6IGZ1bmN0aW9uKHNsdWcpe1xyXG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHNsdWcpO1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VPYmplY3QoZGF0YSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBhbGw6IGNhdGVnb3JpZXNcclxuICAgIH1cclxuICAgIHJldHVybiBDYXRlZ29yeTtcclxuICB9KVxyXG5cclxuXHJcbiAgLy9MYW5ndWFnZXNcclxuICAuZmFjdG9yeSgnTGFuZ3VhZ2VzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2xhbmd1YWdlcycpO1xyXG4gICAgdmFyIGxhbmcgPSAkZmlyZWJhc2VBcnJheShyZWYpO1xyXG5cclxuICAgIHJldHVybiBsYW5nO1xyXG4gIH0pXHJcblxyXG5cclxuICAvL0xhbmd1YWdlc1xyXG4gIC5mYWN0b3J5KCdBcmNoaXZlJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKXtcclxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ2FyY2hpdmUnKTtcclxuICAgIHZhciBhcmNoaXZlID0gJGZpcmViYXNlQXJyYXkocmVmKTtcclxuXHJcbiAgICB2YXIgQXJjaGl2ZSA9e1xyXG4gICAgICBhZGRDaGlsZDogZnVuY3Rpb24oc2x1Zyl7XHJcbiAgICAgICAgcmV0dXJuIHJlZi5jaGlsZChzbHVnKTtcclxuICAgICAgfSxcclxuICAgICAgcmVmOiByZWYsXHJcbiAgICAgIGFycjogYXJjaGl2ZVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFyY2hpdmU7XHJcbiAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHAnKVxyXG4gIC5jb250cm9sbGVyKCdUYWdDdHJsJywgZnVuY3Rpb24oQXV0aCwgVXNlcnMsICRzdGF0ZSwkcm9vdFNjb3BlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdMYW5kaW5nLHRhZ05hbWUpIHtcclxuXHJcbiAgICB2YXIgdGFnQ3RybCA9IHRoaXM7XHJcbiAgICB0YWdDdHJsLnRhZ0xhbmRpbmcgID0gdGFnTGFuZGluZztcclxuICAgIHRhZ0N0cmwudGFnTmFtZSAgICAgPSB0YWdOYW1lO1xyXG5cclxuICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5mYWN0b3J5KCdUYWdzJywgZnVuY3Rpb24oJGZpcmViYXNlQXJyYXksICRmaXJlYmFzZU9iamVjdCwgRmlyZWJhc2VVcmwsICRxKXtcblxuICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRmlyZWJhc2VVcmwrJ3RhZ3MnKTtcbiAgICB2YXIgdGFncyA9ICRmaXJlYmFzZUFycmF5KHJlZik7XG5cbiAgICB2YXIgVGFncyA9IHtcblxuICAgICAgYWRkQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkbmFtZSl7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGRuYW1lKVxuICAgICAgfSxcblxuICAgICAgdGFnc1VybDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmKTtcbiAgICAgIH0sXG5cbiAgICAgIGdldFRhZ1JlZjpmdW5jdGlvbih0YWcpe1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRhZyk7XG4gICAgICB9LFxuXG4gICAgICBnZXRUYWdPYmplY3Q6ZnVuY3Rpb24odGFnKXtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodGFnKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljVGFnczpmdW5jdGlvbih0YWcpe1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCk7XG4gICAgICAgIHZhciBkYXRhUmV0ID0gJyc7XG5cbiAgICAgICAgcmV0dXJuIGZiLmNoaWxkKCd0YWdzLycrdGFnKVxuICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0YWdTbmFwKXtcbiAgICAgICAgICAgIGZiLmNoaWxkKCd0b3BpY3MnKVxuICAgICAgICAgICAgICAub3JkZXJCeUNoaWxkKFwidGFnc1wiKVxuICAgICAgICAgICAgICAuZXF1YWxUbyh0YWcpXG4gICAgICAgICAgICAgIC5vbignY2hpbGRfYWRkZWQnLCBmdW5jdGlvbih0b3BpY1NuYXApIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgLy9zaG93KCBleHRlbmQoe30sIHRhZ1NuYXAudmFsKCksIHRvcGljU25hcC52YWwoKSkgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZW5kKHt9LCB0YWdTbmFwLnZhbCgpLCB0b3BpY1NuYXAudmFsKCkpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YVJldCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgIH0sXG5cbiAgICAgIGFycjogdGFnc1xuXG4gICAgfVxuICAgIHJldHVybiBUYWdzO1xuICB9KVxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdUb3BpY0xhbmRpbmdDdHJsJywgZnVuY3Rpb24gKCRzdGF0ZSwgJHNjb3BlLCBTbHVnLCBUb3BpY3MsIEF1dGgsIFVzZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPd25lcix0b3BpY0xhbmRpbmcsIHJlcGx5TGlzdCwgdmlld0RhdGEsIGZvbGxvd2Vycykge1xuXG4gICAgdmFyIHRvcGljTGFuZGluZ0N0cmwgPSB0aGlzXG5cblxuICAgIHRvcGljTGFuZGluZ0N0cmwuYXV0aCAgICAgICAgID0gQXV0aDtcbiAgICB0b3BpY0xhbmRpbmdDdHJsLnVzZXJzICAgICAgICA9IFVzZXJzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNMYW5kaW5nID0gdG9waWNMYW5kaW5nO1xuICAgIHRvcGljTGFuZGluZ0N0cmwudG9waWNzICAgICAgID0gVG9waWNzO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlMaXN0ICAgID0gcmVwbHlMaXN0O1xuICAgIHRvcGljTGFuZGluZ0N0cmwudmlld3MgICAgICAgID0gdmlld0RhdGE7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5mb2xsb3dlcnMgICAgPSBmb2xsb3dlcnM7XG4gICAgdG9waWNMYW5kaW5nQ3RybC5pc093bmVyICAgICAgPSBpc093bmVyO1xuXG5cblxuXG4gICAgLy9HZXR0aW5nIFJlcGxpZXMgaW4gcmVwbGllc1xuICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFyciA9IFtdO1xuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5ID0gZnVuY3Rpb24oKXtcblxuICAgICAgZm9yKHZhciBpPTA7IGk8dG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3QubGVuZ3RoO2krKyl7XG4gICAgICAgIHZhciB0b3BpY0lkID0gdG9waWNMYW5kaW5nQ3RybC5yZXBseUxpc3RbaV0udG9waWNJZDtcbiAgICAgICAgdmFyIHJlcGx5SWQgPSB0b3BpY0xhbmRpbmdDdHJsLnJlcGx5TGlzdFtpXS4kaWQ7XG4gICAgICAgIHRvcGljTGFuZGluZ0N0cmwuaW5SZXBseUFycltpXSA9IHRvcGljTGFuZGluZ0N0cmwudG9waWNzLnJlcGx5SW5SZXBseSh0b3BpY0lkLHJlcGx5SWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRvcGljTGFuZGluZ0N0cmwucmVwbHlJblJlcGx5KCk7XG4gIH0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwJylcbiAgLy8gVG9waWMgbGlzdFxuICAuZmFjdG9yeSgnVG9waWNzJywgZnVuY3Rpb24gKCRmaXJlYmFzZU9iamVjdCwgJGZpcmViYXNlQXJyYXksIEZpcmViYXNlVXJsKSB7XG4gICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MnKVxuICAgIHZhciB0b3BpY3MgPSAkZmlyZWJhc2VPYmplY3QocmVmKVxuICAgIHZhciB0b3BpY3NBcnIgPSAkZmlyZWJhc2VBcnJheShyZWYpXG4gICAgdmFyIHRvcGljS2V5ID0gJydcblxuICAgIHZhciBUb3BpY3MgPSB7XG4gICAgICAvLyBHZXQgdG9waWMgdGFnXG4gICAgICBnZXRUYWc6IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5vcmRlckJ5Q2hpbGQoJ3RhZ3MnKS5lcXVhbFRvKHRhZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBHZXQgdG9waWMgc2x1Z1xuICAgICAgZ2V0U2x1ZzogZnVuY3Rpb24gKHNsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyhzbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIEdldHRpbmcgdGhlIGxpc3Qgb2YgdG9waWNzIGNyZWF0ZWQgYnkgdXNlcl9pZFxuICAgICAgY3JlYXRlZEJ5OiBmdW5jdGlvbiAodWlkKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd1aWQnKS5lcXVhbFRvKHVpZCkpXG5cbiAgICAgIH0sXG4gICAgICByZWZDaGlsZDogZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiByZWYuY2hpbGQoY2hpbGQpXG4gICAgICB9LFxuICAgICAgY291bnRVc2VyVG9waWNzOiBmdW5jdGlvbiAoKSB7fSxcblxuICAgICAgLy8gR2V0dGluZyB0aGUgbGlzdCBvZiB0b3BpYyBiYXNlIG9uIGNhdGVnb3J5XG4gICAgICBsaXN0OiBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdjYXRlZ29yeScpLmVxdWFsVG8oY2F0ZWdvcnkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShkYXRhKVxuICAgICAgfSxcblxuICAgICAgbmFtZTogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZWYub3JkZXJCeUNoaWxkKCdzbHVnJykuZXF1YWxUbyh0b3BpY19zbHVnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KGRhdGEpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBSZWZcbiAgICAgIGZvcnRvcGljUmVmOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gcmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZylcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlLZXk6IGZ1bmN0aW9uICh0b3BpY19rZXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCArICd0b3BpY3MvJyArIHRvcGljX2tleSlcbiAgICAgIH0sXG5cbiAgICAgIGdldFRvcGljQnlTbHVnOiBmdW5jdGlvbiAodG9waWNfc2x1Zykge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnc2x1ZycpLmVxdWFsVG8odG9waWNfc2x1ZykubGltaXRUb0ZpcnN0KDEpKVxuICAgICAgfSxcblxuICAgICAgaW5jcmVtZW50VmlldzogZnVuY3Rpb24gKHRvcGljX3NsdWcpIHt9LFxuXG4gICAgICAvLyBSZXR1cm4gdG9waWMgZGV0YWlscyBpbiBhcnJheVxuICAgICAgZm9ydG9waWM6IGZ1bmN0aW9uICh0b3BpY19zbHVnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShUb3BpY3MuZm9ydG9waWNSZWYodG9waWNfc2x1ZykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBsaXN0aW5nXG4gICAgICByZXBseUxpc3Q6IGZ1bmN0aW9uICh0b3BpY0lkKSB7XG4gICAgICAgIHZhciBkYXRhID0gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMnKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkoZGF0YSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IEFycmF5XG4gICAgICByZXBseUFycjogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzJykpXG4gICAgICB9LFxuXG4gICAgICAvLyBSZXBseSBjb3VudFxuICAgICAgcmVwbHlDb3VudDogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nKSlcbiAgICAgIH0sXG4gICAgICByZXBseUNvdW50UmVmOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4gcmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvY291bnQnKVxuICAgICAgfSxcblxuICAgICAgcmVwbHlJblJlcGx5OiBmdW5jdGlvbiAodG9waWNJZCwgcmVwbHlJZCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLmNoaWxkKHRvcGljSWQgKyAnL3JlcGxpZXMvJyArIHJlcGx5SWQgKyAnL2luUmVwbHknKSlcbiAgICAgIH0sXG5cbiAgICAgIC8vIFJlcGx5IGluIFJlcGx5IEFycmF5XG4gICAgICByZXBseUluUmVwbHlBcnI6IGZ1bmN0aW9uICh0b3BpY0lkLCByZXBseUlkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9yZXBsaWVzLycrcmVwbHlJZCsnL2luUmVwbHknKSkpXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvcmVwbGllcy8nICsgcmVwbHlJZCArICcvaW5SZXBseScpKVxuICAgICAgfSxcblxuICAgICAgLy8gdXB2b3Rlc1xuICAgICAgZ2V0VXB2b3RlczogZnVuY3Rpb24gKHRvcGljSWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByZWY6IHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJyksXG4gICAgICAgICAgYXJyYXk6ICRmaXJlYmFzZUFycmF5KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGRvd252b3Rlc1xuICAgICAgZ2V0RG93bnZvdGVzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2Rvd252b3RlcycpLFxuICAgICAgICAgIGFycmF5OiAkZmlyZWJhc2VBcnJheShyZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJykpXG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGZvbGxvd2Vyc1xuICAgICAgZ2V0Rm9sbG93ZXJzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9mb2xsb3dlcnMnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgdXB2b3RlVG9waWM6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy91cHZvdGVzJykuY2hpbGQodWlkKSlcbiAgICAgIH0sXG5cbiAgICAgIHVuZG9VcHZvdGU6IGZ1bmN0aW9uICh0b3BpY0lkLCB1aWQpIHtcbiAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL3Vwdm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvdXB2b3RlcycpXG4gICAgICB9LFxuXG4gICAgICBkb3dudm90ZVRvcGljOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICByZXR1cm4gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpKVxuICAgICAgfSxcblxuICAgICAgdW5kb0Rvd252b3RlOiBmdW5jdGlvbiAodG9waWNJZCwgdWlkKSB7XG4gICAgICAgIHJlZi5jaGlsZCh0b3BpY0lkICsgJy9kb3dudm90ZXMnKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZG93bnZvdGVzJylcbiAgICAgIH0sXG5cbiAgICAgIGZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnNldChtb21lbnQoKS50b0lTT1N0cmluZygpKVxuICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGlmIChkYXRhLnZhbHVlID09PSBudWxsIHx8IGRhdGEudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpLnNldCgxKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlICsgMSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdChyZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykpXG4gICAgICB9LFxuXG4gICAgICB1bmZvbGxvdzogZnVuY3Rpb24gKHRvcGljSWQsIHVpZCkge1xuICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2hpc3RvcnknKS5jaGlsZCh1aWQpLnJlbW92ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvcjonLCBlcnJvcilcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5IScpXG4gICAgICAgICAgICAkZmlyZWJhc2VPYmplY3QocmVmLmNoaWxkKHRvcGljSWQgKyAnL2ZvbGxvd2VycycpLmNoaWxkKCdjb3VudCcpKS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJykuY2hpbGQoJ2NvdW50Jykuc2V0KGRhdGEuJHZhbHVlIC0gMSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfX0pXG4gICAgICAgIHJldHVybiByZWYuY2hpbGQodG9waWNJZCArICcvZm9sbG93ZXJzJylcbiAgICAgIH0sXG5cbiAgICAgIGdldFZpZXdzOiBmdW5jdGlvbiAodG9waWNJZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlZjogcmVmLmNoaWxkKHRvcGljSWQpLmNoaWxkKCd2aWV3cycpLFxuICAgICAgICAgIG9iajogJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCh0b3BpY0lkKS5jaGlsZCgndmlld3MnKSlcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgbGF0ZXN0RmVlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGZpcmViYXNlQXJyYXkocmVmLm9yZGVyQnlDaGlsZCgnY3JlYXRlZCcpLmxpbWl0VG9MYXN0KDEwKSlcbiAgICAgIH0sXG5cbiAgICAgIHRvcGljc0J5VGFnOiBmdW5jdGlvbiAodGFnKSB7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheShyZWYub3JkZXJCeUNoaWxkKCd0YWdzJykuZXF1YWxUbyh0YWcpKVxuICAgICAgfSxcblxuICAgICAgLy8gUmV0dXJuIGFycmF5XG4gICAgICBhcnI6ICRmaXJlYmFzZUFycmF5KHJlZiksXG5cbiAgICAgIGFsbDogdG9waWNzLFxuICAgICAgcmVmOiByZWZcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRvcGljc1xuXG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXG4gIC5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCAkZmlsdGVyLCBtZDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VydmljZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXV0aCxVc2VycyxUb3BpY3MsIEZhY2Vib29rLG5vdGlmeSxDYXRlU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNvbHZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGUsaXNPd25lcix1c2VyUG9zdHMpe1xuICAgIHZhciBwcm9maWxlQ3RybCA9IHRoaXM7XG5cbiAgICAvL1BhcnNlclxuICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUgICA9IHByb2ZpbGU7XG4gICAgcHJvZmlsZUN0cmwuYXV0aCAgICAgID0gQXV0aDtcbiAgICBwcm9maWxlQ3RybC51c2VycyAgICAgPSBVc2VycztcbiAgICBwcm9maWxlQ3RybC50b3BpY3MgICAgPSBUb3BpY3M7XG4gICAgcHJvZmlsZUN0cmwuZmFjZWJvb2sgID0gRmFjZWJvb2s7XG4gICAgcHJvZmlsZUN0cmwuaXNPd25lciAgID0gaXNPd25lcjtcbiAgICBwcm9maWxlQ3RybC5jYXRlICAgICAgPSBDYXRlU2VydmljZTtcbiAgICBwcm9maWxlQ3RybC4kc3RhdGUgICAgPSAkc3RhdGU7XG4gICAgcHJvZmlsZUN0cmwudXNlclBvc3RzID0gdXNlclBvc3RzO1xuXG4gICAgcHJvZmlsZUN0cmwuZmVlZCA9ICcnO1xuICAgIHByb2ZpbGVDdHJsLmVkaXRJbml0ID0gJ3VzZXJFZGl0JztcblxuICAgIHByb2ZpbGVDdHJsLm5hbWVFeGlzdD0gZmFsc2U7XG5cblxuICAgIHByb2ZpbGVDdHJsLmdldFVzZXJQb3N0ID0gZnVuY3Rpb24odWlkKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZlZWQgPSBwcm9maWxlQ3RybC50b3BpY3MuY3JlYXRlZEJ5KHVpZCk7XG4gICAgfVxuXG5cblxuICAgIC8qTGluayBhY2NvdW50IHdpdGggZmFjZWJvb2sqL1xuICAgIHByb2ZpbGVDdHJsLmxpbmtGYWNlYm9vayA9IGZ1bmN0aW9uKCl7XG4gICAgICBwcm9maWxlQ3RybC5mYWNlYm9vay5sb2dpbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBwcm9maWxlQ3RybC5mYWNlYm9vay5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgaWYocmVzcG9uc2Uuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2dlZEluID0gdHJ1ZTtcbiAgICAgICAgICAgIHByb2ZpbGVDdHJsLmZhY2Vib29rLmFwaSgnL21lJywgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJub3QgbG9nZ2VkIGluXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vVGhlIG9yaWdpbmFsIHZhbHVlIGZyb20gcHJvZmlsZVxuICAgIHByb2ZpbGVDdHJsLm9sZFByb2ZpbGVWYWx1ZSA9IHByb2ZpbGVDdHJsLnByb2ZpbGU7XG5cblxuICAgIHByb2ZpbGVDdHJsLnVzZXJDcmVhdGVkID0gZnVuY3Rpb24odWlkKXtcbiAgICAgIHJldHVybiBwcm9maWxlQ3RybC50b3BpY3MuY3JlYXRlZEJ5KHVpZCk7XG4gICAgfVxuXG5cbiAgICAvL1ByZXNldCBQYXJhbWV0ZXJzXG4gICAgcHJvZmlsZUN0cmwuaW1hZ2VTdHJpbmdzICAgID0gW107XG4gICAgcHJvZmlsZUN0cmwudXNlckNhdGVGb2xsb3cgID0gW107XG4gICAgcHJvZmlsZUN0cmwuY2F0ZUlzRm9sbG93ICAgID0gW107XG4gICAgcHJvZmlsZUN0cmwuZm9sbG93TGlzdCAgICAgID0gJyc7XG5cblxuXG5cblxuICAgIHByb2ZpbGVDdHJsLmZvbGxvd0NhdGVMaXN0QXJyID0gZnVuY3Rpb24odWlkKXtcbiAgICAgIHByb2ZpbGVDdHJsLmZvbGxvd0xpc3QgPSBwcm9maWxlQ3RybC5jYXRlLmZvbGxvd0xpc3QodWlkKTtcbiAgICB9XG5cbiAgICBpZihBdXRoLnJlZi5nZXRBdXRoKCkpe1xuICAgICAgcHJvZmlsZUN0cmwuZm9sbG93Q2F0ZUxpc3RBcnIoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCk7XG4gICAgfVxuXG4gICAgcHJvZmlsZUN0cmwuZm9sbG93Q2F0ZSA9IGZ1bmN0aW9uKGluZGV4LGNhdGVfc2x1Zyl7XG4gICAgICBwcm9maWxlQ3RybC5jYXRlSXNGb2xsb3dbaW5kZXhdICA9IHRydWU7XG4gICAgICBwcm9maWxlQ3RybC5jYXRlLmFkZENoaWxkKGNhdGVfc2x1ZysnL2ZvbGxvd2VyJylcbiAgICAgICAgLmNoaWxkKEF1dGgucmVmLmdldEF1dGgoKS51aWQpLnB1c2goKS5zZXQobW9tZW50KCkudG9JU09TdHJpbmcoKSk7XG4gICAgfVxuXG5cblxuXG5cbiAgICAvL1VwbG9hZCBQcm9maWxlIGltYWdlXG4gICAgcHJvZmlsZUN0cmwudXBsb2FkRmlsZSA9IGZ1bmN0aW9uKGZpbGVzKSB7XG4gICAgICBhbmd1bGFyLmZvckVhY2goZmlsZXMsIGZ1bmN0aW9uIChmbG93RmlsZSwgaSkge1xuICAgICAgICB2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIGZpbGVSZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgdmFyIHVyaSA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgcHJvZmlsZUN0cmwuaW1hZ2VTdHJpbmdzW2ldID0gdXJpO1xuICAgICAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKHtcInBob3RvXCI6IHVyaX0pXG4gICAgICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmbG93RmlsZS5maWxlKTtcbiAgICAgIH0pXG4gICAgfTtcblxuXG4gICAgLy9TYXZlIHByb2ZpbGUgd2l0aCBwcm9maWxlQ3RybC5wcm9maWxlXG4gICAgLy9wYXJhbXM6IHJlZGlyZWN0LCBpZiBleGlzdCB0aGVuIHJlZGlyZWN0IGFmdGVyIHNhdmVcbiAgICBwcm9maWxlQ3RybC5zYXZlUHJvZmlsZSA9IGZ1bmN0aW9uKHJlZGlyZWN0KXtcbiAgICAgIHByb2ZpbGVDdHJsLnByb2ZpbGUudXBkYXRlZCA9IG1vbWVudCgpLnRvSVNPU3RyaW5nKCk7XG5cblxuICAgICAgaWYocHJvZmlsZUN0cmwubG9jYXRpb24gIT09IG51bGwgKSB7XG4gICAgICAgIGxvY2F0aW9uRGV0YWlsID0ge1xuICAgICAgICAgIHBsYWNlX2lkOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLnBsYWNlX2lkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMubmFtZSxcbiAgICAgICAgICBhZGRyZXNzOiBwcm9maWxlQ3RybC5sb2NhdGlvbi5kZXRhaWxzLmZvcm1hdHRlZF9hZGRyZXNzLFxuICAgICAgICAgIGxhdDogcHJvZmlsZUN0cmwubG9jYXRpb24uZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICBsbmc6IHByb2ZpbGVDdHJsLmxvY2F0aW9uLmRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgIH1cblxuICAgICAgICBwcm9maWxlQ3RybC5wcm9maWxlLnVzZXJMb2NhdGlvbiA9IGxvY2F0aW9uRGV0YWlsO1xuICAgICAgfVxuXG4gICAgICBwcm9maWxlQ3RybC5wcm9maWxlLiRzYXZlKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgbm90aWZ5KHttZXNzYWdlOidTYXZlZCcscG9zaXRpb246J2NlbnRlcicsZHVyYXRpb246IDMwMDAgfSk7XG4gICAgICAgIGlmKHJlZGlyZWN0ICE9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICRzdGF0ZS5nbyhyZWRpcmVjdCk7XG4gICAgICAgIH1cbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgIG5vdGlmeSh7bWVzc2FnZTonRXJyb3Igc2F2aW5nIGRhdGEnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICAvL1VwZGF0ZSBuYW1lXG4gICAgcHJvZmlsZUN0cmwudXBkYXRlTmFtZSA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgXCJmaXJzdG5hbWVcIjogIHByb2ZpbGVDdHJsLnByb2ZpbGUuZmlyc3RuYW1lLFxuICAgICAgICAgIFwibGFzdG5hbWVcIjogICBwcm9maWxlQ3RybC5wcm9maWxlLmxhc3RuYW1lLFxuICAgICAgICB9XG4gICAgICApXG5cbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCsnL2xvZycpLnB1c2goKS5zZXQoe1xuICAgICAgICBhY3Rpb246ICAgXCJuYW1lX2NoYW5nZVwiLFxuICAgICAgICBvbGRuYW1lOiAgcHJvZmlsZUN0cmwub2xkUHJvZmlsZVZhbHVlLmZpcnN0bmFtZSArIFwiLVwiICsgcHJvZmlsZUN0cmwub2xkUHJvZmlsZVZhbHVlLmxhc3RuYW1lLFxuICAgICAgICBjcmVhdGVkOiAgbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgfSk7XG5cbiAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgIH1cblxuXG4gICAgLy9VcGRhdGUgQmlvXG4gICAgcHJvZmlsZUN0cmwudXBkYXRlQmlvID0gZnVuY3Rpb24oKXtcbiAgICAgIHByb2ZpbGVDdHJsLnVzZXJzLnVzZXJBcnJSZWYoQXV0aC5yZWYuZ2V0QXV0aCgpLnVpZCkudXBkYXRlKHtcImJpb2dyYXBoeVwiOiBwcm9maWxlQ3RybC5wcm9maWxlLmJpb2dyYXBoeX0pXG5cbiAgICAgIG5vdGlmeSh7bWVzc2FnZTonU2F2ZWQnLHBvc2l0aW9uOidjZW50ZXInLGR1cmF0aW9uOiAzMDAwIH0pO1xuICAgIH1cblxuXG4gICAgcHJvZmlsZUN0cmwudXBkYXRlUHJvZmlsZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAvL3Byb2ZpbGVDdHJsLnByb2ZpbGUuZW1haWxIYXNoID0gbWQ1LmNyZWF0ZUhhc2goYXV0aC5wYXNzd29yZC5lbWFpbCk7XG4gICAgICBwcm9maWxlQ3RybC5wcm9maWxlLiRzYXZlKCkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgLy9DaGVjayBpZiB1c2VyIGV4aXN0LCByZXR1cm4gZmFsc2UgaWYgdGhleSBkb1xuICAgIHByb2ZpbGVDdHJsLmNoZWNrVXNlcm5hbWUgPSBmdW5jdGlvbigpe1xuXG4gICAgICBwcm9maWxlQ3RybC51c2Vycy5jaGVja1VzZXJuYW1lRXhpc3QocHJvZmlsZUN0cmwucHJvZmlsZS5kaXNwbGF5TmFtZSkub25jZSgndmFsdWUnLCBmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICBpZihzbmFwc2hvdC52YWwoKSAhPT0gbnVsbCl7XG4gICAgICAgICAgcmV0dXJuIHByb2ZpbGVDdHJsLm5hbWVFeGlzdD10cnVlO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHByb2ZpbGVDdHJsLm5hbWVFeGlzdD1mYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcCcpXHJcbiAgLmZhY3RvcnkoJ1VzZXJzJywgZnVuY3Rpb24gKCRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZpcmViYXNlVXJsLCAkaHR0cCkge1xyXG4gICAgdmFyIHVzZXJzUmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsICsgJ3VzZXJzJylcclxuICAgIHZhciB1c2VycyA9ICRmaXJlYmFzZUFycmF5KHVzZXJzUmVmKVxyXG5cclxuICAgIHZhciBVc2VycyA9IHtcclxuICAgICAgZ2V0TG9jYXRpb25JUDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxyXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBnZXRMb2NhdGlvbklQRGF0YTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICB1cmw6ICdodHRwOi8vaXBpbmZvLmlvL2pzb24nLFxyXG4gICAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgIHJldHVybiBkYXRhLmRhdGFcclxuICAgICAgICB9KVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcHJvZmlsZTogZnVuY3Rpb24odWlkKXtcclxuICAgICAgICByZXR1cm4gdXNlcnMuJGdldFJlY29yZCh1aWQpO1xyXG4gICAgICB9LFxyXG5cclxuXHJcbiAgICAgIC8vU2VhcmNoIGFuZCByZXR1cm4gdXNlcm5hbWVcclxuICAgICAgZ2V0UHJvZmlsZUJ5VXNlcm5hbWU6ZnVuY3Rpb24odXNlcm5hbWUpe1xyXG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBcnJheSh1c2Vyc1JlZi5vcmRlckJ5Q2hpbGQoJ2Rpc3BsYXlOYW1lJykuZXF1YWxUbyh1c2VybmFtZSkpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy9DaGVjayBpZiB1c2VybmFtZSBleGlzdCwgaWYgbm90IHJldHVybiBudWxsXHJcbiAgICAgIGNoZWNrVXNlcm5hbWVFeGlzdDpmdW5jdGlvbih1c2VybmFtZSl7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLm9yZGVyQnlDaGlsZCgnZGlzcGxheU5hbWUnKS5lcXVhbFRvKHVzZXJuYW1lKTtcclxuICAgICAgfSxcclxuXHJcblxyXG4gICAgICBnZXRQcm9maWxlOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuICRmaXJlYmFzZU9iamVjdCh1c2Vyc1JlZi5jaGlsZCh1aWQpKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZ2V0RGlzcGxheU5hbWU6IGZ1bmN0aW9uICh1aWQpIHtcclxuICAgICAgICBpZiAodWlkID09IG51bGwgfHwgdWlkID09PSAnJykge1xyXG4gICAgICAgICAgcmV0dXJuICcnXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB1c2Vycy4kZ2V0UmVjb3JkKHVpZCkuZGlzcGxheU5hbWVcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvL0NoZWNrIGlmIHVzZXIgaXMgYWxyZWFkeSBmb2xsb3dpbmdcclxuICAgICAgY2hlY2tGb2xsb3c6ZnVuY3Rpb24odWlkLGZvbGxvd19pZCl7XHJcblxyXG4gICAgICAgIHZhciBmb2xsb3c9ZmFsc2U7XHJcbiAgICAgICAgdmFyIHJlZiAgICA9IG5ldyBGaXJlYmFzZShGaXJlYmFzZVVybCsndXNlcnMvJyt1aWQrJy9zdGF0L2ZvbGxvd2luZy91aWQvJytmb2xsb3dfaWQpO1xyXG4gICAgICAgIHJlZi5vbmNlKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcclxuICAgICAgICAgIGZvbGxvdyA9IHNuYXBzaG90LmV4aXN0cygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGZvbGxvdztcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVzZXJDaGFuZ2VQYXNzd29yZDpmdW5jdGlvbihlbWFpbCxvbGRwYXNzLG5ld3Bhc3Mpe1xyXG5cclxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZpcmViYXNlVXJsKTtcclxuICAgICAgICByZWYuY2hhbmdlUGFzc3dvcmQoe1xyXG4gICAgICAgICAgZW1haWw6IGVtYWlsLFxyXG4gICAgICAgICAgb2xkUGFzc3dvcmQ6IG9sZHBhc3MsXHJcbiAgICAgICAgICBuZXdQYXNzd29yZDogbmV3cGFzc1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChlcnJvci5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgY2FzZSBcIklOVkFMSURfUEFTU1dPUkRcIjpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgcGFzc3dvcmQgaXMgaW5jb3JyZWN0LlwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgXCJJTlZBTElEX1VTRVJcIjpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGhlIHNwZWNpZmllZCB1c2VyIGFjY291bnQgZG9lcyBub3QgZXhpc3QuXCIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgY2hhbmdpbmcgcGFzc3dvcmQ6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyIHBhc3N3b3JkIGNoYW5nZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHVzZXJSZWY6IGZ1bmN0aW9uICh1aWQpIHtcclxuICAgICAgICByZXR1cm4gdXNlcnNSZWYuY2hpbGQodWlkKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgdXB2b3RlczogZnVuY3Rpb24gKHVpZCkge1xyXG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCd1cHZvdGVzJylcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGRvd252b3RlczogZnVuY3Rpb24gKHVpZCkge1xyXG4gICAgICAgIHJldHVybiB1c2Vyc1JlZi5jaGlsZCh1aWQpLmNoaWxkKCdkb3dudm90ZXMnKVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgZm9sbG93aW5nOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZCkuY2hpbGQoJ2ZvbGxvd2luZycpXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB1c2VyQXJyUmVmOiBmdW5jdGlvbiAodWlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJzUmVmLmNoaWxkKHVpZClcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGFsbDogdXNlcnNcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gVXNlcnNcclxuICB9KVxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
